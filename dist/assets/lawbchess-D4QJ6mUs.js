import"./style-B_l4csH6.js";import"./leaderboard-BN2XGABn.js";import"./multiplayer-COHzGpRM.js";import"./chess-27wBeYrn.js";console.log("Starting Supabase initialization...");window.gameDatabase=window.supabase.createClient("https://roxwocgknkiqnsgiojgz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJveHdvY2drbmtpcW5zZ2lvamd6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzA3NjMxMTIsImV4cCI6MjA0NjMzOTExMn0.NbLMZom-gk7XYGdV4MtXYcgR8R1s8xthrIQ0hpQfx9Y",{db:{schema:"public"},auth:{autoRefreshToken:!0,persistSession:!0},realtime:{params:{eventsPerSecond:10,maxBufferSize:1e5},heartbeatIntervalMs:3e4}});async function c(){try{const{data:n,error:l}=await window.gameDatabase.from("leaderboard").select("count").single();if(l)throw l;return console.log("Supabase connection verified"),!0}catch(n){return console.error("Supabase verification failed:",n),!1}}async function r(){await c(),typeof window.initializeMultiplayerManager=="function"&&window.initializeMultiplayerManager(),window.LeaderboardManager&&!window.leaderboardManager&&(window.leaderboardManager=new window.LeaderboardManager),typeof window.initGame=="function"&&window.initGame()}document.addEventListener("DOMContentLoaded",()=>{console.log("DOM fully loaded"),r();const n=(l=1,i=10,s=1500)=>{console.log(`Wallet UI init attempt ${l}, document.readyState: ${document.readyState}`);const e={disconnectWalletBtn:document.getElementById("disconnect-wallet"),addressDisplay:document.getElementById("walletAddress"),walletButtons:document.querySelector(".wallet-buttons"),difficultyScreen:document.getElementById("difficulty-screen"),statusElement:document.getElementById("status"),aiModeBtn:document.getElementById("ai-mode"),multiplayerModeBtn:document.getElementById("multiplayer-mode"),backToSinglePlayerBtn:document.getElementById("back-to-single-player")};if(console.log("Wallet UI elements:",{disconnectWalletBtn:!!e.disconnectWalletBtn,addressDisplay:!!e.addressDisplay,walletButtons:!!e.walletButtons,backToSinglePlayerBtn:!!e.backToSinglePlayerBtn}),!e.addressDisplay||!e.walletButtons)if(l<=i){console.warn(`Critical wallet UI elements not found, retrying in ${s}ms (attempt ${l}/${i})`),setTimeout(()=>n(l+1,i,s),s);return}else{console.error("Critical wallet UI elements not found after max attempts.");return}console.log("Wallet UI elements found, setting up event listeners"),e.disconnectWalletBtn&&(e.disconnectWalletBtn.style.display=localStorage.getItem("currentPlayer")?"block":"none",e.disconnectWalletBtn.addEventListener("click",()=>{if(window.walletConnector){window.walletConnector.disconnectWallet(),e.addressDisplay.style.display="none",e.disconnectWalletBtn.style.display="none",e.walletButtons.style.display="flex",e.difficultyScreen.style.display="none",e.statusElement.textContent="Connect to play";const t=document.querySelector(".multiplayer-menu");t&&(t.classList.add("hidden"),t.style.display="none")}})),e.aiModeBtn&&e.aiModeBtn.addEventListener("click",()=>{console.log("AI mode button clicked"),e.aiModeBtn.classList.add("selected"),e.multiplayerModeBtn.classList.remove("selected"),e.difficultyScreen.style.display="flex";const t=document.querySelector(".multiplayer-menu");t&&(console.log("Hiding multiplayer menu"),t.classList.add("hidden"),t.style.display="none"),window.chessGame&&(window.chessGame.isMultiplayerMode=!1,window.chessGame.updateStatusDisplay("Select a difficulty to start a single-player game")),window.multiplayerManager&&window.multiplayerManager.stopGameStateChecks()}),e.multiplayerModeBtn&&e.multiplayerModeBtn.addEventListener("click",()=>{console.log("Multiplayer mode button clicked"),e.multiplayerModeBtn.classList.add("selected"),e.aiModeBtn.classList.remove("selected"),e.difficultyScreen.style.display="none";const t=document.querySelector(".multiplayer-menu");t&&(console.log("Showing multiplayer menu"),t.classList.remove("hidden"),t.style.display="block"),window.chessGame&&(window.chessGame.isMultiplayerMode=!0,window.chessGame.updateStatusDisplay("Select an option to start a multiplayer game"))}),e.backToSinglePlayerBtn&&e.backToSinglePlayerBtn.addEventListener("click",()=>{console.log("Back to Single Player button clicked"),e.aiModeBtn.classList.add("selected"),e.multiplayerModeBtn.classList.remove("selected"),e.difficultyScreen.style.display="flex";const t=document.querySelector(".multiplayer-menu");t?(console.log("Hiding multiplayer menu"),t.classList.add("hidden"),t.style.display="none"):console.error("Multiplayer menu not found"),window.chessGame&&(window.chessGame.isMultiplayerMode=!1,window.chessGame.updateStatusDisplay("Select a difficulty to start a single-player game")),window.multiplayerManager&&window.multiplayerManager.stopGameStateChecks()}),document.addEventListener("walletConnected",t=>{var d;const{address:a}=t.detail;if(e.addressDisplay.textContent=`Connected [DMT]: ${a.slice(0,4)}...${a.slice(-4)}`,e.addressDisplay.style.display="block",e.walletButtons.style.display="none",e.disconnectWalletBtn&&(e.disconnectWalletBtn.style.display="block"),(d=e.aiModeBtn)!=null&&d.classList.contains("selected")){e.difficultyScreen.style.display="flex";const o=document.querySelector(".multiplayer-menu");o&&(o.classList.add("hidden"),o.style.display="none")}e.statusElement.textContent="Connected. Checking for active game..."}),document.addEventListener("walletDisconnected",()=>{e.addressDisplay.style.display="none",e.difficultyScreen.style.display="none";const t=document.querySelector(".multiplayer-menu");t&&(t.classList.add("hidden"),t.style.display="none");const a=document.getElementById("chess-game");a&&(a.style.display="none"),e.statusElement.textContent="Connect to play",e.disconnectWalletBtn&&(e.disconnectWalletBtn.style.display="none"),e.walletButtons.style.display="flex"}),console.log("Wallet UI initialization complete")};n()});
