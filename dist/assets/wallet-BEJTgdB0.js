const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/embedded-wallet-SxqnNz-1.js","assets/if-defined-5Al-vCnG.js","assets/vendor-B9R9w7LK.js","assets/query-dpKa22bh.js","assets/index-DkpFId51.js","assets/index-85GSrhpv.js","assets/ref-C-0KljE4.js","assets/index-BtcC4rCv.js","assets/index-CdcJPGxE.js","assets/index-DiOqL7Ty.js","assets/index-D6IN6U7Q.js","assets/index-luf8llPF.js","assets/index-BtYYAriB.js","assets/index-WtviJKYv.js","assets/email-Dr8bETm9.js","assets/index-Dm36PmHb.js","assets/socials-B_EA-w2t.js","assets/index-DvjwgGmF.js","assets/ConstantsUtil-Dmg8YACJ.js","assets/index-BRMLZ9fn.js","assets/index-lOk1Qhk-.js","assets/index-hwpX6cec.js","assets/index-H1nc9QEI.js","assets/swaps-CNER8pYh.js","assets/index-2gmriSxH.js","assets/index-D0hxi3iu.js","assets/index-skPpw1VR.js","assets/send-B1GarwWd.js","assets/index-CCmBCpfB.js","assets/index-BHC3DP12.js","assets/receive-DWNjaDsF.js","assets/index-DYPYxsoY.js","assets/onramp-Egp8ZTs9.js","assets/index-CwvvTBnK.js","assets/index-C6rVG7fx.js","assets/index-0-0oHQlP.js","assets/transactions--JUwT97p.js","assets/index-Da-rZJPn.js","assets/index-BtLoahgX.js","assets/index-BYoRe41r.js","assets/index-CK9Fz2P5.js","assets/index-DTgo5DML.js","assets/w3m-modal-CZLUB59t.js","assets/index-tlA5APKf.js"])))=>i.map(i=>d[i]);
import{g as pi,f as uw,a as dw,k as Ub,_ as mr,b as $b,r as Bb,h as Lb,c as Mb,s as Fb,d as vn,e as uf,i as oc,j as jb,t as df,l as hw,m as fw,S as dd,P as hf,C as qb,n as ff,U as Wl,o as zl,p as Hb,w as Wb,q as zb,u as Vb,v as Kb,x as Gb,y as Yb,z as Zb,A as Jb,B as Xb,D as Qb,E as eE,F as $s,G as Vl,H as pf,I as gf,J as tE,K as rE}from"./vendor-B9R9w7LK.js";const nE=Symbol(),mf=Object.getPrototypeOf,hd=new WeakMap,sE=t=>t&&(hd.has(t)?hd.get(t):mf(t)===Object.prototype||mf(t)===Array.prototype),iE=t=>sE(t)&&t[nE]||null,wf=(t,e=!0)=>{hd.set(t,e)},Vc={},Kl=t=>typeof t=="object"&&t!==null,fs=new WeakMap,Fo=new WeakSet,oE=(t=Object.is,e=(l,u)=>new Proxy(l,u),r=l=>Kl(l)&&!Fo.has(l)&&(Array.isArray(l)||!(Symbol.iterator in l))&&!(l instanceof WeakMap)&&!(l instanceof WeakSet)&&!(l instanceof Error)&&!(l instanceof Number)&&!(l instanceof Date)&&!(l instanceof String)&&!(l instanceof RegExp)&&!(l instanceof ArrayBuffer),n=l=>{switch(l.status){case"fulfilled":return l.value;case"rejected":throw l.reason;default:throw l}},s=new WeakMap,i=(l,u,d=n)=>{const h=s.get(l);if((h==null?void 0:h[0])===u)return h[1];const m=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l));return wf(m,!0),s.set(l,[u,m]),Reflect.ownKeys(l).forEach(f=>{if(Object.getOwnPropertyDescriptor(m,f))return;const g=Reflect.get(l,f),{enumerable:_}=Reflect.getOwnPropertyDescriptor(l,f),I={value:g,enumerable:_,configurable:!0};if(Fo.has(g))wf(g,!1);else if(g instanceof Promise)delete I.value,I.get=()=>d(g);else if(fs.has(g)){const[N,C]=fs.get(g);I.value=i(N,C(),d)}Object.defineProperty(m,f,I)}),Object.preventExtensions(m)},o=new WeakMap,a=[1,1],c=l=>{if(!Kl(l))throw new Error("object required");const u=o.get(l);if(u)return u;let d=a[0];const h=new Set,m=(U,M=++a[0])=>{d!==M&&(d=M,h.forEach($=>$(U,M)))};let f=a[1];const g=(U=++a[1])=>(f!==U&&!h.size&&(f=U,I.forEach(([M])=>{const $=M[1](U);$>d&&(d=$)})),d),_=U=>(M,$)=>{const F=[...M];F[1]=[U,...F[1]],m(F,$)},I=new Map,N=(U,M)=>{if((Vc?"production":void 0)!=="production"&&I.has(U))throw new Error("prop listener already exists");if(h.size){const $=M[3](_(U));I.set(U,[M,$])}else I.set(U,[M])},C=U=>{var M;const $=I.get(U);$&&(I.delete(U),(M=$[1])==null||M.call($))},E=U=>(h.add(U),h.size===1&&I.forEach(([$,F],W)=>{if((Vc?"production":void 0)!=="production"&&F)throw new Error("remove already exists");const q=$[3](_(W));I.set(W,[$,q])}),()=>{h.delete(U),h.size===0&&I.forEach(([$,F],W)=>{F&&(F(),I.set(W,[$]))})}),v=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l)),x=e(v,{deleteProperty(U,M){const $=Reflect.get(U,M);C(M);const F=Reflect.deleteProperty(U,M);return F&&m(["delete",[M],$]),F},set(U,M,$,F){const W=Reflect.has(U,M),q=Reflect.get(U,M,F);if(W&&(t(q,$)||o.has($)&&t(q,o.get($))))return!0;C(M),Kl($)&&($=iE($)||$);let y=$;if($ instanceof Promise)$.then(b=>{$.status="fulfilled",$.value=b,m(["resolve",[M],b])}).catch(b=>{$.status="rejected",$.reason=b,m(["reject",[M],b])});else{!fs.has($)&&r($)&&(y=c($));const b=!Fo.has(y)&&fs.get(y);b&&N(M,b)}return Reflect.set(U,M,y,F),m(["set",[M],$,q]),!0}});o.set(l,x);const D=[v,g,i,E];return fs.set(x,D),Reflect.ownKeys(l).forEach(U=>{const M=Object.getOwnPropertyDescriptor(l,U);"value"in M&&(x[U]=l[U],delete M.value,delete M.writable),Object.defineProperty(v,U,M)}),x})=>[c,fs,Fo,t,e,r,n,s,i,o,a],[aE]=oE();function et(t={}){return aE(t)}function Tt(t,e,r){const n=fs.get(t);(Vc?"production":void 0)!=="production"&&!n&&console.warn("Please use proxy object");let s;const i=[],o=n[3];let a=!1;const l=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,l()}}function aa(t,e){const r=fs.get(t);(Vc?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");const[n,s,i]=r;return i(n,s(),e)}function si(t){return Fo.add(t),t}function Nt(t,e,r,n){let s=t[e];return Tt(t,()=>{const i=t[e];Object.is(s,i)||r(s=i)})}function cE(t){const e=et({data:Array.from([]),has(r){return this.data.some(n=>n[0]===r)},set(r,n){const s=this.data.find(i=>i[0]===r);return s?s[1]=n:this.data.push([r,n]),this},get(r){var n;return(n=this.data.find(s=>s[0]===r))==null?void 0:n[1]},delete(r){const n=this.data.findIndex(s=>s[0]===r);return n===-1?!1:(this.data.splice(n,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},toJSON(){return new Map(this.data)},forEach(r){this.data.forEach(n=>{r(n[1],n[0],this)})},keys(){return this.data.map(r=>r[0]).values()},values(){return this.data.map(r=>r[1]).values()},entries(){return new Map(this.data).entries()},get[Symbol.toStringTag](){return"Map"},[Symbol.iterator](){return this.entries()}});return Object.defineProperties(e,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(e),e}var Oc={exports:{}},lE=Oc.exports,yf;function uE(){return yf||(yf=1,function(t,e){(function(r,n){t.exports=n()})(lE,function(){var r=1e3,n=6e4,s=36e5,i="millisecond",o="second",a="minute",c="hour",l="day",u="week",d="month",h="quarter",m="year",f="date",g="Invalid Date",_=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,I=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,N={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(q){var y=["th","st","nd","rd"],b=q%100;return"["+q+(y[(b-20)%10]||y[b]||y[0])+"]"}},C=function(q,y,b){var O=String(q);return!O||O.length>=y?q:""+Array(y+1-O.length).join(b)+q},E={s:C,z:function(q){var y=-q.utcOffset(),b=Math.abs(y),O=Math.floor(b/60),B=b%60;return(y<=0?"+":"-")+C(O,2,"0")+":"+C(B,2,"0")},m:function q(y,b){if(y.date()<b.date())return-q(b,y);var O=12*(b.year()-y.year())+(b.month()-y.month()),B=y.clone().add(O,d),k=b-B<0,L=y.clone().add(O+(k?-1:1),d);return+(-(O+(b-B)/(k?B-L:L-B))||0)},a:function(q){return q<0?Math.ceil(q)||0:Math.floor(q)},p:function(q){return{M:d,y:m,w:u,d:l,D:f,h:c,m:a,s:o,ms:i,Q:h}[q]||String(q||"").toLowerCase().replace(/s$/,"")},u:function(q){return q===void 0}},v="en",A={};A[v]=N;var x="$isDayjsObject",D=function(q){return q instanceof F||!(!q||!q[x])},U=function q(y,b,O){var B;if(!y)return v;if(typeof y=="string"){var k=y.toLowerCase();A[k]&&(B=k),b&&(A[k]=b,B=k);var L=y.split("-");if(!B&&L.length>1)return q(L[0])}else{var H=y.name;A[H]=y,B=H}return!O&&B&&(v=B),B||!O&&v},M=function(q,y){if(D(q))return q.clone();var b=typeof y=="object"?y:{};return b.date=q,b.args=arguments,new F(b)},$=E;$.l=U,$.i=D,$.w=function(q,y){return M(q,{locale:y.$L,utc:y.$u,x:y.$x,$offset:y.$offset})};var F=function(){function q(b){this.$L=U(b.locale,null,!0),this.parse(b),this.$x=this.$x||b.x||{},this[x]=!0}var y=q.prototype;return y.parse=function(b){this.$d=function(O){var B=O.date,k=O.utc;if(B===null)return new Date(NaN);if($.u(B))return new Date;if(B instanceof Date)return new Date(B);if(typeof B=="string"&&!/Z$/i.test(B)){var L=B.match(_);if(L){var H=L[2]-1||0,K=(L[7]||"0").substring(0,3);return k?new Date(Date.UTC(L[1],H,L[3]||1,L[4]||0,L[5]||0,L[6]||0,K)):new Date(L[1],H,L[3]||1,L[4]||0,L[5]||0,L[6]||0,K)}}return new Date(B)}(b),this.init()},y.init=function(){var b=this.$d;this.$y=b.getFullYear(),this.$M=b.getMonth(),this.$D=b.getDate(),this.$W=b.getDay(),this.$H=b.getHours(),this.$m=b.getMinutes(),this.$s=b.getSeconds(),this.$ms=b.getMilliseconds()},y.$utils=function(){return $},y.isValid=function(){return this.$d.toString()!==g},y.isSame=function(b,O){var B=M(b);return this.startOf(O)<=B&&B<=this.endOf(O)},y.isAfter=function(b,O){return M(b)<this.startOf(O)},y.isBefore=function(b,O){return this.endOf(O)<M(b)},y.$g=function(b,O,B){return $.u(b)?this[O]:this.set(B,b)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(b,O){var B=this,k=!!$.u(O)||O,L=$.p(b),H=function(be,xe){var Ze=$.w(B.$u?Date.UTC(B.$y,xe,be):new Date(B.$y,xe,be),B);return k?Ze:Ze.endOf(l)},K=function(be,xe){return $.w(B.toDate()[be].apply(B.toDate("s"),(k?[0,0,0,0]:[23,59,59,999]).slice(xe)),B)},Q=this.$W,Z=this.$M,re=this.$D,we="set"+(this.$u?"UTC":"");switch(L){case m:return k?H(1,0):H(31,11);case d:return k?H(1,Z):H(0,Z+1);case u:var Ee=this.$locale().weekStart||0,Ne=(Q<Ee?Q+7:Q)-Ee;return H(k?re-Ne:re+(6-Ne),Z);case l:case f:return K(we+"Hours",0);case c:return K(we+"Minutes",1);case a:return K(we+"Seconds",2);case o:return K(we+"Milliseconds",3);default:return this.clone()}},y.endOf=function(b){return this.startOf(b,!1)},y.$set=function(b,O){var B,k=$.p(b),L="set"+(this.$u?"UTC":""),H=(B={},B[l]=L+"Date",B[f]=L+"Date",B[d]=L+"Month",B[m]=L+"FullYear",B[c]=L+"Hours",B[a]=L+"Minutes",B[o]=L+"Seconds",B[i]=L+"Milliseconds",B)[k],K=k===l?this.$D+(O-this.$W):O;if(k===d||k===m){var Q=this.clone().set(f,1);Q.$d[H](K),Q.init(),this.$d=Q.set(f,Math.min(this.$D,Q.daysInMonth())).$d}else H&&this.$d[H](K);return this.init(),this},y.set=function(b,O){return this.clone().$set(b,O)},y.get=function(b){return this[$.p(b)]()},y.add=function(b,O){var B,k=this;b=Number(b);var L=$.p(O),H=function(Z){var re=M(k);return $.w(re.date(re.date()+Math.round(Z*b)),k)};if(L===d)return this.set(d,this.$M+b);if(L===m)return this.set(m,this.$y+b);if(L===l)return H(1);if(L===u)return H(7);var K=(B={},B[a]=n,B[c]=s,B[o]=r,B)[L]||1,Q=this.$d.getTime()+b*K;return $.w(Q,this)},y.subtract=function(b,O){return this.add(-1*b,O)},y.format=function(b){var O=this,B=this.$locale();if(!this.isValid())return B.invalidDate||g;var k=b||"YYYY-MM-DDTHH:mm:ssZ",L=$.z(this),H=this.$H,K=this.$m,Q=this.$M,Z=B.weekdays,re=B.months,we=B.meridiem,Ee=function(xe,Ze,tt,qe){return xe&&(xe[Ze]||xe(O,k))||tt[Ze].slice(0,qe)},Ne=function(xe){return $.s(H%12||12,xe,"0")},be=we||function(xe,Ze,tt){var qe=xe<12?"AM":"PM";return tt?qe.toLowerCase():qe};return k.replace(I,function(xe,Ze){return Ze||function(tt){switch(tt){case"YY":return String(O.$y).slice(-2);case"YYYY":return $.s(O.$y,4,"0");case"M":return Q+1;case"MM":return $.s(Q+1,2,"0");case"MMM":return Ee(B.monthsShort,Q,re,3);case"MMMM":return Ee(re,Q);case"D":return O.$D;case"DD":return $.s(O.$D,2,"0");case"d":return String(O.$W);case"dd":return Ee(B.weekdaysMin,O.$W,Z,2);case"ddd":return Ee(B.weekdaysShort,O.$W,Z,3);case"dddd":return Z[O.$W];case"H":return String(H);case"HH":return $.s(H,2,"0");case"h":return Ne(1);case"hh":return Ne(2);case"a":return be(H,K,!0);case"A":return be(H,K,!1);case"m":return String(K);case"mm":return $.s(K,2,"0");case"s":return String(O.$s);case"ss":return $.s(O.$s,2,"0");case"SSS":return $.s(O.$ms,3,"0");case"Z":return L}return null}(xe)||L.replace(":","")})},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(b,O,B){var k,L=this,H=$.p(O),K=M(b),Q=(K.utcOffset()-this.utcOffset())*n,Z=this-K,re=function(){return $.m(L,K)};switch(H){case m:k=re()/12;break;case d:k=re();break;case h:k=re()/3;break;case u:k=(Z-Q)/6048e5;break;case l:k=(Z-Q)/864e5;break;case c:k=Z/s;break;case a:k=Z/n;break;case o:k=Z/r;break;default:k=Z}return B?k:$.a(k)},y.daysInMonth=function(){return this.endOf(d).$D},y.$locale=function(){return A[this.$L]},y.locale=function(b,O){if(!b)return this.$L;var B=this.clone(),k=U(b,O,!0);return k&&(B.$L=k),B},y.clone=function(){return $.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},q}(),W=F.prototype;return M.prototype=W,[["$ms",i],["$s",o],["$m",a],["$H",c],["$W",l],["$M",d],["$y",m],["$D",f]].forEach(function(q){W[q[1]]=function(y){return this.$g(y,q[0],q[1])}}),M.extend=function(q,y){return q.$i||(q(y,F,M),q.$i=!0),M},M.locale=U,M.isDayjs=D,M.unix=function(q){return M(1e3*q)},M.en=A[v],M.Ls=A,M.p={},M})}(Oc)),Oc.exports}var dE=uE();const Gi=pi(dE);var Rc={exports:{}},hE=Rc.exports,bf;function fE(){return bf||(bf=1,function(t,e){(function(r,n){t.exports=n()})(hE,function(){return{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(r){var n=["th","st","nd","rd"],s=r%100;return"["+r+(n[(s-20)%10]||n[s]||n[0])+"]"}}})}(Rc)),Rc.exports}var pE=fE();const gE=pi(pE);var Pc={exports:{}},mE=Pc.exports,Ef;function wE(){return Ef||(Ef=1,function(t,e){(function(r,n){t.exports=n()})(mE,function(){return function(r,n,s){r=r||{};var i=n.prototype,o={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function a(l,u,d,h){return i.fromToBase(l,u,d,h)}s.en.relativeTime=o,i.fromToBase=function(l,u,d,h,m){for(var f,g,_,I=d.$locale().relativeTime||o,N=r.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],C=N.length,E=0;E<C;E+=1){var v=N[E];v.d&&(f=h?s(l).diff(d,v.d,!0):d.diff(l,v.d,!0));var A=(r.rounding||Math.round)(Math.abs(f));if(_=f>0,A<=v.r||!v.r){A<=1&&E>0&&(v=N[E-1]);var x=I[v.l];m&&(A=m(""+A)),g=typeof x=="string"?x.replace("%d",A):x(A,u,v.l,_);break}}if(u)return g;var D=_?I.future:I.past;return typeof D=="function"?D(g):D.replace("%s",g)},i.to=function(l,u){return a(l,u,this,!0)},i.from=function(l,u){return a(l,u,this)};var c=function(l){return l.$u?s.utc():s()};i.toNow=function(l){return this.to(c(this),l)},i.fromNow=function(l){return this.from(c(this),l)}}})}(Pc)),Pc.exports}var yE=wE();const bE=pi(yE);var Dc={exports:{}},EE=Dc.exports,vf;function vE(){return vf||(vf=1,function(t,e){(function(r,n){t.exports=n()})(EE,function(){return function(r,n,s){s.updateLocale=function(i,o){var a=s.Ls[i];if(a)return(o?Object.keys(o):[]).forEach(function(c){a[c]=o[c]}),a}}})}(Dc)),Dc.exports}var _E=vE();const CE=pi(_E);Gi.extend(bE);Gi.extend(CE);const AE={...gE,name:"en-web3-modal",relativeTime:{future:"in %s",past:"%s ago",s:"%d sec",m:"1 min",mm:"%d min",h:"1 hr",hh:"%d hrs",d:"1 d",dd:"%d d",M:"1 mo",MM:"%d mo",y:"1 yr",yy:"%d yr"}},IE=["January","February","March","April","May","June","July","August","September","October","November","December"];Gi.locale("en-web3-modal",AE);const _f={getMonthNameByIndex(t){return IE[t]},getYear(t=new Date().toISOString()){return Gi(t).year()},getRelativeDateFromNow(t){return Gi(t).locale("en-web3-modal").fromNow(!0)},formatDate(t,e="DD MMM"){return Gi(t).format(e)}};var Cf={};const G={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof Cf<"u"?Cf.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org"},ca={caipNetworkIdToNumber(t){return t?Number(t.split(":")[1]):void 0},parseEvmChainId(t){return typeof t=="string"?this.caipNetworkIdToNumber(t):t},getNetworksByNamespace(t,e){return(t==null?void 0:t.filter(r=>r.chainNamespace===e))||[]},getFirstNetworkByNamespace(t,e){return this.getNetworksByNamespace(t,e)[0]},getNetworkNameByCaipNetworkId(t,e){var s;if(!e)return;const r=t.find(i=>i.caipNetworkId===e);if(r)return r.name;const[n]=e.split(":");return((s=G.CHAIN_NAME_MAP)==null?void 0:s[n])||void 0}};var SE=20,TE=1,ii=1e6,Af=1e6,NE=-7,xE=21,OE=!1,$a="[big.js] ",gi=$a+"Invalid ",vl=gi+"decimal places",RE=gi+"rounding mode",pw=$a+"Division by zero",Qe={},In=void 0,PE=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function gw(){function t(e){var r=this;if(!(r instanceof t))return e===In?gw():new t(e);if(e instanceof t)r.s=e.s,r.e=e.e,r.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(gi+"value");e=e===0&&1/e<0?"-0":String(e)}DE(r,e)}r.constructor=t}return t.prototype=Qe,t.DP=SE,t.RM=TE,t.NE=NE,t.PE=xE,t.strict=OE,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function DE(t,e){var r,n,s;if(!PE.test(e))throw Error(gi+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),s=e.length,n=0;n<s&&e.charAt(n)=="0";)++n;if(n==s)t.c=[t.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(t.e=r-n-1,t.c=[],r=0;n<=s;)t.c[r++]=+e.charAt(n++)}return t}function mi(t,e,r,n){var s=t.c;if(r===In&&(r=t.constructor.RM),r!==0&&r!==1&&r!==2&&r!==3)throw Error(RE);if(e<1)n=r===3&&(n||!!s[0])||e===0&&(r===1&&s[0]>=5||r===2&&(s[0]>5||s[0]===5&&(n||s[1]!==In))),s.length=1,n?(t.e=t.e-e+1,s[0]=1):s[0]=t.e=0;else if(e<s.length){if(n=r===1&&s[e]>=5||r===2&&(s[e]>5||s[e]===5&&(n||s[e+1]!==In||s[e-1]&1))||r===3&&(n||!!s[0]),s.length=e,n){for(;++s[--e]>9;)if(s[e]=0,e===0){++t.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return t}function wi(t,e,r){var n=t.e,s=t.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(n<0?"e":"e+")+n;else if(n<0){for(;++n;)s="0"+s;s="0."+s}else if(n>0)if(++n>i)for(n-=i;n--;)s+="0";else n<i&&(s=s.slice(0,n)+"."+s.slice(n));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return t.s<0&&r?"-"+s:s}Qe.abs=function(){var t=new this.constructor(this);return t.s=1,t};Qe.cmp=function(t){var e,r=this,n=r.c,s=(t=new r.constructor(t)).c,i=r.s,o=t.s,a=r.e,c=t.e;if(!n[0]||!s[0])return n[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,a!=c)return a>c^e?1:-1;for(o=(a=n.length)<(c=s.length)?a:c,i=-1;++i<o;)if(n[i]!=s[i])return n[i]>s[i]^e?1:-1;return a==c?0:a>c^e?1:-1};Qe.div=function(t){var e=this,r=e.constructor,n=e.c,s=(t=new r(t)).c,i=e.s==t.s?1:-1,o=r.DP;if(o!==~~o||o<0||o>ii)throw Error(vl);if(!s[0])throw Error(pw);if(!n[0])return t.s=i,t.c=[t.e=0],t;var a,c,l,u,d,h=s.slice(),m=a=s.length,f=n.length,g=n.slice(0,a),_=g.length,I=t,N=I.c=[],C=0,E=o+(I.e=e.e-t.e)+1;for(I.s=i,i=E<0?0:E,h.unshift(0);_++<a;)g.push(0);do{for(l=0;l<10;l++){if(a!=(_=g.length))u=a>_?1:-1;else for(d=-1,u=0;++d<a;)if(s[d]!=g[d]){u=s[d]>g[d]?1:-1;break}if(u<0){for(c=_==a?s:h;_;){if(g[--_]<c[_]){for(d=_;d&&!g[--d];)g[d]=9;--g[d],g[_]+=10}g[_]-=c[_]}for(;!g[0];)g.shift()}else break}N[C++]=u?l:++l,g[0]&&u?g[_]=n[m]||0:g=[n[m]]}while((m++<f||g[0]!==In)&&i--);return!N[0]&&C!=1&&(N.shift(),I.e--,E--),C>E&&mi(I,E,r.RM,g[0]!==In),I};Qe.eq=function(t){return this.cmp(t)===0};Qe.gt=function(t){return this.cmp(t)>0};Qe.gte=function(t){return this.cmp(t)>-1};Qe.lt=function(t){return this.cmp(t)<0};Qe.lte=function(t){return this.cmp(t)<1};Qe.minus=Qe.sub=function(t){var e,r,n,s,i=this,o=i.constructor,a=i.s,c=(t=new o(t)).s;if(a!=c)return t.s=-c,i.plus(t);var l=i.c.slice(),u=i.e,d=t.c,h=t.e;if(!l[0]||!d[0])return d[0]?t.s=-c:l[0]?t=new o(i):t.s=1,t;if(a=u-h){for((s=a<0)?(a=-a,n=l):(h=u,n=d),n.reverse(),c=a;c--;)n.push(0);n.reverse()}else for(r=((s=l.length<d.length)?l:d).length,a=c=0;c<r;c++)if(l[c]!=d[c]){s=l[c]<d[c];break}if(s&&(n=l,l=d,d=n,t.s=-t.s),(c=(r=d.length)-(e=l.length))>0)for(;c--;)l[e++]=0;for(c=e;r>a;){if(l[--r]<d[r]){for(e=r;e&&!l[--e];)l[e]=9;--l[e],l[r]+=10}l[r]-=d[r]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--h;return l[0]||(t.s=1,l=[h=0]),t.c=l,t.e=h,t};Qe.mod=function(t){var e,r=this,n=r.constructor,s=r.s,i=(t=new n(t)).s;if(!t.c[0])throw Error(pw);return r.s=t.s=1,e=t.cmp(r)==1,r.s=s,t.s=i,e?new n(r):(s=n.DP,i=n.RM,n.DP=n.RM=0,r=r.div(t),n.DP=s,n.RM=i,this.minus(r.times(t)))};Qe.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};Qe.plus=Qe.add=function(t){var e,r,n,s=this,i=s.constructor;if(t=new i(t),s.s!=t.s)return t.s=-t.s,s.minus(t);var o=s.e,a=s.c,c=t.e,l=t.c;if(!a[0]||!l[0])return l[0]||(a[0]?t=new i(s):t.s=s.s),t;if(a=a.slice(),e=o-c){for(e>0?(c=o,n=l):(e=-e,n=a),n.reverse();e--;)n.push(0);n.reverse()}for(a.length-l.length<0&&(n=l,l=a,a=n),e=l.length,r=0;e;a[e]%=10)r=(a[--e]=a[e]+l[e]+r)/10|0;for(r&&(a.unshift(r),++c),e=a.length;a[--e]===0;)a.pop();return t.c=a,t.e=c,t};Qe.pow=function(t){var e=this,r=new e.constructor("1"),n=r,s=t<0;if(t!==~~t||t<-Af||t>Af)throw Error(gi+"exponent");for(s&&(t=-t);t&1&&(n=n.times(e)),t>>=1,!!t;)e=e.times(e);return s?r.div(n):n};Qe.prec=function(t,e){if(t!==~~t||t<1||t>ii)throw Error(gi+"precision");return mi(new this.constructor(this),t,e)};Qe.round=function(t,e){if(t===In)t=0;else if(t!==~~t||t<-ii||t>ii)throw Error(vl);return mi(new this.constructor(this),t+this.e+1,e)};Qe.sqrt=function(){var t,e,r,n=this,s=n.constructor,i=n.s,o=n.e,a=new s("0.5");if(!n.c[0])return new s(n);if(i<0)throw Error($a+"No square root");i=Math.sqrt(+wi(n,!0,!0)),i===0||i===1/0?(e=n.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),t=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):t=new s(i+""),o=t.e+(s.DP+=4);do r=t,t=a.times(r.plus(n.div(r)));while(r.c.slice(0,o).join("")!==t.c.slice(0,o).join(""));return mi(t,(s.DP-=4)+t.e+1,s.RM)};Qe.times=Qe.mul=function(t){var e,r=this,n=r.constructor,s=r.c,i=(t=new n(t)).c,o=s.length,a=i.length,c=r.e,l=t.e;if(t.s=r.s==t.s?1:-1,!s[0]||!i[0])return t.c=[t.e=0],t;for(t.e=c+l,o<a&&(e=s,s=i,i=e,l=o,o=a,a=l),e=new Array(l=o+a);l--;)e[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=e[l]+i[c]*s[l-c-1]+a,e[l--]=a%10,a=a/10|0;e[l]=a}for(a?++t.e:e.shift(),c=e.length;!e[--c];)e.pop();return t.c=e,t};Qe.toExponential=function(t,e){var r=this,n=r.c[0];if(t!==In){if(t!==~~t||t<0||t>ii)throw Error(vl);for(r=mi(new r.constructor(r),++t,e);r.c.length<t;)r.c.push(0)}return wi(r,!0,!!n)};Qe.toFixed=function(t,e){var r=this,n=r.c[0];if(t!==In){if(t!==~~t||t<0||t>ii)throw Error(vl);for(r=mi(new r.constructor(r),t+r.e+1,e),t=t+r.e+1;r.c.length<t;)r.c.push(0)}return wi(r,!1,!!n)};Qe[Symbol.for("nodejs.util.inspect.custom")]=Qe.toJSON=Qe.toString=function(){var t=this,e=t.constructor;return wi(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};Qe.toNumber=function(){var t=+wi(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error($a+"Imprecise conversion");return t};Qe.toPrecision=function(t,e){var r=this,n=r.constructor,s=r.c[0];if(t!==In){if(t!==~~t||t<1||t>ii)throw Error(gi+"precision");for(r=mi(new n(r),t,e);r.c.length<t;)r.c.push(0)}return wi(r,t<=r.e||r.e<=n.NE||r.e>=n.PE,!!s)};Qe.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error($a+"valueOf disallowed");return wi(t,t.e<=e.NE||t.e>=e.PE,!0)};var bo=gw();const dt={bigNumber(t){return t?new bo(t):new bo(0)},multiply(t,e){if(t===void 0||e===void 0)return new bo(0);const r=new bo(t),n=new bo(e);return r.times(n)},formatNumberToLocalString(t,e=2){return t===void 0?"0.00":typeof t=="number"?t.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e}):parseFloat(t).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e})},parseLocalStringToNumber(t){return t===void 0?0:parseFloat(t.replace(/,/gu,""))}},EB={numericInputKeyDown(t,e,r){const n=["Backspace","Meta","Ctrl","a","A","c","C","x","X","v","V","ArrowLeft","ArrowRight","Tab"],s=t.metaKey||t.ctrlKey,i=t.key,o=i.toLocaleLowerCase(),a=o==="a",c=o==="c",l=o==="v",u=o==="x",d=i===",",h=i===".",m=i>="0"&&i<="9";!s&&(a||c||l||u)&&t.preventDefault(),e==="0"&&!d&&!h&&i==="0"&&t.preventDefault(),e==="0"&&m&&(r(i),t.preventDefault()),(d||h)&&(e||(r("0."),t.preventDefault()),(e!=null&&e.includes(".")||e!=null&&e.includes(","))&&t.preventDefault()),!m&&!n.includes(i)&&!h&&!d&&t.preventDefault()}},kE=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],UE=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],$E=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],BE={getERC20Abi:t=>G.USDT_CONTRACT_ADDRESSES.includes(t)?$E:kE,getSwapAbi:()=>UE},vB={URLS:{FAQ:"https://walletconnect.com/faq"}},Pr={validateCaipAddress(t){var e;if(((e=t.split(":"))==null?void 0:e.length)!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[r,n,s]=e;if(!r||!n||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:r,chainId:n,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[r,n]=e;if(!r||!n)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:r,chainId:n}}},Te={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids"};function Gl(t){if(!t)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${t}:connected_connector_id`}const Ie={setItem(t,e){jo()&&e!==void 0&&localStorage.setItem(t,e)},getItem(t){if(jo())return localStorage.getItem(t)||void 0},removeItem(t){jo()&&localStorage.removeItem(t)},clear(){jo()&&localStorage.clear()}};function jo(){return typeof window<"u"&&typeof localStorage<"u"}function Kn(t,e){return e==="light"?{"--w3m-accent":(t==null?void 0:t["--w3m-accent"])||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":(t==null?void 0:t["--w3m-accent"])||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}var If={};const Yl=(typeof process<"u"&&typeof If<"u"?If.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",mw=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]},{label:"Coinbase",name:"coinbase",feeRange:"1-2%",url:"",supportedChains:["eip155"]}],LE="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",Ye={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:Yl,SECURE_SITE_DASHBOARD:`${Yl}/dashboard`,SECURE_SITE_FAVICON:`${Yl}/images/favicon.png`,RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],WC_COINBASE_PAY_SDK_CHAINS:["ethereum","arbitrum","polygon","berachain","avalanche-c-chain","optimism","celo","base"],WC_COINBASE_PAY_SDK_FALLBACK_CHAIN:"ethereum",WC_COINBASE_PAY_SDK_CHAIN_NAME_MAP:{Ethereum:"ethereum","Arbitrum One":"arbitrum",Polygon:"polygon",Berachain:"berachain",Avalanche:"avalanche-c-chain","OP Mainnet":"optimism",Celo:"celo",Base:"base"},WC_COINBASE_ONRAMP_APP_ID:"bf18c88d-495a-463b-b249-0b9d3656cf5e",SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:["eip155","solana"],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:["eip155"],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:["eip155","solana"],ACTIVITY_ENABLED_CHAIN_NAMESPACES:["eip155"],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:["eip155","solana"],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld","coinbase"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"}},oe={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5},isCacheExpired(t,e){return Date.now()-t>e},getActiveNetworkProps(){const t=oe.getActiveNamespace(),e=oe.getActiveCaipNetworkId(),r=e?e.split(":")[1]:void 0,n=r?isNaN(Number(r))?r:Number(r):void 0;return{namespace:t,caipNetworkId:e,chainId:n}},setWalletConnectDeepLink({name:t,href:e}){try{Ie.setItem(Te.DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const t=Ie.getItem(Te.DEEPLINK_CHOICE);if(t)return JSON.parse(t)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{Ie.removeItem(Te.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(t){try{Ie.setItem(Te.ACTIVE_NAMESPACE,t)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(t){try{Ie.setItem(Te.ACTIVE_CAIP_NETWORK_ID,t),oe.setActiveNamespace(t.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return Ie.getItem(Te.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{Ie.removeItem(Te.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(t){try{const e=Gl(t);Ie.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(t){try{const e=oe.getRecentWallets();e.find(n=>n.id===t.id)||(e.unshift(t),e.length>2&&e.pop(),Ie.setItem(Te.RECENT_WALLETS,JSON.stringify(e)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const t=Ie.getItem(Te.RECENT_WALLETS);return t?JSON.parse(t):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(t,e){try{const r=Gl(t);Ie.setItem(r,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return Ie.getItem(Te.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(t){if(t)try{const e=Gl(t);return Ie.getItem(e)}catch{console.info("Unable to get connected connector id in namespace",t)}},setConnectedSocialProvider(t){try{Ie.setItem(Te.CONNECTED_SOCIAL,t)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return Ie.getItem(Te.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{Ie.removeItem(Te.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return Ie.getItem(Te.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){var r;const t=Ie.getItem(Te.ACTIVE_CAIP_NETWORK_ID);return(r=t==null?void 0:t.split(":"))==null?void 0:r[1]},setConnectionStatus(t){try{Ie.setItem(Te.CONNECTION_STATUS,t)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return Ie.getItem(Te.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const t=Ie.getItem(Te.CONNECTED_NAMESPACES);return t!=null&&t.length?t.split(","):[]}catch{return[]}},setConnectedNamespaces(t){try{const e=Array.from(new Set(t));Ie.setItem(Te.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(t){try{const e=oe.getConnectedNamespaces();e.includes(t)||(e.push(t),oe.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(t){try{const e=oe.getConnectedNamespaces(),r=e.indexOf(t);r>-1&&(e.splice(r,1),oe.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return Ie.getItem(Te.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(t){try{Ie.setItem(Te.TELEGRAM_SOCIAL_PROVIDER,t)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{Ie.removeItem(Te.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let t={};try{const e=Ie.getItem(Te.PORTFOLIO_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromBalanceCache(t){try{const e=oe.getBalanceCache();Ie.setItem(Te.PORTFOLIO_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getBalanceCacheForCaipAddress(t){try{const r=oe.getBalanceCache()[t];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.portfolio))return r.balance;oe.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateBalanceCache(t){try{const e=oe.getBalanceCache();e[t.caipAddress]=t,Ie.setItem(Te.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getNativeBalanceCache(){let t={};try{const e=Ie.getItem(Te.NATIVE_BALANCE_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromNativeBalanceCache(t){try{const e=oe.getBalanceCache();Ie.setItem(Te.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getNativeBalanceCacheForCaipAddress(t){try{const r=oe.getNativeBalanceCache()[t];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.nativeBalance))return r;console.info("Discarding cache for address",t),oe.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateNativeBalanceCache(t){try{const e=oe.getNativeBalanceCache();e[t.caipAddress]=t,Ie.setItem(Te.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getEnsCache(){let t={};try{const e=Ie.getItem(Te.ENS_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return t},getEnsFromCacheForAddress(t){try{const r=oe.getEnsCache()[t];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.ens))return r.ens;oe.removeEnsFromCache(t)}catch{console.info("Unable to get ens name from cache",t)}},updateEnsCache(t){try{const e=oe.getEnsCache();e[t.address]=t,Ie.setItem(Te.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",t)}},removeEnsFromCache(t){try{const e=oe.getEnsCache();Ie.setItem(Te.ENS_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove ens name from cache",t)}},getIdentityCache(){let t={};try{const e=Ie.getItem(Te.IDENTITY_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return t},getIdentityFromCacheForAddress(t){try{const r=oe.getIdentityCache()[t];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.identity))return r.identity;oe.removeIdentityFromCache(t)}catch{console.info("Unable to get identity from cache",t)}},updateIdentityCache(t){try{const e=oe.getIdentityCache();e[t.address]={identity:t.identity,timestamp:t.timestamp},Ie.setItem(Te.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",t)}},removeIdentityFromCache(t){try{const e=oe.getIdentityCache();Ie.setItem(Te.IDENTITY_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove identity from cache",t)}},clearAddressCache(){try{Ie.removeItem(Te.PORTFOLIO_CACHE),Ie.removeItem(Te.NATIVE_BALANCE_CACHE),Ie.removeItem(Te.ENS_CACHE),Ie.removeItem(Te.IDENTITY_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(t){try{Ie.setItem(Te.PREFERRED_ACCOUNT_TYPES,JSON.stringify(t))}catch{console.info("Unable to set preferred account types",t)}},getPreferredAccountTypes(){try{const t=Ie.getItem(Te.PREFERRED_ACCOUNT_TYPES);return t?JSON.parse(t):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(t,e){try{const r=oe.getConnections(),n=r[e]??[],s=new Map;for(const o of n)s.set(o.connectorId,{...o});for(const o of t){const a=s.get(o.connectorId),c=o.connectorId===G.CONNECTOR_ID.AUTH;if(a&&!c){const l=new Set(a.accounts.map(d=>d.address.toLowerCase())),u=o.accounts.filter(d=>!l.has(d.address.toLowerCase()));a.accounts.push(...u)}else s.set(o.connectorId,{...o})}const i={...r,[e]:Array.from(s.values())};Ie.setItem(Te.CONNECTIONS,JSON.stringify(i))}catch(r){console.error("Unable to sync connections to storage",r)}},getConnections(){try{const t=Ie.getItem(Te.CONNECTIONS);return t?JSON.parse(t):{}}catch(t){return console.error("Unable to get connections from storage",t),{}}},deleteAddressFromConnection({connectorId:t,address:e,namespace:r}){try{const n=oe.getConnections(),s=n[r]??[],i=new Map(s.map(a=>[a.connectorId,a])),o=i.get(t);o&&(o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase()).length===0?i.delete(t):i.set(t,{...o,accounts:o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase())})),Ie.setItem(Te.CONNECTIONS,JSON.stringify({...n,[r]:Array.from(i.values())}))}catch{console.error(`Unable to remove address "${e}" from connector "${t}" in namespace "${r}"`)}},getDisconnectedConnectorIds(){try{const t=Ie.getItem(Te.DISCONNECTED_CONNECTOR_IDS);return t?JSON.parse(t):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(t,e){try{const r=oe.getDisconnectedConnectorIds(),n=r[e]??[];n.push(t),Ie.setItem(Te.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...r,[e]:Array.from(new Set(n))}))}catch{console.error(`Unable to set disconnected connector id "${t}" for namespace "${e}"`)}},removeDisconnectedConnectorId(t,e){try{const r=oe.getDisconnectedConnectorIds();let n=r[e]??[];n=n.filter(s=>s.toLowerCase()!==t.toLowerCase()),Ie.setItem(Te.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...r,[e]:Array.from(new Set(n))}))}catch{console.error(`Unable to remove disconnected connector id "${t}" for namespace "${e}"`)}},isConnectorDisconnected(t,e){try{return(oe.getDisconnectedConnectorIds()[e]??[]).some(s=>s.toLowerCase()===t.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${t}" for namespace "${e}"`)}return!1}},le={isMobile(){var t;return this.isClient()?!!(window!=null&&window.matchMedia&&typeof window.matchMedia=="function"&&((t=window.matchMedia("(pointer:coarse)"))!=null&&t.matches)||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(t,e=""){return t==null?void 0:t.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return le.isMobile()&&t.includes("android")},isIos(){if(!this.isMobile())return!1;const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")},isSafari(){return this.isClient()?(window==null?void 0:window.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(t){return t?t-Date.now()<=Ye.TEN_SEC_MS:!0},isAllowedRetry(t,e=Ye.ONE_SEC_MS){return Date.now()-t>=e},copyToClopboard(t){navigator.clipboard.writeText(t)},isIframe(){try{return(window==null?void 0:window.self)!==(window==null?void 0:window.top)}catch{return!1}},isSafeApp(){var t,e;if(le.isClient()&&window.self!==window.top)try{const r=(e=(t=window==null?void 0:window.location)==null?void 0:t.ancestorOrigins)==null?void 0:e[0],n="https://app.safe.global";if(r){const s=new URL(r),i=new URL(n);return s.hostname===i.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+Ye.FOUR_MINUTES_MS},getNetworkId(t){return t==null?void 0:t.split(":")[1]},getPlainAddress(t){return t==null?void 0:t.split(":")[2]},async wait(t){return new Promise(e=>{setTimeout(e,t)})},debounce(t,e=500){let r;return(...n)=>{function s(){t(...n)}r&&clearTimeout(r),r=setTimeout(s,e)}},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,r=null){if(le.isHttpUrl(t))return this.formatUniversalUrl(t,e);let n=t,s=r;n.includes("://")||(n=t.replaceAll("/","").replaceAll(":",""),n=`${n}://`),n.endsWith("/")||(n=`${n}/`),s&&!(s!=null&&s.endsWith("/"))&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const i=encodeURIComponent(e);return{redirect:`${n}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:n}},formatUniversalUrl(t,e){if(!le.isHttpUrl(t))return this.formatNativeUrl(t,e);let r=t;r.endsWith("/")||(r=`${r}/`);const n=encodeURIComponent(e);return{redirect:`${r}wc?uri=${n}`,href:r}},getOpenTargetForPlatform(t){return t==="popupWindow"?t:this.isTelegram()?oe.getTelegramSocialProvider()?"_top":"_blank":t},openHref(t,e,r){window==null||window.open(t,this.getOpenTargetForPlatform(e),r||"noreferrer noopener")},returnOpenHref(t,e,r){return window==null?void 0:window.open(t,this.getOpenTargetForPlatform(e),r||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){var r,n;if(typeof window>"u")return!1;const t=window!=null&&window.matchMedia&&typeof window.matchMedia=="function"?(r=window.matchMedia("(display-mode: standalone)"))==null?void 0:r.matches:!1,e=(n=window==null?void 0:window.navigator)==null?void 0:n.standalone;return!!(t||e)},async preloadImage(t){const e=new Promise((r,n)=>{const s=new Image;s.onload=r,s.onerror=n,s.crossOrigin="anonymous",s.src=t});return Promise.race([e,le.wait(2e3)])},formatBalance(t,e){let r="0.000";if(typeof t=="string"){const n=Number(t);if(n){const s=Math.floor(n*1e3)/1e3;s&&(r=s.toString())}}return`${r}${e?` ${e}`:""}`},formatBalance2(t,e){var n;let r;if(t==="0")r="0";else if(typeof t=="string"){const s=Number(t);s&&(r=(n=s.toString().match(/^-?\d+(?:\.\d{0,3})?/u))==null?void 0:n[0])}return{value:r??"0",rest:r==="0"?"000":"",symbol:e}},getApiUrl(){return G.W3M_API_URL},getBlockchainApiUrl(){return G.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return G.PULSE_API_URL},getUUID(){return crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})},parseError(t){var e,r;return typeof t=="string"?t:typeof((r=(e=t==null?void 0:t.issues)==null?void 0:e[0])==null?void 0:r.message)=="string"?t.issues[0].message:t instanceof Error?t.message:"Unknown error"},sortRequestedNetworks(t,e=[]){const r={};return e&&t&&(t.forEach((n,s)=>{r[n]=s}),e.sort((n,s)=>{const i=r[n.id],o=r[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(t){let e=0;for(const r of t)e+=r.value??0;return e},formatTokenBalance(t){const e=t.toFixed(2),[r,n]=e.split(".");return{dollars:r,pennies:n}},isAddress(t,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)||/^(?:0x)?[0-9A-F]{40}$/iu.test(t))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(t);default:return!1}},uniqueBy(t,e){const r=new Set;return t.filter(n=>{const s=n[e];return r.has(s)?!1:(r.add(s),!0)})},generateSdkVersion(t,e,r){const s=t.length===0?Ye.ADAPTER_TYPES.UNIVERSAL:t.map(i=>i.adapterType).join(",");return`${e}-${s}-${r}`},createAccount(t,e,r,n,s){return{namespace:t,address:e,type:r,publicKey:n,path:s}},isCaipAddress(t){if(typeof t!="string")return!1;const e=t.split(":"),r=e[0];return e.filter(Boolean).length===3&&r in G.CHAIN_NAME_MAP},isMac(){const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return t.includes("macintosh")&&!t.includes("safari")},formatTelegramSocialLoginUrl(t){const e=`--${encodeURIComponent(window==null?void 0:window.location.href)}`,r="state=";if(new URL(t).host==="auth.magic.link"){const s="provider_authorization_url=",i=t.substring(t.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),r,e);return t.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(t,r,e)},injectIntoUrl(t,e,r){const n=t.indexOf(e);if(n===-1)throw new Error(`${e} parameter not found in the URL: ${t}`);const s=t.indexOf("&",n),i=e.length,o=s!==-1?s:t.length,a=t.substring(0,n+i),c=t.substring(n+i,o),l=t.substring(s),u=c+r;return a+u+l}};async function Eo(...t){const e=await fetch(...t);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class Ba{constructor({baseUrl:e,clientId:r}){this.baseUrl=e,this.clientId=r}async get({headers:e,signal:r,cache:n,...s}){const i=this.createUrl(s);return(await Eo(i,{method:"GET",headers:e,signal:r,cache:n})).json()}async getBlob({headers:e,signal:r,...n}){const s=this.createUrl(n);return(await Eo(s,{method:"GET",headers:e,signal:r})).blob()}async post({body:e,headers:r,signal:n,...s}){const i=this.createUrl(s);return(await Eo(i,{method:"POST",headers:r,body:e?JSON.stringify(e):void 0,signal:n})).json()}async put({body:e,headers:r,signal:n,...s}){const i=this.createUrl(s);return(await Eo(i,{method:"PUT",headers:r,body:e?JSON.stringify(e):void 0,signal:n})).json()}async delete({body:e,headers:r,signal:n,...s}){const i=this.createUrl(s);return(await Eo(i,{method:"DELETE",headers:r,body:e?JSON.stringify(e):void 0,signal:n})).json()}createUrl({path:e,params:r}){const n=new URL(e,this.baseUrl);return r&&Object.entries(r).forEach(([s,i])=>{i&&n.searchParams.append(s,i)}),this.clientId&&n.searchParams.append("clientId",this.clientId),n}}const ME={getFeatureValue(t,e){const r=e==null?void 0:e[t];return r===void 0?Ye.DEFAULT_FEATURES[t]:r},filterSocialsByPlatform(t){if(!t||!t.length)return t;if(le.isTelegram()){if(le.isIos())return t.filter(e=>e!=="google");if(le.isMac())return t.filter(e=>e!=="x");if(le.isAndroid())return t.filter(e=>!["facebook","x"].includes(e))}return t}},Ce=et({features:Ye.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:Ye.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{}}),X={state:Ce,subscribeKey(t,e){return Nt(Ce,t,e)},setOptions(t){Object.assign(Ce,t)},setRemoteFeatures(t){var r;if(!t)return;const e={...Ce.remoteFeatures,...t};Ce.remoteFeatures=e,(r=Ce.remoteFeatures)!=null&&r.socials&&(Ce.remoteFeatures.socials=ME.filterSocialsByPlatform(Ce.remoteFeatures.socials))},setFeatures(t){if(!t)return;Ce.features||(Ce.features=Ye.DEFAULT_FEATURES);const e={...Ce.features,...t};Ce.features=e},setProjectId(t){Ce.projectId=t},setCustomRpcUrls(t){Ce.customRpcUrls=t},setAllWallets(t){Ce.allWallets=t},setIncludeWalletIds(t){Ce.includeWalletIds=t},setExcludeWalletIds(t){Ce.excludeWalletIds=t},setFeaturedWalletIds(t){Ce.featuredWalletIds=t},setTokens(t){Ce.tokens=t},setTermsConditionsUrl(t){Ce.termsConditionsUrl=t},setPrivacyPolicyUrl(t){Ce.privacyPolicyUrl=t},setCustomWallets(t){Ce.customWallets=t},setIsSiweEnabled(t){Ce.isSiweEnabled=t},setIsUniversalProvider(t){Ce.isUniversalProvider=t},setSdkVersion(t){Ce.sdkVersion=t},setMetadata(t){Ce.metadata=t},setDisableAppend(t){Ce.disableAppend=t},setEIP6963Enabled(t){Ce.enableEIP6963=t},setDebug(t){Ce.debug=t},setEnableWalletConnect(t){Ce.enableWalletConnect=t},setEnableWalletGuide(t){Ce.enableWalletGuide=t},setEnableAuthLogger(t){Ce.enableAuthLogger=t},setEnableWallets(t){Ce.enableWallets=t},setPreferUniversalLinks(t){Ce.experimental_preferUniversalLinks=t},setHasMultipleAddresses(t){Ce.hasMultipleAddresses=t},setSIWX(t){Ce.siwx=t},setConnectMethodsOrder(t){Ce.features={...Ce.features,connectMethodsOrder:t}},setWalletFeaturesOrder(t){Ce.features={...Ce.features,walletFeaturesOrder:t}},setSocialsOrder(t){Ce.remoteFeatures={...Ce.remoteFeatures,socials:t}},setCollapseWallets(t){Ce.features={...Ce.features,collapseWallets:t}},setEnableEmbedded(t){Ce.enableEmbedded=t},setAllowUnsupportedChain(t){Ce.allowUnsupportedChain=t},setManualWCControl(t){Ce.manualWCControl=t},setEnableNetworkSwitch(t){Ce.enableNetworkSwitch=t},setDefaultAccountTypes(t={}){Object.entries(t).forEach(([e,r])=>{r&&(Ce.defaultAccountTypes[e]=r)})},setUniversalProviderConfigOverride(t){Ce.universalProviderConfigOverride=t},getUniversalProviderConfigOverride(){return Ce.universalProviderConfigOverride},getSnapshot(){return aa(Ce)}},FE=Object.freeze({enabled:!0,events:[]}),jE=new Ba({baseUrl:le.getAnalyticsUrl(),clientId:null}),qE=5,HE=60*1e3,rs=et({...FE}),WE={state:rs,subscribeKey(t,e){return Nt(rs,t,e)},async sendError(t,e){if(!rs.enabled)return;const r=Date.now();if(rs.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return r-o<HE}).length>=qE)return;const s={type:"error",event:e,properties:{errorType:t.name,errorMessage:t.message,stackTrace:t.stack,timestamp:new Date().toISOString()}};rs.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:a}=X.state;await jE.post({path:"/e",params:{projectId:i,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:le.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:t.name,errorMessage:t.message,stackTrace:t.stack}}})}catch{}},enable(){rs.enabled=!0},disable(){rs.enabled=!1},clearEvents(){rs.events=[]}};class to extends Error{constructor(e,r,n){super(e),this.name="AppKitError",this.category=r,this.originalError=n,Object.setPrototypeOf(this,to.prototype);let s=!1;if(n instanceof Error&&typeof n.stack=="string"&&n.stack){const i=n.stack,o=i.indexOf(`
`);if(o>-1){const a=i.substring(o+1);this.stack=`${this.name}: ${this.message}
${a}`,s=!0}}s||(Error.captureStackTrace?Error.captureStackTrace(this,to):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function Sf(t,e){const r=t instanceof to?t:new to(t instanceof Error?t.message:String(t),e,t);throw WE.sendError(r,r.category),r}function ar(t,e="INTERNAL_SDK_ERROR"){const r={};return Object.keys(t).forEach(n=>{const s=t[n];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(a){return Sf(a,e)}}:i=(...o)=>{try{return s(...o)}catch(a){return Sf(a,e)}},r[n]=i}else r[n]=s}),r}const _n={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"}},zE={handleMobileDeeplinkRedirect(t,e){const r=window.location.href,n=encodeURIComponent(r);if(t===_n.PHANTOM.id&&!("phantom"in window)){const s=r.startsWith("https")?"https":"http",i=r.split("/")[2],o=encodeURIComponent(`${s}://${i}`);window.location.href=`${_n.PHANTOM.url}/ul/browse/${n}?ref=${o}`}t===_n.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${_n.SOLFLARE.url}/ul/v1/browse/${n}?ref=${n}`),e===G.CHAIN.SOLANA&&t===_n.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${_n.COINBASE.url}/dapp?cb_url=${n}`)}},xr=et({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),VE={state:xr,subscribeNetworkImages(t){return Tt(xr.networkImages,()=>t(xr.networkImages))},subscribeKey(t,e){return Nt(xr,t,e)},subscribe(t){return Tt(xr,()=>t(xr))},setWalletImage(t,e){xr.walletImages[t]=e},setNetworkImage(t,e){xr.networkImages[t]=e},setChainImage(t,e){xr.chainImages[t]=e},setConnectorImage(t,e){xr.connectorImages={...xr.connectorImages,[t]:e}},setTokenImage(t,e){xr.tokenImages[t]=e},setCurrencyImage(t,e){xr.currencyImages[t]=e}},on=ar(VE),KE={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:""},Zl=et({networkImagePromises:{}}),ww={async fetchWalletImage(t){if(t)return await ve._fetchWalletImage(t),this.getWalletImageById(t)},async fetchNetworkImage(t){if(!t)return;const e=this.getNetworkImageById(t);return e||(Zl.networkImagePromises[t]||(Zl.networkImagePromises[t]=ve._fetchNetworkImage(t)),await Zl.networkImagePromises[t],this.getNetworkImageById(t))},getWalletImageById(t){if(t)return on.state.walletImages[t]},getWalletImage(t){if(t!=null&&t.image_url)return t==null?void 0:t.image_url;if(t!=null&&t.image_id)return on.state.walletImages[t.image_id]},getNetworkImage(t){var e,r,n;if((e=t==null?void 0:t.assets)!=null&&e.imageUrl)return(r=t==null?void 0:t.assets)==null?void 0:r.imageUrl;if((n=t==null?void 0:t.assets)!=null&&n.imageId)return on.state.networkImages[t.assets.imageId]},getNetworkImageById(t){if(t)return on.state.networkImages[t]},getConnectorImage(t){var e;if(t!=null&&t.imageUrl)return t.imageUrl;if((e=t==null?void 0:t.info)!=null&&e.icon)return t.info.icon;if(t!=null&&t.imageId)return on.state.connectorImages[t.imageId]},getChainImage(t){return on.state.networkImages[KE[t]]}},ns=et({message:"",variant:"info",open:!1}),GE={state:ns,subscribeKey(t,e){return Nt(ns,t,e)},open(t,e){const{debug:r}=X.state,{shortMessage:n,longMessage:s}=t;r&&(ns.message=n,ns.variant=e,ns.open=!0),s&&console.error(typeof s=="function"?s():s)},close(){ns.open=!1,ns.message="",ns.variant="info"}},_t=ar(GE),YE=le.getAnalyticsUrl(),ZE=new Ba({baseUrl:YE,clientId:null}),JE=["MODAL_CREATED"],Rn=et({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),je={state:Rn,subscribe(t){return Tt(Rn,()=>t(Rn))},getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:r}=X.state;return{projectId:t,st:e,sv:r||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(t){try{const e=ee.state.address;if(JE.includes(t.data.event)||typeof window>"u")return;await ZE.post({path:"/e",params:je.getSdkProperties(),body:{eventId:le.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:t.timestamp,props:{...t.data,address:e}}}),Rn.reportedErrors.FORBIDDEN=!1}catch(e){e instanceof Error&&e.cause instanceof Response&&e.cause.status===G.HTTP_STATUS_CODES.FORBIDDEN&&!Rn.reportedErrors.FORBIDDEN&&(_t.open({shortMessage:"Invalid App Configuration",longMessage:`Origin ${jo()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),Rn.reportedErrors.FORBIDDEN=!0)}},sendEvent(t){var e;Rn.timestamp=Date.now(),Rn.data=t,(e=X.state.features)!=null&&e.analytics&&je._sendAnalyticsEvent(Rn)}},XE=le.getApiUrl(),cr=new Ba({baseUrl:XE,clientId:null}),QE=40,Tf=4,ev=20,Re=et({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),ve={state:Re,subscribeKey(t,e){return Nt(Re,t,e)},_getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:r}=X.state;return{projectId:t,st:e||"appkit",sv:r||"html-wagmi-4.2.2"}},_filterOutExtensions(t){return X.state.isUniversalProvider?t.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):t},async _fetchWalletImage(t){const e=`${cr.baseUrl}/getWalletImage/${t}`,r=await cr.getBlob({path:e,params:ve._getSdkProperties()});on.setWalletImage(t,URL.createObjectURL(r))},async _fetchNetworkImage(t){const e=`${cr.baseUrl}/public/getAssetImage/${t}`,r=await cr.getBlob({path:e,params:ve._getSdkProperties()});on.setNetworkImage(t,URL.createObjectURL(r))},async _fetchConnectorImage(t){const e=`${cr.baseUrl}/public/getAssetImage/${t}`,r=await cr.getBlob({path:e,params:ve._getSdkProperties()});on.setConnectorImage(t,URL.createObjectURL(r))},async _fetchCurrencyImage(t){const e=`${cr.baseUrl}/public/getCurrencyImage/${t}`,r=await cr.getBlob({path:e,params:ve._getSdkProperties()});on.setCurrencyImage(t,URL.createObjectURL(r))},async _fetchTokenImage(t){const e=`${cr.baseUrl}/public/getTokenImage/${t}`,r=await cr.getBlob({path:e,params:ve._getSdkProperties()});on.setTokenImage(t,URL.createObjectURL(r))},_filterWalletsByPlatform(t){return le.isMobile()?t==null?void 0:t.filter(r=>r.mobile_link||r.id===_n.COINBASE.id?!0:R.state.activeChain==="solana"&&(r.id===_n.SOLFLARE.id||r.id===_n.PHANTOM.id)):t},async fetchProjectConfig(){return(await cr.get({path:"/appkit/v1/config",params:ve._getSdkProperties()})).features},async fetchAllowedOrigins(){try{const{allowedOrigins:t}=await cr.get({path:"/projects/v1/origins",params:ve._getSdkProperties()});return t}catch(t){if(t instanceof Error&&t.cause instanceof Response){const e=t.cause.status;if(e===G.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:t});if(e>=G.HTTP_STATUS_CODES.SERVER_ERROR&&e<600)throw new Error("SERVER_ERROR",{cause:t});return[]}return[]}},async fetchNetworkImages(){const t=R.getAllRequestedCaipNetworks(),e=t==null?void 0:t.map(({assets:r})=>r==null?void 0:r.imageId).filter(Boolean).filter(r=>!ww.getNetworkImageById(r));e&&await Promise.allSettled(e.map(r=>ve._fetchNetworkImage(r)))},async fetchConnectorImages(){const{connectors:t}=ie.state,e=t.map(({imageId:r})=>r).filter(Boolean);await Promise.allSettled(e.map(r=>ve._fetchConnectorImage(r)))},async fetchCurrencyImages(t=[]){await Promise.allSettled(t.map(e=>ve._fetchCurrencyImage(e)))},async fetchTokenImages(t=[]){await Promise.allSettled(t.map(e=>ve._fetchTokenImage(e)))},async fetchWallets(t){var i;const e=t.exclude??[];ve._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(_n).map(o=>o.id));const n=await cr.get({path:"/getWallets",params:{...ve._getSdkProperties(),...t,page:String(t.page),entries:String(t.entries),include:(i=t.include)==null?void 0:i.join(","),exclude:e.join(",")}});return{data:ve._filterWalletsByPlatform(n==null?void 0:n.data)||[],count:n==null?void 0:n.count}},async fetchFeaturedWallets(){const{featuredWalletIds:t}=X.state;if(t!=null&&t.length){const e={...ve._getSdkProperties(),page:1,entries:(t==null?void 0:t.length)??Tf,include:t},{data:r}=await ve.fetchWallets(e),n=[...r].sort((i,o)=>t.indexOf(i.id)-t.indexOf(o.id)),s=n.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(s.map(i=>ve._fetchWalletImage(i))),Re.featured=n,Re.allFeatured=n}},async fetchRecommendedWallets(){try{Re.isFetchingRecommendedWallets=!0;const{includeWalletIds:t,excludeWalletIds:e,featuredWalletIds:r}=X.state,n=[...e??[],...r??[]].filter(Boolean),s=R.getRequestedCaipNetworkIds().join(","),i={page:1,entries:Tf,include:t,exclude:n,chains:s},{data:o,count:a}=await ve.fetchWallets(i),c=oe.getRecentWallets(),l=o.map(d=>d.image_id).filter(Boolean),u=c.map(d=>d.image_id).filter(Boolean);await Promise.allSettled([...l,...u].map(d=>ve._fetchWalletImage(d))),Re.recommended=o,Re.allRecommended=o,Re.count=a??0}catch{}finally{Re.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:t}){const{includeWalletIds:e,excludeWalletIds:r,featuredWalletIds:n}=X.state,s=R.getRequestedCaipNetworkIds().join(","),i=[...Re.recommended.map(({id:u})=>u),...r??[],...n??[]].filter(Boolean),o={page:t,entries:QE,include:e,exclude:i,chains:s},{data:a,count:c}=await ve.fetchWallets(o),l=a.slice(0,ev).map(u=>u.image_id).filter(Boolean);await Promise.allSettled(l.map(u=>ve._fetchWalletImage(u))),Re.wallets=le.uniqueBy([...Re.wallets,...ve._filterOutExtensions(a)],"id").filter(u=>{var d;return(d=u.chains)==null?void 0:d.some(h=>s.includes(h))}),Re.count=c>Re.count?c:Re.count,Re.page=t},async initializeExcludedWallets({ids:t}){const e={page:1,entries:t.length,include:t},{data:r}=await ve.fetchWallets(e);r&&r.forEach(n=>{Re.excludedWallets.push({rdns:n.rdns,name:n.name})})},async searchWallet({search:t,badge:e}){const{includeWalletIds:r,excludeWalletIds:n}=X.state,s=R.getRequestedCaipNetworkIds().join(",");Re.search=[];const i={page:1,entries:100,search:t==null?void 0:t.trim(),badge_type:e,include:r,exclude:n,chains:s},{data:o}=await ve.fetchWallets(i);je.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:t??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>ve._fetchWalletImage(c)),le.wait(300)]),Re.search=ve._filterOutExtensions(o)},initPromise(t,e){const r=Re.promises[t];return r||(Re.promises[t]=e())},prefetch({fetchConnectorImages:t=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:r=!0,fetchNetworkImages:n=!0}={}){const s=[t&&ve.initPromise("connectorImages",ve.fetchConnectorImages),e&&ve.initPromise("featuredWallets",ve.fetchFeaturedWallets),r&&ve.initPromise("recommendedWallets",ve.fetchRecommendedWallets),n&&ve.initPromise("networkImages",ve.fetchNetworkImages)].filter(Boolean);return Promise.allSettled(s)},prefetchAnalyticsConfig(){var t;(t=X.state.features)!=null&&t.analytics&&ve.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:t}=await cr.get({path:"/getAnalyticsConfig",params:ve._getSdkProperties()});X.setFeatures({analytics:t})}catch{X.setFeatures({analytics:!1})}},filterByNamespaces(t){if(!(t!=null&&t.length)){Re.featured=Re.allFeatured,Re.recommended=Re.allRecommended;return}const e=R.getRequestedCaipNetworkIds().join(",");Re.featured=Re.allFeatured.filter(r=>{var n;return(n=r.chains)==null?void 0:n.some(s=>e.includes(s))}),Re.recommended=Re.allRecommended.filter(r=>{var n;return(n=r.chains)==null?void 0:n.some(s=>e.includes(s))}),Re.filteredWallets=Re.wallets.filter(r=>{var n;return(n=r.chains)==null?void 0:n.some(s=>e.includes(s))})},clearFilterByNamespaces(){Re.filteredWallets=[]},setFilterByNamespace(t){if(!t){Re.featured=Re.allFeatured,Re.recommended=Re.allRecommended;return}const e=R.getRequestedCaipNetworkIds().join(",");Re.featured=Re.allFeatured.filter(r=>{var n;return(n=r.chains)==null?void 0:n.some(s=>e.includes(s))}),Re.recommended=Re.allRecommended.filter(r=>{var n;return(n=r.chains)==null?void 0:n.some(s=>e.includes(s))}),Re.filteredWallets=Re.wallets.filter(r=>{var n;return(n=r.chains)==null?void 0:n.some(s=>e.includes(s))})}},rt=et({view:"Connect",history:["Connect"],transactionStack:[]}),tv={state:rt,subscribeKey(t,e){return Nt(rt,t,e)},pushTransactionStack(t){rt.transactionStack.push(t)},popTransactionStack(t){const e=rt.transactionStack.pop();if(!e)return;const{onSuccess:r,onError:n,onCancel:s}=e;switch(t){case"success":r==null||r();break;case"error":n==null||n(),me.goBack();break;case"cancel":s==null||s(),me.goBack();break}},push(t,e){t!==rt.view&&(rt.view=t,rt.history.push(t),rt.data=e)},reset(t,e){rt.view=t,rt.history=[t],rt.data=e},replace(t,e){rt.history.at(-1)===t||(rt.view=t,rt.history[rt.history.length-1]=t,rt.data=e)},goBack(){var n;const t=R.state.activeCaipAddress,e=me.state.view==="ConnectingFarcaster",r=!t&&e;if(rt.history.length>1){rt.history.pop();const[s]=rt.history.slice(-1);s&&(t&&s==="Connect"?rt.view="Account":rt.view=s)}else Fe.close();(n=rt.data)!=null&&n.wallet&&(rt.data.wallet=void 0),setTimeout(()=>{var s,i,o;if(r){ee.setFarcasterUrl(void 0,R.state.activeChain);const a=ie.getAuthConnector();(s=a==null?void 0:a.provider)==null||s.reload();const c=aa(X.state);(o=(i=a==null?void 0:a.provider)==null?void 0:i.syncDappData)==null||o.call(i,{metadata:c.metadata,sdkVersion:c.sdkVersion,projectId:c.projectId,sdkType:c.sdkType})}},100)},goBackToIndex(t){if(rt.history.length>1){rt.history=rt.history.slice(0,t+1);const[e]=rt.history.slice(-1);e&&(rt.view=e)}},goBackOrCloseModal(){me.state.history.length>1?me.goBack():Fe.close()}},me=ar(tv),Pn=et({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),fd={state:Pn,subscribe(t){return Tt(Pn,()=>t(Pn))},setThemeMode(t){Pn.themeMode=t;try{const e=ie.getAuthConnector();if(e){const r=fd.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:t,themeVariables:r,w3mThemeVariables:Kn(r,t)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(t){Pn.themeVariables={...Pn.themeVariables,...t};try{const e=ie.getAuthConnector();if(e){const r=fd.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:r,w3mThemeVariables:Kn(Pn.themeVariables,Pn.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return aa(Pn)}},yr=ar(fd),yw={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},He=et({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:{...yw},filterByNamespaceMap:{eip155:!0,solana:!0,polkadot:!0,bip122:!0,cosmos:!0}}),rv={state:He,subscribe(t){return Tt(He,()=>{t(He)})},subscribeKey(t,e){return Nt(He,t,e)},initialize(t){t.forEach(e=>{const r=oe.getConnectedConnectorId(e);r&&ie.setConnectorId(r,e)})},setActiveConnector(t){t&&(He.activeConnector=si(t))},setConnectors(t){t.filter(s=>!He.allConnectors.some(i=>i.id===s.id&&ie.getConnectorName(i.name)===ie.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&He.allConnectors.push(si(s))});const r=ie.getEnabledNamespaces(),n=ie.getEnabledConnectors(r);He.connectors=ie.mergeMultiChainConnectors(n)},filterByNamespaces(t){Object.keys(He.filterByNamespaceMap).forEach(e=>{He.filterByNamespaceMap[e]=!1}),t.forEach(e=>{He.filterByNamespaceMap[e]=!0}),ie.updateConnectorsForEnabledNamespaces()},filterByNamespace(t,e){He.filterByNamespaceMap[t]=e,ie.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const t=ie.getEnabledNamespaces(),e=ie.getEnabledConnectors(t),r=ie.areAllNamespacesEnabled();He.connectors=ie.mergeMultiChainConnectors(e),r?ve.clearFilterByNamespaces():ve.filterByNamespaces(t)},getEnabledNamespaces(){return Object.entries(He.filterByNamespaceMap).filter(([t,e])=>e).map(([t])=>t)},getEnabledConnectors(t){return He.allConnectors.filter(e=>t.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(He.filterByNamespaceMap).every(t=>t)},mergeMultiChainConnectors(t){const e=ie.generateConnectorMapByName(t),r=[];return e.forEach(n=>{const s=n[0],i=(s==null?void 0:s.id)===G.CONNECTOR_ID.AUTH;n.length>1&&s?r.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...n],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:(s==null?void 0:s.id)||""}):s&&r.push(s)}),r},generateConnectorMapByName(t){const e=new Map;return t.forEach(r=>{const{name:n}=r,s=ie.getConnectorName(n);if(!s)return;const i=e.get(s)||[];i.find(a=>a.chain===r.chain)||i.push(r),e.set(s,i)}),e},getConnectorName(t){return t&&({"Trust Wallet":"Trust"}[t]||t)},getUniqueConnectorsByName(t){const e=[];return t.forEach(r=>{e.find(n=>n.chain===r.chain)||e.push(r)}),e},addConnector(t){var e,r,n;if(t.id===G.CONNECTOR_ID.AUTH){const s=t,i=aa(X.state),o=yr.getSnapshot().themeMode,a=yr.getSnapshot().themeVariables;(r=(e=s==null?void 0:s.provider)==null?void 0:e.syncDappData)==null||r.call(e,{metadata:i.metadata,sdkVersion:i.sdkVersion,projectId:i.projectId,sdkType:i.sdkType}),(n=s==null?void 0:s.provider)==null||n.syncTheme({themeMode:o,themeVariables:a,w3mThemeVariables:Kn(a,o)}),ie.setConnectors([t])}else ie.setConnectors([t])},getAuthConnector(t){var n;const e=t||R.state.activeChain,r=He.connectors.find(s=>s.id===G.CONNECTOR_ID.AUTH);if(r)return(n=r==null?void 0:r.connectors)!=null&&n.length?r.connectors.find(i=>i.chain===e):r},getAnnouncedConnectorRdns(){return He.connectors.filter(t=>t.type==="ANNOUNCED").map(t=>{var e;return(e=t.info)==null?void 0:e.rdns})},getConnectorById(t){return He.allConnectors.find(e=>e.id===t)},getConnector(t,e){return He.allConnectors.filter(n=>n.chain===R.state.activeChain).find(n=>{var s;return n.explorerId===t||((s=n.info)==null?void 0:s.rdns)===e})},syncIfAuthConnector(t){var i,o;if(t.id!=="ID_AUTH")return;const e=t,r=aa(X.state),n=yr.getSnapshot().themeMode,s=yr.getSnapshot().themeVariables;(o=(i=e==null?void 0:e.provider)==null?void 0:i.syncDappData)==null||o.call(i,{metadata:r.metadata,sdkVersion:r.sdkVersion,sdkType:r.sdkType,projectId:r.projectId}),e.provider.syncTheme({themeMode:n,themeVariables:s,w3mThemeVariables:Kn(s,n)})},getConnectorsByNamespace(t){const e=He.allConnectors.filter(r=>r.chain===t);return ie.mergeMultiChainConnectors(e)},selectWalletConnector(t){const e=ie.getConnector(t.id,t.rdns),r=R.state.activeChain;zE.handleMobileDeeplinkRedirect((e==null?void 0:e.explorerId)||t.id,r),e?me.push("ConnectingExternal",{connector:e}):me.push("ConnectingWalletConnect",{wallet:t})},getConnectors(t){return t?ie.getConnectorsByNamespace(t):ie.mergeMultiChainConnectors(He.allConnectors)},setFilterByNamespace(t){He.filterByNamespace=t,He.connectors=ie.getConnectors(t),ve.setFilterByNamespace(t)},setConnectorId(t,e){t&&(He.activeConnectorIds={...He.activeConnectorIds,[e]:t},oe.setConnectedConnectorId(e,t))},removeConnectorId(t){He.activeConnectorIds={...He.activeConnectorIds,[t]:void 0},oe.deleteConnectedConnectorId(t)},getConnectorId(t){if(t)return He.activeConnectorIds[t]},isConnected(t){return t?!!He.activeConnectorIds[t]:Object.values(He.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){He.activeConnectorIds={...yw}}},ie=ar(rv),la={getConnectionStatus(t,e){const r=ie.state.activeConnectorIds[e],n=ue.state.connections.get(e)??[];return!!r&&t.connectorId===r?"connected":n.some(o=>o.connectorId.toLowerCase()===t.connectorId.toLowerCase())?"active":"disconnected"},validateAccountSwitch({namespace:t,connection:e,address:r}){if(t===G.CHAIN.BITCOIN){if(!r)throw new Error("Address parameter is required for switching bip122 connection");const{type:s}=e.accounts.find(i=>i.address.toLowerCase()===r.toLowerCase())??{};if(typeof s=="string"&&s!=="payment")throw new Error(`Switching to non-payment accounts is not allowed for ${t}`)}},excludeConnectorAddressFromConnections({connections:t,connectorId:e,addresses:r}){return t.map(n=>{if((e?n.connectorId.toLowerCase()===e.toLowerCase():!1)&&r){const i=n.accounts.filter(o=>!r.some(c=>c.toLowerCase()===o.address.toLowerCase()));return{...n,accounts:i}}return n})},excludeExistingConnections(t,e){const r=new Set(t);return e.filter(n=>!r.has(n.connectorId))},getConnectionsByConnectorId(t,e){return t.filter(r=>r.connectorId.toLowerCase()===e.toLowerCase())},filterConnectionsByAccountType(t,e){return t.map(r=>{const n=r.accounts.filter(s=>typeof s.type=="string"?s.type.toLowerCase()===e.toLowerCase():!0);return{...r,accounts:n}})},getConnectionsData(t){const e=ue.state.connections.get(t)??[],r=e.filter(a=>!a.recent),n=ie.state.activeConnectorIds[t],i=e.filter(a=>a.recent).filter(a=>ie.getConnectorById(a.connectorId)),o=la.excludeExistingConnections([...r.map(a=>a.connectorId),...n?[n]:[]],i);return{connections:r,recentConnections:o}}};var ro={};const nv="https://secure.walletconnect.org/sdk",sv=(typeof process<"u"&&typeof ro<"u"?ro.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||nv,iv=(typeof process<"u"&&typeof ro<"u"?ro.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",ov=(typeof process<"u"&&typeof ro<"u"?ro.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",ge={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},At={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},av=1e3,Wn={checkNamespaceConnectorId(t,e){return ie.getConnectorId(t)===e},isSocialProvider(t){return Ye.DEFAULT_REMOTE_FEATURES.socials.includes(t)},connectWalletConnect({walletConnect:t,connector:e,closeModalOnConnect:r=!0,redirectViewOnModalClose:n="Connect",onOpen:s,onConnect:i}){return new Promise((o,a)=>{if(t&&ie.setActiveConnector(e),s==null||s(le.isMobile()&&t),n){const l=Fe.subscribeKey("open",u=>{u||(me.state.view!==n&&me.replace(n),l(),a(new Error("Modal closed")))})}const c=R.subscribeKey("activeCaipAddress",l=>{l&&(i==null||i(),r&&Fe.close(),c(),o(Pr.parseCaipAddress(l)))})})},connectExternal(t){return new Promise((e,r)=>{const n=R.subscribeKey("activeCaipAddress",s=>{s&&(Fe.close(),n(),e(Pr.parseCaipAddress(s)))});ue.connectExternal(t,t.chain).catch(()=>{n(),r(new Error("Connection rejected"))})})},connectSocial({social:t,closeModalOnConnect:e=!0,onOpenFarcaster:r,onConnect:n}){let s=ee.state.socialWindow,i=ee.state.socialProvider,o=!1,a=null;const c=R.subscribeKey("activeCaipAddress",l=>{l&&(e&&Fe.close(),c())});return new Promise((l,u)=>{async function d(m){var f;if((f=m.data)!=null&&f.resultUri)if(m.origin===G.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",d,!1);try{const g=ie.getAuthConnector();if(g&&!o){s&&(s.close(),ee.setSocialWindow(void 0,R.state.activeChain),s=ee.state.socialWindow),o=!0;const _=m.data.resultUri;if(i&&je.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:i}}),await g.provider.connectSocial(_),i){oe.setConnectedSocialProvider(i),await ue.connectExternal({id:g.id,type:g.type,socialUri:_},g.chain);const I=R.state.activeCaipAddress;if(!I){u(new Error("Failed to connect"));return}l(Pr.parseCaipAddress(I)),je.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:i}})}}}catch{i&&je.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:i}}),u(new Error("Failed to connect"))}}else i&&je.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:i}})}async function h(){if(t&&(ee.setSocialProvider(t,R.state.activeChain),i=ee.state.socialProvider,je.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:i}})),i==="farcaster"){r==null||r();const m=Fe.subscribeKey("open",g=>{!g&&t==="farcaster"&&(u(new Error("Popup closed")),n==null||n(),m())}),f=ie.getAuthConnector();if(f&&!ee.state.farcasterUrl)try{const{url:g}=await f.provider.getFarcasterUri();ee.setFarcasterUrl(g,R.state.activeChain)}catch{u(new Error("Failed to connect to farcaster"))}}else{const m=ie.getAuthConnector();a=le.returnOpenHref(`${G.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(m&&i){const{uri:f}=await m.provider.getSocialRedirectUri({provider:i});if(a&&f){ee.setSocialWindow(a,R.state.activeChain),s=ee.state.socialWindow,a.location.href=f;const g=setInterval(()=>{s!=null&&s.closed&&!o&&(u(new Error("Popup closed")),clearInterval(g))},1e3);window.addEventListener("message",d,!1)}else a==null||a.close(),u(new Error("Failed to initiate social connection"))}}catch{u(new Error("Failed to initiate social connection")),a==null||a.close()}}}h()})},connectEmail({closeModalOnConnect:t=!0,redirectViewOnModalClose:e="Connect",onOpen:r,onConnect:n}){return new Promise((s,i)=>{if(r==null||r(),e){const a=Fe.subscribeKey("open",c=>{c||(me.state.view!==e&&me.replace(e),a(),i(new Error("Modal closed")))})}const o=R.subscribeKey("activeCaipAddress",a=>{a&&(n==null||n(),t&&Fe.close(),o(),s(Pr.parseCaipAddress(a)))})})},async updateEmail(){const t=oe.getConnectedConnectorId(R.state.activeChain),e=ie.getAuthConnector();if(!e)throw new Error("No auth connector found");if(t!==G.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const r=e.provider.getEmail()??"";return me.push("UpdateEmailWallet",{email:r,redirectView:void 0}),new Promise((n,s)=>{const i=setInterval(()=>{const a=e.provider.getEmail()??"";a!==r&&(Fe.close(),clearInterval(i),o(),n({email:a}))},av),o=Fe.subscribeKey("open",a=>{a||(me.state.view!=="Connect"&&me.push("Connect"),clearInterval(i),o(),s(new Error("Modal closed")))})})},canSwitchToSmartAccount(t){var r;return R.checkIfSmartAccountEnabled()&&((r=ee.state.preferredAccountTypes)==null?void 0:r[t])===At.ACCOUNT_TYPES.EOA}},Hs=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),xt=et({...Hs}),cv={state:xt,subscribeKey(t,e){return Nt(xt,t,e)},showLoading(t,e={}){this._showMessage({message:t,variant:"loading",...e})},showSuccess(t){this._showMessage({message:t,variant:"success"})},showSvg(t,e){this._showMessage({message:t,svg:e})},showError(t){const e=le.parseError(t);this._showMessage({message:e,variant:"error"})},hide(){xt.message=Hs.message,xt.variant=Hs.variant,xt.svg=Hs.svg,xt.open=Hs.open,xt.autoClose=Hs.autoClose},_showMessage({message:t,svg:e,variant:r="success",autoClose:n=Hs.autoClose}){xt.open?(xt.open=!1,setTimeout(()=>{xt.message=t,xt.variant=r,xt.svg=e,xt.open=!0,xt.autoClose=n},150)):(xt.message=t,xt.variant=r,xt.svg=e,xt.open=!0,xt.autoClose=n)}},pt=cv,lt=et({transactions:[],coinbaseTransactions:{},transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),lv={state:lt,subscribe(t){return Tt(lt,()=>t(lt))},setLastNetworkInView(t){lt.lastNetworkInView=t},async fetchTransactions(t,e){var r,n;if(!t)throw new Error("Transactions can't be fetched without an accountAddress");lt.loading=!0;try{const s=await ye.fetchTransactions({account:t,cursor:lt.next,onramp:e,cache:e==="coinbase"?"no-cache":void 0,chainId:(r=R.state.activeCaipNetwork)==null?void 0:r.caipNetworkId}),i=qo.filterSpamTransactions(s.data),o=qo.filterByConnectedChain(i),a=[...lt.transactions,...o];lt.loading=!1,e==="coinbase"?lt.coinbaseTransactions=qo.groupTransactionsByYearAndMonth(lt.coinbaseTransactions,s.data):(lt.transactions=a,lt.transactionsByYear=qo.groupTransactionsByYearAndMonth(lt.transactionsByYear,o)),lt.empty=a.length===0,lt.next=s.next?s.next:void 0}catch{const i=R.state.activeChain;je.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:t,projectId:X.state.projectId,cursor:lt.next,isSmartAccount:((n=ee.state.preferredAccountTypes)==null?void 0:n[i])===At.ACCOUNT_TYPES.SMART_ACCOUNT}}),pt.showError("Failed to fetch transactions"),lt.loading=!1,lt.empty=!0,lt.next=void 0}},groupTransactionsByYearAndMonth(t={},e=[]){const r=t;return e.forEach(n=>{const s=new Date(n.metadata.minedAt).getFullYear(),i=new Date(n.metadata.minedAt).getMonth(),o=r[s]??{},c=(o[i]??[]).filter(l=>l.id!==n.id);r[s]={...o,[i]:[...c,n].sort((l,u)=>new Date(u.metadata.minedAt).getTime()-new Date(l.metadata.minedAt).getTime())}}),r},filterSpamTransactions(t){return t.filter(e=>!e.transfers.every(n=>{var s;return((s=n.nft_info)==null?void 0:s.flags.is_spam)===!0}))},filterByConnectedChain(t){var n;const e=(n=R.state.activeCaipNetwork)==null?void 0:n.caipNetworkId;return t.filter(s=>s.metadata.chain===e)},clearCursor(){lt.next=void 0},resetTransactions(){lt.transactions=[],lt.transactionsByYear={},lt.lastNetworkInView=void 0,lt.loading=!1,lt.empty=!1,lt.next=void 0}},qo=ar(lv,"API_ERROR"),Le=et({connections:new Map,isSwitchingConnection:!1,wcError:!1,buffering:!1,status:"disconnected"});let Bs;const uv={state:Le,subscribe(t){return Tt(Le,()=>t(Le))},subscribeKey(t,e){return Nt(Le,t,e)},_getClient(){return Le._client},setClient(t){Le._client=si(t)},initialize(t){const e=oe.getConnections();for(const r of t){const n=r.namespace;if(n){const s=Le.connections.get(n)??[],i=e[n]??[],o=[...s,...i];Le.connections.set(n,o)}}},async connectWalletConnect(){var t,e,r,n;if(le.isTelegram()||le.isSafari()&&le.isIos()){if(Bs){await Bs,Bs=void 0;return}if(!le.isPairingExpired(Le==null?void 0:Le.wcPairingExpiry)){const s=Le.wcUri;Le.wcUri=s;return}Bs=(e=(t=ue._getClient())==null?void 0:t.connectWalletConnect)==null?void 0:e.call(t).catch(()=>{}),ue.state.status="connecting",await Bs,Bs=void 0,Le.wcPairingExpiry=void 0,ue.state.status="connected"}else await((n=(r=ue._getClient())==null?void 0:r.connectWalletConnect)==null?void 0:n.call(r))},async connectExternal(t,e,r=!0){var s,i;const n=await((i=(s=ue._getClient())==null?void 0:s.connectExternal)==null?void 0:i.call(s,t));return r&&R.setActiveNamespace(e),n},async reconnectExternal(t){var r,n;await((n=(r=ue._getClient())==null?void 0:r.reconnectExternal)==null?void 0:n.call(r,t));const e=t.chain||R.state.activeChain;e&&ie.setConnectorId(t.id,e)},async setPreferredAccountType(t,e){var n;Fe.setLoading(!0,R.state.activeChain);const r=ie.getAuthConnector();r&&(ee.setPreferredAccountType(t,e),await r.provider.setPreferredAccount(t),oe.setPreferredAccountTypes(ee.state.preferredAccountTypes??{[e]:t}),await ue.reconnectExternal(r),Fe.setLoading(!1,R.state.activeChain),je.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:t,network:((n=R.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)||""}}))},async signMessage(t){var e;return(e=ue._getClient())==null?void 0:e.signMessage(t)},parseUnits(t,e){var r;return(r=ue._getClient())==null?void 0:r.parseUnits(t,e)},formatUnits(t,e){var r;return(r=ue._getClient())==null?void 0:r.formatUnits(t,e)},async sendTransaction(t){var e;return(e=ue._getClient())==null?void 0:e.sendTransaction(t)},async getCapabilities(t){var e;return(e=ue._getClient())==null?void 0:e.getCapabilities(t)},async grantPermissions(t){var e;return(e=ue._getClient())==null?void 0:e.grantPermissions(t)},async walletGetAssets(t){var e;return((e=ue._getClient())==null?void 0:e.walletGetAssets(t))??{}},async estimateGas(t){var e;return(e=ue._getClient())==null?void 0:e.estimateGas(t)},async writeContract(t){var e;return(e=ue._getClient())==null?void 0:e.writeContract(t)},async getEnsAddress(t){var e;return(e=ue._getClient())==null?void 0:e.getEnsAddress(t)},async getEnsAvatar(t){var e;return(e=ue._getClient())==null?void 0:e.getEnsAvatar(t)},checkInstalled(t){var e,r;return((r=(e=ue._getClient())==null?void 0:e.checkInstalled)==null?void 0:r.call(e,t))||!1},resetWcConnection(){Le.wcUri=void 0,Le.wcPairingExpiry=void 0,Le.wcLinking=void 0,Le.recentWallet=void 0,Le.status="disconnected",qo.resetTransactions(),oe.deleteWalletConnectDeepLink()},resetUri(){Le.wcUri=void 0,Le.wcPairingExpiry=void 0,Bs=void 0},finalizeWcConnection(){var r,n;const{wcLinking:t,recentWallet:e}=ue.state;t&&oe.setWalletConnectDeepLink(t),e&&oe.setAppKitRecent(e),je.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:t?"mobile":"qrcode",name:((n=(r=me.state.data)==null?void 0:r.wallet)==null?void 0:n.name)||"Unknown"}})},setWcBasic(t){Le.wcBasic=t},setUri(t){Le.wcUri=t,Le.wcPairingExpiry=le.getPairingExpiry()},setWcLinking(t){Le.wcLinking=t},setWcError(t){Le.wcError=t,Le.buffering=!1},setRecentWallet(t){Le.recentWallet=t},setBuffering(t){Le.buffering=t},setStatus(t){Le.status=t},setIsSwitchingConnection(t){Le.isSwitchingConnection=t},async disconnect({id:t,namespace:e}={}){var r;try{await((r=ue._getClient())==null?void 0:r.disconnect({id:t,chainNamespace:e}))}catch(n){throw new to("Failed to disconnect","INTERNAL_SDK_ERROR",n)}},setConnections(t,e){Le.connections=new Map(Le.connections.set(e,t))},async handleAuthAccountSwitch({address:t,connection:e,namespace:r}){var o;const n=(o=e.accounts.find(a=>a.type==="smartAccount"))==null?void 0:o.address,i=(n==null?void 0:n.toLowerCase())===t.toLowerCase()&&Wn.canSwitchToSmartAccount(r)?"smartAccount":"eoa";await ue.setPreferredAccountType(i,r)},async handleActiveConnection({connection:t,namespace:e,address:r}){const n=ie.getConnectorById(t.connectorId),s=t.connectorId===G.CONNECTOR_ID.AUTH;if(!n)throw new Error(`No connector found for connection: ${t.connectorId}`);const i=await ue.connectExternal({id:n.id,type:n.type,provider:n.provider,address:r,chain:e},e);return s&&r&&await ue.handleAuthAccountSwitch({address:r,connection:t,namespace:e}),i==null?void 0:i.address},async handleDisconnectedConnection({connection:t,namespace:e,address:r,closeModalOnConnect:n}){var l,u;const s=ie.getConnectorById(t.connectorId),i=(u=(l=t.auth)==null?void 0:l.name)==null?void 0:u.toLowerCase(),o=t.connectorId===G.CONNECTOR_ID.AUTH,a=t.connectorId===G.CONNECTOR_ID.WALLET_CONNECT;if(!s)throw new Error(`No connector found for connection: ${t.connectorId}`);let c;if(o)if(i&&Wn.isSocialProvider(i)){const{address:d}=await Wn.connectSocial({social:i,closeModalOnConnect:n,onOpenFarcaster(){Fe.open({view:"ConnectingFarcaster"})},onConnect(){me.replace("ProfileWallets")}});c=d}else{const{address:d}=await Wn.connectEmail({closeModalOnConnect:n,onOpen(){Fe.open({view:"EmailLogin"})},onConnect(){me.replace("ProfileWallets")}});c=d}else if(a){const{address:d}=await Wn.connectWalletConnect({walletConnect:!0,connector:s,closeModalOnConnect:n,onOpen(h){Fe.open({view:h?"AllWallets":"ConnectingWalletConnect"})},onConnect(){me.replace("ProfileWallets")}});c=d}else{const d=await ue.connectExternal({id:s.id,type:s.type,provider:s.provider,chain:e},e);d&&(c=d.address)}return o&&r&&await ue.handleAuthAccountSwitch({address:r,connection:t,namespace:e}),c},async switchConnection({connection:t,address:e,namespace:r,closeModalOnConnect:n,onChange:s}){la.validateAccountSwitch({namespace:r,connection:t,address:e});let i;const o=ee.getCaipAddress(r);if(o){const{address:c}=Pr.parseCaipAddress(o);i=c}const a=la.getConnectionStatus(t,r);switch(a){case"connected":case"active":{const c=await ue.handleActiveConnection({connection:t,namespace:r,address:e});if(i&&c){const l=c.toLowerCase()!==i.toLowerCase();s==null||s({address:c,namespace:r,hasSwitchedAccount:l,hasSwitchedWallet:a==="active"})}break}case"disconnected":{const c=await ue.handleDisconnectedConnection({connection:t,namespace:r,address:e,closeModalOnConnect:n});c&&(s==null||s({address:c,namespace:r,hasSwitchedAccount:!0,hasSwitchedWallet:!0}));break}default:throw new Error(`Invalid connection status: ${a}`)}}},ue=ar(uv),Ai=et({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),Sn={state:Ai,subscribe(t){return Tt(Ai,()=>t(Ai))},subscribeOpen(t){return Nt(Ai,"open",t)},set(t){Object.assign(Ai,{...Ai,...t})}};function dv(t){const e=Array.from(R.state.chains.keys());let r=[];return t?(r.push([t,R.state.chains.get(t)]),Wn.checkNamespaceConnectorId(t,G.CONNECTOR_ID.WALLET_CONNECT)?e.forEach(n=>{n!==t&&Wn.checkNamespaceConnectorId(n,G.CONNECTOR_ID.WALLET_CONNECT)&&r.push([n,R.state.chains.get(n)])}):Wn.checkNamespaceConnectorId(t,G.CONNECTOR_ID.AUTH)&&e.forEach(n=>{n!==t&&Wn.checkNamespaceConnectorId(n,G.CONNECTOR_ID.AUTH)&&r.push([n,R.state.chains.get(n)])})):r=Array.from(R.state.chains.entries()),r}function vh(){var n,s;const t=((n=R.state.activeCaipNetwork)==null?void 0:n.chainNamespace)||"eip155",e=((s=R.state.activeCaipNetwork)==null?void 0:s.id)||1,r=Ye.NATIVE_TOKEN_ADDRESS[t];return`${t}:${e}:${r}`}const Ho={async getTokenList(){var n;const t=R.state.activeCaipNetwork,e=await ye.fetchSwapTokens({chainId:t==null?void 0:t.caipNetworkId});return((n=e==null?void 0:e.tokens)==null?void 0:n.map(s=>({...s,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0})))||[]},async fetchGasPrice(){var e;const t=R.state.activeCaipNetwork;if(!t)return null;try{switch(t.chainNamespace){case"solana":const r=(e=await(ue==null?void 0:ue.estimateGas({chainNamespace:"solana"})))==null?void 0:e.toString();return{standard:r,fast:r,instant:r};case"eip155":default:return await ye.fetchGasPrice({chainId:t.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:t,userAddress:e,sourceTokenAmount:r,sourceTokenDecimals:n}){const s=await ye.fetchSwapAllowance({tokenAddress:t,userAddress:e});if(s!=null&&s.allowance&&r&&n){const i=ue.parseUnits(r,n)||0;return BigInt(s.allowance)>=i}return!1},async getMyTokensWithBalance(t){const e=await _l.getMyTokensWithBalance(t);return ee.setTokenBalance(e,R.state.activeChain),this.mapBalancesToSwapTokens(e)},mapBalancesToSwapTokens(t){return(t==null?void 0:t.map(e=>({...e,address:e!=null&&e.address?e.address:vh(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1})))||[]}},Xe=et({tokenBalances:[],loading:!1}),hv={state:Xe,subscribe(t){return Tt(Xe,()=>t(Xe))},subscribeKey(t,e){return Nt(Xe,t,e)},setToken(t){t&&(Xe.token=si(t))},setTokenAmount(t){Xe.sendTokenAmount=t},setReceiverAddress(t){Xe.receiverAddress=t},setReceiverProfileImageUrl(t){Xe.receiverProfileImageUrl=t},setReceiverProfileName(t){Xe.receiverProfileName=t},setNetworkBalanceInUsd(t){Xe.networkBalanceInUSD=t},setLoading(t){Xe.loading=t},async sendToken(){var t;try{switch(Ge.setLoading(!0),(t=R.state.activeCaipNetwork)==null?void 0:t.chainNamespace){case"eip155":await Ge.sendEvmToken();return;case"solana":await Ge.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}finally{Ge.setLoading(!1)}},async sendEvmToken(){var r,n,s,i;const t=R.state.activeChain,e=(r=ee.state.preferredAccountTypes)==null?void 0:r[t];if(!Ge.state.sendTokenAmount||!Ge.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!Ge.state.token)throw new Error("A token is required");(n=Ge.state.token)!=null&&n.address?(je.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===At.ACCOUNT_TYPES.SMART_ACCOUNT,token:Ge.state.token.address,amount:Ge.state.sendTokenAmount,network:((s=R.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)||""}}),await Ge.sendERC20Token({receiverAddress:Ge.state.receiverAddress,tokenAddress:Ge.state.token.address,sendTokenAmount:Ge.state.sendTokenAmount,decimals:Ge.state.token.quantity.decimals})):(je.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===At.ACCOUNT_TYPES.SMART_ACCOUNT,token:Ge.state.token.symbol||"",amount:Ge.state.sendTokenAmount,network:((i=R.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)||""}}),await Ge.sendNativeToken({receiverAddress:Ge.state.receiverAddress,sendTokenAmount:Ge.state.sendTokenAmount,decimals:Ge.state.token.quantity.decimals}))},async fetchTokenBalance(t){var i,o;Xe.loading=!0;const e=(i=R.state.activeCaipNetwork)==null?void 0:i.caipNetworkId,r=(o=R.state.activeCaipNetwork)==null?void 0:o.chainNamespace,n=R.state.activeCaipAddress,s=n?le.getPlainAddress(n):void 0;if(Xe.lastRetry&&!le.isAllowedRetry(Xe.lastRetry,30*Ye.ONE_SEC_MS))return Xe.loading=!1,[];try{if(s&&e&&r){const a=await _l.getMyTokensWithBalance();return Xe.tokenBalances=a,Xe.lastRetry=void 0,a}}catch(a){Xe.lastRetry=Date.now(),t==null||t(a),pt.showError("Token Balance Unavailable")}finally{Xe.loading=!1}return[]},fetchNetworkBalance(){if(Xe.tokenBalances.length===0)return;const t=Ho.mapBalancesToSwapTokens(Xe.tokenBalances);if(!t)return;const e=t.find(r=>r.address===vh());e&&(Xe.networkBalanceInUSD=e?dt.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(t){var i,o,a,c;me.pushTransactionStack({});const e=t.receiverAddress,r=ee.state.address,n=ue.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals));await ue.sendTransaction({chainNamespace:"eip155",to:e,address:r,data:"0x",value:n??BigInt(0)}),je.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:((i=ee.state.preferredAccountTypes)==null?void 0:i.eip155)===At.ACCOUNT_TYPES.SMART_ACCOUNT,token:((o=Ge.state.token)==null?void 0:o.symbol)||"",amount:t.sendTokenAmount,network:((a=R.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)||""}}),(c=ue._getClient())==null||c.updateBalance("eip155"),Ge.resetSend()},async sendERC20Token(t){me.pushTransactionStack({onSuccess(){me.replace("Account")}});const e=ue.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals));if(ee.state.address&&t.sendTokenAmount&&t.receiverAddress&&t.tokenAddress){const r=le.getPlainAddress(t.tokenAddress);await ue.writeContract({fromAddress:ee.state.address,tokenAddress:r,args:[t.receiverAddress,e??BigInt(0)],method:"transfer",abi:BE.getERC20Abi(r),chainNamespace:"eip155"}),Ge.resetSend()}},async sendSolanaToken(){var t;if(!Ge.state.sendTokenAmount||!Ge.state.receiverAddress)throw new Error("An amount and receiver address are required");me.pushTransactionStack({onSuccess(){me.replace("Account")}}),await ue.sendTransaction({chainNamespace:"solana",to:Ge.state.receiverAddress,value:Ge.state.sendTokenAmount}),(t=ue._getClient())==null||t.updateBalance("solana"),Ge.resetSend()},resetSend(){Xe.token=void 0,Xe.sendTokenAmount=void 0,Xe.receiverAddress=void 0,Xe.receiverProfileImageUrl=void 0,Xe.receiverProfileName=void 0,Xe.loading=!1,Xe.tokenBalances=[]}},Ge=ar(hv),Jl={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[],user:void 0},ac={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},ce=et({chains:cE(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),fv={state:ce,subscribe(t){return Tt(ce,()=>{t(ce)})},subscribeKey(t,e){return Nt(ce,t,e)},subscribeChainProp(t,e,r){let n;return Tt(ce.chains,()=>{var i;const s=r||ce.activeChain;if(s){const o=(i=ce.chains.get(s))==null?void 0:i[t];n!==o&&(n=o,e(o))}})},initialize(t,e,r){const{chainId:n,namespace:s}=oe.getActiveNetworkProps(),i=e==null?void 0:e.find(u=>u.id.toString()===(n==null?void 0:n.toString())),a=t.find(u=>(u==null?void 0:u.namespace)===s)||(t==null?void 0:t[0]),c=t.map(u=>u.namespace).filter(u=>u!==void 0),l=X.state.enableEmbedded?new Set([...c]):new Set([...(e==null?void 0:e.map(u=>u.chainNamespace))??[]]);((t==null?void 0:t.length)===0||!a)&&(ce.noAdapters=!0),ce.noAdapters||(ce.activeChain=a==null?void 0:a.namespace,ce.activeCaipNetwork=i,R.setChainNetworkData(a==null?void 0:a.namespace,{caipNetwork:i}),ce.activeChain&&Sn.set({activeChain:a==null?void 0:a.namespace})),l.forEach(u=>{const d=e==null?void 0:e.filter(h=>h.chainNamespace===u);R.state.chains.set(u,{namespace:u,networkState:et({...ac,caipNetwork:d==null?void 0:d[0]}),accountState:et(Jl),caipNetworks:d??[],...r}),R.setRequestedCaipNetworks(d??[],u)})},removeAdapter(t){var e,r;if(ce.activeChain===t){const n=Array.from(ce.chains.entries()).find(([s])=>s!==t);if(n){const s=(r=(e=n[1])==null?void 0:e.caipNetworks)==null?void 0:r[0];s&&R.setActiveCaipNetwork(s)}}ce.chains.delete(t)},addAdapter(t,{networkControllerClient:e,connectionControllerClient:r},n){ce.chains.set(t.namespace,{namespace:t.namespace,networkState:{...ac,caipNetwork:n[0]},accountState:Jl,caipNetworks:n,connectionControllerClient:r,networkControllerClient:e}),R.setRequestedCaipNetworks((n==null?void 0:n.filter(s=>s.chainNamespace===t.namespace))??[],t.namespace)},addNetwork(t){var r;const e=ce.chains.get(t.chainNamespace);if(e){const n=[...e.caipNetworks||[]];(r=e.caipNetworks)!=null&&r.find(s=>s.id===t.id)||n.push(t),ce.chains.set(t.chainNamespace,{...e,caipNetworks:n}),R.setRequestedCaipNetworks(n,t.chainNamespace),ie.filterByNamespace(t.chainNamespace,!0)}},removeNetwork(t,e){var n,s,i;const r=ce.chains.get(t);if(r){const o=((n=ce.activeCaipNetwork)==null?void 0:n.id)===e,a=[...((s=r.caipNetworks)==null?void 0:s.filter(c=>c.id!==e))||[]];o&&((i=r==null?void 0:r.caipNetworks)!=null&&i[0])&&R.setActiveCaipNetwork(r.caipNetworks[0]),ce.chains.set(t,{...r,caipNetworks:a}),R.setRequestedCaipNetworks(a||[],t),a.length===0&&ie.filterByNamespace(t,!1)}},setAdapterNetworkState(t,e){const r=ce.chains.get(t);r&&(r.networkState={...r.networkState||ac,...e},ce.chains.set(t,r))},setChainAccountData(t,e,r=!0){if(!t)throw new Error("Chain is required to update chain account data");const n=ce.chains.get(t);if(n){const s={...n.accountState||Jl,...e};ce.chains.set(t,{...n,accountState:s}),(ce.chains.size===1||ce.activeChain===t)&&(e.caipAddress&&(ce.activeCaipAddress=e.caipAddress),ee.replaceState(s))}},setChainNetworkData(t,e){if(!t)return;const r=ce.chains.get(t);if(r){const n={...r.networkState||ac,...e};ce.chains.set(t,{...r,networkState:n})}},setAccountProp(t,e,r,n=!0){R.setChainAccountData(r,{[t]:e},n),t==="status"&&e==="disconnected"&&r&&ie.removeConnectorId(r)},setActiveNamespace(t){var n,s;ce.activeChain=t;const e=t?ce.chains.get(t):void 0,r=(n=e==null?void 0:e.networkState)==null?void 0:n.caipNetwork;r!=null&&r.id&&t&&(ce.activeCaipAddress=(s=e==null?void 0:e.accountState)==null?void 0:s.caipAddress,ce.activeCaipNetwork=r,R.setChainNetworkData(t,{caipNetwork:r}),oe.setActiveCaipNetworkId(r==null?void 0:r.caipNetworkId),Sn.set({activeChain:t,selectedNetworkId:r==null?void 0:r.caipNetworkId}))},setActiveCaipNetwork(t){var n,s,i;if(!t)return;ce.activeChain!==t.chainNamespace&&R.setIsSwitchingNamespace(!0);const e=ce.chains.get(t.chainNamespace);ce.activeChain=t.chainNamespace,ce.activeCaipNetwork=t,R.setChainNetworkData(t.chainNamespace,{caipNetwork:t}),(n=e==null?void 0:e.accountState)!=null&&n.address?ce.activeCaipAddress=`${t.chainNamespace}:${t.id}:${(s=e==null?void 0:e.accountState)==null?void 0:s.address}`:ce.activeCaipAddress=void 0,R.setAccountProp("caipAddress",ce.activeCaipAddress,t.chainNamespace),e&&ee.replaceState(e.accountState),Ge.resetSend(),Sn.set({activeChain:ce.activeChain,selectedNetworkId:(i=ce.activeCaipNetwork)==null?void 0:i.caipNetworkId}),oe.setActiveCaipNetworkId(t.caipNetworkId),!R.checkIfSupportedNetwork(t.chainNamespace)&&X.state.enableNetworkSwitch&&!X.state.allowUnsupportedChain&&!ue.state.wcBasic&&R.showUnsupportedChainUI()},addCaipNetwork(t){var r;if(!t)return;const e=ce.chains.get(t.chainNamespace);e&&((r=e==null?void 0:e.caipNetworks)==null||r.push(t))},async switchActiveNamespace(t){var s;if(!t)return;const e=t!==R.state.activeChain,r=(s=R.getNetworkData(t))==null?void 0:s.caipNetwork,n=R.getCaipNetworkByNamespace(t,r==null?void 0:r.id);e&&n&&await R.switchActiveNetwork(n)},async switchActiveNetwork(t){var s;const e=R.state.chains.get(R.state.activeChain),r=!((s=e==null?void 0:e.caipNetworks)!=null&&s.some(i=>{var o;return i.id===((o=ce.activeCaipNetwork)==null?void 0:o.id)})),n=R.getNetworkControllerClient(t.chainNamespace);if(n){try{await n.switchCaipNetwork(t),r&&Fe.close()}catch{me.goBack()}je.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:t.caipNetworkId}})}},getNetworkControllerClient(t){const e=t||ce.activeChain,r=ce.chains.get(e);if(!r)throw new Error("Chain adapter not found");if(!r.networkControllerClient)throw new Error("NetworkController client not set");return r.networkControllerClient},getConnectionControllerClient(t){const e=t||ce.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const r=ce.chains.get(e);if(!(r!=null&&r.connectionControllerClient))throw new Error("ConnectionController client not set");return r.connectionControllerClient},getAccountProp(t,e){var s;let r=ce.activeChain;if(e&&(r=e),!r)return;const n=(s=ce.chains.get(r))==null?void 0:s.accountState;if(n)return n[t]},getNetworkProp(t,e){var n;const r=(n=ce.chains.get(e))==null?void 0:n.networkState;if(r)return r[t]},getRequestedCaipNetworks(t){const e=ce.chains.get(t),{approvedCaipNetworkIds:r=[],requestedCaipNetworks:n=[]}=(e==null?void 0:e.networkState)||{};return le.sortRequestedNetworks(r,n)},getAllRequestedCaipNetworks(){const t=[];return ce.chains.forEach(e=>{const r=R.getRequestedCaipNetworks(e.namespace);t.push(...r)}),t},setRequestedCaipNetworks(t,e){R.setAdapterNetworkState(e,{requestedCaipNetworks:t});const n=R.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(n));ie.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const t=[];return ce.chains.forEach(e=>{const r=R.getApprovedCaipNetworkIds(e.namespace);t.push(...r)}),t},getActiveCaipNetwork(){return ce.activeCaipNetwork},getActiveCaipAddress(){return ce.activeCaipAddress},getApprovedCaipNetworkIds(t){var n;const e=ce.chains.get(t);return((n=e==null?void 0:e.networkState)==null?void 0:n.approvedCaipNetworkIds)||[]},async setApprovedCaipNetworksData(t){const e=R.getNetworkControllerClient(),r=await(e==null?void 0:e.getApprovedCaipNetworksData());R.setAdapterNetworkState(t,{approvedCaipNetworkIds:r==null?void 0:r.approvedCaipNetworkIds,supportsAllNetworks:r==null?void 0:r.supportsAllNetworks})},checkIfSupportedNetwork(t,e){const r=e||ce.activeCaipNetwork,n=R.getRequestedCaipNetworks(t);return n.length?n==null?void 0:n.some(s=>s.id===(r==null?void 0:r.id)):!0},checkIfSupportedChainId(t){if(!ce.activeChain)return!0;const e=R.getRequestedCaipNetworks(ce.activeChain);return e==null?void 0:e.some(r=>r.id===t)},setSmartAccountEnabledNetworks(t,e){R.setAdapterNetworkState(e,{smartAccountEnabledNetworks:t})},checkIfSmartAccountEnabled(){var n;const t=ca.caipNetworkIdToNumber((n=ce.activeCaipNetwork)==null?void 0:n.caipNetworkId),e=ce.activeChain;if(!e||!t)return!1;const r=R.getNetworkProp("smartAccountEnabledNetworks",e);return!!(r!=null&&r.includes(Number(t)))},showUnsupportedChainUI(){Fe.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const t=ce.activeCaipNetwork;return!!(t!=null&&t.chainNamespace&&Ye.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(t.chainNamespace))},resetNetwork(t){R.setAdapterNetworkState(t,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]})},resetAccount(t){const e=t;if(!e)throw new Error("Chain is required to set account prop");ce.activeCaipAddress=void 0,R.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountTypes:void 0,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,allAccounts:[],user:void 0,status:"disconnected"}),ie.removeConnectorId(e)},setIsSwitchingNamespace(t){ce.isSwitchingNamespace=t},getFirstCaipNetworkSupportsAuthConnector(){var r,n;const t=[];let e;if(ce.chains.forEach(s=>{G.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(i=>i===s.namespace)&&s.namespace&&t.push(s.namespace)}),t.length>0){const s=t[0];return e=s?(n=(r=ce.chains.get(s))==null?void 0:r.caipNetworks)==null?void 0:n[0]:void 0,e}},getAccountData(t){var e;return t?(e=R.state.chains.get(t))==null?void 0:e.accountState:ee.state},getNetworkData(t){var r;const e=t||ce.activeChain;if(e)return(r=R.state.chains.get(e))==null?void 0:r.networkState},getCaipNetworkByNamespace(t,e){var s,i,o;if(!t)return;const r=R.state.chains.get(t),n=(s=r==null?void 0:r.caipNetworks)==null?void 0:s.find(a=>a.id===e);return n||((i=r==null?void 0:r.networkState)==null?void 0:i.caipNetwork)||((o=r==null?void 0:r.caipNetworks)==null?void 0:o[0])},getRequestedCaipNetworkIds(){const t=ie.state.filterByNamespace;return(t?[ce.chains.get(t)]:Array.from(ce.chains.values())).flatMap(r=>(r==null?void 0:r.caipNetworks)||[]).map(r=>r.caipNetworkId)},getCaipNetworks(t){return t?R.getRequestedCaipNetworks(t):R.getAllRequestedCaipNetworks()}},R=ar(fv),pv={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},bw=le.getBlockchainApiUrl(),lr=et({clientId:null,api:new Ba({baseUrl:bw,clientId:null}),supportedChains:{http:[],ws:[]}}),ye={state:lr,async get(t){const{st:e,sv:r}=ye.getSdkProperties(),n=X.state.projectId,s={...t.params||{},st:e,sv:r,projectId:n};return lr.api.get({...t,params:s})},getSdkProperties(){const{sdkType:t,sdkVersion:e}=X.state;return{st:t||"unknown",sv:e||"unknown"}},async isNetworkSupported(t){if(!t)return!1;try{lr.supportedChains.http.length||await ye.getSupportedNetworks()}catch{return!1}return lr.supportedChains.http.includes(t)},async getSupportedNetworks(){try{const t=await ye.get({path:"v1/supported-chains"});return lr.supportedChains=t,t}catch{return lr.supportedChains}},async fetchIdentity({address:t,caipNetworkId:e}){if(!await ye.isNetworkSupported(e))return{avatar:"",name:""};const n=oe.getIdentityFromCacheForAddress(t);if(n)return n;const s=await ye.get({path:`/v1/identity/${t}`,params:{sender:R.state.activeCaipAddress?le.getPlainAddress(R.state.activeCaipAddress):void 0}});return oe.updateIdentityCache({address:t,identity:s,timestamp:Date.now()}),s},async fetchTransactions({account:t,cursor:e,onramp:r,signal:n,cache:s,chainId:i}){var a;return await ye.isNetworkSupported((a=R.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)?ye.get({path:`/v1/account/${t}/history`,params:{cursor:e,onramp:r,chainId:i},signal:n,cache:s}):{data:[],next:void 0}},async fetchSwapQuote({amount:t,userAddress:e,from:r,to:n,gasPrice:s}){var o;return await ye.isNetworkSupported((o=R.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)?ye.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:t,userAddress:e,from:r,to:n,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:t}){var r;return await ye.isNetworkSupported((r=R.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?ye.get({path:"/v1/convert/tokens",params:{chainId:t}}):{tokens:[]}},async fetchTokenPrice({addresses:t}){var r;return await ye.isNetworkSupported((r=R.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?lr.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:t,projectId:X.state.projectId},headers:{"Content-Type":"application/json"}}):{fungibles:[]}},async fetchSwapAllowance({tokenAddress:t,userAddress:e}){var n;return await ye.isNetworkSupported((n=R.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?ye.get({path:"/v1/convert/allowance",params:{tokenAddress:t,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:t}){var s;const{st:e,sv:r}=ye.getSdkProperties();if(!await ye.isNetworkSupported((s=R.state.activeCaipNetwork)==null?void 0:s.caipNetworkId))throw new Error("Network not supported for Gas Price");return ye.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:t,st:e,sv:r}})},async generateSwapCalldata({amount:t,from:e,to:r,userAddress:n,disableEstimate:s}){var o;if(!await ye.isNetworkSupported((o=R.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return lr.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:t,eip155:{slippage:Ye.CONVERT_SLIPPAGE_TOLERANCE},projectId:X.state.projectId,from:e,to:r,userAddress:n,disableEstimate:s}})},async generateApproveCalldata({from:t,to:e,userAddress:r}){var o;const{st:n,sv:s}=ye.getSdkProperties();if(!await ye.isNetworkSupported((o=R.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return ye.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:r,from:t,to:e,st:n,sv:s}})},async getBalance(t,e,r){var l;const{st:n,sv:s}=ye.getSdkProperties();if(!await ye.isNetworkSupported((l=R.state.activeCaipNetwork)==null?void 0:l.caipNetworkId))return pt.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${t}`,a=oe.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await ye.get({path:`/v1/account/${t}/balance`,params:{currency:"usd",chainId:e,forceUpdate:r,st:n,sv:s}});return oe.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(t){var r;return await ye.isNetworkSupported((r=R.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?ye.get({path:`/v1/profile/account/${t}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:t}){var r;return await ye.isNetworkSupported((r=R.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?ye.get({path:`/v1/profile/reverse/${t}`,params:{sender:ee.state.address,apiVersion:"2"}}):[]},async getEnsNameSuggestions(t){var r;return await ye.isNetworkSupported((r=R.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?ye.get({path:`/v1/profile/suggestions/${t}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:t,address:e,message:r,signature:n}){var i;return await ye.isNetworkSupported((i=R.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)?lr.api.post({path:"/v1/profile/account",body:{coin_type:t,address:e,message:r,signature:n},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:t,partnerUserId:e,defaultNetwork:r,purchaseAmount:n,paymentAmount:s}){var a;return await ye.isNetworkSupported((a=R.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)?(await lr.api.post({path:"/v1/generators/onrampurl",params:{projectId:X.state.projectId},body:{destinationWallets:t,defaultNetwork:r,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:n,presetFiatAmount:s}})).url:""},async getOnrampOptions(){var e;if(!await ye.isNetworkSupported((e=R.state.activeCaipNetwork)==null?void 0:e.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await ye.get({path:"/v1/onramp/options"})}catch{return pv}},async getOnrampQuote({purchaseCurrency:t,paymentCurrency:e,amount:r,network:n}){var s;try{return await ye.isNetworkSupported((s=R.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?await lr.api.post({path:"/v1/onramp/quote",params:{projectId:X.state.projectId},body:{purchaseCurrency:t,paymentCurrency:e,amount:r,network:n}}):null}catch{return{coinbaseFee:{amount:r,currency:e.id},networkFee:{amount:r,currency:e.id},paymentSubtotal:{amount:r,currency:e.id},paymentTotal:{amount:r,currency:e.id},purchaseAmount:{amount:r,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(t){var r;return await ye.isNetworkSupported((r=R.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?ye.get({path:`/v1/sessions/${t}`}):[]},async revokeSmartSession(t,e,r){var s;return await ye.isNetworkSupported((s=R.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?lr.api.post({path:`/v1/sessions/${t}/revoke`,params:{projectId:X.state.projectId},body:{pci:e,signature:r}}):{success:!1}},setClientId(t){lr.clientId=t,lr.api=new Ba({baseUrl:bw,clientId:t})}},Xl={createBalance(t,e){const r={name:t.metadata.name||"",symbol:t.metadata.symbol||"",decimals:t.metadata.decimals||0,value:t.metadata.value||0,price:t.metadata.price||0,iconUrl:t.metadata.iconUrl||""};return{name:r.name,symbol:r.symbol,chainId:e,address:t.address==="native"?void 0:this.convertAddressToCAIP10Address(t.address,e),value:r.value,price:r.price,quantity:{decimals:r.decimals.toString(),numeric:this.convertHexToBalance({hex:t.balance,decimals:r.decimals})},iconUrl:r.iconUrl}},convertHexToBalance({hex:t,decimals:e}){return uw(BigInt(t),e)},convertAddressToCAIP10Address(t,e){return`${e}:${t}`},createCAIP2ChainId(t,e){return`${e}:${parseInt(t,16)}`},getChainIdHexFromCAIP2ChainId(t){const e=t.split(":");if(e.length<2||!e[1])return"0x0";const r=e[1],n=parseInt(r,10);return isNaN(n)?"0x0":`0x${n.toString(16)}`},isWalletGetAssetsResponse(t){return typeof t!="object"||t===null?!1:Object.values(t).every(e=>Array.isArray(e)&&e.every(r=>this.isValidAsset(r)))},isValidAsset(t){return typeof t=="object"&&t!==null&&typeof t.address=="string"&&typeof t.balance=="string"&&(t.type==="ERC20"||t.type==="NATIVE")&&typeof t.metadata=="object"&&t.metadata!==null&&typeof t.metadata.name=="string"&&typeof t.metadata.symbol=="string"&&typeof t.metadata.decimals=="number"&&typeof t.metadata.price=="number"&&typeof t.metadata.iconUrl=="string"}},_l={async getMyTokensWithBalance(t){const e=ee.state.address,r=R.state.activeCaipNetwork,n=ie.getConnectorId("eip155")===G.CONNECTOR_ID.AUTH;if(!e||!r)return[];const s=`${r.caipNetworkId}:${e}`,i=oe.getBalanceCacheForCaipAddress(s);if(i)return i.balances;if(r.chainNamespace==="eip155"&&n){const a=await this.getEIP155Balances(e,r);if(a)return this.filterLowQualityTokens(a)}const o=await ye.getBalance(e,r.caipNetworkId,t);return this.filterLowQualityTokens(o.balances)},async getEIP155Balances(t,e){var r,n;try{const s=Xl.getChainIdHexFromCAIP2ChainId(e.caipNetworkId),i=await ue.getCapabilities(t);if(!((n=(r=i==null?void 0:i[s])==null?void 0:r.assetDiscovery)!=null&&n.supported))return null;const o=await ue.walletGetAssets({account:t,chainFilter:[s]});if(!Xl.isWalletGetAssetsResponse(o))return null;const c=(o[s]||[]).map(l=>Xl.createBalance(l,e.caipNetworkId));return oe.updateBalanceCache({caipAddress:`${e.caipNetworkId}:${t}`,balance:{balances:c},timestamp:Date.now()}),c}catch{return null}},filterLowQualityTokens(t){return t.filter(e=>e.quantity.decimals!=="0")}},Br=et({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[]}),gv={state:Br,replaceState(t){t&&Object.assign(Br,si(t))},subscribe(t){return R.subscribeChainProp("accountState",e=>{if(e)return t(e)})},subscribeKey(t,e,r){let n;return R.subscribeChainProp("accountState",s=>{if(s){const i=s[t];n!==i&&(n=i,e(i))}},r)},setStatus(t,e){R.setAccountProp("status",t,e)},getCaipAddress(t){return R.getAccountProp("caipAddress",t)},setCaipAddress(t,e){const r=t?le.getPlainAddress(t):void 0;e===R.state.activeChain&&(R.state.activeCaipAddress=t),R.setAccountProp("caipAddress",t,e),R.setAccountProp("address",r,e)},setBalance(t,e,r){R.setAccountProp("balance",t,r),R.setAccountProp("balanceSymbol",e,r)},setProfileName(t,e){R.setAccountProp("profileName",t,e)},setProfileImage(t,e){R.setAccountProp("profileImage",t,e)},setUser(t,e){R.setAccountProp("user",t,e)},setAddressExplorerUrl(t,e){R.setAccountProp("addressExplorerUrl",t,e)},setSmartAccountDeployed(t,e){R.setAccountProp("smartAccountDeployed",t,e)},setCurrentTab(t){R.setAccountProp("currentTab",t,R.state.activeChain)},setTokenBalance(t,e){t&&R.setAccountProp("tokenBalance",t,e)},setShouldUpdateToAddress(t,e){R.setAccountProp("shouldUpdateToAddress",t,e)},setAllAccounts(t,e){R.setAccountProp("allAccounts",t,e)},addAddressLabel(t,e,r){const n=R.getAccountProp("addressLabels",r)||new Map;n.set(t,e),R.setAccountProp("addressLabels",n,r)},removeAddressLabel(t,e){const r=R.getAccountProp("addressLabels",e)||new Map;r.delete(t),R.setAccountProp("addressLabels",r,e)},setConnectedWalletInfo(t,e){R.setAccountProp("connectedWalletInfo",t,e,!1)},setPreferredAccountType(t,e){R.setAccountProp("preferredAccountTypes",{...Br.preferredAccountTypes,[e]:t},e)},setPreferredAccountTypes(t){Br.preferredAccountTypes=t},setSocialProvider(t,e){t&&R.setAccountProp("socialProvider",t,e)},setSocialWindow(t,e){R.setAccountProp("socialWindow",t?si(t):void 0,e)},setFarcasterUrl(t,e){R.setAccountProp("farcasterUrl",t,e)},async fetchTokenBalance(t){var i,o;Br.balanceLoading=!0;const e=(i=R.state.activeCaipNetwork)==null?void 0:i.caipNetworkId,r=(o=R.state.activeCaipNetwork)==null?void 0:o.chainNamespace,n=R.state.activeCaipAddress,s=n?le.getPlainAddress(n):void 0;if(Br.lastRetry&&!le.isAllowedRetry(Br.lastRetry,30*Ye.ONE_SEC_MS))return Br.balanceLoading=!1,[];try{if(s&&e&&r){const a=await _l.getMyTokensWithBalance();return ee.setTokenBalance(a,r),Br.lastRetry=void 0,Br.balanceLoading=!1,a}}catch(a){Br.lastRetry=Date.now(),t==null||t(a),pt.showError("Token Balance Unavailable")}finally{Br.balanceLoading=!1}return[]},resetAccount(t){R.resetAccount(t)}},ee=ar(gv),mv={onSwitchNetwork({network:t,ignoreSwitchConfirmation:e=!1}){const r=R.state.activeCaipNetwork,n=me.state.data;if(t.id===(r==null?void 0:r.id))return;const i=ee.getCaipAddress(R.state.activeChain),o=t.chainNamespace!==R.state.activeChain,a=ee.getCaipAddress(t.chainNamespace),l=ie.getConnectorId(R.state.activeChain)===G.CONNECTOR_ID.AUTH,u=G.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(d=>d===t.chainNamespace);e||l&&u?me.push("SwitchNetwork",{...n,network:t}):i&&o&&!a?me.push("SwitchActiveChain",{switchToChain:t.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:t}):me.push("SwitchNetwork",{...n,network:t})}},ur=et({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),wv={state:ur,subscribe(t){return Tt(ur,()=>t(ur))},subscribeKey(t,e){return Nt(ur,t,e)},async open(t){var o,a;const e=ee.state.status==="connected",r=t==null?void 0:t.namespace,n=R.state.activeChain,s=r&&r!==n,i=(o=R.getAccountData(t==null?void 0:t.namespace))==null?void 0:o.caipAddress;if(ue.state.wcBasic?ve.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await ve.prefetch({fetchConnectorImages:!e,fetchFeaturedWallets:!e,fetchRecommendedWallets:!e}),ie.setFilterByNamespace(t==null?void 0:t.namespace),Fe.setLoading(!0,r),r&&s){const c=((a=R.getNetworkData(r))==null?void 0:a.caipNetwork)||R.getRequestedCaipNetworks(r)[0];c&&mv.onSwitchNetwork({network:c,ignoreSwitchConfirmation:!0})}else{const c=R.state.noAdapters;X.state.manualWCControl||c&&!i?le.isMobile()?me.reset("AllWallets"):me.reset("ConnectingWalletConnectBasic"):t!=null&&t.view?me.reset(t.view,t.data):i?me.reset("Account"):me.reset("Connect")}ur.open=!0,Sn.set({open:!0}),je.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!i}})},close(){const t=X.state.enableEmbedded,e=!!R.state.activeCaipAddress;ur.open&&je.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:e}}),ur.open=!1,me.reset("Connect"),Fe.clearLoading(),t?e?me.replace("Account"):me.push("Connect"):Sn.set({open:!1}),ue.resetUri()},setLoading(t,e){e&&ur.loadingNamespaceMap.set(e,t),ur.loading=t,Sn.set({loading:t})},clearLoading(){ur.loadingNamespaceMap.clear(),ur.loading=!1},shake(){ur.shake||(ur.shake=!0,setTimeout(()=>{ur.shake=!1},500))}},Fe=ar(wv),Yo={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},pd={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},yv={providers:mw,selectedProvider:null,error:null,purchaseCurrency:Yo,paymentCurrency:pd,purchaseCurrencies:[Yo],paymentCurrencies:[],quotesLoading:!1},Me=et(yv),bv={state:Me,subscribe(t){return Tt(Me,()=>t(Me))},subscribeKey(t,e){return Nt(Me,t,e)},setSelectedProvider(t){if(t&&t.name==="meld"){const e=R.state.activeChain===G.CHAIN.SOLANA?"SOL":"USDC",r=ee.state.address??"",n=new URL(t.url);n.searchParams.append("publicKey",LE),n.searchParams.append("destinationCurrencyCode",e),n.searchParams.append("walletAddress",r),n.searchParams.append("externalCustomerId",X.state.projectId),Me.selectedProvider={...t,url:n.toString()}}else Me.selectedProvider=t},setOnrampProviders(t){if(Array.isArray(t)&&t.every(e=>typeof e=="string")){const e=t,r=mw.filter(n=>e.includes(n.name));Me.providers=r}else Me.providers=[]},setPurchaseCurrency(t){Me.purchaseCurrency=t},setPaymentCurrency(t){Me.paymentCurrency=t},setPurchaseAmount(t){gd.state.purchaseAmount=t},setPaymentAmount(t){gd.state.paymentAmount=t},async getAvailableCurrencies(){const t=await ye.getOnrampOptions();Me.purchaseCurrencies=t.purchaseCurrencies,Me.paymentCurrencies=t.paymentCurrencies,Me.paymentCurrency=t.paymentCurrencies[0]||pd,Me.purchaseCurrency=t.purchaseCurrencies[0]||Yo,await ve.fetchCurrencyImages(t.paymentCurrencies.map(e=>e.id)),await ve.fetchTokenImages(t.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){var t,e;Me.quotesLoading=!0;try{const r=await ye.getOnrampQuote({purchaseCurrency:Me.purchaseCurrency,paymentCurrency:Me.paymentCurrency,amount:((t=Me.paymentAmount)==null?void 0:t.toString())||"0",network:(e=Me.purchaseCurrency)==null?void 0:e.symbol});return Me.quotesLoading=!1,Me.purchaseAmount=Number(r==null?void 0:r.purchaseAmount.amount),r}catch(r){return Me.error=r.message,Me.quotesLoading=!1,null}finally{Me.quotesLoading=!1}},resetState(){Me.selectedProvider=null,Me.error=null,Me.purchaseCurrency=Yo,Me.paymentCurrency=pd,Me.purchaseCurrencies=[Yo],Me.paymentCurrencies=[],Me.paymentAmount=void 0,Me.purchaseAmount=void 0,Me.quotesLoading=!1}},gd=ar(bv),hs={getGasPriceInEther(t,e){const r=e*t;return Number(r)/1e18},getGasPriceInUSD(t,e,r){const n=hs.getGasPriceInEther(e,r);return dt.bigNumber(t).times(n).toNumber()},getPriceImpact({sourceTokenAmount:t,sourceTokenPriceInUSD:e,toTokenPriceInUSD:r,toTokenAmount:n}){const s=dt.bigNumber(t).times(e),i=dt.bigNumber(n).times(r);return s.minus(i).div(s).times(100).toNumber()},getMaxSlippage(t,e){const r=dt.bigNumber(t).div(100);return dt.multiply(e,r).toNumber()},getProviderFee(t,e=.0085){return dt.bigNumber(t).times(e).toString()},isInsufficientNetworkTokenForGas(t,e){const r=e||"0";return dt.bigNumber(t).eq(0)?!0:dt.bigNumber(dt.bigNumber(r)).gt(t)},isInsufficientSourceTokenForSwap(t,e,r){var i,o;const n=(o=(i=r==null?void 0:r.find(a=>a.address===e))==null?void 0:i.quantity)==null?void 0:o.numeric;return dt.bigNumber(n||"0").lt(t)},getToTokenAmount({sourceToken:t,toToken:e,sourceTokenPrice:r,toTokenPrice:n,sourceTokenAmount:s}){if(s==="0"||!t||!e)return"0";const i=t.decimals,o=r,a=e.decimals,c=n;if(c<=0)return"0";const l=dt.bigNumber(s).times(.0085),d=dt.bigNumber(s).minus(l).times(dt.bigNumber(10).pow(i)),h=dt.bigNumber(o).div(c),m=i-a;return d.times(h).div(dt.bigNumber(10).pow(m)).div(dt.bigNumber(10).pow(a)).toFixed(a).toString()}},Nf=15e4,Ev=6,rr={initializing:!1,initialized:!1,loadingPrices:!1,loadingQuote:!1,loadingApprovalTransaction:!1,loadingBuildTransaction:!1,loadingTransaction:!1,fetchError:!1,approvalTransaction:void 0,swapTransaction:void 0,transactionError:void 0,sourceToken:void 0,sourceTokenAmount:"",sourceTokenPriceInUSD:0,toToken:void 0,toTokenAmount:"",toTokenPriceInUSD:0,networkPrice:"0",networkBalanceInUSD:"0",networkTokenSymbol:"",inputError:void 0,slippage:Ye.CONVERT_SLIPPAGE_TOLERANCE,tokens:void 0,popularTokens:void 0,suggestedTokens:void 0,foundTokens:void 0,myTokensWithBalance:void 0,tokensPriceMap:{},gasFee:"0",gasPriceInUSD:0,priceImpact:void 0,maxSlippage:void 0,providerFee:void 0},z=et(rr),kc={state:z,subscribe(t){return Tt(z,()=>t(z))},subscribeKey(t,e){return Nt(z,t,e)},getParams(){var c,l,u,d,h,m,f,g;const t=R.state.activeCaipAddress,e=R.state.activeChain,r=le.getPlainAddress(t),n=vh(),s=ie.getConnectorId(e);if(!r)throw new Error("No address found to swap the tokens from.");const i=!((c=z.toToken)!=null&&c.address)||!((l=z.toToken)!=null&&l.decimals),o=!((u=z.sourceToken)!=null&&u.address)||!((d=z.sourceToken)!=null&&d.decimals)||!dt.bigNumber(z.sourceTokenAmount).gt(0),a=!z.sourceTokenAmount;return{networkAddress:n,fromAddress:r,fromCaipAddress:t,sourceTokenAddress:(h=z.sourceToken)==null?void 0:h.address,toTokenAddress:(m=z.toToken)==null?void 0:m.address,toTokenAmount:z.toTokenAmount,toTokenDecimals:(f=z.toToken)==null?void 0:f.decimals,sourceTokenAmount:z.sourceTokenAmount,sourceTokenDecimals:(g=z.sourceToken)==null?void 0:g.decimals,invalidToToken:i,invalidSourceToken:o,invalidSourceTokenAmount:a,availableToSwap:t&&!i&&!o&&!a,isAuthConnector:s===G.CONNECTOR_ID.AUTH}},setSourceToken(t){if(!t){z.sourceToken=t,z.sourceTokenAmount="",z.sourceTokenPriceInUSD=0;return}z.sourceToken=t,Ae.setTokenPrice(t.address,"sourceToken")},setSourceTokenAmount(t){z.sourceTokenAmount=t},setToToken(t){if(!t){z.toToken=t,z.toTokenAmount="",z.toTokenPriceInUSD=0;return}z.toToken=t,Ae.setTokenPrice(t.address,"toToken")},setToTokenAmount(t){z.toTokenAmount=t?dt.formatNumberToLocalString(t,Ev):""},async setTokenPrice(t,e){let r=z.tokensPriceMap[t]||0;r||(z.loadingPrices=!0,r=await Ae.getAddressPrice(t)),e==="sourceToken"?z.sourceTokenPriceInUSD=r:e==="toToken"&&(z.toTokenPriceInUSD=r),z.loadingPrices&&(z.loadingPrices=!1),Ae.getParams().availableToSwap&&Ae.swapTokens()},switchTokens(){if(z.initializing||!z.initialized)return;const t=z.toToken?{...z.toToken}:void 0,e=z.sourceToken?{...z.sourceToken}:void 0,r=t&&z.toTokenAmount===""?"1":z.toTokenAmount;Ae.setSourceToken(t),Ae.setToToken(e),Ae.setSourceTokenAmount(r),Ae.setToTokenAmount(""),Ae.swapTokens()},resetState(){z.myTokensWithBalance=rr.myTokensWithBalance,z.tokensPriceMap=rr.tokensPriceMap,z.initialized=rr.initialized,z.sourceToken=rr.sourceToken,z.sourceTokenAmount=rr.sourceTokenAmount,z.sourceTokenPriceInUSD=rr.sourceTokenPriceInUSD,z.toToken=rr.toToken,z.toTokenAmount=rr.toTokenAmount,z.toTokenPriceInUSD=rr.toTokenPriceInUSD,z.networkPrice=rr.networkPrice,z.networkTokenSymbol=rr.networkTokenSymbol,z.networkBalanceInUSD=rr.networkBalanceInUSD,z.inputError=rr.inputError,z.myTokensWithBalance=rr.myTokensWithBalance},resetValues(){var r;const{networkAddress:t}=Ae.getParams(),e=(r=z.tokens)==null?void 0:r.find(n=>n.address===t);Ae.setSourceToken(e),Ae.setToToken(void 0)},getApprovalLoadingState(){return z.loadingApprovalTransaction},clearError(){z.transactionError=void 0},async initializeState(){if(!z.initializing){if(z.initializing=!0,!z.initialized)try{await Ae.fetchTokens(),z.initialized=!0}catch{z.initialized=!1,pt.showError("Failed to initialize swap"),me.goBack()}z.initializing=!1}},async fetchTokens(){var r;const{networkAddress:t}=Ae.getParams();await Ae.getTokenList(),await Ae.getNetworkTokenPrice(),await Ae.getMyTokensWithBalance();const e=(r=z.tokens)==null?void 0:r.find(n=>n.address===t);e&&(z.networkTokenSymbol=e.symbol,Ae.setSourceToken(e),Ae.setSourceTokenAmount("1"))},async getTokenList(){const t=await Ho.getTokenList();z.tokens=t,z.popularTokens=t.sort((e,r)=>e.symbol<r.symbol?-1:e.symbol>r.symbol?1:0),z.suggestedTokens=t.filter(e=>!!Ye.SWAP_SUGGESTED_TOKENS.includes(e.symbol),{})},async getAddressPrice(t){var c,l;const e=z.tokensPriceMap[t];if(e)return e;const r=await ye.fetchTokenPrice({addresses:[t]}),n=(r==null?void 0:r.fungibles)||[],s=[...z.tokens||[],...z.myTokensWithBalance||[]],i=(c=s==null?void 0:s.find(u=>u.address===t))==null?void 0:c.symbol,o=((l=n.find(u=>u.symbol.toLowerCase()===(i==null?void 0:i.toLowerCase())))==null?void 0:l.price)||0,a=parseFloat(o.toString());return z.tokensPriceMap[t]=a,a},async getNetworkTokenPrice(){var s;const{networkAddress:t}=Ae.getParams(),r=(s=(await ye.fetchTokenPrice({addresses:[t]}).catch(()=>(pt.showError("Failed to fetch network token price"),{fungibles:[]}))).fungibles)==null?void 0:s[0],n=(r==null?void 0:r.price.toString())||"0";z.tokensPriceMap[t]=parseFloat(n),z.networkTokenSymbol=(r==null?void 0:r.symbol)||"",z.networkPrice=n},async getMyTokensWithBalance(t){const e=await _l.getMyTokensWithBalance(t),r=Ho.mapBalancesToSwapTokens(e);r&&(await Ae.getInitialGasPrice(),Ae.setBalances(r))},setBalances(t){const{networkAddress:e}=Ae.getParams(),r=R.state.activeCaipNetwork;if(!r)return;const n=t.find(s=>s.address===e);t.forEach(s=>{z.tokensPriceMap[s.address]=s.price||0}),z.myTokensWithBalance=t.filter(s=>s.address.startsWith(r.caipNetworkId)),z.networkBalanceInUSD=n?dt.multiply(n.quantity.numeric,n.price).toString():"0"},async getInitialGasPrice(){var e,r;const t=await Ho.fetchGasPrice();if(!t)return{gasPrice:null,gasPriceInUSD:null};switch((r=(e=R.state)==null?void 0:e.activeCaipNetwork)==null?void 0:r.chainNamespace){case"solana":return z.gasFee=t.standard??"0",z.gasPriceInUSD=dt.multiply(t.standard,z.networkPrice).div(1e9).toNumber(),{gasPrice:BigInt(z.gasFee),gasPriceInUSD:Number(z.gasPriceInUSD)};case"eip155":default:const n=t.standard??"0",s=BigInt(n),i=BigInt(Nf),o=hs.getGasPriceInUSD(z.networkPrice,i,s);return z.gasFee=n,z.gasPriceInUSD=o,{gasPrice:s,gasPriceInUSD:o}}},async swapTokens(){var i,o;const t=ee.state.address,e=z.sourceToken,r=z.toToken,n=dt.bigNumber(z.sourceTokenAmount).gt(0);if(n||Ae.setToTokenAmount(""),!r||!e||z.loadingPrices||!n)return;z.loadingQuote=!0;const s=dt.bigNumber(z.sourceTokenAmount).times(10**e.decimals).round(0);try{const a=await ye.fetchSwapQuote({userAddress:t,from:e.address,to:r.address,gasPrice:z.gasFee,amount:s.toString()});z.loadingQuote=!1;const c=(o=(i=a==null?void 0:a.quotes)==null?void 0:i[0])==null?void 0:o.toAmount;if(!c){_t.open({shortMessage:"Incorrect amount",longMessage:"Please enter a valid amount"},"error");return}const l=dt.bigNumber(c).div(10**r.decimals).toString();Ae.setToTokenAmount(l),Ae.hasInsufficientToken(z.sourceTokenAmount,e.address)?z.inputError="Insufficient balance":(z.inputError=void 0,Ae.setTransactionDetails())}catch{z.loadingQuote=!1,z.inputError="Insufficient balance"}},async getTransaction(){const{fromCaipAddress:t,availableToSwap:e}=Ae.getParams(),r=z.sourceToken,n=z.toToken;if(!(!t||!e||!r||!n||z.loadingQuote))try{z.loadingBuildTransaction=!0;const s=await Ho.fetchSwapAllowance({userAddress:t,tokenAddress:r.address,sourceTokenAmount:z.sourceTokenAmount,sourceTokenDecimals:r.decimals});let i;return s?i=await Ae.createSwapTransaction():i=await Ae.createAllowanceTransaction(),z.loadingBuildTransaction=!1,z.fetchError=!1,i}catch{me.goBack(),pt.showError("Failed to check allowance"),z.loadingBuildTransaction=!1,z.approvalTransaction=void 0,z.swapTransaction=void 0,z.fetchError=!0;return}},async createAllowanceTransaction(){const{fromCaipAddress:t,sourceTokenAddress:e,toTokenAddress:r}=Ae.getParams();if(!(!t||!r)){if(!e)throw new Error("createAllowanceTransaction - No source token address found.");try{const n=await ye.generateApproveCalldata({from:e,to:r,userAddress:t}),s={data:n.tx.data,to:le.getPlainAddress(n.tx.from),gasPrice:BigInt(n.tx.eip155.gasPrice),value:BigInt(n.tx.value),toAmount:z.toTokenAmount};return z.swapTransaction=void 0,z.approvalTransaction={data:s.data,to:s.to,gasPrice:s.gasPrice,value:s.value,toAmount:s.toAmount},{data:s.data,to:s.to,gasPrice:s.gasPrice,value:s.value,toAmount:s.toAmount}}catch{me.goBack(),pt.showError("Failed to create approval transaction"),z.approvalTransaction=void 0,z.swapTransaction=void 0,z.fetchError=!0;return}}},async createSwapTransaction(){var o;const{networkAddress:t,fromCaipAddress:e,sourceTokenAmount:r}=Ae.getParams(),n=z.sourceToken,s=z.toToken;if(!e||!r||!n||!s)return;const i=(o=ue.parseUnits(r,n.decimals))==null?void 0:o.toString();try{const a=await ye.generateSwapCalldata({userAddress:e,from:n.address,to:s.address,amount:i,disableEstimate:!0}),c=n.address===t,l=BigInt(a.tx.eip155.gas),u=BigInt(a.tx.eip155.gasPrice),d={data:a.tx.data,to:le.getPlainAddress(a.tx.to),gas:l,gasPrice:u,value:BigInt(c?i??"0":"0"),toAmount:z.toTokenAmount};return z.gasPriceInUSD=hs.getGasPriceInUSD(z.networkPrice,l,u),z.approvalTransaction=void 0,z.swapTransaction=d,d}catch{me.goBack(),pt.showError("Failed to create transaction"),z.approvalTransaction=void 0,z.swapTransaction=void 0,z.fetchError=!0;return}},async sendTransactionForApproval(t){var s,i,o,a;const{fromAddress:e,isAuthConnector:r}=Ae.getParams();z.loadingApprovalTransaction=!0;const n="Approve limit increase in your wallet";r?me.pushTransactionStack({onSuccess(){pt.showLoading(n)}}):pt.showLoading(n);try{await ue.sendTransaction({address:e,to:t.to,data:t.data,value:t.value,chainNamespace:"eip155"}),await Ae.swapTokens(),await Ae.getTransaction(),z.approvalTransaction=void 0,z.loadingApprovalTransaction=!1}catch(c){const l=c;z.transactionError=l==null?void 0:l.shortMessage,z.loadingApprovalTransaction=!1,pt.showError((l==null?void 0:l.shortMessage)||"Transaction error"),je.sendEvent({type:"track",event:"SWAP_APPROVAL_ERROR",properties:{message:(l==null?void 0:l.shortMessage)||(l==null?void 0:l.message)||"Unknown",network:((s=R.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)||"",swapFromToken:((i=Ae.state.sourceToken)==null?void 0:i.symbol)||"",swapToToken:((o=Ae.state.toToken)==null?void 0:o.symbol)||"",swapFromAmount:Ae.state.sourceTokenAmount||"",swapToAmount:Ae.state.toTokenAmount||"",isSmartAccount:((a=ee.state.preferredAccountTypes)==null?void 0:a.eip155)===At.ACCOUNT_TYPES.SMART_ACCOUNT}})}},async sendTransactionForSwap(t){var o,a,c,l,u,d,h,m,f,g,_,I,N,C;if(!t)return;const{fromAddress:e,toTokenAmount:r,isAuthConnector:n}=Ae.getParams();z.loadingTransaction=!0;const s=`Swapping ${(o=z.sourceToken)==null?void 0:o.symbol} to ${dt.formatNumberToLocalString(r,3)} ${(a=z.toToken)==null?void 0:a.symbol}`,i=`Swapped ${(c=z.sourceToken)==null?void 0:c.symbol} to ${dt.formatNumberToLocalString(r,3)} ${(l=z.toToken)==null?void 0:l.symbol}`;n?me.pushTransactionStack({onSuccess(){me.replace("Account"),pt.showLoading(s),kc.resetState()}}):pt.showLoading("Confirm transaction in your wallet");try{const E=[(u=z.sourceToken)==null?void 0:u.address,(d=z.toToken)==null?void 0:d.address].join(","),v=await ue.sendTransaction({address:e,to:t.to,data:t.data,value:t.value,chainNamespace:"eip155"});return z.loadingTransaction=!1,pt.showSuccess(i),je.sendEvent({type:"track",event:"SWAP_SUCCESS",properties:{network:((h=R.state.activeCaipNetwork)==null?void 0:h.caipNetworkId)||"",swapFromToken:((m=Ae.state.sourceToken)==null?void 0:m.symbol)||"",swapToToken:((f=Ae.state.toToken)==null?void 0:f.symbol)||"",swapFromAmount:Ae.state.sourceTokenAmount||"",swapToAmount:Ae.state.toTokenAmount||"",isSmartAccount:((g=ee.state.preferredAccountTypes)==null?void 0:g.eip155)===At.ACCOUNT_TYPES.SMART_ACCOUNT}}),kc.resetState(),n||me.replace("Account"),kc.getMyTokensWithBalance(E),v}catch(E){const v=E;z.transactionError=v==null?void 0:v.shortMessage,z.loadingTransaction=!1,pt.showError((v==null?void 0:v.shortMessage)||"Transaction error"),je.sendEvent({type:"track",event:"SWAP_ERROR",properties:{message:(v==null?void 0:v.shortMessage)||(v==null?void 0:v.message)||"Unknown",network:((_=R.state.activeCaipNetwork)==null?void 0:_.caipNetworkId)||"",swapFromToken:((I=Ae.state.sourceToken)==null?void 0:I.symbol)||"",swapToToken:((N=Ae.state.toToken)==null?void 0:N.symbol)||"",swapFromAmount:Ae.state.sourceTokenAmount||"",swapToAmount:Ae.state.toTokenAmount||"",isSmartAccount:((C=ee.state.preferredAccountTypes)==null?void 0:C.eip155)===At.ACCOUNT_TYPES.SMART_ACCOUNT}});return}},hasInsufficientToken(t,e){return hs.isInsufficientSourceTokenForSwap(t,e,z.myTokensWithBalance)},setTransactionDetails(){const{toTokenAddress:t,toTokenDecimals:e}=Ae.getParams();!t||!e||(z.gasPriceInUSD=hs.getGasPriceInUSD(z.networkPrice,BigInt(z.gasFee),BigInt(Nf)),z.priceImpact=hs.getPriceImpact({sourceTokenAmount:z.sourceTokenAmount,sourceTokenPriceInUSD:z.sourceTokenPriceInUSD,toTokenPriceInUSD:z.toTokenPriceInUSD,toTokenAmount:z.toTokenAmount}),z.maxSlippage=hs.getMaxSlippage(z.slippage,z.toTokenAmount),z.providerFee=hs.getProviderFee(z.sourceTokenAmount))}},Ae=ar(kc),Xr=et({message:"",open:!1,triggerRect:{width:0,height:0,top:0,left:0},variant:"shade"}),vv={state:Xr,subscribe(t){return Tt(Xr,()=>t(Xr))},subscribeKey(t,e){return Nt(Xr,t,e)},showTooltip({message:t,triggerRect:e,variant:r}){Xr.open=!0,Xr.message=t,Xr.triggerRect=e,Xr.variant=r},hide(){Xr.open=!1,Xr.message="",Xr.triggerRect={width:0,height:0,top:0,left:0}}},_B=ar(vv),xf=2147483648,_v={convertEVMChainIdToCoinType(t){if(t>=xf)throw new Error("Invalid chainId");return(xf|t)>>>0}},Lr=et({suggestions:[],loading:!1}),Cv={state:Lr,subscribe(t){return Tt(Lr,()=>t(Lr))},subscribeKey(t,e){return Nt(Lr,t,e)},async resolveName(t){var e,r;try{return await ye.lookupEnsName(t)}catch(n){const s=n;throw new Error(((r=(e=s==null?void 0:s.reasons)==null?void 0:e[0])==null?void 0:r.description)||"Error resolving name")}},async isNameRegistered(t){try{return await ye.lookupEnsName(t),!0}catch{return!1}},async getSuggestions(t){try{Lr.loading=!0,Lr.suggestions=[];const e=await ye.getEnsNameSuggestions(t);return Lr.suggestions=e.suggestions.map(r=>({...r,name:r.name}))||[],Lr.suggestions}catch(e){const r=Zo.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(r)}finally{Lr.loading=!1}},async getNamesForAddress(t){try{if(!R.state.activeCaipNetwork)return[];const r=oe.getEnsFromCacheForAddress(t);if(r)return r;const n=await ye.reverseLookupEnsName({address:t});return oe.updateEnsCache({address:t,ens:n,timestamp:Date.now()}),n}catch(e){const r=Zo.parseEnsApiError(e,"Error fetching names for address");throw new Error(r)}},async registerName(t){const e=R.state.activeCaipNetwork;if(!e)throw new Error("Network not found");const r=ee.state.address,n=ie.getAuthConnector();if(!r||!n)throw new Error("Address or auth connector not found");Lr.loading=!0;try{const s=JSON.stringify({name:t,attributes:{},timestamp:Math.floor(Date.now()/1e3)});me.pushTransactionStack({onCancel(){me.replace("RegisterAccountName")}});const i=await ue.signMessage(s);Lr.loading=!1;const o=e.id;if(!o)throw new Error("Network not found");const a=_v.convertEVMChainIdToCoinType(Number(o));await ye.registerEnsName({coinType:a,address:r,signature:i,message:s}),ee.setProfileName(t,e.chainNamespace),me.replace("RegisterAccountNameSuccess")}catch(s){const i=Zo.parseEnsApiError(s,`Error registering name ${t}`);throw me.replace("RegisterAccountName"),new Error(i)}finally{Lr.loading=!1}},validateName(t){return/^[a-zA-Z0-9-]{4,}$/u.test(t)},parseEnsApiError(t,e){var n,s;const r=t;return((s=(n=r==null?void 0:r.reasons)==null?void 0:n[0])==null?void 0:s.description)||e}},Zo=ar(Cv),vo=et({isLegalCheckboxChecked:!1}),CB={state:vo,subscribe(t){return Tt(vo,()=>t(vo))},subscribeKey(t,e){return Nt(vo,t,e)},setIsLegalCheckboxChecked(t){vo.isLegalCheckboxChecked=t}};var cc={exports:{}},Of;function Av(){if(Of)return cc.exports;Of=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(v,A,x){return Function.prototype.apply.call(v,A,x)},r;t&&typeof t.ownKeys=="function"?r=t.ownKeys:Object.getOwnPropertySymbols?r=function(v){return Object.getOwnPropertyNames(v).concat(Object.getOwnPropertySymbols(v))}:r=function(v){return Object.getOwnPropertyNames(v)};function n(E){console&&console.warn&&console.warn(E)}var s=Number.isNaN||function(v){return v!==v};function i(){i.init.call(this)}cc.exports=i,cc.exports.once=I,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(E){if(typeof E!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(E){if(typeof E!="number"||E<0||s(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");o=E}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(v){if(typeof v!="number"||v<0||s(v))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+v+".");return this._maxListeners=v,this};function c(E){return E._maxListeners===void 0?i.defaultMaxListeners:E._maxListeners}i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(v){for(var A=[],x=1;x<arguments.length;x++)A.push(arguments[x]);var D=v==="error",U=this._events;if(U!==void 0)D=D&&U.error===void 0;else if(!D)return!1;if(D){var M;if(A.length>0&&(M=A[0]),M instanceof Error)throw M;var $=new Error("Unhandled error."+(M?" ("+M.message+")":""));throw $.context=M,$}var F=U[v];if(F===void 0)return!1;if(typeof F=="function")e(F,this,A);else for(var W=F.length,q=f(F,W),x=0;x<W;++x)e(q[x],this,A);return!0};function l(E,v,A,x){var D,U,M;if(a(A),U=E._events,U===void 0?(U=E._events=Object.create(null),E._eventsCount=0):(U.newListener!==void 0&&(E.emit("newListener",v,A.listener?A.listener:A),U=E._events),M=U[v]),M===void 0)M=U[v]=A,++E._eventsCount;else if(typeof M=="function"?M=U[v]=x?[A,M]:[M,A]:x?M.unshift(A):M.push(A),D=c(E),D>0&&M.length>D&&!M.warned){M.warned=!0;var $=new Error("Possible EventEmitter memory leak detected. "+M.length+" "+String(v)+" listeners added. Use emitter.setMaxListeners() to increase limit");$.name="MaxListenersExceededWarning",$.emitter=E,$.type=v,$.count=M.length,n($)}return E}i.prototype.addListener=function(v,A){return l(this,v,A,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(v,A){return l(this,v,A,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(E,v,A){var x={fired:!1,wrapFn:void 0,target:E,type:v,listener:A},D=u.bind(x);return D.listener=A,x.wrapFn=D,D}i.prototype.once=function(v,A){return a(A),this.on(v,d(this,v,A)),this},i.prototype.prependOnceListener=function(v,A){return a(A),this.prependListener(v,d(this,v,A)),this},i.prototype.removeListener=function(v,A){var x,D,U,M,$;if(a(A),D=this._events,D===void 0)return this;if(x=D[v],x===void 0)return this;if(x===A||x.listener===A)--this._eventsCount===0?this._events=Object.create(null):(delete D[v],D.removeListener&&this.emit("removeListener",v,x.listener||A));else if(typeof x!="function"){for(U=-1,M=x.length-1;M>=0;M--)if(x[M]===A||x[M].listener===A){$=x[M].listener,U=M;break}if(U<0)return this;U===0?x.shift():g(x,U),x.length===1&&(D[v]=x[0]),D.removeListener!==void 0&&this.emit("removeListener",v,$||A)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(v){var A,x,D;if(x=this._events,x===void 0)return this;if(x.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):x[v]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete x[v]),this;if(arguments.length===0){var U=Object.keys(x),M;for(D=0;D<U.length;++D)M=U[D],M!=="removeListener"&&this.removeAllListeners(M);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(A=x[v],typeof A=="function")this.removeListener(v,A);else if(A!==void 0)for(D=A.length-1;D>=0;D--)this.removeListener(v,A[D]);return this};function h(E,v,A){var x=E._events;if(x===void 0)return[];var D=x[v];return D===void 0?[]:typeof D=="function"?A?[D.listener||D]:[D]:A?_(D):f(D,D.length)}i.prototype.listeners=function(v){return h(this,v,!0)},i.prototype.rawListeners=function(v){return h(this,v,!1)},i.listenerCount=function(E,v){return typeof E.listenerCount=="function"?E.listenerCount(v):m.call(E,v)},i.prototype.listenerCount=m;function m(E){var v=this._events;if(v!==void 0){var A=v[E];if(typeof A=="function")return 1;if(A!==void 0)return A.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function f(E,v){for(var A=new Array(v),x=0;x<v;++x)A[x]=E[x];return A}function g(E,v){for(;v+1<E.length;v++)E[v]=E[v+1];E.pop()}function _(E){for(var v=new Array(E.length),A=0;A<v.length;++A)v[A]=E[A].listener||E[A];return v}function I(E,v){return new Promise(function(A,x){function D(M){E.removeListener(v,U),x(M)}function U(){typeof E.removeListener=="function"&&E.removeListener("error",D),A([].slice.call(arguments))}C(E,v,U,{once:!0}),v!=="error"&&N(E,D,{once:!0})})}function N(E,v,A){typeof E.on=="function"&&C(E,"error",v,A)}function C(E,v,A,x){if(typeof E.on=="function")x.once?E.once(v,A):E.on(v,A);else if(typeof E.addEventListener=="function")E.addEventListener(v,function D(U){x.once&&E.removeEventListener(v,D),A(U)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E)}return cc.exports}var Gr=Av();const _h=pi(Gr);var Ql={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var md=function(t,e){return md=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])},md(t,e)};function Iv(t,e){md(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var wd=function(){return wd=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},wd.apply(this,arguments)};function Sv(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function Tv(t,e,r,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,r,i):o(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i}function Nv(t,e){return function(r,n){e(r,n,t)}}function xv(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Ov(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})}function Rv(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,s=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(u){l=[6,u],s=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Pv(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Dv(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function yd(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ew(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function kv(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ew(arguments[e]));return t}function Uv(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<r;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function ua(t){return this instanceof ua?(this.v=t,this):new ua(t)}function $v(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){n[h]&&(s[h]=function(m){return new Promise(function(f,g){i.push([h,m,f,g])>1||a(h,m)})})}function a(h,m){try{c(n[h](m))}catch(f){d(i[0][3],f)}}function c(h){h.value instanceof ua?Promise.resolve(h.value.v).then(l,u):d(i[0][2],h)}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,m){h(m),i.shift(),i.length&&a(i[0][0],i[0][1])}}function Bv(t){var e,r;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=t[s]?function(o){return(r=!r)?{value:ua(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function Lv(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof yd=="function"?yd(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function Mv(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Fv(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function jv(t){return t&&t.__esModule?t:{default:t}}function qv(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Hv(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const Wv=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return wd},__asyncDelegator:Bv,__asyncGenerator:$v,__asyncValues:Lv,__await:ua,__awaiter:Ov,__classPrivateFieldGet:qv,__classPrivateFieldSet:Hv,__createBinding:Pv,__decorate:Tv,__exportStar:Dv,__extends:Iv,__generator:Rv,__importDefault:jv,__importStar:Fv,__makeTemplateObject:Mv,__metadata:xv,__param:Nv,__read:Ew,__rest:Sv,__spread:kv,__spreadArrays:Uv,__values:yd},Symbol.toStringTag,{value:"Module"})),Cl=dw(Wv);var eu={},_o={},Rf;function zv(){if(Rf)return _o;Rf=1,Object.defineProperty(_o,"__esModule",{value:!0}),_o.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return _o.delay=t,_o}var Ls={},tu={},Ms={},Pf;function Vv(){return Pf||(Pf=1,Object.defineProperty(Ms,"__esModule",{value:!0}),Ms.ONE_THOUSAND=Ms.ONE_HUNDRED=void 0,Ms.ONE_HUNDRED=100,Ms.ONE_THOUSAND=1e3),Ms}var ru={},Df;function Kv(){return Df||(Df=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(ru)),ru}var kf;function vw(){return kf||(kf=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Cl;e.__exportStar(Vv(),t),e.__exportStar(Kv(),t)}(tu)),tu}var Uf;function Gv(){if(Uf)return Ls;Uf=1,Object.defineProperty(Ls,"__esModule",{value:!0}),Ls.fromMiliseconds=Ls.toMiliseconds=void 0;const t=vw();function e(n){return n*t.ONE_THOUSAND}Ls.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return Ls.fromMiliseconds=r,Ls}var $f;function Yv(){return $f||($f=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Cl;e.__exportStar(zv(),t),e.__exportStar(Gv(),t)}(eu)),eu}var Ii={},Bf;function Zv(){if(Bf)return Ii;Bf=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const s=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:s})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return Ii.Watch=t,Ii.default=t,Ii}var nu={},Co={},Lf;function Jv(){if(Lf)return Co;Lf=1,Object.defineProperty(Co,"__esModule",{value:!0}),Co.IWatch=void 0;class t{}return Co.IWatch=t,Co}var Mf;function Xv(){return Mf||(Mf=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Cl.__exportStar(Jv(),t)}(nu)),nu}var Ff;function Qv(){return Ff||(Ff=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Cl;e.__exportStar(Yv(),t),e.__exportStar(Zv(),t),e.__exportStar(Xv(),t),e.__exportStar(vw(),t)}(Ql)),Ql}var ne=Qv();class yi{}let e1=class extends yi{constructor(e){super()}};const jf=ne.FIVE_SECONDS,bi={pulse:"heartbeat_pulse"};let t1=class _w extends e1{constructor(e){super(e),this.events=new Gr.EventEmitter,this.interval=jf,this.interval=(e==null?void 0:e.interval)||jf}static async init(e){const r=new _w(e);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),ne.toMiliseconds(this.interval))}pulse(){this.events.emit(bi.pulse)}};const r1=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,n1=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,s1=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function i1(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){o1(t);return}return e}function o1(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function lc(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const r=t.trim();if(r.length<=9)switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!s1.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(r1.test(t)||n1.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,i1)}return JSON.parse(t)}catch(n){if(e.strict)throw n;return t}}function a1(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function Ut(t,...e){try{return a1(t(...e))}catch(r){return Promise.reject(r)}}function c1(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function l1(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function Uc(t){if(c1(t))return String(t);if(l1(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return Uc(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const bd="base64:";function u1(t){return typeof t=="string"?t:bd+f1(t)}function d1(t){return typeof t!="string"||!t.startsWith(bd)?t:h1(t.slice(bd.length))}function h1(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function f1(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function gr(t){var e;return t&&((e=t.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function p1(...t){return gr(t.join(":"))}function uc(t){return t=gr(t),t?t+":":""}function g1(t,e){if(e===void 0)return!0;let r=0,n=t.indexOf(":");for(;n>-1;)r++,n=t.indexOf(":",n+1);return r<=e}function m1(t,e){return e?t.startsWith(e)&&t[t.length-1]!=="$":t[t.length-1]!=="$"}const w1="memory",y1=()=>{const t=new Map;return{name:w1,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,r){t.set(e,r)},setItemRaw(e,r){t.set(e,r)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function b1(t={}){const e={mounts:{"":t.driver||y1()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},n=(l,u)=>e.mountpoints.filter(d=>d.startsWith(l)||u&&l.startsWith(d)).map(d=>({relativeBase:l.length>d.length?l.slice(d.length):void 0,mountpoint:d,driver:e.mounts[d]})),s=(l,u)=>{if(e.watching){u=gr(u);for(const d of e.watchListeners)d(l,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await qf(e.mounts[l],s,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,d)=>{const h=new Map,m=f=>{let g=h.get(f.base);return g||(g={driver:f.driver,base:f.base,items:[]},h.set(f.base,g)),g};for(const f of l){const g=typeof f=="string",_=gr(g?f:f.key),I=g?void 0:f.value,N=g||!f.options?u:{...u,...f.options},C=r(_);m(C).items.push({key:_,value:I,relativeKey:C.relativeKey,options:N})}return Promise.all([...h.values()].map(f=>d(f))).then(f=>f.flat())},c={hasItem(l,u={}){l=gr(l);const{relativeKey:d,driver:h}=r(l);return Ut(h.hasItem,d,u)},getItem(l,u={}){l=gr(l);const{relativeKey:d,driver:h}=r(l);return Ut(h.getItem,d,u).then(m=>lc(m))},getItems(l,u={}){return a(l,u,d=>d.driver.getItems?Ut(d.driver.getItems,d.items.map(h=>({key:h.relativeKey,options:h.options})),u).then(h=>h.map(m=>({key:p1(d.base,m.key),value:lc(m.value)}))):Promise.all(d.items.map(h=>Ut(d.driver.getItem,h.relativeKey,h.options).then(m=>({key:h.key,value:lc(m)})))))},getItemRaw(l,u={}){l=gr(l);const{relativeKey:d,driver:h}=r(l);return h.getItemRaw?Ut(h.getItemRaw,d,u):Ut(h.getItem,d,u).then(m=>d1(m))},async setItem(l,u,d={}){if(u===void 0)return c.removeItem(l);l=gr(l);const{relativeKey:h,driver:m}=r(l);m.setItem&&(await Ut(m.setItem,h,Uc(u),d),m.watch||s("update",l))},async setItems(l,u){await a(l,u,async d=>{if(d.driver.setItems)return Ut(d.driver.setItems,d.items.map(h=>({key:h.relativeKey,value:Uc(h.value),options:h.options})),u);d.driver.setItem&&await Promise.all(d.items.map(h=>Ut(d.driver.setItem,h.relativeKey,Uc(h.value),h.options)))})},async setItemRaw(l,u,d={}){if(u===void 0)return c.removeItem(l,d);l=gr(l);const{relativeKey:h,driver:m}=r(l);if(m.setItemRaw)await Ut(m.setItemRaw,h,u,d);else if(m.setItem)await Ut(m.setItem,h,u1(u),d);else return;m.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=gr(l);const{relativeKey:d,driver:h}=r(l);h.removeItem&&(await Ut(h.removeItem,d,u),(u.removeMeta||u.removeMata)&&await Ut(h.removeItem,d+"$",u),h.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=gr(l);const{relativeKey:d,driver:h}=r(l),m=Object.create(null);if(h.getMeta&&Object.assign(m,await Ut(h.getMeta,d,u)),!u.nativeOnly){const f=await Ut(h.getItem,d+"$",u).then(g=>lc(g));f&&typeof f=="object"&&(typeof f.atime=="string"&&(f.atime=new Date(f.atime)),typeof f.mtime=="string"&&(f.mtime=new Date(f.mtime)),Object.assign(m,f))}return m},setMeta(l,u,d={}){return this.setItem(l+"$",u,d)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){var _;l=uc(l);const d=n(l,!0);let h=[];const m=[];let f=!0;for(const I of d){(_=I.driver.flags)!=null&&_.maxDepth||(f=!1);const N=await Ut(I.driver.getKeys,I.relativeBase,u);for(const C of N){const E=I.mountpoint+gr(C);h.some(v=>E.startsWith(v))||m.push(E)}h=[I.mountpoint,...h.filter(C=>!C.startsWith(I.mountpoint))]}const g=u.maxDepth!==void 0&&!f;return m.filter(I=>(!g||g1(I,u.maxDepth))&&m1(I,l))},async clear(l,u={}){l=uc(l),await Promise.all(n(l,!1).map(async d=>{if(d.driver.clear)return Ut(d.driver.clear,d.relativeBase,u);if(d.driver.removeItem){const h=await d.driver.getKeys(d.relativeBase||"",u);return Promise.all(h.map(m=>d.driver.removeItem(m,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>Hf(l)))},async watch(l){return await i(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=uc(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((d,h)=>h.length-d.length)),e.mounts[l]=u,e.watching&&Promise.resolve(qf(u,s,l)).then(d=>{e.unwatch[l]=d}).catch(console.error),c},async unmount(l,u=!0){var d,h;l=uc(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&((h=(d=e.unwatch)[l])==null||h.call(d),delete e.unwatch[l]),u&&await Hf(e.mounts[l]),e.mountpoints=e.mountpoints.filter(m=>m!==l),delete e.mounts[l])},getMount(l=""){l=gr(l)+":";const u=r(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=gr(l),n(l,u.parents).map(h=>({driver:h.driver,base:h.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,d={})=>c.setItem(l,u,d),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function qf(t,e,r){return t.watch?t.watch((n,s)=>e(n,r+s)):()=>{}}async function Hf(t){typeof t.dispose=="function"&&await Ut(t.dispose)}function Ei(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function Cw(t,e){let r;const n=()=>{if(r)return r;const s=indexedDB.open(t);return s.onupgradeneeded=()=>s.result.createObjectStore(e),r=Ei(s),r.then(i=>{i.onclose=()=>r=void 0},()=>{}),r};return(s,i)=>n().then(o=>i(o.transaction(e,s).objectStore(e)))}let su;function La(){return su||(su=Cw("keyval-store","keyval")),su}function Wf(t,e=La()){return e("readonly",r=>Ei(r.get(t)))}function E1(t,e,r=La()){return r("readwrite",n=>(n.put(e,t),Ei(n.transaction)))}function v1(t,e=La()){return e("readwrite",r=>(r.delete(t),Ei(r.transaction)))}function _1(t=La()){return t("readwrite",e=>(e.clear(),Ei(e.transaction)))}function C1(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Ei(t.transaction)}function A1(t=La()){return t("readonly",e=>{if(e.getAllKeys)return Ei(e.getAllKeys());const r=[];return C1(e,n=>r.push(n.key)).then(()=>r)})}const I1=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),S1=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function oi(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return S1(t)}catch{return t}}function Jn(t){return typeof t=="string"?t:I1(t)||""}const T1="idb-keyval";var N1=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",r=s=>e+s;let n;return t.dbName&&t.storeName&&(n=Cw(t.dbName,t.storeName)),{name:T1,options:t,async hasItem(s){return!(typeof await Wf(r(s),n)>"u")},async getItem(s){return await Wf(r(s),n)??null},setItem(s,i){return E1(r(s),i,n)},removeItem(s){return v1(r(s),n)},getKeys(){return A1(n)},clear(){return _1(n)}}};const x1="WALLET_CONNECT_V2_INDEXED_DB",O1="keyvaluestorage";let R1=class{constructor(){this.indexedDb=b1({driver:N1({dbName:x1,storeName:O1})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,Jn(r))}async removeItem(e){await this.indexedDb.removeItem(e)}};var iu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$c={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof iu<"u"&&iu.localStorage?$c.exports=iu.localStorage:typeof window<"u"&&window.localStorage?$c.exports=window.localStorage:$c.exports=new e})();function P1(t){var e;return[t[0],oi((e=t[1])!=null?e:"")]}let D1=class{constructor(){this.localStorage=$c.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(P1)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return oi(r)}async setItem(e,r){this.localStorage.setItem(e,Jn(r))}async removeItem(e){this.localStorage.removeItem(e)}};const k1="wc_storage_version",zf=1,U1=async(t,e,r)=>{const n=k1,s=await e.getItem(n);if(s&&s>=zf){r(e);return}const i=await t.getKeys();if(!i.length){r(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await t.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(n,zf),r(e),$1(t,o)},$1=async(t,e)=>{e.length&&e.forEach(async r=>{await t.removeItem(r)})};let B1=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new D1;this.storage=e;try{const r=new R1;U1(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}};var ou,Vf;function L1(){if(Vf)return ou;Vf=1;function t(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}ou=e;function e(r,n,s){var i=s&&s.stringify||t,o=1;if(typeof r=="object"&&r!==null){var a=n.length+o;if(a===1)return r;var c=new Array(a);c[0]=i(r);for(var l=1;l<a;l++)c[l]=i(n[l]);return c.join(" ")}if(typeof r!="string")return r;var u=n.length;if(u===0)return r;for(var d="",h=1-o,m=-1,f=r&&r.length||0,g=0;g<f;){if(r.charCodeAt(g)===37&&g+1<f){switch(m=m>-1?m:0,r.charCodeAt(g+1)){case 100:case 102:if(h>=u||n[h]==null)break;m<g&&(d+=r.slice(m,g)),d+=Number(n[h]),m=g+2,g++;break;case 105:if(h>=u||n[h]==null)break;m<g&&(d+=r.slice(m,g)),d+=Math.floor(Number(n[h])),m=g+2,g++;break;case 79:case 111:case 106:if(h>=u||n[h]===void 0)break;m<g&&(d+=r.slice(m,g));var _=typeof n[h];if(_==="string"){d+="'"+n[h]+"'",m=g+2,g++;break}if(_==="function"){d+=n[h].name||"<anonymous>",m=g+2,g++;break}d+=i(n[h]),m=g+2,g++;break;case 115:if(h>=u)break;m<g&&(d+=r.slice(m,g)),d+=String(n[h]),m=g+2,g++;break;case 37:m<g&&(d+=r.slice(m,g)),d+="%",m=g+2,g++,h--;break}++h}++g}return m===-1?r:(m<f&&(d+=r.slice(m)),d)}return ou}var au,Kf;function M1(){if(Kf)return au;Kf=1;const t=L1();au=s;const e=v().console||{},r={mapHttpRequest:f,mapHttpResponse:f,wrapRequestSerializer:g,wrapResponseSerializer:g,wrapErrorSerializer:g,req:f,res:f,err:h};function n(A,x){return Array.isArray(A)?A.filter(function(U){return U!=="!stdSerializers.err"}):A===!0?Object.keys(x):!1}function s(A){A=A||{},A.browser=A.browser||{};const x=A.browser.transmit;if(x&&typeof x.send!="function")throw Error("pino: transmit option must have a send function");const D=A.browser.write||e;A.browser.write&&(A.browser.asObject=!0);const U=A.serializers||{},M=n(A.browser.serialize,U);let $=A.browser.serialize;Array.isArray(A.browser.serialize)&&A.browser.serialize.indexOf("!stdSerializers.err")>-1&&($=!1);const F=["error","fatal","warn","info","debug","trace"];typeof D=="function"&&(D.error=D.fatal=D.warn=D.info=D.debug=D.trace=D),A.enabled===!1&&(A.level="silent");const W=A.level||"info",q=Object.create(D);q.log||(q.log=_),Object.defineProperty(q,"levelVal",{get:b}),Object.defineProperty(q,"level",{get:O,set:B});const y={transmit:x,serialize:M,asObject:A.browser.asObject,levels:F,timestamp:m(A)};q.levels=s.levels,q.level=W,q.setMaxListeners=q.getMaxListeners=q.emit=q.addListener=q.on=q.prependListener=q.once=q.prependOnceListener=q.removeListener=q.removeAllListeners=q.listeners=q.listenerCount=q.eventNames=q.write=q.flush=_,q.serializers=U,q._serialize=M,q._stdErrSerialize=$,q.child=k,x&&(q._logEvent=d());function b(){return this.level==="silent"?1/0:this.levels.values[this.level]}function O(){return this._level}function B(L){if(L!=="silent"&&!this.levels.values[L])throw Error("unknown level "+L);this._level=L,i(y,q,"error","log"),i(y,q,"fatal","error"),i(y,q,"warn","error"),i(y,q,"info","log"),i(y,q,"debug","log"),i(y,q,"trace","log")}function k(L,H){if(!L)throw new Error("missing bindings for child Pino");H=H||{},M&&L.serializers&&(H.serializers=L.serializers);const K=H.serializers;if(M&&K){var Q=Object.assign({},U,K),Z=A.browser.serialize===!0?Object.keys(Q):M;delete L.serializers,c([L],Z,Q,this._stdErrSerialize)}function re(we){this._childLevel=(we._childLevel|0)+1,this.error=l(we,L,"error"),this.fatal=l(we,L,"fatal"),this.warn=l(we,L,"warn"),this.info=l(we,L,"info"),this.debug=l(we,L,"debug"),this.trace=l(we,L,"trace"),Q&&(this.serializers=Q,this._serialize=Z),x&&(this._logEvent=d([].concat(we._logEvent.bindings,L)))}return re.prototype=this,new re(this)}return q}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers=r,s.stdTimeFunctions=Object.assign({},{nullTime:I,epochTime:N,unixTime:C,isoTime:E});function i(A,x,D,U){const M=Object.getPrototypeOf(x);x[D]=x.levelVal>x.levels.values[D]?_:M[D]?M[D]:e[D]||e[U]||_,o(A,x,D)}function o(A,x,D){!A.transmit&&x[D]===_||(x[D]=function(U){return function(){const $=A.timestamp(),F=new Array(arguments.length),W=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var q=0;q<F.length;q++)F[q]=arguments[q];if(A.serialize&&!A.asObject&&c(F,this._serialize,this.serializers,this._stdErrSerialize),A.asObject?U.call(W,a(this,D,F,$)):U.apply(W,F),A.transmit){const y=A.transmit.level||x.level,b=s.levels.values[y],O=s.levels.values[D];if(O<b)return;u(this,{ts:$,methodLevel:D,methodValue:O,transmitValue:s.levels.values[A.transmit.level||x.level],send:A.transmit.send,val:x.levelVal},F)}}}(x[D]))}function a(A,x,D,U){A._serialize&&c(D,A._serialize,A.serializers,A._stdErrSerialize);const M=D.slice();let $=M[0];const F={};U&&(F.time=U),F.level=s.levels.values[x];let W=(A._childLevel|0)+1;if(W<1&&(W=1),$!==null&&typeof $=="object"){for(;W--&&typeof M[0]=="object";)Object.assign(F,M.shift());$=M.length?t(M.shift(),M):void 0}else typeof $=="string"&&($=t(M.shift(),M));return $!==void 0&&(F.msg=$),F}function c(A,x,D,U){for(const M in A)if(U&&A[M]instanceof Error)A[M]=s.stdSerializers.err(A[M]);else if(typeof A[M]=="object"&&!Array.isArray(A[M]))for(const $ in A[M])x&&x.indexOf($)>-1&&$ in D&&(A[M][$]=D[$](A[M][$]))}function l(A,x,D){return function(){const U=new Array(1+arguments.length);U[0]=x;for(var M=1;M<U.length;M++)U[M]=arguments[M-1];return A[D].apply(this,U)}}function u(A,x,D){const U=x.send,M=x.ts,$=x.methodLevel,F=x.methodValue,W=x.val,q=A._logEvent.bindings;c(D,A._serialize||Object.keys(A.serializers),A.serializers,A._stdErrSerialize===void 0?!0:A._stdErrSerialize),A._logEvent.ts=M,A._logEvent.messages=D.filter(function(y){return q.indexOf(y)===-1}),A._logEvent.level.label=$,A._logEvent.level.value=F,U($,A._logEvent,W),A._logEvent=d(q)}function d(A){return{ts:0,messages:[],bindings:A||[],level:{label:"",value:0}}}function h(A){const x={type:A.constructor.name,msg:A.message,stack:A.stack};for(const D in A)x[D]===void 0&&(x[D]=A[D]);return x}function m(A){return typeof A.timestamp=="function"?A.timestamp:A.timestamp===!1?I:N}function f(){return{}}function g(A){return A}function _(){}function I(){return!1}function N(){return Date.now()}function C(){return Math.round(Date.now()/1e3)}function E(){return new Date(Date.now()).toISOString()}function v(){function A(x){return typeof x<"u"&&x}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return A(self)||A(window)||A(this)||{}}}return au}var qi=M1();const Ma=pi(qi),F1={level:"info"},Fa="custom_context",Ch=1e3*1024;let j1=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Gf=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const r=new j1(e);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let r=this.head;for(;r!==null;)e.push(r.value),r=r.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const r=e.value;return e=e.next,{done:!1,value:r}}}}},Aw=class{constructor(e,r=Ch){this.level=e??"error",this.levelValue=qi.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new Gf(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,r){r===qi.levels.values.error?console.error(e):r===qi.levels.values.warn?console.warn(e):r===qi.levels.values.debug?console.debug(e):r===qi.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Jn({timestamp:new Date().toISOString(),log:e}));const r=typeof e=="string"?JSON.parse(e).level:e.level;r>=this.levelValue&&this.forwardToConsole(e,r)}getLogs(){return this.logs}clearLogs(){this.logs=new Gf(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const r=this.getLogArray();return r.push(Jn({extraMetadata:e})),new Blob(r,{type:"application/json"})}},q1=class{constructor(e,r=Ch){this.baseChunkLogger=new Aw(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const r=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=r,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}},H1=class{constructor(e,r=Ch){this.baseChunkLogger=new Aw(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var W1=Object.defineProperty,z1=Object.defineProperties,V1=Object.getOwnPropertyDescriptors,Yf=Object.getOwnPropertySymbols,K1=Object.prototype.hasOwnProperty,G1=Object.prototype.propertyIsEnumerable,Zf=(t,e,r)=>e in t?W1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Kc=(t,e)=>{for(var r in e||(e={}))K1.call(e,r)&&Zf(t,r,e[r]);if(Yf)for(var r of Yf(e))G1.call(e,r)&&Zf(t,r,e[r]);return t},Gc=(t,e)=>z1(t,V1(e));function co(t){return Gc(Kc({},t),{level:(t==null?void 0:t.level)||F1.level})}function Y1(t,e=Fa){return t[e]||""}function Z1(t,e,r=Fa){return t[r]=e,t}function Sr(t,e=Fa){let r="";return typeof t.bindings>"u"?r=Y1(t,e):r=t.bindings().context||"",r}function J1(t,e,r=Fa){const n=Sr(t,r);return n.trim()?`${n}/${e}`:e}function tr(t,e,r=Fa){const n=J1(t,e,r),s=t.child({context:n});return Z1(s,n,r)}function X1(t){var e,r;const n=new q1((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Ma(Gc(Kc({},t.opts),{level:"trace",browser:Gc(Kc({},(r=t.opts)==null?void 0:r.browser),{write:s=>n.write(s)})})),chunkLoggerController:n}}function Q1(t){var e;const r=new H1((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Ma(Gc(Kc({},t.opts),{level:"trace"}),r),chunkLoggerController:r}}function Ah(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?X1(t):Q1(t)}var e_=Object.defineProperty,t_=(t,e,r)=>e in t?e_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Jf=(t,e,r)=>t_(t,typeof e!="symbol"?e+"":e,r);let r_=class extends yi{constructor(e){super(),this.opts=e,Jf(this,"protocol","wc"),Jf(this,"version",2)}};var n_=Object.defineProperty,s_=(t,e,r)=>e in t?n_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,i_=(t,e,r)=>s_(t,e+"",r);let o_=class extends yi{constructor(e,r){super(),this.core=e,this.logger=r,i_(this,"records",new Map)}},a_=class{constructor(e,r){this.logger=e,this.core=r}},c_=class extends yi{constructor(e,r){super(),this.relayer=e,this.logger=r}},l_=class extends yi{constructor(e){super()}},u_=class{constructor(e,r,n,s){this.core=e,this.logger=r,this.name=n}},d_=class extends yi{constructor(e,r){super(),this.relayer=e,this.logger=r}},h_=class extends yi{constructor(e,r){super(),this.core=e,this.logger=r}},f_=class{constructor(e,r,n){this.core=e,this.logger=r,this.store=n}},p_=class{constructor(e,r){this.projectId=e,this.logger=r}},g_=class{constructor(e,r,n){this.core=e,this.logger=r,this.telemetryEnabled=n}};var m_=Object.defineProperty,w_=(t,e,r)=>e in t?m_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xf=(t,e,r)=>w_(t,typeof e!="symbol"?e+"":e,r);let y_=class{constructor(e){this.opts=e,Xf(this,"protocol","wc"),Xf(this,"version",2)}},b_=class{constructor(e){this.client=e}};function E_(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Iw(t,...e){if(!E_(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Qf(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function v_(t,e){Iw(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const Si=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const cu=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function __(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Sw(t){return typeof t=="string"&&(t=__(t)),Iw(t),t}let C_=class{clone(){return this._cloneInto()}};function A_(t){const e=n=>t().update(Sw(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Tw(t=32){if(Si&&typeof Si.getRandomValues=="function")return Si.getRandomValues(new Uint8Array(t));if(Si&&typeof Si.randomBytes=="function")return Si.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function I_(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}let S_=class extends C_{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=cu(this.buffer)}update(e){Qf(this);const{view:r,buffer:n,blockLen:s}=this;e=Sw(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=cu(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Qf(this),v_(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;I_(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=cu(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}};const dc=BigInt(2**32-1),Ed=BigInt(32);function Nw(t,e=!1){return e?{h:Number(t&dc),l:Number(t>>Ed&dc)}:{h:Number(t>>Ed&dc)|0,l:Number(t&dc)|0}}function T_(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=Nw(t[s],e);[r[s],n[s]]=[i,o]}return[r,n]}const N_=(t,e)=>BigInt(t>>>0)<<Ed|BigInt(e>>>0),x_=(t,e,r)=>t>>>r,O_=(t,e,r)=>t<<32-r|e>>>r,R_=(t,e,r)=>t>>>r|e<<32-r,P_=(t,e,r)=>t<<32-r|e>>>r,D_=(t,e,r)=>t<<64-r|e>>>r-32,k_=(t,e,r)=>t>>>r-32|e<<64-r,U_=(t,e)=>e,$_=(t,e)=>t,B_=(t,e,r)=>t<<r|e>>>32-r,L_=(t,e,r)=>e<<r|t>>>32-r,M_=(t,e,r)=>e<<r-32|t>>>64-r,F_=(t,e,r)=>t<<r-32|e>>>64-r;function j_(t,e,r,n){const s=(e>>>0)+(n>>>0);return{h:t+r+(s/2**32|0)|0,l:s|0}}const q_=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),H_=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,W_=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),z_=(t,e,r,n,s)=>e+r+n+s+(t/2**32|0)|0,V_=(t,e,r,n,s)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(s>>>0),K_=(t,e,r,n,s,i)=>e+r+n+s+i+(t/2**32|0)|0,De={fromBig:Nw,split:T_,toBig:N_,shrSH:x_,shrSL:O_,rotrSH:R_,rotrSL:P_,rotrBH:D_,rotrBL:k_,rotr32H:U_,rotr32L:$_,rotlSH:B_,rotlSL:L_,rotlBH:M_,rotlBL:F_,add:j_,add3L:q_,add3H:H_,add4L:W_,add4H:z_,add5H:K_,add5L:V_},[G_,Y_]=De.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),ss=new Uint32Array(80),is=new Uint32Array(80);let Z_=class extends S_{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:m,Gl:f,Hh:g,Hl:_}=this;return[e,r,n,s,i,o,a,c,l,u,d,h,m,f,g,_]}set(e,r,n,s,i,o,a,c,l,u,d,h,m,f,g,_){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=m|0,this.Gl=f|0,this.Hh=g|0,this.Hl=_|0}process(e,r){for(let C=0;C<16;C++,r+=4)ss[C]=e.getUint32(r),is[C]=e.getUint32(r+=4);for(let C=16;C<80;C++){const E=ss[C-15]|0,v=is[C-15]|0,A=De.rotrSH(E,v,1)^De.rotrSH(E,v,8)^De.shrSH(E,v,7),x=De.rotrSL(E,v,1)^De.rotrSL(E,v,8)^De.shrSL(E,v,7),D=ss[C-2]|0,U=is[C-2]|0,M=De.rotrSH(D,U,19)^De.rotrBH(D,U,61)^De.shrSH(D,U,6),$=De.rotrSL(D,U,19)^De.rotrBL(D,U,61)^De.shrSL(D,U,6),F=De.add4L(x,$,is[C-7],is[C-16]),W=De.add4H(F,A,M,ss[C-7],ss[C-16]);ss[C]=W|0,is[C]=F|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:m,Fl:f,Gh:g,Gl:_,Hh:I,Hl:N}=this;for(let C=0;C<80;C++){const E=De.rotrSH(d,h,14)^De.rotrSH(d,h,18)^De.rotrBH(d,h,41),v=De.rotrSL(d,h,14)^De.rotrSL(d,h,18)^De.rotrBL(d,h,41),A=d&m^~d&g,x=h&f^~h&_,D=De.add5L(N,v,x,Y_[C],is[C]),U=De.add5H(D,I,E,A,G_[C],ss[C]),M=D|0,$=De.rotrSH(n,s,28)^De.rotrBH(n,s,34)^De.rotrBH(n,s,39),F=De.rotrSL(n,s,28)^De.rotrBL(n,s,34)^De.rotrBL(n,s,39),W=n&i^n&a^i&a,q=s&o^s&c^o&c;I=g|0,N=_|0,g=m|0,_=f|0,m=d|0,f=h|0,{h:d,l:h}=De.add(l|0,u|0,U|0,M|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const y=De.add3L(M,F,q);n=De.add3H(y,U,$,W),s=y|0}({h:n,l:s}=De.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=De.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=De.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=De.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=De.add(this.Eh|0,this.El|0,d|0,h|0),{h:m,l:f}=De.add(this.Fh|0,this.Fl|0,m|0,f|0),{h:g,l:_}=De.add(this.Gh|0,this.Gl|0,g|0,_|0),{h:I,l:N}=De.add(this.Hh|0,this.Hl|0,I|0,N|0),this.set(n,s,i,o,a,c,l,u,d,h,m,f,g,_,I,N)}roundClean(){ss.fill(0),is.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const J_=A_(()=>new Z_);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ih=BigInt(0),xw=BigInt(1),X_=BigInt(2);function Sh(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Th(t){if(!Sh(t))throw new Error("Uint8Array expected")}function lu(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const Q_=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Nh(t){Th(t);let e="";for(let r=0;r<t.length;r++)e+=Q_[t[r]];return e}function Ow(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Ih:BigInt("0x"+t)}const Dn={_0:48,_9:57,A:65,F:70,a:97,f:102};function ep(t){if(t>=Dn._0&&t<=Dn._9)return t-Dn._0;if(t>=Dn.A&&t<=Dn.F)return t-(Dn.A-10);if(t>=Dn.a&&t<=Dn.f)return t-(Dn.a-10)}function Rw(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){const o=ep(t.charCodeAt(i)),a=ep(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function eC(t){return Ow(Nh(t))}function Bc(t){return Th(t),Ow(Nh(Uint8Array.from(t).reverse()))}function Pw(t,e){return Rw(t.toString(16).padStart(e*2,"0"))}function vd(t,e){return Pw(t,e).reverse()}function kn(t,e,r){let n;if(typeof e=="string")try{n=Rw(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Sh(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(t+" of length "+r+" expected, got "+s);return n}function tp(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];Th(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}const uu=t=>typeof t=="bigint"&&Ih<=t;function tC(t,e,r){return uu(t)&&uu(e)&&uu(r)&&e<=t&&t<r}function Ao(t,e,r,n){if(!tC(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function rC(t){let e;for(e=0;t>Ih;t>>=xw,e+=1);return e}const nC=t=>(X_<<BigInt(t-1))-xw,sC={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Sh(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function xh(t,e,r={}){const n=(s,i,o)=>{const a=sC[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(r))n(s,i,!0);return t}function rp(t){const e=new WeakMap;return(r,...n)=>{const s=e.get(r);if(s!==void 0)return s;const i=t(r,...n);return e.set(r,i),i}}const Ft=BigInt(0),Ct=BigInt(1),zs=BigInt(2),iC=BigInt(3),_d=BigInt(4),np=BigInt(5),sp=BigInt(8);function Pt(t,e){const r=t%e;return r>=Ft?r:e+r}function oC(t,e,r){if(e<Ft)throw new Error("invalid exponent, negatives unsupported");if(r<=Ft)throw new Error("invalid modulus");if(r===Ct)return Ft;let n=Ct;for(;e>Ft;)e&Ct&&(n=n*t%r),t=t*t%r,e>>=Ct;return n}function pn(t,e,r){let n=t;for(;e-- >Ft;)n*=n,n%=r;return n}function ip(t,e){if(t===Ft)throw new Error("invert: expected non-zero number");if(e<=Ft)throw new Error("invert: expected positive modulus, got "+e);let r=Pt(t,e),n=e,s=Ft,i=Ct;for(;r!==Ft;){const o=n/r,a=n%r,c=s-i*o;n=r,r=a,s=i,i=c}if(n!==Ct)throw new Error("invert: does not exist");return Pt(s,e)}function aC(t){const e=(t-Ct)/zs;let r,n,s;for(r=t-Ct,n=0;r%zs===Ft;r/=zs,n++);for(s=zs;s<t&&oC(s,e,t)!==t-Ct;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(t+Ct)/_d;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(r+Ct)/zs;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,l=o.pow(o.mul(o.ONE,s),r),u=o.pow(a,i),d=o.pow(a,r);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let f=o.sqr(d);h<c&&!o.eql(f,o.ONE);h++)f=o.sqr(f);const m=o.pow(l,Ct<<BigInt(c-h-1));l=o.sqr(m),u=o.mul(u,m),d=o.mul(d,l),c=h}return u}}function cC(t){if(t%_d===iC){const e=(t+Ct)/_d;return function(r,n){const s=r.pow(n,e);if(!r.eql(r.sqr(s),n))throw new Error("Cannot find square root");return s}}if(t%sp===np){const e=(t-np)/sp;return function(r,n){const s=r.mul(n,zs),i=r.pow(s,e),o=r.mul(n,i),a=r.mul(r.mul(o,zs),i),c=r.mul(o,r.sub(a,r.ONE));if(!r.eql(r.sqr(c),n))throw new Error("Cannot find square root");return c}}return aC(t)}const lC=(t,e)=>(Pt(t,e)&Ct)===Ct,uC=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function dC(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=uC.reduce((n,s)=>(n[s]="function",n),e);return xh(t,r)}function hC(t,e,r){if(r<Ft)throw new Error("invalid exponent, negatives unsupported");if(r===Ft)return t.ONE;if(r===Ct)return e;let n=t.ONE,s=e;for(;r>Ft;)r&Ct&&(n=t.mul(n,s)),s=t.sqr(s),r>>=Ct;return n}function fC(t,e){const r=new Array(e.length),n=e.reduce((i,o,a)=>t.is0(o)?i:(r[a]=i,t.mul(i,o)),t.ONE),s=t.inv(n);return e.reduceRight((i,o,a)=>t.is0(o)?i:(r[a]=t.mul(i,r[a]),t.mul(i,o)),s),r}function Dw(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function kw(t,e,r=!1,n={}){if(t<=Ft)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=Dw(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:s,BYTES:i,MASK:nC(s),ZERO:Ft,ONE:Ct,create:c=>Pt(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Ft<=c&&c<t},is0:c=>c===Ft,isOdd:c=>(c&Ct)===Ct,neg:c=>Pt(-c,t),eql:(c,l)=>c===l,sqr:c=>Pt(c*c,t),add:(c,l)=>Pt(c+l,t),sub:(c,l)=>Pt(c-l,t),mul:(c,l)=>Pt(c*l,t),pow:(c,l)=>hC(a,c,l),div:(c,l)=>Pt(c*ip(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>ip(c,t),sqrt:n.sqrt||(c=>(o||(o=cC(t)),o(a,c))),invertBatch:c=>fC(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>r?vd(c,i):Pw(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return r?Bc(c):eC(c)}});return Object.freeze(a)}const op=BigInt(0),hc=BigInt(1);function du(t,e){const r=e.negate();return t?r:e}function Uw(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function hu(t,e){Uw(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1);return{windows:r,windowSize:n}}function pC(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function gC(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const fu=new WeakMap,$w=new WeakMap;function pu(t){return $w.get(t)||1}function mC(t,e){return{constTimeNegate:du,hasPrecomputes(r){return pu(r)!==1},unsafeLadder(r,n,s=t.ZERO){let i=r;for(;n>op;)n&hc&&(s=s.add(i)),i=i.double(),n>>=hc;return s},precomputeWindow(r,n){const{windows:s,windowSize:i}=hu(n,e),o=[];let a=r,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,s){const{windows:i,windowSize:o}=hu(r,e);let a=t.ZERO,c=t.BASE;const l=BigInt(2**r-1),u=2**r,d=BigInt(r);for(let h=0;h<i;h++){const m=h*o;let f=Number(s&l);s>>=d,f>o&&(f-=u,s+=hc);const g=m,_=m+Math.abs(f)-1,I=h%2!==0,N=f<0;f===0?c=c.add(du(I,n[g])):a=a.add(du(N,n[_]))}return{p:a,f:c}},wNAFUnsafe(r,n,s,i=t.ZERO){const{windows:o,windowSize:a}=hu(r,e),c=BigInt(2**r-1),l=2**r,u=BigInt(r);for(let d=0;d<o;d++){const h=d*a;if(s===op)break;let m=Number(s&c);if(s>>=u,m>a&&(m-=l,s+=hc),m===0)continue;let f=n[h+Math.abs(m)-1];m<0&&(f=f.negate()),i=i.add(f)}return i},getPrecomputes(r,n,s){let i=fu.get(n);return i||(i=this.precomputeWindow(n,r),r!==1&&fu.set(n,s(i))),i},wNAFCached(r,n,s){const i=pu(r);return this.wNAF(i,this.getPrecomputes(i,r,s),n)},wNAFCachedUnsafe(r,n,s,i){const o=pu(r);return o===1?this.unsafeLadder(r,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,r,s),n,i)},setWindowSize(r,n){Uw(n,e),$w.set(r,n),fu.delete(r)}}}function wC(t,e,r,n){if(pC(r,t),gC(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=rC(BigInt(r.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let d=l;d>=0;d-=o){c.fill(s);for(let m=0;m<n.length;m++){const f=n[m],g=Number(f>>BigInt(d)&BigInt(a));c[g]=c[g].add(r[m])}let h=s;for(let m=c.length-1,f=s;m>0;m--)f=f.add(c[m]),h=h.add(f);if(u=u.add(h),d!==0)for(let m=0;m<o;m++)u=u.double()}return u}function yC(t){return dC(t.Fp),xh(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Dw(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const Qr=BigInt(0),dr=BigInt(1),fc=BigInt(2),bC=BigInt(8),EC={zip215:!0};function vC(t){const e=yC(t);return xh(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function _C(t){const e=vC(t),{Fp:r,n,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=fc<<BigInt(a*8)-dr,u=r.create,d=kw(e.n,e.nBitLength),h=e.uvRatio||((y,b)=>{try{return{isValid:!0,value:r.sqrt(y*r.inv(b))}}catch{return{isValid:!1,value:Qr}}}),m=e.adjustScalarBytes||(y=>y),f=e.domain||((y,b,O)=>{if(lu("phflag",O),b.length||O)throw new Error("Contexts/pre-hash are not supported");return y});function g(y,b){Ao("coordinate "+y,b,Qr,l)}function _(y){if(!(y instanceof C))throw new Error("ExtendedPoint expected")}const I=rp((y,b)=>{const{ex:O,ey:B,ez:k}=y,L=y.is0();b==null&&(b=L?bC:r.inv(k));const H=u(O*b),K=u(B*b),Q=u(k*b);if(L)return{x:Qr,y:dr};if(Q!==dr)throw new Error("invZ was invalid");return{x:H,y:K}}),N=rp(y=>{const{a:b,d:O}=e;if(y.is0())throw new Error("bad point: ZERO");const{ex:B,ey:k,ez:L,et:H}=y,K=u(B*B),Q=u(k*k),Z=u(L*L),re=u(Z*Z),we=u(K*b),Ee=u(Z*u(we+Q)),Ne=u(re+u(O*u(K*Q)));if(Ee!==Ne)throw new Error("bad point: equation left != right (1)");const be=u(B*k),xe=u(L*H);if(be!==xe)throw new Error("bad point: equation left != right (2)");return!0});class C{constructor(b,O,B,k){this.ex=b,this.ey=O,this.ez=B,this.et=k,g("x",b),g("y",O),g("z",B),g("t",k),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(b){if(b instanceof C)throw new Error("extended point not allowed");const{x:O,y:B}=b||{};return g("x",O),g("y",B),new C(O,B,dr,u(O*B))}static normalizeZ(b){const O=r.invertBatch(b.map(B=>B.ez));return b.map((B,k)=>B.toAffine(O[k])).map(C.fromAffine)}static msm(b,O){return wC(C,d,b,O)}_setWindowSize(b){A.setWindowSize(this,b)}assertValidity(){N(this)}equals(b){_(b);const{ex:O,ey:B,ez:k}=this,{ex:L,ey:H,ez:K}=b,Q=u(O*K),Z=u(L*k),re=u(B*K),we=u(H*k);return Q===Z&&re===we}is0(){return this.equals(C.ZERO)}negate(){return new C(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:b}=e,{ex:O,ey:B,ez:k}=this,L=u(O*O),H=u(B*B),K=u(fc*u(k*k)),Q=u(b*L),Z=O+B,re=u(u(Z*Z)-L-H),we=Q+H,Ee=we-K,Ne=Q-H,be=u(re*Ee),xe=u(we*Ne),Ze=u(re*Ne),tt=u(Ee*we);return new C(be,xe,tt,Ze)}add(b){_(b);const{a:O,d:B}=e,{ex:k,ey:L,ez:H,et:K}=this,{ex:Q,ey:Z,ez:re,et:we}=b;if(O===BigInt(-1)){const nc=u((L-k)*(Z+Q)),yo=u((L+k)*(Z-Q)),ts=u(yo-nc);if(ts===Qr)return this.double();const Nr=u(H*fc*we),Ci=u(K*fc*re),sc=Ci+Nr,Jr=yo+nc,ic=Ci-Nr,S=u(sc*ts),p=u(Jr*ic),w=u(sc*ic),P=u(ts*Jr);return new C(S,p,P,w)}const Ee=u(k*Q),Ne=u(L*Z),be=u(K*B*we),xe=u(H*re),Ze=u((k+L)*(Q+Z)-Ee-Ne),tt=xe-be,qe=xe+be,ct=u(Ne-O*Ee),jt=u(Ze*tt),Tr=u(qe*ct),wo=u(Ze*ct),Hl=u(tt*qe);return new C(jt,Tr,Hl,wo)}subtract(b){return this.add(b.negate())}wNAF(b){return A.wNAFCached(this,b,C.normalizeZ)}multiply(b){const O=b;Ao("scalar",O,dr,n);const{p:B,f:k}=this.wNAF(O);return C.normalizeZ([B,k])[0]}multiplyUnsafe(b,O=C.ZERO){const B=b;return Ao("scalar",B,Qr,n),B===Qr?v:this.is0()||B===dr?this:A.wNAFCachedUnsafe(this,B,C.normalizeZ,O)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return A.unsafeLadder(this,n).is0()}toAffine(b){return I(this,b)}clearCofactor(){const{h:b}=e;return b===dr?this:this.multiplyUnsafe(b)}static fromHex(b,O=!1){const{d:B,a:k}=e,L=r.BYTES;b=kn("pointHex",b,L),lu("zip215",O);const H=b.slice(),K=b[L-1];H[L-1]=K&-129;const Q=Bc(H),Z=O?l:r.ORDER;Ao("pointHex.y",Q,Qr,Z);const re=u(Q*Q),we=u(re-dr),Ee=u(B*re-k);let{isValid:Ne,value:be}=h(we,Ee);if(!Ne)throw new Error("Point.fromHex: invalid y coordinate");const xe=(be&dr)===dr,Ze=(K&128)!==0;if(!O&&be===Qr&&Ze)throw new Error("Point.fromHex: x=0 and x_0=1");return Ze!==xe&&(be=u(-be)),C.fromAffine({x:be,y:Q})}static fromPrivateKey(b){return U(b).point}toRawBytes(){const{x:b,y:O}=this.toAffine(),B=vd(O,r.BYTES);return B[B.length-1]|=b&dr?128:0,B}toHex(){return Nh(this.toRawBytes())}}C.BASE=new C(e.Gx,e.Gy,dr,u(e.Gx*e.Gy)),C.ZERO=new C(Qr,dr,dr,Qr);const{BASE:E,ZERO:v}=C,A=mC(C,a*8);function x(y){return Pt(y,n)}function D(y){return x(Bc(y))}function U(y){const b=r.BYTES;y=kn("private key",y,b);const O=kn("hashed private key",i(y),2*b),B=m(O.slice(0,b)),k=O.slice(b,2*b),L=D(B),H=E.multiply(L),K=H.toRawBytes();return{head:B,prefix:k,scalar:L,point:H,pointBytes:K}}function M(y){return U(y).pointBytes}function $(y=new Uint8Array,...b){const O=tp(...b);return D(i(f(O,kn("context",y),!!s)))}function F(y,b,O={}){y=kn("message",y),s&&(y=s(y));const{prefix:B,scalar:k,pointBytes:L}=U(b),H=$(O.context,B,y),K=E.multiply(H).toRawBytes(),Q=$(O.context,K,L,y),Z=x(H+Q*k);Ao("signature.s",Z,Qr,n);const re=tp(K,vd(Z,r.BYTES));return kn("result",re,r.BYTES*2)}const W=EC;function q(y,b,O,B=W){const{context:k,zip215:L}=B,H=r.BYTES;y=kn("signature",y,2*H),b=kn("message",b),O=kn("publicKey",O,H),L!==void 0&&lu("zip215",L),s&&(b=s(b));const K=Bc(y.slice(H,2*H));let Q,Z,re;try{Q=C.fromHex(O,L),Z=C.fromHex(y.slice(0,H),L),re=E.multiplyUnsafe(K)}catch{return!1}if(!L&&Q.isSmallOrder())return!1;const we=$(k,Z.toRawBytes(),Q.toRawBytes(),b);return Z.add(Q.multiplyUnsafe(we)).subtract(re).clearCofactor().equals(C.ZERO)}return E._setWindowSize(8),{CURVE:e,getPublicKey:M,sign:F,verify:q,ExtendedPoint:C,utils:{getExtendedPublicKey:U,randomPrivateKey:()=>o(r.BYTES),precompute(y=8,b=C.BASE){return b._setWindowSize(y),b.multiply(BigInt(3)),b}}}}BigInt(0),BigInt(1);const Oh=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),ap=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const CC=BigInt(1),cp=BigInt(2);BigInt(3);const AC=BigInt(5),IC=BigInt(8);function SC(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),s=BigInt(80),i=Oh,o=t*t%i*t%i,a=pn(o,cp,i)*o%i,c=pn(a,CC,i)*t%i,l=pn(c,AC,i)*c%i,u=pn(l,e,i)*l%i,d=pn(u,r,i)*u%i,h=pn(d,n,i)*d%i,m=pn(h,s,i)*h%i,f=pn(m,s,i)*h%i,g=pn(f,e,i)*l%i;return{pow_p_5_8:pn(g,cp,i)*t%i,b2:o}}function TC(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function NC(t,e){const r=Oh,n=Pt(e*e*e,r),s=Pt(n*n*e,r),i=SC(t*s).pow_p_5_8;let o=Pt(t*n*i,r);const a=Pt(e*o*o,r),c=o,l=Pt(o*ap,r),u=a===t,d=a===Pt(-t,r),h=a===Pt(-t*ap,r);return u&&(o=c),(d||h)&&(o=l),lC(o,r)&&(o=Pt(-o,r)),{isValid:u||d,value:o}}const xC=kw(Oh,void 0,!0),OC={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:xC,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:IC,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:J_,randomBytes:Tw,adjustScalarBytes:TC,uvRatio:NC},Bw=_C(OC),RC="EdDSA",PC="JWT",Yc=".",Al="base64url",Lw="utf8",Mw="utf8",DC=":",kC="did",UC="key",lp="base58btc",$C="z",BC="K36",LC=32;function Rh(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Fw(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Rh(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function jw(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const r=Fw(e);let n=0;for(const s of t)r.set(s,n),n+=s.length;return Rh(r)}function MC(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var g=0,_=0,I=0,N=f.length;I!==N&&f[I]===0;)I++,g++;for(var C=(N-I)*u+1>>>0,E=new Uint8Array(C);I!==N;){for(var v=f[I],A=0,x=C-1;(v!==0||A<_)&&x!==-1;x--,A++)v+=256*E[x]>>>0,E[x]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");_=A,I++}for(var D=C-_;D!==C&&E[D]===0;)D++;for(var U=c.repeat(g);D<C;++D)U+=t.charAt(E[D]);return U}function h(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var g=0;if(f[g]!==" "){for(var _=0,I=0;f[g]===c;)_++,g++;for(var N=(f.length-g)*l+1>>>0,C=new Uint8Array(N);f[g];){var E=r[f.charCodeAt(g)];if(E===255)return;for(var v=0,A=N-1;(E!==0||v<I)&&A!==-1;A--,v++)E+=a*C[A]>>>0,C[A]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");I=v,g++}if(f[g]!==" "){for(var x=N-I;x!==N&&C[x]===0;)x++;for(var D=new Uint8Array(_+(N-x)),U=_;x!==N;)D[U++]=C[x++];return D}}}function m(f){var g=h(f);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:m}}var FC=MC,jC=FC;const qw=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},qC=t=>new TextEncoder().encode(t),HC=t=>new TextDecoder().decode(t);let WC=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},zC=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Hw(this,e)}},VC=class{constructor(e){this.decoders=e}or(e){return Hw(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const Hw=(t,e)=>new VC({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let KC=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new WC(e,r,n),this.decoder=new zC(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const Il=({name:t,prefix:e,encode:r,decode:n})=>new KC(t,e,r,n),ja=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=jC(r,e);return Il({prefix:t,name:e,encode:n,decode:i=>qw(s(i))})},GC=(t,e,r,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},YC=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Kt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Il({prefix:e,name:t,encode(s){return YC(s,n,r)},decode(s){return GC(s,n,r,t)}}),ZC=Il({prefix:"\0",name:"identity",encode:t=>HC(t),decode:t=>qC(t)});var JC=Object.freeze({__proto__:null,identity:ZC});const XC=Kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var QC=Object.freeze({__proto__:null,base2:XC});const eA=Kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var tA=Object.freeze({__proto__:null,base8:eA});const rA=ja({prefix:"9",name:"base10",alphabet:"0123456789"});var nA=Object.freeze({__proto__:null,base10:rA});const sA=Kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),iA=Kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var oA=Object.freeze({__proto__:null,base16:sA,base16upper:iA});const aA=Kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),cA=Kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),lA=Kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),uA=Kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),dA=Kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hA=Kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),fA=Kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),pA=Kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),gA=Kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var mA=Object.freeze({__proto__:null,base32:aA,base32upper:cA,base32pad:lA,base32padupper:uA,base32hex:dA,base32hexupper:hA,base32hexpad:fA,base32hexpadupper:pA,base32z:gA});const wA=ja({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),yA=ja({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var bA=Object.freeze({__proto__:null,base36:wA,base36upper:yA});const EA=ja({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),vA=ja({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var _A=Object.freeze({__proto__:null,base58btc:EA,base58flickr:vA});const CA=Kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),AA=Kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),IA=Kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),SA=Kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var TA=Object.freeze({__proto__:null,base64:CA,base64pad:AA,base64url:IA,base64urlpad:SA});const Ww=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),NA=Ww.reduce((t,e,r)=>(t[r]=e,t),[]),xA=Ww.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function OA(t){return t.reduce((e,r)=>(e+=NA[r],e),"")}function RA(t){const e=[];for(const r of t){const n=xA[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const PA=Il({prefix:"🚀",name:"base256emoji",encode:OA,decode:RA});var DA=Object.freeze({__proto__:null,base256emoji:PA}),kA=zw,up=128,UA=-128,$A=Math.pow(2,31);function zw(t,e,r){e=e||[],r=r||0;for(var n=r;t>=$A;)e[r++]=t&255|up,t/=128;for(;t&UA;)e[r++]=t&255|up,t>>>=7;return e[r]=t|0,zw.bytes=r-n+1,e}var BA=Cd,LA=128,dp=127;function Cd(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw Cd.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&dp)<<s:(o&dp)*Math.pow(2,s),s+=7}while(o>=LA);return Cd.bytes=i-n,r}var MA=Math.pow(2,7),FA=Math.pow(2,14),jA=Math.pow(2,21),qA=Math.pow(2,28),HA=Math.pow(2,35),WA=Math.pow(2,42),zA=Math.pow(2,49),VA=Math.pow(2,56),KA=Math.pow(2,63),GA=function(t){return t<MA?1:t<FA?2:t<jA?3:t<qA?4:t<HA?5:t<WA?6:t<zA?7:t<VA?8:t<KA?9:10},YA={encode:kA,decode:BA,encodingLength:GA},Vw=YA;const hp=(t,e,r=0)=>(Vw.encode(t,e,r),e),fp=t=>Vw.encodingLength(t),Ad=(t,e)=>{const r=e.byteLength,n=fp(t),s=n+fp(r),i=new Uint8Array(s+r);return hp(t,i,0),hp(r,i,n),i.set(e,s),new ZA(t,r,e,i)};let ZA=class{constructor(e,r,n,s){this.code=e,this.size=r,this.digest=n,this.bytes=s}};const Kw=({name:t,code:e,encode:r})=>new JA(t,e,r);let JA=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Ad(this.code,r):r.then(n=>Ad(this.code,n))}else throw Error("Unknown type, must be binary type")}};const Gw=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),XA=Kw({name:"sha2-256",code:18,encode:Gw("SHA-256")}),QA=Kw({name:"sha2-512",code:19,encode:Gw("SHA-512")});var eI=Object.freeze({__proto__:null,sha256:XA,sha512:QA});const Yw=0,tI="identity",Zw=qw,rI=t=>Ad(Yw,Zw(t)),nI={code:Yw,name:tI,encode:Zw,digest:rI};var sI=Object.freeze({__proto__:null,identity:nI});new TextEncoder,new TextDecoder;const pp={...JC,...QC,...tA,...nA,...oA,...mA,...bA,..._A,...TA,...DA};({...eI,...sI});function Jw(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const gp=Jw("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),gu=Jw("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Fw(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Xw={utf8:gp,"utf-8":gp,hex:pp.base16,latin1:gu,ascii:gu,binary:gu,...pp};function Sl(t,e="utf8"){const r=Xw[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function lo(t,e="utf8"){const r=Xw[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Rh(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function mp(t){return oi(Sl(lo(t,Al),Lw))}function Zc(t){return Sl(lo(Jn(t),Lw),Al)}function Qw(t){const e=lo(BC,lp),r=$C+Sl(jw([e,t]),lp);return[kC,UC,r].join(DC)}function iI(t){return Sl(t,Al)}function oI(t){return lo(t,Al)}function aI(t){return lo([Zc(t.header),Zc(t.payload)].join(Yc),Mw)}function cI(t){return[Zc(t.header),Zc(t.payload),iI(t.signature)].join(Yc)}function Id(t){const e=t.split(Yc),r=mp(e[0]),n=mp(e[1]),s=oI(e[2]),i=lo(e.slice(0,2).join(Yc),Mw);return{header:r,payload:n,signature:s,data:i}}function wp(t=Tw(LC)){const e=Bw.getPublicKey(t);return{secretKey:jw([t,e]),publicKey:e}}async function lI(t,e,r,n,s=ne.fromMiliseconds(Date.now())){const i={alg:RC,typ:PC},o=Qw(n.publicKey),a=s+r,c={iss:o,sub:t,aud:e,iat:s,exp:a},l=aI({header:i,payload:c}),u=Bw.sign(l,n.secretKey.slice(0,32));return cI({header:i,payload:c,signature:u})}var yp=function(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))},uI=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}(),dI=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),hI=function(){function t(e,r,n,s){this.name=e,this.version=r,this.os=n,this.bot=s,this.type="bot-device"}return t}(),fI=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),pI=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),gI=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,mI=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,bp=3,wI=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",gI]],Ep=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function yI(t){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new pI:typeof navigator<"u"?EI(navigator.userAgent):_I()}function bI(t){return t!==""&&wI.reduce(function(e,r){var n=r[0],s=r[1];if(e)return e;var i=s.exec(t);return!!i&&[n,i]},!1)}function EI(t){var e=bI(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new fI;var s=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);s?s.length<bp&&(s=yp(yp([],s,!0),CI(bp-s.length),!0)):s=[];var i=s.join("."),o=vI(t),a=mI.exec(t);return a&&a[1]?new hI(r,i,o,a[1]):new uI(r,i,o)}function vI(t){for(var e=0,r=Ep.length;e<r;e++){var n=Ep[e],s=n[0],i=n[1],o=i.exec(t);if(o)return s}return null}function _I(){var t=typeof process<"u"&&process.version;return t?new dI(process.version.slice(1)):null}function CI(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var ot={},vp;function ey(){if(vp)return ot;vp=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.getLocalStorage=ot.getLocalStorageOrThrow=ot.getCrypto=ot.getCryptoOrThrow=ot.getLocation=ot.getLocationOrThrow=ot.getNavigator=ot.getNavigatorOrThrow=ot.getDocument=ot.getDocumentOrThrow=ot.getFromWindowOrThrow=ot.getFromWindow=void 0;function t(h){let m;return typeof window<"u"&&typeof window[h]<"u"&&(m=window[h]),m}ot.getFromWindow=t;function e(h){const m=t(h);if(!m)throw new Error(`${h} is not defined in Window`);return m}ot.getFromWindowOrThrow=e;function r(){return e("document")}ot.getDocumentOrThrow=r;function n(){return t("document")}ot.getDocument=n;function s(){return e("navigator")}ot.getNavigatorOrThrow=s;function i(){return t("navigator")}ot.getNavigator=i;function o(){return e("location")}ot.getLocationOrThrow=o;function a(){return t("location")}ot.getLocation=a;function c(){return e("crypto")}ot.getCryptoOrThrow=c;function l(){return t("crypto")}ot.getCrypto=l;function u(){return e("localStorage")}ot.getLocalStorageOrThrow=u;function d(){return t("localStorage")}return ot.getLocalStorage=d,ot}var Xn=ey(),Io={},_p;function AI(){if(_p)return Io;_p=1,Object.defineProperty(Io,"__esModule",{value:!0}),Io.getWindowMetadata=void 0;const t=ey();function e(){let r,n;try{r=t.getDocumentOrThrow(),n=t.getLocationOrThrow()}catch{return null}function s(){const m=r.getElementsByTagName("link"),f=[];for(let g=0;g<m.length;g++){const _=m[g],I=_.getAttribute("rel");if(I&&I.toLowerCase().indexOf("icon")>-1){const N=_.getAttribute("href");if(N)if(N.toLowerCase().indexOf("https:")===-1&&N.toLowerCase().indexOf("http:")===-1&&N.indexOf("//")!==0){let C=n.protocol+"//"+n.host;if(N.indexOf("/")===0)C+=N;else{const E=n.pathname.split("/");E.pop();const v=E.join("/");C+=v+"/"+N}f.push(C)}else if(N.indexOf("//")===0){const C=n.protocol+N;f.push(C)}else f.push(N)}}return f}function i(...m){const f=r.getElementsByTagName("meta");for(let g=0;g<f.length;g++){const _=f[g],I=["itemprop","property","name"].map(N=>_.getAttribute(N)).filter(N=>N?m.includes(N):!1);if(I.length&&I){const N=_.getAttribute("content");if(N)return N}}return""}function o(){let m=i("name","og:site_name","og:title","twitter:title");return m||(m=r.title),m}function a(){return i("description","og:description","twitter:description","keywords")}const c=o(),l=a(),u=n.origin,d=s();return{description:l,url:u,icons:d,name:c}}return Io.getWindowMetadata=e,Io}var II=AI();function da(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function Sd(t){return da(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const ty="2.30.6";let So={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:r})=>e?`${t??"https://viem.sh"}${e}${r?`#${r}`:""}`:void 0,version:`viem@${ty}`};class ai extends Error{constructor(e,r={}){var a;const n=(()=>{var c;return r.cause instanceof ai?r.cause.details:(c=r.cause)!=null&&c.message?r.cause.message:r.details})(),s=r.cause instanceof ai&&r.cause.docsPath||r.docsPath,i=(a=So.getDocsUrl)==null?void 0:a.call(So,{...r,docsPath:s}),o=[e||"An error occurred.","",...r.metaMessages?[...r.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...n?[`Details: ${n}`]:[],...So.version?[`Version: ${So.version}`]:[]].join(`
`);super(o,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=r.metaMessages,this.name=r.name??this.name,this.shortMessage=e,this.version=ty}walk(e){return ry(this,e)}}function ry(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?ry(t.cause,e):e?null:t}class ny extends ai{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${r}).`,{name:"SizeExceedsPaddingSizeError"})}}function uo(t,{dir:e,size:r=32}={}){return typeof t=="string"?SI(t,{dir:e,size:r}):TI(t,{dir:e,size:r})}function SI(t,{dir:e,size:r=32}={}){if(r===null)return t;const n=t.replace("0x","");if(n.length>r*2)throw new ny({size:Math.ceil(n.length/2),targetSize:r,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](r*2,"0")}`}function TI(t,{dir:e,size:r=32}={}){if(r===null)return t;if(t.length>r)throw new ny({size:t.length,targetSize:r,type:"bytes"});const n=new Uint8Array(r);for(let s=0;s<r;s++){const i=e==="right";n[i?s:r-s-1]=t[i?s:t.length-s-1]}return n}class NI extends ai{constructor({max:e,min:r,signed:n,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${r} to ${e})`:`(above ${r})`}`,{name:"IntegerOutOfRangeError"})}}class xI extends ai{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed ${r} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function ho(t,{size:e}){if(Sd(t)>e)throw new xI({givenSize:Sd(t),maxSize:e})}function Td(t,e={}){const{signed:r}=e;e.size&&ho(t,{size:e.size});const n=BigInt(t);if(!r)return n;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return n<=i?n:n-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function OI(t,e={}){return Number(Td(t,e))}const RI=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Nd(t,e={}){return typeof t=="number"||typeof t=="bigint"?iy(t,e):typeof t=="string"?kI(t,e):typeof t=="boolean"?PI(t,e):sy(t,e)}function PI(t,e={}){const r=`0x${Number(t)}`;return typeof e.size=="number"?(ho(r,{size:e.size}),uo(r,{size:e.size})):r}function sy(t,e={}){let r="";for(let s=0;s<t.length;s++)r+=RI[t[s]];const n=`0x${r}`;return typeof e.size=="number"?(ho(n,{size:e.size}),uo(n,{dir:"right",size:e.size})):n}function iy(t,e={}){const{signed:r,size:n}=e,s=BigInt(t);let i;n?r?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&r?-i-1n:0;if(i&&s>i||s<o){const c=typeof t=="bigint"?"n":"";throw new NI({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:r,size:n,value:`${t}${c}`})}const a=`0x${(r&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?uo(a,{size:n}):a}const DI=new TextEncoder;function kI(t,e={}){const r=DI.encode(t);return sy(r,e)}const UI=new TextEncoder;function $I(t,e={}){return typeof t=="number"||typeof t=="bigint"?LI(t,e):typeof t=="boolean"?BI(t,e):da(t)?oy(t,e):ay(t,e)}function BI(t,e={}){const r=new Uint8Array(1);return r[0]=Number(t),typeof e.size=="number"?(ho(r,{size:e.size}),uo(r,{size:e.size})):r}const Un={zero:48,nine:57,A:65,F:70,a:97,f:102};function Cp(t){if(t>=Un.zero&&t<=Un.nine)return t-Un.zero;if(t>=Un.A&&t<=Un.F)return t-(Un.A-10);if(t>=Un.a&&t<=Un.f)return t-(Un.a-10)}function oy(t,e={}){let r=t;e.size&&(ho(r,{size:e.size}),r=uo(r,{dir:"right",size:e.size}));let n=r.slice(2);n.length%2&&(n=`0${n}`);const s=n.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=Cp(n.charCodeAt(a++)),l=Cp(n.charCodeAt(a++));if(c===void 0||l===void 0)throw new ai(`Invalid byte sequence ("${n[a-2]}${n[a-1]}" in "${n}").`);i[o]=c*16+l}return i}function LI(t,e){const r=iy(t,e);return oy(r)}function ay(t,e={}){const r=UI.encode(t);return typeof e.size=="number"?(ho(r,{size:e.size}),uo(r,{dir:"right",size:e.size})):r}function cy(t,e){const r=e||"hex",n=Ub(da(t,{strict:!1})?$I(t):t);return r==="bytes"?n:Nd(n)}class MI extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const mu=new MI(8192);function FI(t,e){if(mu.has(`${t}.${e}`))return mu.get(`${t}.${e}`);const r=t.substring(2).toLowerCase(),n=cy(ay(r),"bytes"),s=r.split("");for(let o=0;o<40;o+=2)n[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(n[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return mu.set(`${t}.${e}`,i),i}function jI(t){const e=cy(`0x${t.substring(4)}`).substring(26);return FI(`0x${e}`)}async function qI({hash:t,signature:e}){const r=da(t)?t:Nd(t),{secp256k1:n}=await mr(async()=>{const{secp256k1:o}=await Promise.resolve().then(()=>yS);return{secp256k1:o}},void 0);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:u,v:d,yParity:h}=e,m=Number(h??d),f=Ap(m);return new n.Signature(Td(l),Td(u)).addRecoveryBit(f)}const o=da(e)?e:Nd(e);if(Sd(o)!==65)throw new Error("invalid signature length");const a=OI(`0x${o.slice(130)}`),c=Ap(a);return n.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(r.substring(2)).toHex(!1)}`}function Ap(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function HI({hash:t,signature:e}){return jI(await qI({hash:t,signature:e}))}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ph=BigInt(0),xd=BigInt(1);function qa(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Dh(t){if(!qa(t))throw new Error("Uint8Array expected")}function ha(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function pc(t){const e=t.toString(16);return e.length&1?"0"+e:e}function ly(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Ph:BigInt("0x"+t)}const uy=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",WI=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function fa(t){if(Dh(t),uy)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=WI[t[r]];return e}const $n={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ip(t){if(t>=$n._0&&t<=$n._9)return t-$n._0;if(t>=$n.A&&t<=$n.F)return t-($n.A-10);if(t>=$n.a&&t<=$n.f)return t-($n.a-10)}function Jc(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(uy)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){const o=Ip(t.charCodeAt(i)),a=Ip(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function Qs(t){return ly(fa(t))}function dy(t){return Dh(t),ly(fa(Uint8Array.from(t).reverse()))}function Ha(t,e){return Jc(t.toString(16).padStart(e*2,"0"))}function hy(t,e){return Ha(t,e).reverse()}function Wr(t,e,r){let n;if(typeof e=="string")try{n=Jc(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(qa(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(t+" of length "+r+" expected, got "+s);return n}function Xc(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];Dh(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}const wu=t=>typeof t=="bigint"&&Ph<=t;function kh(t,e,r){return wu(t)&&wu(e)&&wu(r)&&e<=t&&t<r}function Yi(t,e,r,n){if(!kh(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function zI(t){let e;for(e=0;t>Ph;t>>=xd,e+=1);return e}const Tl=t=>(xd<<BigInt(t))-xd,yu=t=>new Uint8Array(t),Sp=t=>Uint8Array.from(t);function VI(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=yu(t),s=yu(t),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...d)=>r(s,n,...d),c=(d=yu(0))=>{s=a(Sp([0]),d),n=a(),d.length!==0&&(s=a(Sp([1]),d),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const h=[];for(;d<e;){n=a();const m=n.slice();h.push(m),d+=n.length}return Xc(...h)};return(d,h)=>{o(),c(d);let m;for(;!(m=h(l()));)c();return o(),m}}const KI={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||qa(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Nl(t,e,r={}){const n=(s,i,o)=>{const a=KI[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(r))n(s,i,!0);return t}function Tp(t){const e=new WeakMap;return(r,...n)=>{const s=e.get(r);if(s!==void 0)return s;const i=t(r,...n);return e.set(r,i),i}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Cr=BigInt(0),nr=BigInt(1),Gs=BigInt(2),GI=BigInt(3),fy=BigInt(4),py=BigInt(5),gy=BigInt(8);function Er(t,e){const r=t%e;return r>=Cr?r:e+r}function Mr(t,e,r){let n=t;for(;e-- >Cr;)n*=n,n%=r;return n}function Od(t,e){if(t===Cr)throw new Error("invert: expected non-zero number");if(e<=Cr)throw new Error("invert: expected positive modulus, got "+e);let r=Er(t,e),n=e,s=Cr,i=nr;for(;r!==Cr;){const a=n/r,c=n%r,l=s-i*a;n=r,r=c,s=i,i=l}if(n!==nr)throw new Error("invert: does not exist");return Er(s,e)}function my(t,e){const r=(t.ORDER+nr)/fy,n=t.pow(e,r);if(!t.eql(t.sqr(n),e))throw new Error("Cannot find square root");return n}function YI(t,e){const r=(t.ORDER-py)/gy,n=t.mul(e,Gs),s=t.pow(n,r),i=t.mul(e,s),o=t.mul(t.mul(i,Gs),s),a=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function ZI(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-nr,r=0;for(;e%Gs===Cr;)e/=Gs,r++;let n=Gs;const s=Uh(t);for(;Np(s,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return my;let i=s.pow(n,e);const o=(e+nr)/Gs;return function(c,l){if(c.is0(l))return l;if(Np(c,l)!==1)throw new Error("Cannot find square root");let u=r,d=c.mul(c.ONE,i),h=c.pow(l,e),m=c.pow(l,o);for(;!c.eql(h,c.ONE);){if(c.is0(h))return c.ZERO;let f=1,g=c.sqr(h);for(;!c.eql(g,c.ONE);)if(f++,g=c.sqr(g),f===u)throw new Error("Cannot find square root");const _=nr<<BigInt(u-f-1),I=c.pow(d,_);u=f,d=c.sqr(I),h=c.mul(h,d),m=c.mul(m,I)}return m}}function JI(t){return t%fy===GI?my:t%gy===py?YI:ZI(t)}const XI=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function QI(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=XI.reduce((n,s)=>(n[s]="function",n),e);return Nl(t,r)}function eS(t,e,r){if(r<Cr)throw new Error("invalid exponent, negatives unsupported");if(r===Cr)return t.ONE;if(r===nr)return e;let n=t.ONE,s=e;for(;r>Cr;)r&nr&&(n=t.mul(n,s)),s=t.sqr(s),r>>=nr;return n}function wy(t,e,r=!1){const n=new Array(e.length).fill(r?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(n[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(n[c]=t.mul(o,n[c]),t.mul(o,a)),i),n}function Np(t,e){const r=(t.ORDER-nr)/Gs,n=t.pow(e,r),s=t.eql(n,t.ONE),i=t.eql(n,t.ZERO),o=t.eql(n,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function yy(t,e){e!==void 0&&$b(e);const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Uh(t,e,r=!1,n={}){if(t<=Cr)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=yy(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:s,BYTES:i,MASK:Tl(s),ZERO:Cr,ONE:nr,create:c=>Er(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Cr<=c&&c<t},is0:c=>c===Cr,isOdd:c=>(c&nr)===nr,neg:c=>Er(-c,t),eql:(c,l)=>c===l,sqr:c=>Er(c*c,t),add:(c,l)=>Er(c+l,t),sub:(c,l)=>Er(c-l,t),mul:(c,l)=>Er(c*l,t),pow:(c,l)=>eS(a,c,l),div:(c,l)=>Er(c*Od(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Od(c,t),sqrt:n.sqrt||(c=>(o||(o=JI(t)),o(a,c))),toBytes:c=>r?hy(c,i):Ha(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return r?dy(c):Qs(c)},invertBatch:c=>wy(a,c),cmov:(c,l,u)=>u?l:c});return Object.freeze(a)}function by(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Ey(t){const e=by(t);return e+Math.ceil(e/2)}function tS(t,e,r=!1){const n=t.length,s=by(e),i=Ey(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=r?dy(t):Qs(t),a=Er(o,e-nr)+nr;return r?hy(a,s):Ha(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const xp=BigInt(0),Rd=BigInt(1);function bu(t,e){const r=e.negate();return t?r:e}function vy(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Eu(t,e){vy(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1),s=2**t,i=Tl(t),o=BigInt(t);return{windows:r,windowSize:n,mask:i,maxNumber:s,shiftBy:o}}function Op(t,e,r){const{windowSize:n,mask:s,maxNumber:i,shiftBy:o}=r;let a=Number(t&s),c=t>>o;a>n&&(a-=i,c+=Rd);const l=e*n,u=l+Math.abs(a)-1,d=a===0,h=a<0,m=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:m,offsetF:l}}function rS(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function nS(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const vu=new WeakMap,_y=new WeakMap;function _u(t){return _y.get(t)||1}function sS(t,e){return{constTimeNegate:bu,hasPrecomputes(r){return _u(r)!==1},unsafeLadder(r,n,s=t.ZERO){let i=r;for(;n>xp;)n&Rd&&(s=s.add(i)),i=i.double(),n>>=Rd;return s},precomputeWindow(r,n){const{windows:s,windowSize:i}=Eu(n,e),o=[];let a=r,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,s){let i=t.ZERO,o=t.BASE;const a=Eu(r,e);for(let c=0;c<a.windows;c++){const{nextN:l,offset:u,isZero:d,isNeg:h,isNegF:m,offsetF:f}=Op(s,c,a);s=l,d?o=o.add(bu(m,n[f])):i=i.add(bu(h,n[u]))}return{p:i,f:o}},wNAFUnsafe(r,n,s,i=t.ZERO){const o=Eu(r,e);for(let a=0;a<o.windows&&s!==xp;a++){const{nextN:c,offset:l,isZero:u,isNeg:d}=Op(s,a,o);if(s=c,!u){const h=n[l];i=i.add(d?h.negate():h)}}return i},getPrecomputes(r,n,s){let i=vu.get(n);return i||(i=this.precomputeWindow(n,r),r!==1&&vu.set(n,s(i))),i},wNAFCached(r,n,s){const i=_u(r);return this.wNAF(i,this.getPrecomputes(i,r,s),n)},wNAFCachedUnsafe(r,n,s,i){const o=_u(r);return o===1?this.unsafeLadder(r,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,r,s),n,i)},setWindowSize(r,n){vy(n,e),_y.set(r,n),vu.delete(r)}}}function iS(t,e,r,n){rS(r,t),nS(n,e);const s=r.length,i=n.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=zI(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=Tl(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let h=o;for(let m=d;m>=0;m-=c){u.fill(o);for(let g=0;g<i;g++){const _=n[g],I=Number(_>>BigInt(m)&l);u[I]=u[I].add(r[g])}let f=o;for(let g=u.length-1,_=o;g>0;g--)_=_.add(u[g]),f=f.add(_);if(h=h.add(f),m!==0)for(let g=0;g<c;g++)h=h.double()}return h}function Cy(t){return QI(t.Fp),Nl(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...yy(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Rp(t){t.lowS!==void 0&&ha("lowS",t.lowS),t.prehash!==void 0&&ha("prehash",t.prehash)}function oS(t){const e=Cy(t);Nl(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:r,Fp:n,a:s}=e;if(r){if(!n.eql(s,n.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...e})}class aS extends Error{constructor(e=""){super(e)}}const qn={Err:aS,_tlv:{encode:(t,e)=>{const{Err:r}=qn;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const n=e.length/2,s=pc(n);if(s.length/2&128)throw new r("tlv.encode: long form length too big");const i=n>127?pc(s.length/2|128):"";return pc(t)+i+s+e},decode(t,e){const{Err:r}=qn;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(n+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=qn;if(t<zn)throw new e("integer: negative integers are not allowed");let r=pc(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=qn;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return Qs(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=qn,s=Wr("signature",t),{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:l,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(t){const{_tlv:e,_int:r}=qn,n=e.encode(2,r.encode(t.r)),s=e.encode(2,r.encode(t.s)),i=n+s;return e.encode(48,i)}};function Cu(t,e){return fa(Ha(t,e))}const zn=BigInt(0),$t=BigInt(1);BigInt(2);const Au=BigInt(3),cS=BigInt(4);function lS(t){const e=oS(t),{Fp:r}=e,n=Uh(e.n,e.nBitLength),s=e.toBytes||((C,E,v)=>{const A=E.toAffine();return Xc(Uint8Array.from([4]),r.toBytes(A.x),r.toBytes(A.y))}),i=e.fromBytes||(C=>{const E=C.subarray(1),v=r.fromBytes(E.subarray(0,r.BYTES)),A=r.fromBytes(E.subarray(r.BYTES,2*r.BYTES));return{x:v,y:A}});function o(C){const{a:E,b:v}=e,A=r.sqr(C),x=r.mul(A,C);return r.add(r.add(x,r.mul(C,E)),v)}function a(C,E){const v=r.sqr(E),A=o(C);return r.eql(v,A)}if(!a(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const c=r.mul(r.pow(e.a,Au),cS),l=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(c,l)))throw new Error("bad curve params: a or b");function u(C){return kh(C,$t,e.n)}function d(C){const{allowedPrivateKeyLengths:E,nByteLength:v,wrapPrivateKey:A,n:x}=e;if(E&&typeof C!="bigint"){if(qa(C)&&(C=fa(C)),typeof C!="string"||!E.includes(C.length))throw new Error("invalid private key");C=C.padStart(v*2,"0")}let D;try{D=typeof C=="bigint"?C:Qs(Wr("private key",C,v))}catch{throw new Error("invalid private key, expected hex or "+v+" bytes, got "+typeof C)}return A&&(D=Er(D,x)),Yi("private key",D,$t,x),D}function h(C){if(!(C instanceof g))throw new Error("ProjectivePoint expected")}const m=Tp((C,E)=>{const{px:v,py:A,pz:x}=C;if(r.eql(x,r.ONE))return{x:v,y:A};const D=C.is0();E==null&&(E=D?r.ONE:r.inv(x));const U=r.mul(v,E),M=r.mul(A,E),$=r.mul(x,E);if(D)return{x:r.ZERO,y:r.ZERO};if(!r.eql($,r.ONE))throw new Error("invZ was invalid");return{x:U,y:M}}),f=Tp(C=>{if(C.is0()){if(e.allowInfinityPoint&&!r.is0(C.py))return;throw new Error("bad point: ZERO")}const{x:E,y:v}=C.toAffine();if(!r.isValid(E)||!r.isValid(v))throw new Error("bad point: x or y not FE");if(!a(E,v))throw new Error("bad point: equation left != right");if(!C.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class g{constructor(E,v,A){if(E==null||!r.isValid(E))throw new Error("x required");if(v==null||!r.isValid(v)||r.is0(v))throw new Error("y required");if(A==null||!r.isValid(A))throw new Error("z required");this.px=E,this.py=v,this.pz=A,Object.freeze(this)}static fromAffine(E){const{x:v,y:A}=E||{};if(!E||!r.isValid(v)||!r.isValid(A))throw new Error("invalid affine point");if(E instanceof g)throw new Error("projective point not allowed");const x=D=>r.eql(D,r.ZERO);return x(v)&&x(A)?g.ZERO:new g(v,A,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(E){const v=wy(r,E.map(A=>A.pz));return E.map((A,x)=>A.toAffine(v[x])).map(g.fromAffine)}static fromHex(E){const v=g.fromAffine(i(Wr("pointHex",E)));return v.assertValidity(),v}static fromPrivateKey(E){return g.BASE.multiply(d(E))}static msm(E,v){return iS(g,n,E,v)}_setWindowSize(E){N.setWindowSize(this,E)}assertValidity(){f(this)}hasEvenY(){const{y:E}=this.toAffine();if(r.isOdd)return!r.isOdd(E);throw new Error("Field doesn't support isOdd")}equals(E){h(E);const{px:v,py:A,pz:x}=this,{px:D,py:U,pz:M}=E,$=r.eql(r.mul(v,M),r.mul(D,x)),F=r.eql(r.mul(A,M),r.mul(U,x));return $&&F}negate(){return new g(this.px,r.neg(this.py),this.pz)}double(){const{a:E,b:v}=e,A=r.mul(v,Au),{px:x,py:D,pz:U}=this;let M=r.ZERO,$=r.ZERO,F=r.ZERO,W=r.mul(x,x),q=r.mul(D,D),y=r.mul(U,U),b=r.mul(x,D);return b=r.add(b,b),F=r.mul(x,U),F=r.add(F,F),M=r.mul(E,F),$=r.mul(A,y),$=r.add(M,$),M=r.sub(q,$),$=r.add(q,$),$=r.mul(M,$),M=r.mul(b,M),F=r.mul(A,F),y=r.mul(E,y),b=r.sub(W,y),b=r.mul(E,b),b=r.add(b,F),F=r.add(W,W),W=r.add(F,W),W=r.add(W,y),W=r.mul(W,b),$=r.add($,W),y=r.mul(D,U),y=r.add(y,y),W=r.mul(y,b),M=r.sub(M,W),F=r.mul(y,q),F=r.add(F,F),F=r.add(F,F),new g(M,$,F)}add(E){h(E);const{px:v,py:A,pz:x}=this,{px:D,py:U,pz:M}=E;let $=r.ZERO,F=r.ZERO,W=r.ZERO;const q=e.a,y=r.mul(e.b,Au);let b=r.mul(v,D),O=r.mul(A,U),B=r.mul(x,M),k=r.add(v,A),L=r.add(D,U);k=r.mul(k,L),L=r.add(b,O),k=r.sub(k,L),L=r.add(v,x);let H=r.add(D,M);return L=r.mul(L,H),H=r.add(b,B),L=r.sub(L,H),H=r.add(A,x),$=r.add(U,M),H=r.mul(H,$),$=r.add(O,B),H=r.sub(H,$),W=r.mul(q,L),$=r.mul(y,B),W=r.add($,W),$=r.sub(O,W),W=r.add(O,W),F=r.mul($,W),O=r.add(b,b),O=r.add(O,b),B=r.mul(q,B),L=r.mul(y,L),O=r.add(O,B),B=r.sub(b,B),B=r.mul(q,B),L=r.add(L,B),b=r.mul(O,L),F=r.add(F,b),b=r.mul(H,L),$=r.mul(k,$),$=r.sub($,b),b=r.mul(k,O),W=r.mul(H,W),W=r.add(W,b),new g($,F,W)}subtract(E){return this.add(E.negate())}is0(){return this.equals(g.ZERO)}wNAF(E){return N.wNAFCached(this,E,g.normalizeZ)}multiplyUnsafe(E){const{endo:v,n:A}=e;Yi("scalar",E,zn,A);const x=g.ZERO;if(E===zn)return x;if(this.is0()||E===$t)return this;if(!v||N.hasPrecomputes(this))return N.wNAFCachedUnsafe(this,E,g.normalizeZ);let{k1neg:D,k1:U,k2neg:M,k2:$}=v.splitScalar(E),F=x,W=x,q=this;for(;U>zn||$>zn;)U&$t&&(F=F.add(q)),$&$t&&(W=W.add(q)),q=q.double(),U>>=$t,$>>=$t;return D&&(F=F.negate()),M&&(W=W.negate()),W=new g(r.mul(W.px,v.beta),W.py,W.pz),F.add(W)}multiply(E){const{endo:v,n:A}=e;Yi("scalar",E,$t,A);let x,D;if(v){const{k1neg:U,k1:M,k2neg:$,k2:F}=v.splitScalar(E);let{p:W,f:q}=this.wNAF(M),{p:y,f:b}=this.wNAF(F);W=N.constTimeNegate(U,W),y=N.constTimeNegate($,y),y=new g(r.mul(y.px,v.beta),y.py,y.pz),x=W.add(y),D=q.add(b)}else{const{p:U,f:M}=this.wNAF(E);x=U,D=M}return g.normalizeZ([x,D])[0]}multiplyAndAddUnsafe(E,v,A){const x=g.BASE,D=(M,$)=>$===zn||$===$t||!M.equals(x)?M.multiplyUnsafe($):M.multiply($),U=D(this,v).add(D(E,A));return U.is0()?void 0:U}toAffine(E){return m(this,E)}isTorsionFree(){const{h:E,isTorsionFree:v}=e;if(E===$t)return!0;if(v)return v(g,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:E,clearCofactor:v}=e;return E===$t?this:v?v(g,this):this.multiplyUnsafe(e.h)}toRawBytes(E=!0){return ha("isCompressed",E),this.assertValidity(),s(g,this,E)}toHex(E=!0){return ha("isCompressed",E),fa(this.toRawBytes(E))}}g.BASE=new g(e.Gx,e.Gy,r.ONE),g.ZERO=new g(r.ZERO,r.ONE,r.ZERO);const{endo:_,nBitLength:I}=e,N=sS(g,_?Math.ceil(I/2):I);return{CURVE:e,ProjectivePoint:g,normPrivateKeyToScalar:d,weierstrassEquation:o,isWithinCurveOrder:u}}function uS(t){const e=Cy(t);return Nl(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function dS(t){const e=uS(t),{Fp:r,n,nByteLength:s,nBitLength:i}=e,o=r.BYTES+1,a=2*r.BYTES+1;function c(y){return Er(y,n)}function l(y){return Od(y,n)}const{ProjectivePoint:u,normPrivateKeyToScalar:d,weierstrassEquation:h,isWithinCurveOrder:m}=lS({...e,toBytes(y,b,O){const B=b.toAffine(),k=r.toBytes(B.x),L=Xc;return ha("isCompressed",O),O?L(Uint8Array.from([b.hasEvenY()?2:3]),k):L(Uint8Array.from([4]),k,r.toBytes(B.y))},fromBytes(y){const b=y.length,O=y[0],B=y.subarray(1);if(b===o&&(O===2||O===3)){const k=Qs(B);if(!kh(k,$t,r.ORDER))throw new Error("Point is not on curve");const L=h(k);let H;try{H=r.sqrt(L)}catch(Z){const re=Z instanceof Error?": "+Z.message:"";throw new Error("Point is not on curve"+re)}const K=(H&$t)===$t;return(O&1)===1!==K&&(H=r.neg(H)),{x:k,y:H}}else if(b===a&&O===4){const k=r.fromBytes(B.subarray(0,r.BYTES)),L=r.fromBytes(B.subarray(r.BYTES,2*r.BYTES));return{x:k,y:L}}else{const k=o,L=a;throw new Error("invalid Point, expected length of "+k+", or uncompressed "+L+", got "+b)}}});function f(y){const b=n>>$t;return y>b}function g(y){return f(y)?c(-y):y}const _=(y,b,O)=>Qs(y.slice(b,O));class I{constructor(b,O,B){Yi("r",b,$t,n),Yi("s",O,$t,n),this.r=b,this.s=O,B!=null&&(this.recovery=B),Object.freeze(this)}static fromCompact(b){const O=s;return b=Wr("compactSignature",b,O*2),new I(_(b,0,O),_(b,O,2*O))}static fromDER(b){const{r:O,s:B}=qn.toSig(Wr("DER",b));return new I(O,B)}assertValidity(){}addRecoveryBit(b){return new I(this.r,this.s,b)}recoverPublicKey(b){const{r:O,s:B,recovery:k}=this,L=x(Wr("msgHash",b));if(k==null||![0,1,2,3].includes(k))throw new Error("recovery id invalid");const H=k===2||k===3?O+e.n:O;if(H>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const K=(k&1)===0?"02":"03",Q=u.fromHex(K+Cu(H,r.BYTES)),Z=l(H),re=c(-L*Z),we=c(B*Z),Ee=u.BASE.multiplyAndAddUnsafe(Q,re,we);if(!Ee)throw new Error("point at infinify");return Ee.assertValidity(),Ee}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new I(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return Jc(this.toDERHex())}toDERHex(){return qn.hexFromSig(this)}toCompactRawBytes(){return Jc(this.toCompactHex())}toCompactHex(){const b=s;return Cu(this.r,b)+Cu(this.s,b)}}const N={isValidPrivateKey(y){try{return d(y),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const y=Ey(e.n);return tS(e.randomBytes(y),e.n)},precompute(y=8,b=u.BASE){return b._setWindowSize(y),b.multiply(BigInt(3)),b}};function C(y,b=!0){return u.fromPrivateKey(y).toRawBytes(b)}function E(y){if(typeof y=="bigint")return!1;if(y instanceof u)return!0;const O=Wr("key",y).length,B=r.BYTES,k=B+1,L=2*B+1;if(!(e.allowedPrivateKeyLengths||s===k))return O===k||O===L}function v(y,b,O=!0){if(E(y)===!0)throw new Error("first arg must be private key");if(E(b)===!1)throw new Error("second arg must be public key");return u.fromHex(b).multiply(d(y)).toRawBytes(O)}const A=e.bits2int||function(y){if(y.length>8192)throw new Error("input is too large");const b=Qs(y),O=y.length*8-i;return O>0?b>>BigInt(O):b},x=e.bits2int_modN||function(y){return c(A(y))},D=Tl(i);function U(y){return Yi("num < 2^"+i,y,zn,D),Ha(y,s)}function M(y,b,O=$){if(["recovered","canonical"].some(be=>be in O))throw new Error("sign() legacy options not supported");const{hash:B,randomBytes:k}=e;let{lowS:L,prehash:H,extraEntropy:K}=O;L==null&&(L=!0),y=Wr("msgHash",y),Rp(O),H&&(y=Wr("prehashed msgHash",B(y)));const Q=x(y),Z=d(b),re=[U(Z),U(Q)];if(K!=null&&K!==!1){const be=K===!0?k(r.BYTES):K;re.push(Wr("extraEntropy",be))}const we=Xc(...re),Ee=Q;function Ne(be){const xe=A(be);if(!m(xe))return;const Ze=l(xe),tt=u.BASE.multiply(xe).toAffine(),qe=c(tt.x);if(qe===zn)return;const ct=c(Ze*c(Ee+qe*Z));if(ct===zn)return;let jt=(tt.x===qe?0:2)|Number(tt.y&$t),Tr=ct;return L&&f(ct)&&(Tr=g(ct),jt^=1),new I(qe,Tr,jt)}return{seed:we,k2sig:Ne}}const $={lowS:e.lowS,prehash:!1},F={lowS:e.lowS,prehash:!1};function W(y,b,O=$){const{seed:B,k2sig:k}=M(y,b,O),L=e;return VI(L.hash.outputLen,L.nByteLength,L.hmac)(B,k)}u.BASE._setWindowSize(8);function q(y,b,O,B=F){var jt;const k=y;b=Wr("msgHash",b),O=Wr("publicKey",O);const{lowS:L,prehash:H,format:K}=B;if(Rp(B),"strict"in B)throw new Error("options.strict was renamed to lowS");if(K!==void 0&&K!=="compact"&&K!=="der")throw new Error("format must be compact or der");const Q=typeof k=="string"||qa(k),Z=!Q&&!K&&typeof k=="object"&&k!==null&&typeof k.r=="bigint"&&typeof k.s=="bigint";if(!Q&&!Z)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let re,we;try{if(Z&&(re=new I(k.r,k.s)),Q){try{K!=="compact"&&(re=I.fromDER(k))}catch(Tr){if(!(Tr instanceof qn.Err))throw Tr}!re&&K!=="der"&&(re=I.fromCompact(k))}we=u.fromHex(O)}catch{return!1}if(!re||L&&re.hasHighS())return!1;H&&(b=e.hash(b));const{r:Ee,s:Ne}=re,be=x(b),xe=l(Ne),Ze=c(be*xe),tt=c(Ee*xe),qe=(jt=u.BASE.multiplyAndAddUnsafe(we,Ze,tt))==null?void 0:jt.toAffine();return qe?c(qe.x)===Ee:!1}return{CURVE:e,getPublicKey:C,getSharedSecret:v,sign:W,verify:q,ProjectivePoint:u,Signature:I,utils:N}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function hS(t){return{hash:t,hmac:(e,...r)=>Lb(t,e,Mb(...r)),randomBytes:Bb}}function fS(t,e){const r=n=>dS({...t,...hS(n)});return{...r(e),create:r}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ay=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Pp=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),pS=BigInt(0),gS=BigInt(1),Pd=BigInt(2),Dp=(t,e)=>(t+e/Pd)/e;function mS(t){const e=Ay,r=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,u=l*l*t%e,d=Mr(u,r,e)*u%e,h=Mr(d,r,e)*u%e,m=Mr(h,Pd,e)*l%e,f=Mr(m,s,e)*m%e,g=Mr(f,i,e)*f%e,_=Mr(g,a,e)*g%e,I=Mr(_,c,e)*_%e,N=Mr(I,a,e)*g%e,C=Mr(N,r,e)*u%e,E=Mr(C,o,e)*f%e,v=Mr(E,n,e)*l%e,A=Mr(v,Pd,e);if(!Dd.eql(Dd.sqr(A),t))throw new Error("Cannot find square root");return A}const Dd=Uh(Ay,void 0,void 0,{sqrt:mS}),wS=fS({a:pS,b:BigInt(7),Fp:Dd,n:Pp,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=Pp,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-gS*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,o=BigInt("0x100000000000000000000000000000000"),a=Dp(i*t,e),c=Dp(-n*t,e);let l=Er(t-a*r-c*s,e),u=Er(-a*n-c*i,e);const d=l>o,h=u>o;if(d&&(l=e-l),h&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:d,k1:l,k2neg:h,k2:u}}}},Fb),yS=Object.freeze(Object.defineProperty({__proto__:null,secp256k1:wS},Symbol.toStringTag,{value:"Module"}));function bS(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const u=t.charAt(l),d=u.charCodeAt(0);if(e[d]!==255)throw new TypeError(u+" is ambiguous");e[d]=l}const r=t.length,n=t.charAt(0),s=Math.log(r)/Math.log(256),i=Math.log(256)/Math.log(r);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,h=0;const m=l.length;for(;h!==m&&l[h]===0;)h++,u++;const f=(m-h)*i+1>>>0,g=new Uint8Array(f);for(;h!==m;){let N=l[h],C=0;for(let E=f-1;(N!==0||C<d)&&E!==-1;E--,C++)N+=256*g[E]>>>0,g[E]=N%r>>>0,N=N/r>>>0;if(N!==0)throw new Error("Non-zero carry");d=C,h++}let _=f-d;for(;_!==f&&g[_]===0;)_++;let I=n.repeat(u);for(;_<f;++_)I+=t.charAt(g[_]);return I}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;l[u]===n;)d++,u++;const m=(l.length-u)*s+1>>>0,f=new Uint8Array(m);for(;u<l.length;){const N=l.charCodeAt(u);if(N>255)return;let C=e[N];if(C===255)return;let E=0;for(let v=m-1;(C!==0||E<h)&&v!==-1;v--,E++)C+=r*f[v]>>>0,f[v]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");h=E,u++}let g=m-h;for(;g!==m&&f[g]===0;)g++;const _=new Uint8Array(d+(m-g));let I=d;for(;g!==m;)_[I++]=f[g++];return _}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+r+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var ES="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const fo=bS(ES);function vS(t){const e=t.length;let r=0,n=0;for(;n<e;){let s=t.charCodeAt(n++);if((s&4294967168)===0){r++;continue}else if((s&4294965248)===0)r+=2;else{if(s>=55296&&s<=56319&&n<e){const i=t.charCodeAt(n);(i&64512)===56320&&(++n,s=((s&1023)<<10)+(i&1023)+65536)}(s&4294901760)===0?r+=3:r+=4}}return r}function _S(t,e,r){const n=t.length;let s=r,i=0;for(;i<n;){let o=t.charCodeAt(i++);if((o&4294967168)===0){e[s++]=o;continue}else if((o&4294965248)===0)e[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<n){const a=t.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}(o&4294901760)===0?(e[s++]=o>>12&15|224,e[s++]=o>>6&63|128):(e[s++]=o>>18&7|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128)}e[s++]=o&63|128}}const CS=new TextEncoder,AS=50;function IS(t,e,r){CS.encodeInto(t,e.subarray(r))}function SS(t,e,r){t.length>AS?IS(t,e,r):_S(t,e,r)}const TS=4096;function Iy(t,e,r){let n=e;const s=n+r,i=[];let o="";for(;n<s;){const a=t[n++];if((a&128)===0)i.push(a);else if((a&224)===192){const c=t[n++]&63;i.push((a&31)<<6|c)}else if((a&240)===224){const c=t[n++]&63,l=t[n++]&63;i.push((a&31)<<12|c<<6|l)}else if((a&248)===240){const c=t[n++]&63,l=t[n++]&63,u=t[n++]&63;let d=(a&7)<<18|c<<12|l<<6|u;d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|d&1023),i.push(d)}else i.push(a);i.length>=TS&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const NS=new TextDecoder,xS=200;function OS(t,e,r){const n=t.subarray(e,e+r);return NS.decode(n)}function RS(t,e,r){return r>xS?OS(t,e,r):Iy(t,e,r)}class gc{constructor(e,r){this.type=e,this.data=r}}class Dr extends Error{constructor(e){super(e);const r=Object.create(Dr.prototype);Object.setPrototypeOf(this,r),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:Dr.name})}}const To=4294967295;function PS(t,e,r){const n=r/4294967296,s=r;t.setUint32(e,n),t.setUint32(e+4,s)}function Sy(t,e,r){const n=Math.floor(r/4294967296),s=r;t.setUint32(e,n),t.setUint32(e+4,s)}function Ty(t,e){const r=t.getInt32(e),n=t.getUint32(e+4);return r*4294967296+n}function DS(t,e){const r=t.getUint32(e),n=t.getUint32(e+4);return r*4294967296+n}const kS=-1,US=4294967296-1,$S=17179869184-1;function BS({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=$S)if(e===0&&t<=US){const r=new Uint8Array(4);return new DataView(r.buffer).setUint32(0,t),r}else{const r=t/4294967296,n=t&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,e<<2|r&3),i.setUint32(4,n),s}else{const r=new Uint8Array(12),n=new DataView(r.buffer);return n.setUint32(0,e),Sy(n,4,t),r}}function LS(t){const e=t.getTime(),r=Math.floor(e/1e3),n=(e-r*1e3)*1e6,s=Math.floor(n/1e9);return{sec:r+s,nsec:n-s*1e9}}function MS(t){if(t instanceof Date){const e=LS(t);return BS(e)}else return null}function FS(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const r=e.getUint32(0),n=e.getUint32(4),s=(r&3)*4294967296+n,i=r>>>2;return{sec:s,nsec:i}}case 12:{const r=Ty(e,4),n=e.getUint32(0);return{sec:r,nsec:n}}default:throw new Dr(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function jS(t){const e=FS(t);return new Date(e.sec*1e3+e.nsec/1e6)}const qS={type:kS,encode:MS,decode:jS};class Qc{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(qS)}register({type:e,encode:r,decode:n}){if(e>=0)this.encoders[e]=r,this.decoders[e]=n;else{const s=-1-e;this.builtInEncoders[s]=r,this.builtInDecoders[s]=n}}tryToEncode(e,r){for(let n=0;n<this.builtInEncoders.length;n++){const s=this.builtInEncoders[n];if(s!=null){const i=s(e,r);if(i!=null){const o=-1-n;return new gc(o,i)}}}for(let n=0;n<this.encoders.length;n++){const s=this.encoders[n];if(s!=null){const i=s(e,r);if(i!=null){const o=n;return new gc(o,i)}}}return e instanceof gc?e:null}decode(e,r,n){const s=r<0?this.builtInDecoders[-1-r]:this.decoders[r];return s?s(e,r,n):new gc(r,e)}}Qc.defaultCodec=new Qc;function HS(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function kd(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):HS(t)?new Uint8Array(t):Uint8Array.from(t)}const WS=100,zS=2048;let VS=class Ny{constructor(e){this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??Qc.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.maxDepth=(e==null?void 0:e.maxDepth)??WS,this.initialBufferSize=(e==null?void 0:e.initialBufferSize)??zS,this.sortKeys=(e==null?void 0:e.sortKeys)??!1,this.forceFloat32=(e==null?void 0:e.forceFloat32)??!1,this.ignoreUndefined=(e==null?void 0:e.ignoreUndefined)??!1,this.forceIntegerToFloat=(e==null?void 0:e.forceIntegerToFloat)??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new Ny({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,r){if(r>this.maxDepth)throw new Error(`Too deep objects in depth ${r}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,r)}ensureBufferSizeToWrite(e){const r=this.pos+e;this.view.byteLength<r&&this.resizeBuffer(r*2)}resizeBuffer(e){const r=new ArrayBuffer(e),n=new Uint8Array(r),s=new DataView(r);n.set(this.bytes),this.view=s,this.bytes=n}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const n=vS(e);this.ensureBufferSizeToWrite(5+n),this.writeStringHeader(n),SS(e,this.bytes,this.pos),this.pos+=n}encodeObject(e,r){const n=this.extensionCodec.tryToEncode(e,this.context);if(n!=null)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,r);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,r);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const r=e.byteLength;if(r<256)this.writeU8(196),this.writeU8(r);else if(r<65536)this.writeU8(197),this.writeU16(r);else if(r<4294967296)this.writeU8(198),this.writeU32(r);else throw new Error(`Too large binary: ${r}`);const n=kd(e);this.writeU8a(n)}encodeArray(e,r){const n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else if(n<4294967296)this.writeU8(221),this.writeU32(n);else throw new Error(`Too large array: ${n}`);for(const s of e)this.doEncode(s,r+1)}countWithoutUndefined(e,r){let n=0;for(const s of r)e[s]!==void 0&&n++;return n}encodeMap(e,r){const n=Object.keys(e);this.sortKeys&&n.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of n){const o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,r+1))}}encodeExtension(e){if(typeof e.data=="function"){const n=e.data(this.pos+6),s=n.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(e.type),this.writeU8a(n);return}const r=e.data.length;if(r===1)this.writeU8(212);else if(r===2)this.writeU8(213);else if(r===4)this.writeU8(214);else if(r===8)this.writeU8(215);else if(r===16)this.writeU8(216);else if(r<256)this.writeU8(199),this.writeU8(r);else if(r<65536)this.writeU8(200),this.writeU16(r);else if(r<4294967296)this.writeU8(201),this.writeU32(r);else throw new Error(`Too large extension object: ${r}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const r=e.length;this.ensureBufferSizeToWrite(r),this.bytes.set(e,this.pos),this.pos+=r}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),PS(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),Sy(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function KS(t,e){return new VS(e).encodeSharedRef(t)}function Iu(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const GS=16,YS=16;class ZS{constructor(e=GS,r=YS){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=r,this.caches=[];for(let n=0;n<this.maxKeyLength;n++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,r,n){const s=this.caches[n-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<n;a++)if(o[a]!==e[r+a])continue e;return i.str}return null}store(e,r){const n=this.caches[e.length-1],s={bytes:e,str:r};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=s:n.push(s)}decode(e,r,n){const s=this.find(e,r,n);if(s!=null)return this.hit++,s;this.miss++;const i=Iy(e,r,n),o=Uint8Array.prototype.slice.call(e,r,r+n);return this.store(o,i),i}}const Ud="array",Jo="map_key",xy="map_value",JS=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new Dr("The type of key must be string or number but "+typeof t)};class XS{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const r=this.getUninitializedStateFromPool();r.type=Ud,r.position=0,r.size=e,r.array=new Array(e)}pushMapState(e){const r=this.getUninitializedStateFromPool();r.type=Jo,r.readCount=0,r.size=e,r.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===Ud){const n=e;n.size=0,n.array=void 0,n.position=0,n.type=void 0}if(e.type===Jo||e.type===xy){const n=e;n.size=0,n.map=void 0,n.readCount=0,n.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const No=-1,$h=new DataView(new ArrayBuffer(0)),QS=new Uint8Array($h.buffer);try{$h.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const kp=new RangeError("Insufficient data"),eT=new ZS;let tT=class Oy{constructor(e){this.totalPos=0,this.pos=0,this.view=$h,this.bytes=QS,this.headByte=No,this.stack=new XS,this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??Qc.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.rawStrings=(e==null?void 0:e.rawStrings)??!1,this.maxStrLength=(e==null?void 0:e.maxStrLength)??To,this.maxBinLength=(e==null?void 0:e.maxBinLength)??To,this.maxArrayLength=(e==null?void 0:e.maxArrayLength)??To,this.maxMapLength=(e==null?void 0:e.maxMapLength)??To,this.maxExtLength=(e==null?void 0:e.maxExtLength)??To,this.keyDecoder=(e==null?void 0:e.keyDecoder)!==void 0?e.keyDecoder:eT,this.mapKeyConverter=(e==null?void 0:e.mapKeyConverter)??JS}clone(){return new Oy({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=No,this.stack.reset()}setBuffer(e){const r=kd(e);this.bytes=r,this.view=new DataView(r.buffer,r.byteOffset,r.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===No&&!this.hasRemaining(1))this.setBuffer(e);else{const r=this.bytes.subarray(this.pos),n=kd(e),s=new Uint8Array(r.length+n.length);s.set(r),s.set(n,r.length),this.setBuffer(s)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:r,pos:n}=this;return new RangeError(`Extra ${r.byteLength-n} of ${r.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const r=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return r}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let r=!1,n;for await(const a of e){if(r)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{n=this.doDecodeSync(),r=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(r){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return n}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${Iu(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,r){if(this.entered){yield*this.clone().decodeMultiAsync(e,r);return}try{this.entered=!0;let n=r,s=-1;for await(const i of e){if(r&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),n&&(s=this.readArraySize(),n=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let r;if(e>=224)r=e-256;else if(e<192)if(e<128)r=e;else if(e<144){const s=e-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else r={}}else if(e<160){const s=e-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else r=[]}else{const s=e-160;r=this.decodeString(s,0)}else if(e===192)r=null;else if(e===194)r=!1;else if(e===195)r=!0;else if(e===202)r=this.readF32();else if(e===203)r=this.readF64();else if(e===204)r=this.readU8();else if(e===205)r=this.readU16();else if(e===206)r=this.readU32();else if(e===207)this.useBigInt64?r=this.readU64AsBigInt():r=this.readU64();else if(e===208)r=this.readI8();else if(e===209)r=this.readI16();else if(e===210)r=this.readI32();else if(e===211)this.useBigInt64?r=this.readI64AsBigInt():r=this.readI64();else if(e===217){const s=this.lookU8();r=this.decodeString(s,1)}else if(e===218){const s=this.lookU16();r=this.decodeString(s,2)}else if(e===219){const s=this.lookU32();r=this.decodeString(s,4)}else if(e===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else r=[]}else if(e===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else r=[]}else if(e===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else r={}}else if(e===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else r={}}else if(e===196){const s=this.lookU8();r=this.decodeBinary(s,1)}else if(e===197){const s=this.lookU16();r=this.decodeBinary(s,2)}else if(e===198){const s=this.lookU32();r=this.decodeBinary(s,4)}else if(e===212)r=this.decodeExtension(1,0);else if(e===213)r=this.decodeExtension(2,0);else if(e===214)r=this.decodeExtension(4,0);else if(e===215)r=this.decodeExtension(8,0);else if(e===216)r=this.decodeExtension(16,0);else if(e===199){const s=this.lookU8();r=this.decodeExtension(s,1)}else if(e===200){const s=this.lookU16();r=this.decodeExtension(s,2)}else if(e===201){const s=this.lookU32();r=this.decodeExtension(s,4)}else throw new Dr(`Unrecognized type byte: ${Iu(e)}`);this.complete();const n=this.stack;for(;n.length>0;){const s=n.top();if(s.type===Ud)if(s.array[s.position]=r,s.position++,s.position===s.size)r=s.array,n.release(s);else continue e;else if(s.type===Jo){if(r==="__proto__")throw new Dr("The key __proto__ is not allowed");s.key=this.mapKeyConverter(r),s.type=xy;continue e}else if(s.map[s.key]=r,s.readCount++,s.readCount===s.size)r=s.map,n.release(s);else{s.key=null,s.type=Jo;continue e}}return r}}readHeadByte(){return this.headByte===No&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=No}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new Dr(`Unrecognized array type byte: ${Iu(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new Dr(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new Dr(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,r){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,r):this.decodeBinary(e,r)}decodeUtf8String(e,r){var i;if(e>this.maxStrLength)throw new Dr(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+r+e)throw kp;const n=this.pos+r;let s;return this.stateIsMapKey()&&((i=this.keyDecoder)!=null&&i.canBeCached(e))?s=this.keyDecoder.decode(this.bytes,n,e):s=RS(this.bytes,n,e),this.pos+=r+e,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===Jo:!1}decodeBinary(e,r){if(e>this.maxBinLength)throw new Dr(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+r))throw kp;const n=this.pos+r,s=this.bytes.subarray(n,n+e);return this.pos+=r+e,s}decodeExtension(e,r){if(e>this.maxExtLength)throw new Dr(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const n=this.view.getInt8(this.pos+r),s=this.decodeBinary(e,r+1);return this.extensionCodec.decode(s,n,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=DS(this.view,this.pos);return this.pos+=8,e}readI64(){const e=Ty(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function rT(t,e){return new tT(e).decode(t)}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function nT(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Ry(t,e){return Array.isArray(e)?e.length===0?!0:t?e.every(r=>typeof r=="string"):e.every(r=>Number.isSafeInteger(r)):!1}function el(t,e){if(typeof e!="string")throw new Error(`${t}: string expected`);return!0}function Bh(t){if(!Number.isSafeInteger(t))throw new Error(`invalid integer: ${t}`)}function $d(t){if(!Array.isArray(t))throw new Error("array expected")}function tl(t,e){if(!Ry(!0,e))throw new Error(`${t}: array of strings expected`)}function sT(t,e){if(!Ry(!1,e))throw new Error(`${t}: array of numbers expected`)}function iT(...t){const e=i=>i,r=(i,o)=>a=>i(o(a)),n=t.map(i=>i.encode).reduceRight(r,e),s=t.map(i=>i.decode).reduce(r,e);return{encode:n,decode:s}}function oT(t){const e=typeof t=="string"?t.split(""):t,r=e.length;tl("alphabet",e);const n=new Map(e.map((s,i)=>[s,i]));return{encode:s=>($d(s),s.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=r)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${t}`);return e[i]})),decode:s=>($d(s),s.map(i=>{el("alphabet.decode",i);const o=n.get(i);if(o===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${t}`);return o}))}}function aT(t=""){return el("join",t),{encode:e=>(tl("join.decode",e),e.join(t)),decode:e=>(el("join.decode",e),e.split(t))}}function cT(t,e="="){return Bh(t),el("padding",e),{encode(r){for(tl("padding.encode",r);r.length*t%8;)r.push(e);return r},decode(r){tl("padding.decode",r);let n=r.length;if(n*t%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;n>0&&r[n-1]===e;n--)if((n-1)*t%8===0)throw new Error("padding: invalid, string has too much padding");return r.slice(0,n)}}}const Py=(t,e)=>e===0?t:Py(e,t%e),rl=(t,e)=>t+(e-Py(t,e)),Su=(()=>{let t=[];for(let e=0;e<40;e++)t.push(2**e);return t})();function Up(t,e,r,n){if($d(t),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(rl(e,r)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${r} carryBits=${rl(e,r)}`);let s=0,i=0;const o=Su[e],a=Su[r]-1,c=[];for(const l of t){if(Bh(l),l>=o)throw new Error(`convertRadix2: invalid data word=${l} from=${e}`);if(s=s<<e|l,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=r;i-=r)c.push((s>>i-r&a)>>>0);const u=Su[i];if(u===void 0)throw new Error("invalid carry");s&=u-1}if(s=s<<r-i&a,!n&&i>=e)throw new Error("Excess padding");if(!n&&s>0)throw new Error(`Non-zero padding: ${s}`);return n&&i>0&&c.push(s>>>0),c}function lT(t,e=!1){if(Bh(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(rl(8,t)>32||rl(t,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!nT(r))throw new Error("radix2.encode input should be Uint8Array");return Up(Array.from(r),8,t,!e)},decode:r=>(sT("radix2.decode",r),Uint8Array.from(Up(r,t,8,e)))}}const uT=iT(lT(5),oT("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),cT(5),aT(""));function Lh(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Dy(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Lh(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Xo(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const r=Dy(e);let n=0;for(const s of t)r.set(s,n),n+=s.length;return Lh(r)}function dT(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var g=0,_=0,I=0,N=f.length;I!==N&&f[I]===0;)I++,g++;for(var C=(N-I)*u+1>>>0,E=new Uint8Array(C);I!==N;){for(var v=f[I],A=0,x=C-1;(v!==0||A<_)&&x!==-1;x--,A++)v+=256*E[x]>>>0,E[x]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");_=A,I++}for(var D=C-_;D!==C&&E[D]===0;)D++;for(var U=c.repeat(g);D<C;++D)U+=t.charAt(E[D]);return U}function h(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var g=0;if(f[g]!==" "){for(var _=0,I=0;f[g]===c;)_++,g++;for(var N=(f.length-g)*l+1>>>0,C=new Uint8Array(N);f[g];){var E=r[f.charCodeAt(g)];if(E===255)return;for(var v=0,A=N-1;(E!==0||v<I)&&A!==-1;A--,v++)E+=a*C[A]>>>0,C[A]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");I=v,g++}if(f[g]!==" "){for(var x=N-I;x!==N&&C[x]===0;)x++;for(var D=new Uint8Array(_+(N-x)),U=_;x!==N;)D[U++]=C[x++];return D}}}function m(f){var g=h(f);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:m}}var hT=dT,fT=hT;const pT=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},gT=t=>new TextEncoder().encode(t),mT=t=>new TextDecoder().decode(t);class wT{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class yT{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ky(this,e)}}class bT{constructor(e){this.decoders=e}or(e){return ky(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ky=(t,e)=>new bT({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class ET{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new wT(e,r,n),this.decoder=new yT(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const xl=({name:t,prefix:e,encode:r,decode:n})=>new ET(t,e,r,n),Wa=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=fT(r,e);return xl({prefix:t,name:e,encode:n,decode:i=>pT(s(i))})},vT=(t,e,r,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},_T=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Gt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>xl({prefix:e,name:t,encode(s){return _T(s,n,r)},decode(s){return vT(s,n,r,t)}}),CT=xl({prefix:"\0",name:"identity",encode:t=>mT(t),decode:t=>gT(t)}),AT=Object.freeze(Object.defineProperty({__proto__:null,identity:CT},Symbol.toStringTag,{value:"Module"})),IT=Gt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ST=Object.freeze(Object.defineProperty({__proto__:null,base2:IT},Symbol.toStringTag,{value:"Module"})),TT=Gt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),NT=Object.freeze(Object.defineProperty({__proto__:null,base8:TT},Symbol.toStringTag,{value:"Module"})),xT=Wa({prefix:"9",name:"base10",alphabet:"0123456789"}),OT=Object.freeze(Object.defineProperty({__proto__:null,base10:xT},Symbol.toStringTag,{value:"Module"})),RT=Gt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),PT=Gt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),DT=Object.freeze(Object.defineProperty({__proto__:null,base16:RT,base16upper:PT},Symbol.toStringTag,{value:"Module"})),kT=Gt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),UT=Gt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),$T=Gt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),BT=Gt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),LT=Gt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),MT=Gt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),FT=Gt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),jT=Gt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),qT=Gt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),HT=Object.freeze(Object.defineProperty({__proto__:null,base32:kT,base32hex:LT,base32hexpad:FT,base32hexpadupper:jT,base32hexupper:MT,base32pad:$T,base32padupper:BT,base32upper:UT,base32z:qT},Symbol.toStringTag,{value:"Module"})),WT=Wa({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),zT=Wa({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),VT=Object.freeze(Object.defineProperty({__proto__:null,base36:WT,base36upper:zT},Symbol.toStringTag,{value:"Module"})),KT=Wa({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),GT=Wa({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),YT=Object.freeze(Object.defineProperty({__proto__:null,base58btc:KT,base58flickr:GT},Symbol.toStringTag,{value:"Module"})),ZT=Gt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),JT=Gt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),XT=Gt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),QT=Gt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),e2=Object.freeze(Object.defineProperty({__proto__:null,base64:ZT,base64pad:JT,base64url:XT,base64urlpad:QT},Symbol.toStringTag,{value:"Module"})),Uy=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),t2=Uy.reduce((t,e,r)=>(t[r]=e,t),[]),r2=Uy.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function n2(t){return t.reduce((e,r)=>(e+=t2[r],e),"")}function s2(t){const e=[];for(const r of t){const n=r2[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const i2=xl({prefix:"🚀",name:"base256emoji",encode:n2,decode:s2}),o2=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:i2},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const $p={...AT,...ST,...NT,...OT,...DT,...HT,...VT,...YT,...e2,...o2};function $y(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Bp=$y("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Tu=$y("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Dy(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),By={utf8:Bp,"utf-8":Bp,hex:$p.base16,latin1:Tu,ascii:Tu,binary:Tu,...$p};function Vr(t,e="utf8"){const r=By[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Lh(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function Ir(t,e="utf8"){const r=By[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}const a2={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var Nu,Lp;function Ly(){if(Lp)return Nu;Lp=1;const t="Input must be an string, Buffer or Uint8Array";function e(o){let a;if(o instanceof Uint8Array)a=o;else if(typeof o=="string")a=new TextEncoder().encode(o);else throw new Error(t);return a}function r(o){return Array.prototype.map.call(o,function(a){return(a<16?"0":"")+a.toString(16)}).join("")}function n(o){return(4294967296+o).toString(16).substring(1)}function s(o,a,c){let l=`
`+o+" = ";for(let u=0;u<a.length;u+=2){if(c===32)l+=n(a[u]).toUpperCase(),l+=" ",l+=n(a[u+1]).toUpperCase();else if(c===64)l+=n(a[u+1]).toUpperCase(),l+=n(a[u]).toUpperCase();else throw new Error("Invalid size "+c);u%6===4?l+=`
`+new Array(o.length+4).join(" "):u<a.length-2&&(l+=" ")}console.log(l)}function i(o,a,c){let l=new Date().getTime();const u=new Uint8Array(a);for(let h=0;h<a;h++)u[h]=h%256;const d=new Date().getTime();console.log("Generated random input in "+(d-l)+"ms"),l=d;for(let h=0;h<c;h++){const m=o(u),f=new Date().getTime(),g=f-l;l=f,console.log("Hashed in "+g+"ms: "+m.substring(0,20)+"..."),console.log(Math.round(a/(1<<20)/(g/1e3)*100)/100+" MB PER SECOND")}}return Nu={normalizeInput:e,toHex:r,debugPrint:s,testSpeed:i},Nu}var xu,Mp;function c2(){if(Mp)return xu;Mp=1;const t=Ly();function e(I,N,C){const E=I[N]+I[C];let v=I[N+1]+I[C+1];E>=4294967296&&v++,I[N]=E,I[N+1]=v}function r(I,N,C,E){let v=I[N]+C;C<0&&(v+=4294967296);let A=I[N+1]+E;v>=4294967296&&A++,I[N]=v,I[N+1]=A}function n(I,N){return I[N]^I[N+1]<<8^I[N+2]<<16^I[N+3]<<24}function s(I,N,C,E,v,A){const x=l[v],D=l[v+1],U=l[A],M=l[A+1];e(c,I,N),r(c,I,x,D);let $=c[E]^c[I],F=c[E+1]^c[I+1];c[E]=F,c[E+1]=$,e(c,C,E),$=c[N]^c[C],F=c[N+1]^c[C+1],c[N]=$>>>24^F<<8,c[N+1]=F>>>24^$<<8,e(c,I,N),r(c,I,U,M),$=c[E]^c[I],F=c[E+1]^c[I+1],c[E]=$>>>16^F<<16,c[E+1]=F>>>16^$<<16,e(c,C,E),$=c[N]^c[C],F=c[N+1]^c[C+1],c[N]=F>>>31^$<<1,c[N+1]=$>>>31^F<<1}const i=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],a=new Uint8Array(o.map(function(I){return I*2})),c=new Uint32Array(32),l=new Uint32Array(32);function u(I,N){let C=0;for(C=0;C<16;C++)c[C]=I.h[C],c[C+16]=i[C];for(c[24]=c[24]^I.t,c[25]=c[25]^I.t/4294967296,N&&(c[28]=~c[28],c[29]=~c[29]),C=0;C<32;C++)l[C]=n(I.b,4*C);for(C=0;C<12;C++)s(0,8,16,24,a[C*16+0],a[C*16+1]),s(2,10,18,26,a[C*16+2],a[C*16+3]),s(4,12,20,28,a[C*16+4],a[C*16+5]),s(6,14,22,30,a[C*16+6],a[C*16+7]),s(0,10,20,30,a[C*16+8],a[C*16+9]),s(2,12,22,24,a[C*16+10],a[C*16+11]),s(4,14,16,26,a[C*16+12],a[C*16+13]),s(6,8,18,28,a[C*16+14],a[C*16+15]);for(C=0;C<16;C++)I.h[C]=I.h[C]^c[C]^c[C+16]}const d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function h(I,N,C,E){if(I===0||I>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(N&&N.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(C&&C.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(E&&E.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const v={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:I};d.fill(0),d[0]=I,N&&(d[1]=N.length),d[2]=1,d[3]=1,C&&d.set(C,32),E&&d.set(E,48);for(let A=0;A<16;A++)v.h[A]=i[A]^n(d,A*4);return N&&(m(v,N),v.c=128),v}function m(I,N){for(let C=0;C<N.length;C++)I.c===128&&(I.t+=I.c,u(I,!1),I.c=0),I.b[I.c++]=N[C]}function f(I){for(I.t+=I.c;I.c<128;)I.b[I.c++]=0;u(I,!0);const N=new Uint8Array(I.outlen);for(let C=0;C<I.outlen;C++)N[C]=I.h[C>>2]>>8*(C&3);return N}function g(I,N,C,E,v){C=C||64,I=t.normalizeInput(I),E&&(E=t.normalizeInput(E)),v&&(v=t.normalizeInput(v));const A=h(C,N,E,v);return m(A,I),f(A)}function _(I,N,C,E,v){const A=g(I,N,C,E,v);return t.toHex(A)}return xu={blake2b:g,blake2bHex:_,blake2bInit:h,blake2bUpdate:m,blake2bFinal:f},xu}var Ou,Fp;function l2(){if(Fp)return Ou;Fp=1;const t=Ly();function e(f,g){return f[g]^f[g+1]<<8^f[g+2]<<16^f[g+3]<<24}function r(f,g,_,I,N,C){o[f]=o[f]+o[g]+N,o[I]=n(o[I]^o[f],16),o[_]=o[_]+o[I],o[g]=n(o[g]^o[_],12),o[f]=o[f]+o[g]+C,o[I]=n(o[I]^o[f],8),o[_]=o[_]+o[I],o[g]=n(o[g]^o[_],7)}function n(f,g){return f>>>g^f<<32-g}const s=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),i=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),o=new Uint32Array(16),a=new Uint32Array(16);function c(f,g){let _=0;for(_=0;_<8;_++)o[_]=f.h[_],o[_+8]=s[_];for(o[12]^=f.t,o[13]^=f.t/4294967296,g&&(o[14]=~o[14]),_=0;_<16;_++)a[_]=e(f.b,4*_);for(_=0;_<10;_++)r(0,4,8,12,a[i[_*16+0]],a[i[_*16+1]]),r(1,5,9,13,a[i[_*16+2]],a[i[_*16+3]]),r(2,6,10,14,a[i[_*16+4]],a[i[_*16+5]]),r(3,7,11,15,a[i[_*16+6]],a[i[_*16+7]]),r(0,5,10,15,a[i[_*16+8]],a[i[_*16+9]]),r(1,6,11,12,a[i[_*16+10]],a[i[_*16+11]]),r(2,7,8,13,a[i[_*16+12]],a[i[_*16+13]]),r(3,4,9,14,a[i[_*16+14]],a[i[_*16+15]]);for(_=0;_<8;_++)f.h[_]^=o[_]^o[_+8]}function l(f,g){if(!(f>0&&f<=32))throw new Error("Incorrect output length, should be in [1, 32]");const _=g?g.length:0;if(g&&!(_>0&&_<=32))throw new Error("Incorrect key length, should be in [1, 32]");const I={h:new Uint32Array(s),b:new Uint8Array(64),c:0,t:0,outlen:f};return I.h[0]^=16842752^_<<8^f,_>0&&(u(I,g),I.c=64),I}function u(f,g){for(let _=0;_<g.length;_++)f.c===64&&(f.t+=f.c,c(f,!1),f.c=0),f.b[f.c++]=g[_]}function d(f){for(f.t+=f.c;f.c<64;)f.b[f.c++]=0;c(f,!0);const g=new Uint8Array(f.outlen);for(let _=0;_<f.outlen;_++)g[_]=f.h[_>>2]>>8*(_&3)&255;return g}function h(f,g,_){_=_||32,f=t.normalizeInput(f);const I=l(_,g);return u(I,f),d(I)}function m(f,g,_){const I=h(f,g,_);return t.toHex(I)}return Ou={blake2s:h,blake2sHex:m,blake2sInit:l,blake2sUpdate:u,blake2sFinal:d},Ou}var Ru,jp;function u2(){if(jp)return Ru;jp=1;const t=c2(),e=l2();return Ru={blake2b:t.blake2b,blake2bHex:t.blake2bHex,blake2bInit:t.blake2bInit,blake2bUpdate:t.blake2bUpdate,blake2bFinal:t.blake2bFinal,blake2s:e.blake2s,blake2sHex:e.blake2sHex,blake2sInit:e.blake2sInit,blake2sUpdate:e.blake2sUpdate,blake2sFinal:e.blake2sFinal},Ru}var d2=u2(),h2={};const f2=":";function Zi(t){const[e,r]=t.split(f2);return{namespace:e,reference:r}}function My(t,e){return t.includes(":")?[t]:e.chains||[]}var p2=Object.defineProperty,g2=Object.defineProperties,m2=Object.getOwnPropertyDescriptors,qp=Object.getOwnPropertySymbols,w2=Object.prototype.hasOwnProperty,y2=Object.prototype.propertyIsEnumerable,Hp=(t,e,r)=>e in t?p2(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Wp=(t,e)=>{for(var r in e||(e={}))w2.call(e,r)&&Hp(t,r,e[r]);if(qp)for(var r of qp(e))y2.call(e,r)&&Hp(t,r,e[r]);return t},b2=(t,e)=>g2(t,m2(e));const E2="ReactNative",Ur={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},v2="js";function nl(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Us(){return!Xn.getDocument()&&!!Xn.getNavigator()&&navigator.product===E2}function _2(){return Us()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function C2(){return Us()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function po(){return!nl()&&!!Xn.getNavigator()&&!!Xn.getDocument()}function za(){return Us()?Ur.reactNative:nl()?Ur.node:po()?Ur.browser:Ur.unknown}function zp(){var t;try{return Us()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function A2(t,e){const r=new URLSearchParams(t);for(const n of Object.keys(e).sort())if(e.hasOwnProperty(n)){const s=e[n];s!==void 0&&r.set(n,s)}return r.toString()}function I2(t){var e,r;const n=Fy();try{return t!=null&&t.url&&n.url&&new URL(t.url).host!==new URL(n.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),t.url=n.url),(e=t==null?void 0:t.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(s=>s!=="")),b2(Wp(Wp({},n),t),{url:(t==null?void 0:t.url)||n.url,name:(t==null?void 0:t.name)||n.name,description:(t==null?void 0:t.description)||n.description,icons:(r=t==null?void 0:t.icons)!=null&&r.length&&t.icons.length>0?t.icons:n.icons})}catch(s){return console.warn("Error populating app metadata",s),t||n}}function Fy(){return II.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function S2(){if(za()===Ur.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:n}=global.Platform;return[r,n].join("-")}const t=yI();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function T2(){var t;const e=za();return e===Ur.browser?[e,((t=Xn.getLocation())==null?void 0:t.host)||"unknown"].join(":"):e}function jy(t,e,r){const n=S2(),s=T2();return[[t,e].join("-"),[v2,r].join("-"),n,s].join("/")}function N2({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=r.split("?"),u=jy(t,e,n),d={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},h=A2(l[1]||"",d);return l[0]+"?"+h}function Ys(t,e){return t.filter(r=>e.includes(r)).length===t.length}function Bd(t){return Object.fromEntries(t.entries())}function Ld(t){return new Map(Object.entries(t))}function Ws(t=ne.FIVE_MINUTES,e){const r=ne.toMiliseconds(t||ne.FIVE_MINUTES);let n,s,i,o;return{resolve:a=>{i&&n&&(clearTimeout(i),n(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},r),n=a,s=c})}}function vs(t,e,r){return new Promise(async(n,s)=>{const i=setTimeout(()=>s(new Error(r)),e);try{const o=await t;n(o)}catch(o){s(o)}clearTimeout(i)})}function qy(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function x2(t){return qy("topic",t)}function O2(t){return qy("id",t)}function Hy(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function Rt(t,e){return ne.fromMiliseconds(Date.now()+ne.toMiliseconds(t))}function ps(t){return Date.now()>=ne.toMiliseconds(t)}function Je(t,e){return`${t}${e?`:${e}`:""}`}function Tn(t=[],e=[]){return[...new Set([...t,...e])]}async function R2({id:t,topic:e,wcDeepLink:r}){var n;try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r,i=s==null?void 0:s.href;if(typeof i!="string")return;const o=P2(i,t,e),a=za();if(a===Ur.browser){if(!((n=Xn.getDocument())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}D2(o)}else a===Ur.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function P2(t,e,r){const n=`requestId=${e}&sessionTopic=${r}`;t.endsWith("/")&&(t=t.slice(0,-1));let s=`${t}`;if(t.startsWith("https://t.me")){const i=t.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${B2(n,!0)}`}else s=`${s}/wc?${n}`;return s}function D2(t){let e="_self";$2()?e="_top":(U2()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function k2(t,e){let r="";try{if(po()&&(r=localStorage.getItem(e),r))return r;r=await t.getItem(e)}catch(n){console.error(n)}return r}function Vp(t,e){if(!t.includes(e))return null;const r=t.split(/([&,?,=])/),n=r.indexOf(e);return r[n+2]}function Kp(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function Mh(){return typeof process<"u"&&h2.IS_VITEST==="true"}function U2(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function $2(){try{return window.self!==window.top}catch{return!1}}function B2(t,e=!1){const r=Buffer.from(t).toString("base64");return e?r.replace(/[=]/g,""):r}function Wy(t){return Buffer.from(t,"base64").toString("utf-8")}function L2(t){return new Promise(e=>setTimeout(e,t))}const mc=BigInt(2**32-1),Gp=BigInt(32);function zy(t,e=!1){return e?{h:Number(t&mc),l:Number(t>>Gp&mc)}:{h:Number(t>>Gp&mc)|0,l:Number(t&mc)|0}}function Vy(t,e=!1){const r=t.length;let n=new Uint32Array(r),s=new Uint32Array(r);for(let i=0;i<r;i++){const{h:o,l:a}=zy(t[i],e);[n[i],s[i]]=[o,a]}return[n,s]}const Yp=(t,e,r)=>t>>>r,Zp=(t,e,r)=>t<<32-r|e>>>r,gs=(t,e,r)=>t>>>r|e<<32-r,ms=(t,e,r)=>t<<32-r|e>>>r,Wo=(t,e,r)=>t<<64-r|e>>>r-32,zo=(t,e,r)=>t>>>r-32|e<<64-r,M2=(t,e)=>e,F2=(t,e)=>t,j2=(t,e,r)=>t<<r|e>>>32-r,q2=(t,e,r)=>e<<r|t>>>32-r,H2=(t,e,r)=>e<<r-32|t>>>64-r,W2=(t,e,r)=>t<<r-32|e>>>64-r;function sn(t,e,r,n){const s=(e>>>0)+(n>>>0);return{h:t+r+(s/2**32|0)|0,l:s|0}}const Fh=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),jh=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,z2=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),V2=(t,e,r,n,s)=>e+r+n+s+(t/2**32|0)|0,K2=(t,e,r,n,s)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(s>>>0),G2=(t,e,r,n,s,i)=>e+r+n+s+i+(t/2**32|0)|0,Ti=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Y2(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Qn(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Os(t,...e){if(!Y2(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function qh(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Qn(t.outputLen),Qn(t.blockLen)}function Rs(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Hh(t,e){Os(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function pa(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Kr(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Pu(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function gn(t,e){return t<<32-e|t>>>e}const Ky=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Gy(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const Fn=Ky?t=>t:t=>Gy(t);function Z2(t){for(let e=0;e<t.length;e++)t[e]=Gy(t[e]);return t}const ws=Ky?t=>t:Z2;function J2(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function ln(t){return typeof t=="string"&&(t=J2(t)),Os(t),t}function X2(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];Os(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}let Ol=class{};function Va(t){const e=n=>t().update(ln(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Q2(t){const e=(n,s)=>t(s).update(ln(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}function go(t=32){if(Ti&&typeof Ti.getRandomValues=="function")return Ti.getRandomValues(new Uint8Array(t));if(Ti&&typeof Ti.randomBytes=="function")return Uint8Array.from(Ti.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const eN=BigInt(0),xo=BigInt(1),tN=BigInt(2),rN=BigInt(7),nN=BigInt(256),sN=BigInt(113),Yy=[],Zy=[],Jy=[];for(let t=0,e=xo,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],Yy.push(2*(5*n+r)),Zy.push((t+1)*(t+2)/2%64);let s=eN;for(let i=0;i<7;i++)e=(e<<xo^(e>>rN)*sN)%nN,e&tN&&(s^=xo<<(xo<<BigInt(i))-xo);Jy.push(s)}const Xy=Vy(Jy,!0),iN=Xy[0],oN=Xy[1],Jp=(t,e,r)=>r>32?H2(t,e,r):j2(t,e,r),Xp=(t,e,r)=>r>32?W2(t,e,r):q2(t,e,r);function aN(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=r[c],u=r[c+1],d=Jp(l,u,1)^r[a],h=Xp(l,u,1)^r[a+1];for(let m=0;m<50;m+=10)t[o+m]^=d,t[o+m+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=Zy[o],c=Jp(s,i,a),l=Xp(s,i,a),u=Yy[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=iN[n],t[1]^=oN[n]}Kr(r)}let cN=class Qy extends Ol{constructor(e,r,n,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=s,this.rounds=i,Qn(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=pa(this.state)}clone(){return this._cloneInto()}keccak(){ws(this.state32),aN(this.state32,this.rounds),ws(this.state32),this.posOut=0,this.pos=0}update(e){Rs(this),e=ln(e),Os(e);const{blockLen:r,state:n}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:s}=this;e[n]^=r,(r&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Rs(this,!1),Os(e),this.finish();const r=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(r.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Qn(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Hh(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Kr(this.state)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Qy(r,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const lN=(t,e,r)=>Va(()=>new cN(e,t,r)),uN=lN(1,136,256/8);function dN(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}function hN(t,e,r){return t&e^~t&r}function fN(t,e,r){return t&e^t&r^e&r}let e0=class extends Ol{constructor(e,r,n,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(e),this.view=Pu(this.buffer)}update(e){Rs(this),e=ln(e),Os(e);const{view:r,buffer:n,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Pu(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Rs(this),Hh(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,Kr(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;dN(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Pu(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%r&&e.buffer.set(n),e}clone(){return this._cloneInto()}};const os=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Zt=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Jt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),pN=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),as=new Uint32Array(64);class gN extends e0{constructor(e=32){super(64,e,8,!1),this.A=os[0]|0,this.B=os[1]|0,this.C=os[2]|0,this.D=os[3]|0,this.E=os[4]|0,this.F=os[5]|0,this.G=os[6]|0,this.H=os[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,r,n,s,i,o,a,c]}set(e,r,n,s,i,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let d=0;d<16;d++,r+=4)as[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=as[d-15],m=as[d-2],f=gn(h,7)^gn(h,18)^h>>>3,g=gn(m,17)^gn(m,19)^m>>>10;as[d]=g+as[d-7]+f+as[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=gn(a,6)^gn(a,11)^gn(a,25),m=u+h+hN(a,c,l)+pN[d]+as[d]|0,f=(gn(n,2)^gn(n,13)^gn(n,22))+fN(n,s,i)|0;u=l,l=c,c=a,a=o+m|0,o=i,i=s,s=n,n=m+f|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){Kr(as)}destroy(){this.set(0,0,0,0,0,0,0,0),Kr(this.buffer)}}const t0=Vy(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),mN=t0[0],wN=t0[1],cs=new Uint32Array(80),ls=new Uint32Array(80);let Wh=class extends e0{constructor(e=64){super(128,e,16,!1),this.Ah=Jt[0]|0,this.Al=Jt[1]|0,this.Bh=Jt[2]|0,this.Bl=Jt[3]|0,this.Ch=Jt[4]|0,this.Cl=Jt[5]|0,this.Dh=Jt[6]|0,this.Dl=Jt[7]|0,this.Eh=Jt[8]|0,this.El=Jt[9]|0,this.Fh=Jt[10]|0,this.Fl=Jt[11]|0,this.Gh=Jt[12]|0,this.Gl=Jt[13]|0,this.Hh=Jt[14]|0,this.Hl=Jt[15]|0}get(){const{Ah:e,Al:r,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:m,Gl:f,Hh:g,Hl:_}=this;return[e,r,n,s,i,o,a,c,l,u,d,h,m,f,g,_]}set(e,r,n,s,i,o,a,c,l,u,d,h,m,f,g,_){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=m|0,this.Gl=f|0,this.Hh=g|0,this.Hl=_|0}process(e,r){for(let C=0;C<16;C++,r+=4)cs[C]=e.getUint32(r),ls[C]=e.getUint32(r+=4);for(let C=16;C<80;C++){const E=cs[C-15]|0,v=ls[C-15]|0,A=gs(E,v,1)^gs(E,v,8)^Yp(E,v,7),x=ms(E,v,1)^ms(E,v,8)^Zp(E,v,7),D=cs[C-2]|0,U=ls[C-2]|0,M=gs(D,U,19)^Wo(D,U,61)^Yp(D,U,6),$=ms(D,U,19)^zo(D,U,61)^Zp(D,U,6),F=z2(x,$,ls[C-7],ls[C-16]),W=V2(F,A,M,cs[C-7],cs[C-16]);cs[C]=W|0,ls[C]=F|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:m,Fl:f,Gh:g,Gl:_,Hh:I,Hl:N}=this;for(let C=0;C<80;C++){const E=gs(d,h,14)^gs(d,h,18)^Wo(d,h,41),v=ms(d,h,14)^ms(d,h,18)^zo(d,h,41),A=d&m^~d&g,x=h&f^~h&_,D=K2(N,v,x,wN[C],ls[C]),U=G2(D,I,E,A,mN[C],cs[C]),M=D|0,$=gs(n,s,28)^Wo(n,s,34)^Wo(n,s,39),F=ms(n,s,28)^zo(n,s,34)^zo(n,s,39),W=n&i^n&a^i&a,q=s&o^s&c^o&c;I=g|0,N=_|0,g=m|0,_=f|0,m=d|0,f=h|0,{h:d,l:h}=sn(l|0,u|0,U|0,M|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const y=Fh(M,F,q);n=jh(y,U,$,W),s=y|0}({h:n,l:s}=sn(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=sn(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=sn(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=sn(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=sn(this.Eh|0,this.El|0,d|0,h|0),{h:m,l:f}=sn(this.Fh|0,this.Fl|0,m|0,f|0),{h:g,l:_}=sn(this.Gh|0,this.Gl|0,g|0,_|0),{h:I,l:N}=sn(this.Hh|0,this.Hl|0,I|0,N|0),this.set(n,s,i,o,a,c,l,u,d,h,m,f,g,_,I,N)}roundClean(){Kr(cs,ls)}destroy(){Kr(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};class yN extends Wh{constructor(){super(48),this.Ah=Zt[0]|0,this.Al=Zt[1]|0,this.Bh=Zt[2]|0,this.Bl=Zt[3]|0,this.Ch=Zt[4]|0,this.Cl=Zt[5]|0,this.Dh=Zt[6]|0,this.Dl=Zt[7]|0,this.Eh=Zt[8]|0,this.El=Zt[9]|0,this.Fh=Zt[10]|0,this.Fl=Zt[11]|0,this.Gh=Zt[12]|0,this.Gl=Zt[13]|0,this.Hh=Zt[14]|0,this.Hl=Zt[15]|0}}const Xt=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class bN extends Wh{constructor(){super(32),this.Ah=Xt[0]|0,this.Al=Xt[1]|0,this.Bh=Xt[2]|0,this.Bl=Xt[3]|0,this.Ch=Xt[4]|0,this.Cl=Xt[5]|0,this.Dh=Xt[6]|0,this.Dl=Xt[7]|0,this.Eh=Xt[8]|0,this.El=Xt[9]|0,this.Fh=Xt[10]|0,this.Fl=Xt[11]|0,this.Gh=Xt[12]|0,this.Gl=Xt[13]|0,this.Hh=Xt[14]|0,this.Hl=Xt[15]|0}}const Rl=Va(()=>new gN),EN=Va(()=>new Wh),vN=Va(()=>new yN),_N=Va(()=>new bN),CN=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),Ot=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ae=new Uint32Array(32);function us(t,e,r,n,s,i){const o=s[i],a=s[i+1];let c=ae[2*t],l=ae[2*t+1],u=ae[2*e],d=ae[2*e+1],h=ae[2*r],m=ae[2*r+1],f=ae[2*n],g=ae[2*n+1],_=Fh(c,u,o);l=jh(_,l,d,a),c=_|0,{Dh:g,Dl:f}={Dh:g^l,Dl:f^c},{Dh:g,Dl:f}={Dh:M2(g,f),Dl:F2(g)},{h:m,l:h}=sn(m,h,g,f),{Bh:d,Bl:u}={Bh:d^m,Bl:u^h},{Bh:d,Bl:u}={Bh:gs(d,u,24),Bl:ms(d,u,24)},ae[2*t]=c,ae[2*t+1]=l,ae[2*e]=u,ae[2*e+1]=d,ae[2*r]=h,ae[2*r+1]=m,ae[2*n]=f,ae[2*n+1]=g}function ds(t,e,r,n,s,i){const o=s[i],a=s[i+1];let c=ae[2*t],l=ae[2*t+1],u=ae[2*e],d=ae[2*e+1],h=ae[2*r],m=ae[2*r+1],f=ae[2*n],g=ae[2*n+1],_=Fh(c,u,o);l=jh(_,l,d,a),c=_|0,{Dh:g,Dl:f}={Dh:g^l,Dl:f^c},{Dh:g,Dl:f}={Dh:gs(g,f,16),Dl:ms(g,f,16)},{h:m,l:h}=sn(m,h,g,f),{Bh:d,Bl:u}={Bh:d^m,Bl:u^h},{Bh:d,Bl:u}={Bh:Wo(d,u,63),Bl:zo(d,u,63)},ae[2*t]=c,ae[2*t+1]=l,ae[2*e]=u,ae[2*e+1]=d,ae[2*r]=h,ae[2*r+1]=m,ae[2*n]=f,ae[2*n+1]=g}function AN(t,e={},r,n,s){if(Qn(r),t<0||t>r)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=e;if(i!==void 0&&(i.length<1||i.length>r))throw new Error("key length must be undefined or 1.."+r);if(o!==void 0&&o.length!==n)throw new Error("salt must be undefined or "+n);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class IN extends Ol{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Qn(e),Qn(r),this.blockLen=e,this.outputLen=r,this.buffer=new Uint8Array(e),this.buffer32=pa(this.buffer)}update(e){Rs(this),e=ln(e),Os(e);const{blockLen:r,buffer:n,buffer32:s}=this,i=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<i;){this.pos===r&&(ws(s),this.compress(s,0,!1),ws(s),this.pos=0);const l=Math.min(r-this.pos,i-c),u=o+c;if(l===r&&!(u%4)&&c+l<i){const d=new Uint32Array(a,u,Math.floor((i-c)/4));ws(d);for(let h=0;c+r<i;h+=s.length,c+=r)this.length+=r,this.compress(d,h,!1);ws(d);continue}n.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){Rs(this),Hh(e,this);const{pos:r,buffer32:n}=this;this.finished=!0,Kr(this.buffer.subarray(r)),ws(n),this.compress(n,0,!0),ws(n);const s=pa(e);this.get().forEach((i,o)=>s[o]=Fn(i))}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){const{buffer:r,length:n,finished:s,destroyed:i,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(r),e.destroyed=i,e.finished=s,e.length=n,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class SN extends IN{constructor(e={}){const r=e.dkLen===void 0?64:e.dkLen;super(128,r),this.v0l=Ot[0]|0,this.v0h=Ot[1]|0,this.v1l=Ot[2]|0,this.v1h=Ot[3]|0,this.v2l=Ot[4]|0,this.v2h=Ot[5]|0,this.v3l=Ot[6]|0,this.v3h=Ot[7]|0,this.v4l=Ot[8]|0,this.v4h=Ot[9]|0,this.v5l=Ot[10]|0,this.v5h=Ot[11]|0,this.v6l=Ot[12]|0,this.v6h=Ot[13]|0,this.v7l=Ot[14]|0,this.v7h=Ot[15]|0,AN(r,e,64,16,16);let{key:n,personalization:s,salt:i}=e,o=0;if(n!==void 0&&(n=ln(n),o=n.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=ln(i);const a=pa(i);this.v4l^=Fn(a[0]),this.v4h^=Fn(a[1]),this.v5l^=Fn(a[2]),this.v5h^=Fn(a[3])}if(s!==void 0){s=ln(s);const a=pa(s);this.v6l^=Fn(a[0]),this.v6h^=Fn(a[1]),this.v7l^=Fn(a[2]),this.v7h^=Fn(a[3])}if(n!==void 0){const a=new Uint8Array(this.blockLen);a.set(n),this.update(a)}}get(){let{v0l:e,v0h:r,v1l:n,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:d,v5h:h,v6l:m,v6h:f,v7l:g,v7h:_}=this;return[e,r,n,s,i,o,a,c,l,u,d,h,m,f,g,_]}set(e,r,n,s,i,o,a,c,l,u,d,h,m,f,g,_){this.v0l=e|0,this.v0h=r|0,this.v1l=n|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=d|0,this.v5h=h|0,this.v6l=m|0,this.v6h=f|0,this.v7l=g|0,this.v7h=_|0}compress(e,r,n){this.get().forEach((c,l)=>ae[l]=c),ae.set(Ot,16);let{h:s,l:i}=zy(BigInt(this.length));ae[24]=Ot[8]^i,ae[25]=Ot[9]^s,n&&(ae[28]=~ae[28],ae[29]=~ae[29]);let o=0;const a=CN;for(let c=0;c<12;c++)us(0,4,8,12,e,r+2*a[o++]),ds(0,4,8,12,e,r+2*a[o++]),us(1,5,9,13,e,r+2*a[o++]),ds(1,5,9,13,e,r+2*a[o++]),us(2,6,10,14,e,r+2*a[o++]),ds(2,6,10,14,e,r+2*a[o++]),us(3,7,11,15,e,r+2*a[o++]),ds(3,7,11,15,e,r+2*a[o++]),us(0,5,10,15,e,r+2*a[o++]),ds(0,5,10,15,e,r+2*a[o++]),us(1,6,11,12,e,r+2*a[o++]),ds(1,6,11,12,e,r+2*a[o++]),us(2,7,8,13,e,r+2*a[o++]),ds(2,7,8,13,e,r+2*a[o++]),us(3,4,9,14,e,r+2*a[o++]),ds(3,4,9,14,e,r+2*a[o++]);this.v0l^=ae[0]^ae[16],this.v0h^=ae[1]^ae[17],this.v1l^=ae[2]^ae[18],this.v1h^=ae[3]^ae[19],this.v2l^=ae[4]^ae[20],this.v2h^=ae[5]^ae[21],this.v3l^=ae[6]^ae[22],this.v3h^=ae[7]^ae[23],this.v4l^=ae[8]^ae[24],this.v4h^=ae[9]^ae[25],this.v5l^=ae[10]^ae[26],this.v5h^=ae[11]^ae[27],this.v6l^=ae[12]^ae[28],this.v6h^=ae[13]^ae[29],this.v7l^=ae[14]^ae[30],this.v7h^=ae[15]^ae[31],Kr(ae)}destroy(){this.destroyed=!0,Kr(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const TN=Q2(t=>new SN(t)),NN="https://rpc.walletconnect.org/v1";function r0(t){const e=`Ethereum Signed Message:
${t.length}`,r=new TextEncoder().encode(e+t);return"0x"+Buffer.from(uN(r)).toString("hex")}async function xN(t,e,r,n,s,i){switch(r.t){case"eip191":return await ON(t,e,r.s);case"eip1271":return await RN(t,e,r.s,n,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}async function ON(t,e,r){return(await HI({hash:r0(e),signature:r})).toLowerCase()===t.toLowerCase()}async function RN(t,e,r,n,s,i){const o=Zi(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l="0000000000000000000000000000000000000000000000000000000000000041",u=r.substring(2),d=r0(e).substring(2),h=a+d+c+l+u,m=await fetch(`${i||NN}/?chainId=${n}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:PN(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:h},"latest"]})}),{result:f}=await m.json();return f?f.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function PN(){return Date.now()+Math.floor(Math.random()*1e3)}function DN(t){const e=atob(t),r=new Uint8Array(e.length);for(let o=0;o<e.length;o++)r[o]=e.charCodeAt(o);const n=r[0];if(n===0)throw new Error("No signatures found");const s=1+n*64;if(r.length<s)throw new Error("Transaction data too short for claimed signature count");if(r.length<100)throw new Error("Transaction too short");const i=Buffer.from(t,"base64").slice(1,65);return fo.encode(i)}function kN(t){const e=new Uint8Array(Buffer.from(t,"base64")),r=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),n=new Uint8Array(r.length+e.length);n.set(r),n.set(e,r.length);const s=TN(n,{dkLen:32});return fo.encode(s)}function Qp(t){const e=new Uint8Array(Rl(UN(t)));return fo.encode(e)}function UN(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!=null&&t.data)return new Uint8Array(Object.values(t.data));if(typeof t=="object"&&t)return new Uint8Array(Object.values(t));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function eg(t){const e=Buffer.from(t,"base64"),r=rT(e).txn;if(!r)throw new Error("Invalid signed transaction: missing 'txn' field");const n=KS(r),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(n)]),o=_N(i);return uT.encode(o).replace(/=+$/,"")}function Du(t){const e=[];let r=BigInt(t);for(;r>=BigInt(128);)e.push(Number(r&BigInt(127)|BigInt(128))),r>>=BigInt(7);return e.push(Number(r)),Buffer.from(e)}function $N(t){const e=Buffer.from(t.signed.bodyBytes,"base64"),r=Buffer.from(t.signed.authInfoBytes,"base64"),n=Buffer.from(t.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(Du(e.length)),s.push(e),s.push(Buffer.from([18])),s.push(Du(r.length)),s.push(r),s.push(Buffer.from([26])),s.push(Du(n.length)),s.push(n);const i=Buffer.concat(s),o=Rl(i);return Buffer.from(o).toString("hex").toUpperCase()}var BN=Object.defineProperty,LN=Object.defineProperties,MN=Object.getOwnPropertyDescriptors,tg=Object.getOwnPropertySymbols,FN=Object.prototype.hasOwnProperty,jN=Object.prototype.propertyIsEnumerable,rg=(t,e,r)=>e in t?BN(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,qN=(t,e)=>{for(var r in e||(e={}))FN.call(e,r)&&rg(t,r,e[r]);if(tg)for(var r of tg(e))jN.call(e,r)&&rg(t,r,e[r]);return t},HN=(t,e)=>LN(t,MN(e));const WN="did:pkh:",zh=t=>t==null?void 0:t.split(":"),zN=t=>{const e=t&&zh(t);if(e)return t.includes(WN)?e[3]:e[1]},Md=t=>{const e=t&&zh(t);if(e)return e[2]+":"+e[3]},sl=t=>{const e=t&&zh(t);if(e)return e.pop()};async function ng(t){const{cacao:e,projectId:r}=t,{s:n,p:s}=e,i=n0(s,s.iss),o=sl(s.iss);return await xN(o,i,n,Md(s.iss),r)}const n0=(t,e)=>{const r=`${t.domain} wants you to sign in with your Ethereum account:`,n=sl(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=t.statement||void 0;const i=`URI: ${t.aud||t.uri}`,o=`Version: ${t.version}`,a=`Chain ID: ${zN(e)}`,c=`Nonce: ${t.nonce}`,l=`Issued At: ${t.iat}`,u=t.exp?`Expiration Time: ${t.exp}`:void 0,d=t.nbf?`Not Before: ${t.nbf}`:void 0,h=t.requestId?`Request ID: ${t.requestId}`:void 0,m=t.resources?`Resources:${t.resources.map(g=>`
- ${g}`).join("")}`:void 0,f=Lc(t.resources);if(f){const g=ga(f);s=ex(s,g)}return[r,n,"",s,"",i,o,a,c,l,u,d,h,m].filter(g=>g!=null).join(`
`)};function VN(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function KN(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function ci(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(r=>{const n=t.att[r];if(Array.isArray(n))throw new Error(`Resource must be an object: ${r}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${r}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${r}`);Object.keys(n).forEach(s=>{const i=n[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function GN(t,e,r,n={}){return r==null||r.sort((s,i)=>s.localeCompare(i)),{att:{[t]:YN(e,r,n)}}}function YN(t,e,r={}){e=e==null?void 0:e.sort((s,i)=>s.localeCompare(i));const n=e.map(s=>({[`${t}/${s}`]:[r]}));return Object.assign({},...n)}function s0(t){return ci(t),`urn:recap:${VN(t).replace(/=/g,"")}`}function ga(t){const e=KN(t.replace("urn:recap:",""));return ci(e),e}function ZN(t,e,r){const n=GN(t,e,r);return s0(n)}function JN(t){return t&&t.includes("urn:recap:")}function XN(t,e){const r=ga(t),n=ga(e),s=QN(r,n);return s0(s)}function QN(t,e){ci(t),ci(e);const r=Object.keys(t.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),n={att:{}};return r.forEach(s=>{var i,o;Object.keys(((i=t.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;n.att[s]=HN(qN({},n.att[s]),{[a]:((c=t.att[s])==null?void 0:c[a])||((l=e.att[s])==null?void 0:l[a])})})}),n}function ex(t="",e){ci(e);const r="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(r))return t;const n=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,h)=>d.action.localeCompare(h.action));const l={};c.forEach(d=>{l[d.ability]||(l[d.ability]=[]),l[d.ability].push(d.action)});const u=Object.keys(l).map(d=>(s++,`(${s}) '${d}': '${l[d].join("', '")}' for '${a}'.`));n.push(u.join(", ").replace(".,","."))});const i=n.join(" "),o=`${r}${i}`;return`${t?t+" ":""}${o}`}function sg(t){var e;const r=ga(t);ci(r);const n=(e=r.att)==null?void 0:e.eip155;return n?Object.keys(n).map(s=>s.split("/")[1]):[]}function ig(t){const e=ga(t);ci(e);const r=[];return Object.values(e.att).forEach(n=>{Object.values(n).forEach(s=>{var i;(i=s==null?void 0:s[0])!=null&&i.chains&&r.push(s[0].chains)})}),[...new Set(r.flat())]}function Lc(t){if(!t)return;const e=t==null?void 0:t[t.length-1];return JN(e)?e:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function i0(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Fd(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function ku(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function vr(t,...e){if(!i0(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function og(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function tx(t,e){vr(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function As(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function no(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function rx(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const nx=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function sx(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function jd(t){if(typeof t=="string")t=sx(t);else if(i0(t))t=qd(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function ix(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function ox(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}const ax=(t,e)=>{function r(n,...s){if(vr(n),!nx)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");t.varSizeNonce?vr(l):vr(l,t.nonceLength)}const i=t.tagLength;i&&s[1]!==void 0&&vr(s[1]);const o=e(n,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");vr(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,vr(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(vr(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(r,t),r};function ag(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(r&&!lx(e))throw new Error("invalid output, must be aligned");return e}function cg(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i);t.setUint32(e+4,o,n),t.setUint32(e+0,a,n)}function cx(t,e,r){Fd(r);const n=new Uint8Array(16),s=rx(n);return cg(s,0,BigInt(e),r),cg(s,8,BigInt(t),r),n}function lx(t){return t.byteOffset%4===0}function qd(t){return Uint8Array.from(t)}const o0=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),ux=o0("expand 16-byte k"),dx=o0("expand 32-byte k"),hx=As(ux),fx=As(dx);function We(t,e){return t<<e|t>>>32-e}function Hd(t){return t.byteOffset%4===0}const wc=64,px=16,a0=2**32-1,lg=new Uint32Array;function gx(t,e,r,n,s,i,o,a){const c=s.length,l=new Uint8Array(wc),u=As(l),d=Hd(s)&&Hd(i),h=d?As(s):lg,m=d?As(i):lg;for(let f=0;f<c;o++){if(t(e,r,n,u,o,a),o>=a0)throw new Error("arx: counter overflow");const g=Math.min(wc,c-f);if(d&&g===wc){const _=f/4;if(f%4!==0)throw new Error("arx: invalid block position");for(let I=0,N;I<px;I++)N=_+I,m[N]=h[N]^u[I];f+=wc;continue}for(let _=0,I;_<g;_++)I=f+_,i[I]=s[I]^l[_];f+=g}}function mx(t,e){const{allowShortKeys:r,extendNonceFn:n,counterLength:s,counterRight:i,rounds:o}=ix({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return ku(s),ku(o),Fd(i),Fd(r),(a,c,l,u,d=0)=>{vr(a),vr(c),vr(l);const h=l.length;if(u===void 0&&(u=new Uint8Array(h)),vr(u),ku(d),d<0||d>=a0)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const m=[];let f=a.length,g,_;if(f===32)m.push(g=qd(a)),_=fx;else if(f===16&&r)g=new Uint8Array(32),g.set(a),g.set(a,16),_=hx,m.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${f}`);Hd(c)||m.push(c=qd(c));const I=As(g);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(_,I,As(c.subarray(0,16)),I),c=c.subarray(16)}const N=16-s;if(N!==c.length)throw new Error(`arx: nonce must be ${N} or 16 bytes`);if(N!==12){const E=new Uint8Array(12);E.set(c,i?0:12-c.length),c=E,m.push(c)}const C=As(c);return gx(t,_,I,C,l,u,d,o),no(...m),u}}const qt=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class wx{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=jd(e),vr(e,32);const r=qt(e,0),n=qt(e,2),s=qt(e,4),i=qt(e,6),o=qt(e,8),a=qt(e,10),c=qt(e,12),l=qt(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=qt(e,16+2*u)}process(e,r,n=!1){const s=n?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],h=o[5],m=o[6],f=o[7],g=o[8],_=o[9],I=qt(e,r+0),N=qt(e,r+2),C=qt(e,r+4),E=qt(e,r+6),v=qt(e,r+8),A=qt(e,r+10),x=qt(e,r+12),D=qt(e,r+14);let U=i[0]+(I&8191),M=i[1]+((I>>>13|N<<3)&8191),$=i[2]+((N>>>10|C<<6)&8191),F=i[3]+((C>>>7|E<<9)&8191),W=i[4]+((E>>>4|v<<12)&8191),q=i[5]+(v>>>1&8191),y=i[6]+((v>>>14|A<<2)&8191),b=i[7]+((A>>>11|x<<5)&8191),O=i[8]+((x>>>8|D<<8)&8191),B=i[9]+(D>>>5|s),k=0,L=k+U*a+M*(5*_)+$*(5*g)+F*(5*f)+W*(5*m);k=L>>>13,L&=8191,L+=q*(5*h)+y*(5*d)+b*(5*u)+O*(5*l)+B*(5*c),k+=L>>>13,L&=8191;let H=k+U*c+M*a+$*(5*_)+F*(5*g)+W*(5*f);k=H>>>13,H&=8191,H+=q*(5*m)+y*(5*h)+b*(5*d)+O*(5*u)+B*(5*l),k+=H>>>13,H&=8191;let K=k+U*l+M*c+$*a+F*(5*_)+W*(5*g);k=K>>>13,K&=8191,K+=q*(5*f)+y*(5*m)+b*(5*h)+O*(5*d)+B*(5*u),k+=K>>>13,K&=8191;let Q=k+U*u+M*l+$*c+F*a+W*(5*_);k=Q>>>13,Q&=8191,Q+=q*(5*g)+y*(5*f)+b*(5*m)+O*(5*h)+B*(5*d),k+=Q>>>13,Q&=8191;let Z=k+U*d+M*u+$*l+F*c+W*a;k=Z>>>13,Z&=8191,Z+=q*(5*_)+y*(5*g)+b*(5*f)+O*(5*m)+B*(5*h),k+=Z>>>13,Z&=8191;let re=k+U*h+M*d+$*u+F*l+W*c;k=re>>>13,re&=8191,re+=q*a+y*(5*_)+b*(5*g)+O*(5*f)+B*(5*m),k+=re>>>13,re&=8191;let we=k+U*m+M*h+$*d+F*u+W*l;k=we>>>13,we&=8191,we+=q*c+y*a+b*(5*_)+O*(5*g)+B*(5*f),k+=we>>>13,we&=8191;let Ee=k+U*f+M*m+$*h+F*d+W*u;k=Ee>>>13,Ee&=8191,Ee+=q*l+y*c+b*a+O*(5*_)+B*(5*g),k+=Ee>>>13,Ee&=8191;let Ne=k+U*g+M*f+$*m+F*h+W*d;k=Ne>>>13,Ne&=8191,Ne+=q*u+y*l+b*c+O*a+B*(5*_),k+=Ne>>>13,Ne&=8191;let be=k+U*_+M*g+$*f+F*m+W*h;k=be>>>13,be&=8191,be+=q*d+y*u+b*l+O*c+B*a,k+=be>>>13,be&=8191,k=(k<<2)+k|0,k=k+L|0,L=k&8191,k=k>>>13,H+=k,i[0]=L,i[1]=H,i[2]=K,i[3]=Q,i[4]=Z,i[5]=re,i[6]=we,i[7]=Ee,i[8]=Ne,i[9]=be}finalize(){const{h:e,pad:r}=this,n=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,n[0]=e[0]+5,s=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+s,s=n[a]>>>13,n[a]&=8191;n[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)n[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+r[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+r[a]|0)+(o>>>16)|0,e[a]=o&65535;no(n)}update(e){og(this),e=jd(e),vr(e);const{buffer:r,blockLen:n}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o===n){for(;n<=s-i;i+=n)this.process(e,i);continue}r.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){no(this.h,this.r,this.buffer,this.pad)}digestInto(e){og(this),tx(e,this),this.finished=!0;const{buffer:r,h:n}=this;let{pos:s}=this;if(s){for(r[s++]=1;s<16;s++)r[s]=0;this.process(r,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}}function yx(t){const e=(n,s)=>t(s).update(jd(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}const bx=yx(t=>new wx(t));function Ex(t,e,r,n,s,i=20){let o=t[0],a=t[1],c=t[2],l=t[3],u=e[0],d=e[1],h=e[2],m=e[3],f=e[4],g=e[5],_=e[6],I=e[7],N=s,C=r[0],E=r[1],v=r[2],A=o,x=a,D=c,U=l,M=u,$=d,F=h,W=m,q=f,y=g,b=_,O=I,B=N,k=C,L=E,H=v;for(let Q=0;Q<i;Q+=2)A=A+M|0,B=We(B^A,16),q=q+B|0,M=We(M^q,12),A=A+M|0,B=We(B^A,8),q=q+B|0,M=We(M^q,7),x=x+$|0,k=We(k^x,16),y=y+k|0,$=We($^y,12),x=x+$|0,k=We(k^x,8),y=y+k|0,$=We($^y,7),D=D+F|0,L=We(L^D,16),b=b+L|0,F=We(F^b,12),D=D+F|0,L=We(L^D,8),b=b+L|0,F=We(F^b,7),U=U+W|0,H=We(H^U,16),O=O+H|0,W=We(W^O,12),U=U+W|0,H=We(H^U,8),O=O+H|0,W=We(W^O,7),A=A+$|0,H=We(H^A,16),b=b+H|0,$=We($^b,12),A=A+$|0,H=We(H^A,8),b=b+H|0,$=We($^b,7),x=x+F|0,B=We(B^x,16),O=O+B|0,F=We(F^O,12),x=x+F|0,B=We(B^x,8),O=O+B|0,F=We(F^O,7),D=D+W|0,k=We(k^D,16),q=q+k|0,W=We(W^q,12),D=D+W|0,k=We(k^D,8),q=q+k|0,W=We(W^q,7),U=U+M|0,L=We(L^U,16),y=y+L|0,M=We(M^y,12),U=U+M|0,L=We(L^U,8),y=y+L|0,M=We(M^y,7);let K=0;n[K++]=o+A|0,n[K++]=a+x|0,n[K++]=c+D|0,n[K++]=l+U|0,n[K++]=u+M|0,n[K++]=d+$|0,n[K++]=h+F|0,n[K++]=m+W|0,n[K++]=f+q|0,n[K++]=g+y|0,n[K++]=_+b|0,n[K++]=I+O|0,n[K++]=N+B|0,n[K++]=C+k|0,n[K++]=E+L|0,n[K++]=v+H|0}const vx=mx(Ex,{counterRight:!1,counterLength:4,allowShortKeys:!1}),_x=new Uint8Array(16),ug=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(_x.subarray(r))},Cx=new Uint8Array(32);function dg(t,e,r,n,s){const i=t(e,r,Cx),o=bx.create(i);s&&ug(o,s),ug(o,n);const a=cx(n.length,s?s.length:0,!0);o.update(a);const c=o.digest();return no(i,a),c}const Ax=t=>(e,r,n)=>({encrypt(s,i){const o=s.length;i=ag(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);t(e,r,a,a,1);const c=dg(t,e,r,a,n);return i.set(c,o),no(c),i},decrypt(s,i){i=ag(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=dg(t,e,r,o,n);if(!ox(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),t(e,r,i,i,1),no(c),i}}),c0=ax({blockSize:64,nonceLength:12,tagLength:16},Ax(vx));let l0=class extends Ol{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,qh(e);const n=ln(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Kr(i)}update(e){return Rs(this),this.iHash.update(e),this}digestInto(e){Rs(this),Os(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Pl=(t,e,r)=>new l0(t,e).update(r).digest();Pl.create=(t,e)=>new l0(t,e);function Ix(t,e,r){return qh(t),r===void 0&&(r=new Uint8Array(t.outputLen)),Pl(t,ln(r),ln(e))}const Uu=Uint8Array.from([0]),hg=Uint8Array.of();function Sx(t,e,r,n=32){qh(t),Qn(n);const s=t.outputLen;if(n>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(n/s);r===void 0&&(r=hg);const o=new Uint8Array(i*s),a=Pl.create(t,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)Uu[0]=u+1,c.update(u===0?hg:l).update(r).update(Uu).digestInto(l),o.set(l,s*u),a._cloneInto(c);return a.destroy(),c.destroy(),Kr(l,Uu),o.slice(0,n)}const Tx=(t,e,r,n,s)=>Sx(t,Ix(t,e,r),n,s),Dl=Rl;/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Vh=BigInt(0),Wd=BigInt(1);function Ka(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Kh(t){if(!Ka(t))throw new Error("Uint8Array expected")}function ma(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function yc(t){const e=t.toString(16);return e.length&1?"0"+e:e}function u0(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Vh:BigInt("0x"+t)}const d0=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Nx=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function wa(t){if(Kh(t),d0)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=Nx[t[r]];return e}const Bn={_0:48,_9:57,A:65,F:70,a:97,f:102};function fg(t){if(t>=Bn._0&&t<=Bn._9)return t-Bn._0;if(t>=Bn.A&&t<=Bn.F)return t-(Bn.A-10);if(t>=Bn.a&&t<=Bn.f)return t-(Bn.a-10)}function il(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(d0)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){const o=fg(t.charCodeAt(i)),a=fg(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function ei(t){return u0(wa(t))}function ol(t){return Kh(t),u0(wa(Uint8Array.from(t).reverse()))}function Ga(t,e){return il(t.toString(16).padStart(e*2,"0"))}function Gh(t,e){return Ga(t,e).reverse()}function br(t,e,r){let n;if(typeof e=="string")try{n=il(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Ka(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(t+" of length "+r+" expected, got "+s);return n}function al(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];Kh(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}const $u=t=>typeof t=="bigint"&&Vh<=t;function Yh(t,e,r){return $u(t)&&$u(e)&&$u(r)&&e<=t&&t<r}function Is(t,e,r,n){if(!Yh(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function xx(t){let e;for(e=0;t>Vh;t>>=Wd,e+=1);return e}const kl=t=>(Wd<<BigInt(t))-Wd,Bu=t=>new Uint8Array(t),pg=t=>Uint8Array.from(t);function Ox(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Bu(t),s=Bu(t),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...u)=>r(s,n,...u),c=(u=Bu(0))=>{s=a(pg([0]),u),n=a(),u.length!==0&&(s=a(pg([1]),u),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let u=0;const d=[];for(;u<e;){n=a();const h=n.slice();d.push(h),u+=n.length}return al(...d)};return(u,d)=>{o(),c(u);let h;for(;!(h=d(l()));)c();return o(),h}}const Rx={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Ka(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Ya(t,e,r={}){const n=(s,i,o)=>{const a=Rx[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(r))n(s,i,!0);return t}function gg(t){const e=new WeakMap;return(r,...n)=>{const s=e.get(r);if(s!==void 0)return s;const i=t(r,...n);return e.set(r,i),i}}const Ar=BigInt(0),sr=BigInt(1),Zs=BigInt(2),Px=BigInt(3),h0=BigInt(4),f0=BigInt(5),p0=BigInt(8);function _r(t,e){const r=t%e;return r>=Ar?r:e+r}function nn(t,e,r){let n=t;for(;e-- >Ar;)n*=n,n%=r;return n}function zd(t,e){if(t===Ar)throw new Error("invert: expected non-zero number");if(e<=Ar)throw new Error("invert: expected positive modulus, got "+e);let r=_r(t,e),n=e,s=Ar,i=sr;for(;r!==Ar;){const o=n/r,a=n%r,c=s-i*o;n=r,r=a,s=i,i=c}if(n!==sr)throw new Error("invert: does not exist");return _r(s,e)}function g0(t,e){const r=(t.ORDER+sr)/h0,n=t.pow(e,r);if(!t.eql(t.sqr(n),e))throw new Error("Cannot find square root");return n}function Dx(t,e){const r=(t.ORDER-f0)/p0,n=t.mul(e,Zs),s=t.pow(n,r),i=t.mul(e,s),o=t.mul(t.mul(i,Zs),s),a=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function kx(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-sr,r=0;for(;e%Zs===Ar;)e/=Zs,r++;let n=Zs;const s=Za(t);for(;mg(s,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return g0;let i=s.pow(n,e);const o=(e+sr)/Zs;return function(a,c){if(a.is0(c))return c;if(mg(a,c)!==1)throw new Error("Cannot find square root");let l=r,u=a.mul(a.ONE,i),d=a.pow(c,e),h=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let m=1,f=a.sqr(d);for(;!a.eql(f,a.ONE);)if(m++,f=a.sqr(f),m===l)throw new Error("Cannot find square root");const g=sr<<BigInt(l-m-1),_=a.pow(u,g);l=m,u=a.sqr(_),d=a.mul(d,u),h=a.mul(h,_)}return h}}function Ux(t){return t%h0===Px?g0:t%p0===f0?Dx:kx(t)}const $x=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Bx(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=$x.reduce((n,s)=>(n[s]="function",n),e);return Ya(t,r)}function Lx(t,e,r){if(r<Ar)throw new Error("invalid exponent, negatives unsupported");if(r===Ar)return t.ONE;if(r===sr)return e;let n=t.ONE,s=e;for(;r>Ar;)r&sr&&(n=t.mul(n,s)),s=t.sqr(s),r>>=sr;return n}function m0(t,e,r=!1){const n=new Array(e.length).fill(r?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(n[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(n[c]=t.mul(o,n[c]),t.mul(o,a)),i),n}function mg(t,e){const r=(t.ORDER-sr)/Zs,n=t.pow(e,r),s=t.eql(n,t.ONE),i=t.eql(n,t.ZERO),o=t.eql(n,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function w0(t,e){e!==void 0&&Qn(e);const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Za(t,e,r=!1,n={}){if(t<=Ar)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=w0(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:s,BYTES:i,MASK:kl(s),ZERO:Ar,ONE:sr,create:c=>_r(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Ar<=c&&c<t},is0:c=>c===Ar,isOdd:c=>(c&sr)===sr,neg:c=>_r(-c,t),eql:(c,l)=>c===l,sqr:c=>_r(c*c,t),add:(c,l)=>_r(c+l,t),sub:(c,l)=>_r(c-l,t),mul:(c,l)=>_r(c*l,t),pow:(c,l)=>Lx(a,c,l),div:(c,l)=>_r(c*zd(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>zd(c,t),sqrt:n.sqrt||(c=>(o||(o=Ux(t)),o(a,c))),toBytes:c=>r?Gh(c,i):Ga(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return r?ol(c):ei(c)},invertBatch:c=>m0(a,c),cmov:(c,l,u)=>u?l:c});return Object.freeze(a)}function y0(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function b0(t){const e=y0(t);return e+Math.ceil(e/2)}function Mx(t,e,r=!1){const n=t.length,s=y0(e),i=b0(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=r?ol(t):ei(t),a=_r(o,e-sr)+sr;return r?Gh(a,s):Ga(a,s)}const wg=BigInt(0),Vd=BigInt(1);function Lu(t,e){const r=e.negate();return t?r:e}function E0(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Mu(t,e){E0(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1),s=2**t,i=kl(t),o=BigInt(t);return{windows:r,windowSize:n,mask:i,maxNumber:s,shiftBy:o}}function yg(t,e,r){const{windowSize:n,mask:s,maxNumber:i,shiftBy:o}=r;let a=Number(t&s),c=t>>o;a>n&&(a-=i,c+=Vd);const l=e*n,u=l+Math.abs(a)-1,d=a===0,h=a<0,m=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:m,offsetF:l}}function Fx(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function jx(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const Fu=new WeakMap,v0=new WeakMap;function ju(t){return v0.get(t)||1}function qx(t,e){return{constTimeNegate:Lu,hasPrecomputes(r){return ju(r)!==1},unsafeLadder(r,n,s=t.ZERO){let i=r;for(;n>wg;)n&Vd&&(s=s.add(i)),i=i.double(),n>>=Vd;return s},precomputeWindow(r,n){const{windows:s,windowSize:i}=Mu(n,e),o=[];let a=r,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,s){let i=t.ZERO,o=t.BASE;const a=Mu(r,e);for(let c=0;c<a.windows;c++){const{nextN:l,offset:u,isZero:d,isNeg:h,isNegF:m,offsetF:f}=yg(s,c,a);s=l,d?o=o.add(Lu(m,n[f])):i=i.add(Lu(h,n[u]))}return{p:i,f:o}},wNAFUnsafe(r,n,s,i=t.ZERO){const o=Mu(r,e);for(let a=0;a<o.windows&&s!==wg;a++){const{nextN:c,offset:l,isZero:u,isNeg:d}=yg(s,a,o);if(s=c,!u){const h=n[l];i=i.add(d?h.negate():h)}}return i},getPrecomputes(r,n,s){let i=Fu.get(n);return i||(i=this.precomputeWindow(n,r),r!==1&&Fu.set(n,s(i))),i},wNAFCached(r,n,s){const i=ju(r);return this.wNAF(i,this.getPrecomputes(i,r,s),n)},wNAFCachedUnsafe(r,n,s,i){const o=ju(r);return o===1?this.unsafeLadder(r,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,r,s),n,i)},setWindowSize(r,n){E0(n,e),v0.set(r,n),Fu.delete(r)}}}function Hx(t,e,r,n){Fx(r,t),jx(n,e);const s=r.length,i=n.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=xx(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=kl(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let h=o;for(let m=d;m>=0;m-=c){u.fill(o);for(let g=0;g<i;g++){const _=n[g],I=Number(_>>BigInt(m)&l);u[I]=u[I].add(r[g])}let f=o;for(let g=u.length-1,_=o;g>0;g--)_=_.add(u[g]),f=f.add(_);if(h=h.add(f),m!==0)for(let g=0;g<c;g++)h=h.double()}return h}function _0(t){return Bx(t.Fp),Ya(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...w0(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Oo=BigInt(0),Ni=BigInt(1),bc=BigInt(2);function Wx(t){return Ya(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function zx(t){const e=Wx(t),{P:r,type:n,adjustScalarBytes:s,powPminus2:i}=e,o=n==="x25519";if(!o&&n!=="x448")throw new Error("invalid type");const a=o?255:448,c=o?32:56,l=BigInt(o?9:5),u=BigInt(o?121665:39081),d=o?bc**BigInt(254):bc**BigInt(447),h=o?BigInt(8)*bc**BigInt(251)-Ni:BigInt(4)*bc**BigInt(445)-Ni,m=d+h+Ni,f=x=>_r(x,r),g=_(l);function _(x){return Gh(f(x),c)}function I(x){const D=br("u coordinate",x,c);return o&&(D[31]&=127),f(ol(D))}function N(x){return ol(s(br("scalar",x,c)))}function C(x,D){const U=A(I(D),N(x));if(U===Oo)throw new Error("invalid private or public key received");return _(U)}function E(x){return C(x,g)}function v(x,D,U){const M=f(x*(D-U));return D=f(D-M),U=f(U+M),{x_2:D,x_3:U}}function A(x,D){Is("u",x,Oo,r),Is("scalar",D,d,m);const U=D,M=x;let $=Ni,F=Oo,W=x,q=Ni,y=Oo;for(let O=BigInt(a-1);O>=Oo;O--){const B=U>>O&Ni;y^=B,{x_2:$,x_3:W}=v(y,$,W),{x_2:F,x_3:q}=v(y,F,q),y=B;const k=$+F,L=f(k*k),H=$-F,K=f(H*H),Q=L-K,Z=W+q,re=W-q,we=f(re*k),Ee=f(Z*H),Ne=we+Ee,be=we-Ee;W=f(Ne*Ne),q=f(M*f(be*be)),$=f(L*K),F=f(Q*(L+f(u*Q)))}({x_2:$,x_3:W}=v(y,$,W)),{x_2:F,x_3:q}=v(y,F,q);const b=i(F);return f($*b)}return{scalarMult:C,scalarMultBase:E,getSharedSecret:(x,D)=>C(x,D),getPublicKey:x=>E(x),utils:{randomPrivateKey:()=>e.randomBytes(c)},GuBytes:g.slice()}}const Kd=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const Vx=BigInt(1),bg=BigInt(2),Kx=BigInt(3),Gx=BigInt(5);BigInt(8);function Yx(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),s=BigInt(80),i=Kd,o=t*t%i*t%i,a=nn(o,bg,i)*o%i,c=nn(a,Vx,i)*t%i,l=nn(c,Gx,i)*c%i,u=nn(l,e,i)*l%i,d=nn(u,r,i)*u%i,h=nn(d,n,i)*d%i,m=nn(h,s,i)*h%i,f=nn(m,s,i)*h%i,g=nn(f,e,i)*l%i;return{pow_p_5_8:nn(g,bg,i)*t%i,b2:o}}function Zx(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const Gd=zx({P:Kd,type:"x25519",powPminus2:t=>{const e=Kd,{pow_p_5_8:r,b2:n}=Yx(t);return _r(nn(r,Kx,e)*n,e)},adjustScalarBytes:Zx,randomBytes:go});function Eg(t){t.lowS!==void 0&&ma("lowS",t.lowS),t.prehash!==void 0&&ma("prehash",t.prehash)}function Jx(t){const e=_0(t);Ya(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:r,Fp:n,a:s}=e;if(r){if(!n.eql(s,n.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...e})}class Xx extends Error{constructor(e=""){super(e)}}const Hn={Err:Xx,_tlv:{encode:(t,e)=>{const{Err:r}=Hn;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const n=e.length/2,s=yc(n);if(s.length/2&128)throw new r("tlv.encode: long form length too big");const i=n>127?yc(s.length/2|128):"";return yc(t)+i+s+e},decode(t,e){const{Err:r}=Hn;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(n+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=Hn;if(t<Vn)throw new e("integer: negative integers are not allowed");let r=yc(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=Hn;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return ei(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=Hn,s=br("signature",t),{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:l,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(t){const{_tlv:e,_int:r}=Hn,n=e.encode(2,r.encode(t.r)),s=e.encode(2,r.encode(t.s)),i=n+s;return e.encode(48,i)}};function qu(t,e){return wa(Ga(t,e))}const Vn=BigInt(0),Bt=BigInt(1);BigInt(2);const Hu=BigInt(3),Qx=BigInt(4);function eO(t){const e=Jx(t),{Fp:r}=e,n=Za(e.n,e.nBitLength),s=e.toBytes||((C,E,v)=>{const A=E.toAffine();return al(Uint8Array.from([4]),r.toBytes(A.x),r.toBytes(A.y))}),i=e.fromBytes||(C=>{const E=C.subarray(1),v=r.fromBytes(E.subarray(0,r.BYTES)),A=r.fromBytes(E.subarray(r.BYTES,2*r.BYTES));return{x:v,y:A}});function o(C){const{a:E,b:v}=e,A=r.sqr(C),x=r.mul(A,C);return r.add(r.add(x,r.mul(C,E)),v)}function a(C,E){const v=r.sqr(E),A=o(C);return r.eql(v,A)}if(!a(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const c=r.mul(r.pow(e.a,Hu),Qx),l=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(c,l)))throw new Error("bad curve params: a or b");function u(C){return Yh(C,Bt,e.n)}function d(C){const{allowedPrivateKeyLengths:E,nByteLength:v,wrapPrivateKey:A,n:x}=e;if(E&&typeof C!="bigint"){if(Ka(C)&&(C=wa(C)),typeof C!="string"||!E.includes(C.length))throw new Error("invalid private key");C=C.padStart(v*2,"0")}let D;try{D=typeof C=="bigint"?C:ei(br("private key",C,v))}catch{throw new Error("invalid private key, expected hex or "+v+" bytes, got "+typeof C)}return A&&(D=_r(D,x)),Is("private key",D,Bt,x),D}function h(C){if(!(C instanceof g))throw new Error("ProjectivePoint expected")}const m=gg((C,E)=>{const{px:v,py:A,pz:x}=C;if(r.eql(x,r.ONE))return{x:v,y:A};const D=C.is0();E==null&&(E=D?r.ONE:r.inv(x));const U=r.mul(v,E),M=r.mul(A,E),$=r.mul(x,E);if(D)return{x:r.ZERO,y:r.ZERO};if(!r.eql($,r.ONE))throw new Error("invZ was invalid");return{x:U,y:M}}),f=gg(C=>{if(C.is0()){if(e.allowInfinityPoint&&!r.is0(C.py))return;throw new Error("bad point: ZERO")}const{x:E,y:v}=C.toAffine();if(!r.isValid(E)||!r.isValid(v))throw new Error("bad point: x or y not FE");if(!a(E,v))throw new Error("bad point: equation left != right");if(!C.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class g{constructor(E,v,A){if(E==null||!r.isValid(E))throw new Error("x required");if(v==null||!r.isValid(v)||r.is0(v))throw new Error("y required");if(A==null||!r.isValid(A))throw new Error("z required");this.px=E,this.py=v,this.pz=A,Object.freeze(this)}static fromAffine(E){const{x:v,y:A}=E||{};if(!E||!r.isValid(v)||!r.isValid(A))throw new Error("invalid affine point");if(E instanceof g)throw new Error("projective point not allowed");const x=D=>r.eql(D,r.ZERO);return x(v)&&x(A)?g.ZERO:new g(v,A,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(E){const v=m0(r,E.map(A=>A.pz));return E.map((A,x)=>A.toAffine(v[x])).map(g.fromAffine)}static fromHex(E){const v=g.fromAffine(i(br("pointHex",E)));return v.assertValidity(),v}static fromPrivateKey(E){return g.BASE.multiply(d(E))}static msm(E,v){return Hx(g,n,E,v)}_setWindowSize(E){N.setWindowSize(this,E)}assertValidity(){f(this)}hasEvenY(){const{y:E}=this.toAffine();if(r.isOdd)return!r.isOdd(E);throw new Error("Field doesn't support isOdd")}equals(E){h(E);const{px:v,py:A,pz:x}=this,{px:D,py:U,pz:M}=E,$=r.eql(r.mul(v,M),r.mul(D,x)),F=r.eql(r.mul(A,M),r.mul(U,x));return $&&F}negate(){return new g(this.px,r.neg(this.py),this.pz)}double(){const{a:E,b:v}=e,A=r.mul(v,Hu),{px:x,py:D,pz:U}=this;let M=r.ZERO,$=r.ZERO,F=r.ZERO,W=r.mul(x,x),q=r.mul(D,D),y=r.mul(U,U),b=r.mul(x,D);return b=r.add(b,b),F=r.mul(x,U),F=r.add(F,F),M=r.mul(E,F),$=r.mul(A,y),$=r.add(M,$),M=r.sub(q,$),$=r.add(q,$),$=r.mul(M,$),M=r.mul(b,M),F=r.mul(A,F),y=r.mul(E,y),b=r.sub(W,y),b=r.mul(E,b),b=r.add(b,F),F=r.add(W,W),W=r.add(F,W),W=r.add(W,y),W=r.mul(W,b),$=r.add($,W),y=r.mul(D,U),y=r.add(y,y),W=r.mul(y,b),M=r.sub(M,W),F=r.mul(y,q),F=r.add(F,F),F=r.add(F,F),new g(M,$,F)}add(E){h(E);const{px:v,py:A,pz:x}=this,{px:D,py:U,pz:M}=E;let $=r.ZERO,F=r.ZERO,W=r.ZERO;const q=e.a,y=r.mul(e.b,Hu);let b=r.mul(v,D),O=r.mul(A,U),B=r.mul(x,M),k=r.add(v,A),L=r.add(D,U);k=r.mul(k,L),L=r.add(b,O),k=r.sub(k,L),L=r.add(v,x);let H=r.add(D,M);return L=r.mul(L,H),H=r.add(b,B),L=r.sub(L,H),H=r.add(A,x),$=r.add(U,M),H=r.mul(H,$),$=r.add(O,B),H=r.sub(H,$),W=r.mul(q,L),$=r.mul(y,B),W=r.add($,W),$=r.sub(O,W),W=r.add(O,W),F=r.mul($,W),O=r.add(b,b),O=r.add(O,b),B=r.mul(q,B),L=r.mul(y,L),O=r.add(O,B),B=r.sub(b,B),B=r.mul(q,B),L=r.add(L,B),b=r.mul(O,L),F=r.add(F,b),b=r.mul(H,L),$=r.mul(k,$),$=r.sub($,b),b=r.mul(k,O),W=r.mul(H,W),W=r.add(W,b),new g($,F,W)}subtract(E){return this.add(E.negate())}is0(){return this.equals(g.ZERO)}wNAF(E){return N.wNAFCached(this,E,g.normalizeZ)}multiplyUnsafe(E){const{endo:v,n:A}=e;Is("scalar",E,Vn,A);const x=g.ZERO;if(E===Vn)return x;if(this.is0()||E===Bt)return this;if(!v||N.hasPrecomputes(this))return N.wNAFCachedUnsafe(this,E,g.normalizeZ);let{k1neg:D,k1:U,k2neg:M,k2:$}=v.splitScalar(E),F=x,W=x,q=this;for(;U>Vn||$>Vn;)U&Bt&&(F=F.add(q)),$&Bt&&(W=W.add(q)),q=q.double(),U>>=Bt,$>>=Bt;return D&&(F=F.negate()),M&&(W=W.negate()),W=new g(r.mul(W.px,v.beta),W.py,W.pz),F.add(W)}multiply(E){const{endo:v,n:A}=e;Is("scalar",E,Bt,A);let x,D;if(v){const{k1neg:U,k1:M,k2neg:$,k2:F}=v.splitScalar(E);let{p:W,f:q}=this.wNAF(M),{p:y,f:b}=this.wNAF(F);W=N.constTimeNegate(U,W),y=N.constTimeNegate($,y),y=new g(r.mul(y.px,v.beta),y.py,y.pz),x=W.add(y),D=q.add(b)}else{const{p:U,f:M}=this.wNAF(E);x=U,D=M}return g.normalizeZ([x,D])[0]}multiplyAndAddUnsafe(E,v,A){const x=g.BASE,D=(M,$)=>$===Vn||$===Bt||!M.equals(x)?M.multiplyUnsafe($):M.multiply($),U=D(this,v).add(D(E,A));return U.is0()?void 0:U}toAffine(E){return m(this,E)}isTorsionFree(){const{h:E,isTorsionFree:v}=e;if(E===Bt)return!0;if(v)return v(g,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:E,clearCofactor:v}=e;return E===Bt?this:v?v(g,this):this.multiplyUnsafe(e.h)}toRawBytes(E=!0){return ma("isCompressed",E),this.assertValidity(),s(g,this,E)}toHex(E=!0){return ma("isCompressed",E),wa(this.toRawBytes(E))}}g.BASE=new g(e.Gx,e.Gy,r.ONE),g.ZERO=new g(r.ZERO,r.ONE,r.ZERO);const{endo:_,nBitLength:I}=e,N=qx(g,_?Math.ceil(I/2):I);return{CURVE:e,ProjectivePoint:g,normPrivateKeyToScalar:d,weierstrassEquation:o,isWithinCurveOrder:u}}function tO(t){const e=_0(t);return Ya(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function rO(t){const e=tO(t),{Fp:r,n,nByteLength:s,nBitLength:i}=e,o=r.BYTES+1,a=2*r.BYTES+1;function c(y){return _r(y,n)}function l(y){return zd(y,n)}const{ProjectivePoint:u,normPrivateKeyToScalar:d,weierstrassEquation:h,isWithinCurveOrder:m}=eO({...e,toBytes(y,b,O){const B=b.toAffine(),k=r.toBytes(B.x),L=al;return ma("isCompressed",O),O?L(Uint8Array.from([b.hasEvenY()?2:3]),k):L(Uint8Array.from([4]),k,r.toBytes(B.y))},fromBytes(y){const b=y.length,O=y[0],B=y.subarray(1);if(b===o&&(O===2||O===3)){const k=ei(B);if(!Yh(k,Bt,r.ORDER))throw new Error("Point is not on curve");const L=h(k);let H;try{H=r.sqrt(L)}catch(Q){const Z=Q instanceof Error?": "+Q.message:"";throw new Error("Point is not on curve"+Z)}const K=(H&Bt)===Bt;return(O&1)===1!==K&&(H=r.neg(H)),{x:k,y:H}}else if(b===a&&O===4){const k=r.fromBytes(B.subarray(0,r.BYTES)),L=r.fromBytes(B.subarray(r.BYTES,2*r.BYTES));return{x:k,y:L}}else{const k=o,L=a;throw new Error("invalid Point, expected length of "+k+", or uncompressed "+L+", got "+b)}}});function f(y){const b=n>>Bt;return y>b}function g(y){return f(y)?c(-y):y}const _=(y,b,O)=>ei(y.slice(b,O));class I{constructor(b,O,B){Is("r",b,Bt,n),Is("s",O,Bt,n),this.r=b,this.s=O,B!=null&&(this.recovery=B),Object.freeze(this)}static fromCompact(b){const O=s;return b=br("compactSignature",b,O*2),new I(_(b,0,O),_(b,O,2*O))}static fromDER(b){const{r:O,s:B}=Hn.toSig(br("DER",b));return new I(O,B)}assertValidity(){}addRecoveryBit(b){return new I(this.r,this.s,b)}recoverPublicKey(b){const{r:O,s:B,recovery:k}=this,L=x(br("msgHash",b));if(k==null||![0,1,2,3].includes(k))throw new Error("recovery id invalid");const H=k===2||k===3?O+e.n:O;if(H>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const K=(k&1)===0?"02":"03",Q=u.fromHex(K+qu(H,r.BYTES)),Z=l(H),re=c(-L*Z),we=c(B*Z),Ee=u.BASE.multiplyAndAddUnsafe(Q,re,we);if(!Ee)throw new Error("point at infinify");return Ee.assertValidity(),Ee}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new I(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return il(this.toDERHex())}toDERHex(){return Hn.hexFromSig(this)}toCompactRawBytes(){return il(this.toCompactHex())}toCompactHex(){const b=s;return qu(this.r,b)+qu(this.s,b)}}const N={isValidPrivateKey(y){try{return d(y),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const y=b0(e.n);return Mx(e.randomBytes(y),e.n)},precompute(y=8,b=u.BASE){return b._setWindowSize(y),b.multiply(BigInt(3)),b}};function C(y,b=!0){return u.fromPrivateKey(y).toRawBytes(b)}function E(y){if(typeof y=="bigint")return!1;if(y instanceof u)return!0;const b=br("key",y).length,O=r.BYTES,B=O+1,k=2*O+1;if(!(e.allowedPrivateKeyLengths||s===B))return b===B||b===k}function v(y,b,O=!0){if(E(y)===!0)throw new Error("first arg must be private key");if(E(b)===!1)throw new Error("second arg must be public key");return u.fromHex(b).multiply(d(y)).toRawBytes(O)}const A=e.bits2int||function(y){if(y.length>8192)throw new Error("input is too large");const b=ei(y),O=y.length*8-i;return O>0?b>>BigInt(O):b},x=e.bits2int_modN||function(y){return c(A(y))},D=kl(i);function U(y){return Is("num < 2^"+i,y,Vn,D),Ga(y,s)}function M(y,b,O=$){if(["recovered","canonical"].some(be=>be in O))throw new Error("sign() legacy options not supported");const{hash:B,randomBytes:k}=e;let{lowS:L,prehash:H,extraEntropy:K}=O;L==null&&(L=!0),y=br("msgHash",y),Eg(O),H&&(y=br("prehashed msgHash",B(y)));const Q=x(y),Z=d(b),re=[U(Z),U(Q)];if(K!=null&&K!==!1){const be=K===!0?k(r.BYTES):K;re.push(br("extraEntropy",be))}const we=al(...re),Ee=Q;function Ne(be){const xe=A(be);if(!m(xe))return;const Ze=l(xe),tt=u.BASE.multiply(xe).toAffine(),qe=c(tt.x);if(qe===Vn)return;const ct=c(Ze*c(Ee+qe*Z));if(ct===Vn)return;let jt=(tt.x===qe?0:2)|Number(tt.y&Bt),Tr=ct;return L&&f(ct)&&(Tr=g(ct),jt^=1),new I(qe,Tr,jt)}return{seed:we,k2sig:Ne}}const $={lowS:e.lowS,prehash:!1},F={lowS:e.lowS,prehash:!1};function W(y,b,O=$){const{seed:B,k2sig:k}=M(y,b,O),L=e;return Ox(L.hash.outputLen,L.nByteLength,L.hmac)(B,k)}u.BASE._setWindowSize(8);function q(y,b,O,B=F){var ct;const k=y;b=br("msgHash",b),O=br("publicKey",O);const{lowS:L,prehash:H,format:K}=B;if(Eg(B),"strict"in B)throw new Error("options.strict was renamed to lowS");if(K!==void 0&&K!=="compact"&&K!=="der")throw new Error("format must be compact or der");const Q=typeof k=="string"||Ka(k),Z=!Q&&!K&&typeof k=="object"&&k!==null&&typeof k.r=="bigint"&&typeof k.s=="bigint";if(!Q&&!Z)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let re,we;try{if(Z&&(re=new I(k.r,k.s)),Q){try{K!=="compact"&&(re=I.fromDER(k))}catch(jt){if(!(jt instanceof Hn.Err))throw jt}!re&&K!=="der"&&(re=I.fromCompact(k))}we=u.fromHex(O)}catch{return!1}if(!re||L&&re.hasHighS())return!1;H&&(b=e.hash(b));const{r:Ee,s:Ne}=re,be=x(b),xe=l(Ne),Ze=c(be*xe),tt=c(Ee*xe),qe=(ct=u.BASE.multiplyAndAddUnsafe(we,Ze,tt))==null?void 0:ct.toAffine();return qe?c(qe.x)===Ee:!1}return{CURVE:e,getPublicKey:C,getSharedSecret:v,sign:W,verify:q,ProjectivePoint:u,Signature:I,utils:N}}function nO(t){return{hash:t,hmac:(e,...r)=>Pl(t,e,X2(...r)),randomBytes:go}}function Zh(t,e){const r=n=>rO({...t,...nO(n)});return{...r(e),create:r}}const C0=Za(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),sO=C0.create(BigInt("-3")),iO=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),oO=Zh({a:sO,b:iO,Fp:C0,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},Rl),A0=Za(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),aO=A0.create(BigInt("-3")),cO=BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef");Zh({a:aO,b:cO,Fp:A0,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},vN);const I0=Za(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),lO=I0.create(BigInt("-3")),uO=BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00");Zh({a:lO,b:uO,Fp:I0,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1),lowS:!1,allowedPrivateKeyLengths:[130,131,132]},EN);const dO=oO,S0="base10",ir="base16",an="base64pad",ys="base64url",Ja="utf8",T0=0,Gn=1,Xa=2,hO=0,vg=1,Qo=12,Jh=32;function fO(){const t=Gd.utils.randomPrivateKey(),e=Gd.getPublicKey(t);return{privateKey:Ir(t,ir),publicKey:Ir(e,ir)}}function Yd(){const t=go(Jh);return Ir(t,ir)}function pO(t,e){const r=Gd.getSharedSecret(Vr(t,ir),Vr(e,ir)),n=Tx(Dl,r,void 0,void 0,Jh);return Ir(n,ir)}function Mc(t){const e=Dl(Vr(t,ir));return Ir(e,ir)}function Cn(t){const e=Dl(Vr(t,Ja));return Ir(e,ir)}function N0(t){return Vr(`${t}`,S0)}function li(t){return Number(Ir(t,S0))}function x0(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function O0(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r=(4-e.length%4)%4;return e+"=".repeat(r)}function gO(t){const e=N0(typeof t.type<"u"?t.type:T0);if(li(e)===Gn&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?Vr(t.senderPublicKey,ir):void 0,n=typeof t.iv<"u"?Vr(t.iv,ir):go(Qo),s=Vr(t.symKey,ir),i=c0(s,n).encrypt(Vr(t.message,Ja)),o=R0({type:e,sealed:i,iv:n,senderPublicKey:r});return t.encoding===ys?x0(o):o}function mO(t){const e=Vr(t.symKey,ir),{sealed:r,iv:n}=ya({encoded:t.encoded,encoding:t.encoding}),s=c0(e,n).decrypt(r);if(s===null)throw new Error("Failed to decrypt");return Ir(s,Ja)}function wO(t,e){const r=N0(Xa),n=go(Qo),s=Vr(t,Ja),i=R0({type:r,sealed:s,iv:n});return e===ys?x0(i):i}function yO(t,e){const{sealed:r}=ya({encoded:t,encoding:e});return Ir(r,Ja)}function R0(t){if(li(t.type)===Xa)return Ir(Xo([t.type,t.sealed]),an);if(li(t.type)===Gn){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Ir(Xo([t.type,t.senderPublicKey,t.iv,t.sealed]),an)}return Ir(Xo([t.type,t.iv,t.sealed]),an)}function ya(t){const e=(t.encoding||an)===ys?O0(t.encoded):t.encoded,r=Vr(e,an),n=r.slice(hO,vg),s=vg;if(li(n)===Gn){const c=s+Jh,l=c+Qo,u=r.slice(s,c),d=r.slice(c,l),h=r.slice(l);return{type:n,sealed:h,iv:d,senderPublicKey:u}}if(li(n)===Xa){const c=r.slice(s),l=go(Qo);return{type:n,sealed:c,iv:l}}const i=s+Qo,o=r.slice(s,i),a=r.slice(i);return{type:n,sealed:a,iv:o}}function bO(t,e){const r=ya({encoded:t,encoding:e==null?void 0:e.encoding});return P0({type:li(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?Ir(r.senderPublicKey,ir):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function P0(t){const e=(t==null?void 0:t.type)||T0;if(e===Gn){if(typeof(t==null?void 0:t.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(t==null?void 0:t.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t==null?void 0:t.senderPublicKey,receiverPublicKey:t==null?void 0:t.receiverPublicKey}}function _g(t){return t.type===Gn&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function Cg(t){return t.type===Xa}function EO(t){const e=Buffer.from(t.x,"base64"),r=Buffer.from(t.y,"base64");return Xo([new Uint8Array([4]),e,r])}function vO(t,e){const[r,n,s]=t.split("."),i=Buffer.from(O0(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${r}.${n}`,l=Dl(c),u=EO(e);if(!dO.verify(Xo([o,a]),l,u))throw new Error("Invalid signature");return Id(t).payload}const _O="irn";function cl(t){return(t==null?void 0:t.relay)||{protocol:_O}}function Vo(t){const e=a2[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}function CO(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(n)){const i=s.replace(n,""),o=t[s];r[i]=o}}),r}function Ag(t){if(!t.includes("wc:")){const l=Wy(t);l!=null&&l.includes("wc:")&&(t=l)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),s=t.substring(e+1,r).split("@"),i=typeof r<"u"?t.substring(r):"",o=new URLSearchParams(i),a={};o.forEach((l,u)=>{a[u]=l});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:AO(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:CO(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function AO(t){return t.startsWith("//")?t.substring(2):t}function IO(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(s=>{const i=s,o=r+e+i;t[i]&&(n[o]=t[i])}),n}function Ig(t){const e=new URLSearchParams,r=IO(t.relay);Object.keys(r).sort().forEach(s=>{e.set(s,r[s])}),e.set("symKey",t.symKey),t.expiryTimestamp&&e.set("expiryTimestamp",t.expiryTimestamp.toString()),t.methods&&e.set("methods",t.methods.join(","));const n=e.toString();return`${t.protocol}:${t.topic}@${t.version}?${n}`}function Ec(t,e,r){return`${t}?wc_ev=${r}&topic=${e}`}var SO=Object.defineProperty,TO=Object.defineProperties,NO=Object.getOwnPropertyDescriptors,Sg=Object.getOwnPropertySymbols,xO=Object.prototype.hasOwnProperty,OO=Object.prototype.propertyIsEnumerable,Tg=(t,e,r)=>e in t?SO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,RO=(t,e)=>{for(var r in e||(e={}))xO.call(e,r)&&Tg(t,r,e[r]);if(Sg)for(var r of Sg(e))OO.call(e,r)&&Tg(t,r,e[r]);return t},PO=(t,e)=>TO(t,NO(e));function mo(t){const e=[];return t.forEach(r=>{const[n,s]=r.split(":");e.push(`${n}:${s}`)}),e}function DO(t){const e=[];return Object.values(t).forEach(r=>{e.push(...mo(r.accounts))}),e}function kO(t,e){const r=[];return Object.values(t).forEach(n=>{mo(n.accounts).includes(e)&&r.push(...n.methods)}),r}function UO(t,e){const r=[];return Object.values(t).forEach(n=>{mo(n.accounts).includes(e)&&r.push(...n.events)}),r}function Ul(t){return t.includes(":")}function Vi(t){return Ul(t)?t.split(":")[0]:t}function Ng(t){var e,r,n;const s={};if(!Ss(t))return s;for(const[i,o]of Object.entries(t)){const a=Ul(i)?[i]:o.chains,c=o.methods||[],l=o.events||[],u=Vi(i);s[u]=PO(RO({},s[u]),{chains:Tn(a,(e=s[u])==null?void 0:e.chains),methods:Tn(c,(r=s[u])==null?void 0:r.methods),events:Tn(l,(n=s[u])==null?void 0:n.events)})}return s}function $O(t){const e={};return t==null||t.forEach(r=>{var n;const[s,i]=r.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(r),(n=e[s].chains)==null||n.push(`${s}:${i}`)}),e}function xg(t,e){e=e.map(n=>n.replace("did:pkh:",""));const r=$O(e);for(const[n,s]of Object.entries(r))s.methods?s.methods=Tn(s.methods,t):s.methods=t,s.events=["chainChanged","accountsChanged"];return r}function BO(t,e){var r,n,s,i,o,a;const c=Ng(t),l=Ng(e),u={},d=Object.keys(c).concat(Object.keys(l));for(const h of d)u[h]={chains:Tn((r=c[h])==null?void 0:r.chains,(n=l[h])==null?void 0:n.chains),methods:Tn((s=c[h])==null?void 0:s.methods,(i=l[h])==null?void 0:i.methods),events:Tn((o=c[h])==null?void 0:o.events,(a=l[h])==null?void 0:a.events)};return u}const LO={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},MO={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function se(t,e){const{message:r,code:n}=MO[t];return{message:e?`${r} ${e}`:r,code:n}}function st(t,e){const{message:r,code:n}=LO[t];return{message:e?`${r} ${e}`:r,code:n}}function Yn(t,e){return!!Array.isArray(t)}function Ss(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function Vt(t){return typeof t>"u"}function St(t,e){return e&&Vt(t)?!0:typeof t=="string"&&!!t.trim().length}function Xh(t,e){return e&&Vt(t)?!0:typeof t=="number"&&!isNaN(t)}function FO(t,e){const{requiredNamespaces:r}=e,n=Object.keys(t.namespaces),s=Object.keys(r);let i=!0;return Ys(s,n)?(n.forEach(o=>{const{accounts:a,methods:c,events:l}=t.namespaces[o],u=mo(a),d=r[o];(!Ys(My(o,d),u)||!Ys(d.methods,c)||!Ys(d.events,l))&&(i=!1)}),i):!1}function ll(t){return St(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function jO(t){if(St(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&ll(r)}}return!1}function qO(t){function e(r){try{return typeof new URL(r)<"u"}catch{return!1}}try{if(St(t,!1)){if(e(t))return!0;const r=Wy(t);return e(r)}}catch{}return!1}function HO(t){var e;return(e=t==null?void 0:t.proposer)==null?void 0:e.publicKey}function WO(t){return t==null?void 0:t.topic}function zO(t,e){let r=null;return St(t==null?void 0:t.publicKey,!1)||(r=se("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Og(t){let e=!0;return Yn(t)?t.length&&(e=t.every(r=>St(r,!1))):e=!1,e}function VO(t,e,r){let n=null;return Yn(e)&&e.length?e.forEach(s=>{n||ll(s)||(n=st("UNSUPPORTED_CHAINS",`${r}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):ll(t)||(n=st("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function KO(t,e,r){let n=null;return Object.entries(t).forEach(([s,i])=>{if(n)return;const o=VO(s,My(s,i),`${e} ${r}`);o&&(n=o)}),n}function GO(t,e){let r=null;return Yn(t)?t.forEach(n=>{r||jO(n)||(r=st("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=st("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function YO(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const s=GO(n==null?void 0:n.accounts,`${e} namespace`);s&&(r=s)}),r}function ZO(t,e){let r=null;return Og(t==null?void 0:t.methods)?Og(t==null?void 0:t.events)||(r=st("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=st("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function D0(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const s=ZO(n,`${e}, namespace`);s&&(r=s)}),r}function JO(t,e,r){let n=null;if(t&&Ss(t)){const s=D0(t,e);s&&(n=s);const i=KO(t,e,r);i&&(n=i)}else n=se("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return n}function Wu(t,e){let r=null;if(t&&Ss(t)){const n=D0(t,e);n&&(r=n);const s=YO(t,e);s&&(r=s)}else r=se("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function k0(t){return St(t.protocol,!0)}function XO(t,e){let r=!1;return t?t&&Yn(t)&&t.length&&t.forEach(n=>{r=k0(n)}):r=!0,r}function QO(t){return typeof t=="number"}function wr(t){return typeof t<"u"&&typeof t!==null}function eR(t){return!(!t||typeof t!="object"||!t.code||!Xh(t.code,!1)||!t.message||!St(t.message,!1))}function tR(t){return!(Vt(t)||!St(t.method,!1))}function rR(t){return!(Vt(t)||Vt(t.result)&&Vt(t.error)||!Xh(t.id,!1)||!St(t.jsonrpc,!1))}function nR(t){return!(Vt(t)||!St(t.name,!1))}function Rg(t,e){return!(!ll(e)||!DO(t).includes(e))}function sR(t,e,r){return St(r,!1)?kO(t,e).includes(r):!1}function iR(t,e,r){return St(r,!1)?UO(t,e).includes(r):!1}function Pg(t,e,r){let n=null;const s=oR(t),i=aR(e),o=Object.keys(s),a=Object.keys(i),c=Dg(Object.keys(t)),l=Dg(Object.keys(e)),u=c.filter(d=>!l.includes(d));return u.length&&(n=se("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),Ys(o,a)||(n=se("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||n)return;const h=mo(e[d].accounts);h.includes(d)||(n=se("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${h.toString()}`))}),o.forEach(d=>{n||(Ys(s[d].methods,i[d].methods)?Ys(s[d].events,i[d].events)||(n=se("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${d}`)):n=se("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${d}`))}),n}function oR(t){const e={};return Object.keys(t).forEach(r=>{var n;r.includes(":")?e[r]=t[r]:(n=t[r].chains)==null||n.forEach(s=>{e[s]={methods:t[r].methods,events:t[r].events}})}),e}function Dg(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function aR(t){const e={};return Object.keys(t).forEach(r=>{if(r.includes(":"))e[r]=t[r];else{const n=mo(t[r].accounts);n==null||n.forEach(s=>{e[s]={accounts:t[r].accounts.filter(i=>i.includes(`${s}:`)),methods:t[r].methods,events:t[r].events}})}}),e}function cR(t,e){return Xh(t,!1)&&t<=e.max&&t>=e.min}function kg(){const t=za();return new Promise(e=>{switch(t){case Ur.browser:e(lR());break;case Ur.reactNative:e(uR());break;case Ur.node:e(dR());break;default:e(!0)}})}function lR(){return po()&&(navigator==null?void 0:navigator.onLine)}async function uR(){if(Us()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t==null?void 0:t.isConnected}return!0}function dR(){return!0}function hR(t){switch(za()){case Ur.browser:fR(t);break;case Ur.reactNative:pR(t);break}}function fR(t){!Us()&&po()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function pR(t){Us()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>t(e==null?void 0:e.isConnected)))}function gR(){var t;return po()&&Xn.getDocument()?((t=Xn.getDocument())==null?void 0:t.visibilityState)==="visible":!0}const zu={};class Ro{static get(e){return zu[e]}static set(e,r){zu[e]=r}static delete(e){delete zu[e]}}function mR(t){const e=fo.decode(t);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function wR({publicKey:t,signature:e,payload:r}){var n;const s=Zd(r.method),i=128|parseInt(((n=r.version)==null?void 0:n.toString())||"4"),o=ER(r.address),a=r.era==="00"?new Uint8Array([0]):Zd(r.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(r.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${bR(r.tip)}`),d=_R(u),h=new Uint8Array([0,...t,o,...e,...a,...l,...d,...s]),m=vR(h.length+1);return new Uint8Array([...m,i,...h])}function yR(t){const e=Zd(t),r=d2.blake2b(e,void 0,32);return"0x"+Buffer.from(r).toString("hex")}function Zd(t){return new Uint8Array(t.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function bR(t){return t.startsWith("0x")?t.slice(2):t}function ER(t){const e=fo.decode(t)[0];return e===42?0:e===60?2:1}function vR(t){if(t<64)return new Uint8Array([t<<2]);if(t<16384){const e=t<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(t<1<<30){const e=t<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function _R(t){if(t<BigInt(1)<<BigInt(6))return new Uint8Array([Number(t<<BigInt(2))]);if(t<BigInt(1)<<BigInt(14)){const e=t<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(t<BigInt(1)<<BigInt(30)){const e=t<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function CR(t){const e=Uint8Array.from(Buffer.from(t.signature,"hex")),r=mR(t.transaction.address),n=wR({publicKey:r,signature:e,payload:t.transaction}),s=Buffer.from(n).toString("hex");return yR(s)}const AR="PARSE_ERROR",IR="INVALID_REQUEST",SR="METHOD_NOT_FOUND",TR="INVALID_PARAMS",U0="INTERNAL_ERROR",Qh="SERVER_ERROR",NR=[-32700,-32600,-32601,-32602,-32603],ea={[AR]:{code:-32700,message:"Parse error"},[IR]:{code:-32600,message:"Invalid Request"},[SR]:{code:-32601,message:"Method not found"},[TR]:{code:-32602,message:"Invalid params"},[U0]:{code:-32603,message:"Internal error"},[Qh]:{code:-32e3,message:"Server error"}},$0=Qh;function xR(t){return NR.includes(t)}function Ug(t){return Object.keys(ea).includes(t)?ea[t]:ea[$0]}function OR(t){const e=Object.values(ea).find(r=>r.code===t);return e||ea[$0]}function B0(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Vu={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Jd=function(t,e){return Jd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])},Jd(t,e)};function RR(t,e){Jd(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Xd=function(){return Xd=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Xd.apply(this,arguments)};function PR(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function DR(t,e,r,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,r,i):o(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i}function kR(t,e){return function(r,n){e(r,n,t)}}function UR(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function $R(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})}function BR(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,s=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(u){l=[6,u],s=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function LR(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function MR(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Qd(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function L0(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function FR(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(L0(arguments[e]));return t}function jR(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<r;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function ba(t){return this instanceof ba?(this.v=t,this):new ba(t)}function qR(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){n[h]&&(s[h]=function(m){return new Promise(function(f,g){i.push([h,m,f,g])>1||a(h,m)})})}function a(h,m){try{c(n[h](m))}catch(f){d(i[0][3],f)}}function c(h){h.value instanceof ba?Promise.resolve(h.value.v).then(l,u):d(i[0][2],h)}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,m){h(m),i.shift(),i.length&&a(i[0][0],i[0][1])}}function HR(t){var e,r;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=t[s]?function(o){return(r=!r)?{value:ba(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function WR(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Qd=="function"?Qd(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function zR(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function VR(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function KR(t){return t&&t.__esModule?t:{default:t}}function GR(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function YR(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const ZR=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Xd},__asyncDelegator:HR,__asyncGenerator:qR,__asyncValues:WR,__await:ba,__awaiter:$R,__classPrivateFieldGet:GR,__classPrivateFieldSet:YR,__createBinding:LR,__decorate:DR,__exportStar:MR,__extends:RR,__generator:BR,__importDefault:KR,__importStar:VR,__makeTemplateObject:zR,__metadata:UR,__param:kR,__read:L0,__rest:PR,__spread:FR,__spreadArrays:jR,__values:Qd},Symbol.toStringTag,{value:"Module"})),JR=dw(ZR);var Ln={},$g;function XR(){if($g)return Ln;$g=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.isBrowserCryptoAvailable=Ln.getSubtleCrypto=Ln.getBrowerCrypto=void 0;function t(){return(vn===null||vn===void 0?void 0:vn.crypto)||(vn===null||vn===void 0?void 0:vn.msCrypto)||{}}Ln.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}Ln.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Ln.isBrowserCryptoAvailable=r,Ln}var Mn={},Bg;function QR(){if(Bg)return Mn;Bg=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.isBrowser=Mn.isNode=Mn.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Mn.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Mn.isNode=e;function r(){return!t()&&!e()}return Mn.isBrowser=r,Mn}var Lg;function eP(){return Lg||(Lg=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=JR;e.__exportStar(XR(),t),e.__exportStar(QR(),t)}(Vu)),Vu}var tP=eP();function bn(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function Js(t=6){return BigInt(bn(t))}function _s(t,e,r){return{id:r||bn(),jsonrpc:"2.0",method:t,params:e}}function $l(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Bl(t,e,r){return{id:t,jsonrpc:"2.0",error:rP(e)}}function rP(t,e){return typeof t>"u"?Ug(U0):(typeof t=="string"&&(t=Object.assign(Object.assign({},Ug(Qh)),{message:t})),xR(t.code)&&(t=OR(t.code)),t)}let nP=class{},sP=class extends nP{constructor(){super()}},iP=class extends sP{constructor(e){super()}};const oP="^https?:",aP="^wss?:";function cP(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function M0(t,e){const r=cP(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Mg(t){return M0(t,oP)}function Fg(t){return M0(t,aP)}function lP(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function F0(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function ef(t){return F0(t)&&"method"in t}function Ll(t){return F0(t)&&(En(t)||zr(t))}function En(t){return"result"in t}function zr(t){return"error"in t}let Yr=class extends iP{constructor(e){super(e),this.events=new Gr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(_s(e.method,e.params||[],e.id||Js().toString()),r)}async requestStrict(e,r){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{zr(i)?s(i.error):n(i.result)});try{await this.connection.send(e,r)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Ll(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const uP=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),dP=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",jg=t=>t.split("?")[0],qg=10,hP=uP();let fP=class{constructor(e){if(this.url=e,this.events=new Gr.EventEmitter,this.registering=!1,!Fg(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Jn(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!Fg(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const s=tP.isReactNative()?void 0:{rejectUnauthorized:!lP(e)},i=new hP(e,[],s);dP()?i.onerror=o=>{const a=o;n(this.emitError(a.error))}:i.on("error",o=>{n(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),r(i)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?oi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),s=n.message||n.toString(),i=Bl(e,s);this.events.emit("payload",i)}parseError(e,r=this.url){return B0(e,jg(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>qg&&this.events.setMaxListeners(qg)}emitError(e){const r=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${jg(this.url)}`));return this.events.emit("register_error",r),r}};var pP={};const j0="wc",q0=2,eh="core",Nn=`${j0}@2:${eh}:`,gP={logger:"error"},mP={database:":memory:"},wP="crypto",Hg="client_ed25519_seed",yP=ne.ONE_DAY,bP="keychain",EP="0.3",vP="messages",_P="0.3",Wg=ne.SIX_HOURS,CP="publisher",H0="irn",AP="error",W0="wss://relay.walletconnect.org",IP="relayer",Lt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},SP="_subscription",Fr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},TP=.1,th="2.21.2",ft={link_mode:"link_mode",relay:"relay"},Fc={inbound:"inbound",outbound:"outbound"},NP="0.3",xP="WALLETCONNECT_CLIENT_ID",zg="WALLETCONNECT_LINK_MODE_APPS",Rr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},OP="subscription",RP="0.3",PP="pairing",DP="0.3",Po={wc_pairingDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:0},res:{ttl:ne.ONE_DAY,prompt:!1,tag:0}}},Vs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},en={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},kP="history",UP="0.3",$P="expirer",Hr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},BP="0.3",LP="verify-api",MP="https://verify.walletconnect.com",z0="https://verify.walletconnect.org",ta=z0,FP=`${ta}/v3`,jP=[MP,z0],qP="echo",HP="https://echo.walletconnect.com",yn={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},jn={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},tn={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Fs={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},js={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},Do={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},WP=.1,zP="event-client",VP=86400,KP="https://pulse.walletconnect.org/batch";function GP(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var g=0,_=0,I=0,N=f.length;I!==N&&f[I]===0;)I++,g++;for(var C=(N-I)*u+1>>>0,E=new Uint8Array(C);I!==N;){for(var v=f[I],A=0,x=C-1;(v!==0||A<_)&&x!==-1;x--,A++)v+=256*E[x]>>>0,E[x]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");_=A,I++}for(var D=C-_;D!==C&&E[D]===0;)D++;for(var U=c.repeat(g);D<C;++D)U+=t.charAt(E[D]);return U}function h(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var g=0;if(f[g]!==" "){for(var _=0,I=0;f[g]===c;)_++,g++;for(var N=(f.length-g)*l+1>>>0,C=new Uint8Array(N);f[g];){var E=r[f.charCodeAt(g)];if(E===255)return;for(var v=0,A=N-1;(E!==0||v<I)&&A!==-1;A--,v++)E+=a*C[A]>>>0,C[A]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");I=v,g++}if(f[g]!==" "){for(var x=N-I;x!==N&&C[x]===0;)x++;for(var D=new Uint8Array(_+(N-x)),U=_;x!==N;)D[U++]=C[x++];return D}}}function m(f){var g=h(f);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:m}}var YP=GP,ZP=YP;const V0=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},JP=t=>new TextEncoder().encode(t),XP=t=>new TextDecoder().decode(t);class QP{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class e3{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return K0(this,e)}}class t3{constructor(e){this.decoders=e}or(e){return K0(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const K0=(t,e)=>new t3({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class r3{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new QP(e,r,n),this.decoder=new e3(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ml=({name:t,prefix:e,encode:r,decode:n})=>new r3(t,e,r,n),Qa=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=ZP(r,e);return Ml({prefix:t,name:e,encode:n,decode:i=>V0(s(i))})},n3=(t,e,r,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},s3=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Yt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Ml({prefix:e,name:t,encode(s){return s3(s,n,r)},decode(s){return n3(s,n,r,t)}}),i3=Ml({prefix:"\0",name:"identity",encode:t=>XP(t),decode:t=>JP(t)});var o3=Object.freeze({__proto__:null,identity:i3});const a3=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var c3=Object.freeze({__proto__:null,base2:a3});const l3=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var u3=Object.freeze({__proto__:null,base8:l3});const d3=Qa({prefix:"9",name:"base10",alphabet:"0123456789"});var h3=Object.freeze({__proto__:null,base10:d3});const f3=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),p3=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var g3=Object.freeze({__proto__:null,base16:f3,base16upper:p3});const m3=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),w3=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),y3=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),b3=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),E3=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),v3=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),_3=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),C3=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),A3=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var I3=Object.freeze({__proto__:null,base32:m3,base32upper:w3,base32pad:y3,base32padupper:b3,base32hex:E3,base32hexupper:v3,base32hexpad:_3,base32hexpadupper:C3,base32z:A3});const S3=Qa({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),T3=Qa({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var N3=Object.freeze({__proto__:null,base36:S3,base36upper:T3});const x3=Qa({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),O3=Qa({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var R3=Object.freeze({__proto__:null,base58btc:x3,base58flickr:O3});const P3=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),D3=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),k3=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),U3=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var $3=Object.freeze({__proto__:null,base64:P3,base64pad:D3,base64url:k3,base64urlpad:U3});const G0=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),B3=G0.reduce((t,e,r)=>(t[r]=e,t),[]),L3=G0.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function M3(t){return t.reduce((e,r)=>(e+=B3[r],e),"")}function F3(t){const e=[];for(const r of t){const n=L3[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const j3=Ml({prefix:"🚀",name:"base256emoji",encode:M3,decode:F3});var q3=Object.freeze({__proto__:null,base256emoji:j3}),H3=Y0,Vg=128,W3=-128,z3=Math.pow(2,31);function Y0(t,e,r){e=e||[],r=r||0;for(var n=r;t>=z3;)e[r++]=t&255|Vg,t/=128;for(;t&W3;)e[r++]=t&255|Vg,t>>>=7;return e[r]=t|0,Y0.bytes=r-n+1,e}var V3=rh,K3=128,Kg=127;function rh(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw rh.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&Kg)<<s:(o&Kg)*Math.pow(2,s),s+=7}while(o>=K3);return rh.bytes=i-n,r}var G3=Math.pow(2,7),Y3=Math.pow(2,14),Z3=Math.pow(2,21),J3=Math.pow(2,28),X3=Math.pow(2,35),Q3=Math.pow(2,42),eD=Math.pow(2,49),tD=Math.pow(2,56),rD=Math.pow(2,63),nD=function(t){return t<G3?1:t<Y3?2:t<Z3?3:t<J3?4:t<X3?5:t<Q3?6:t<eD?7:t<tD?8:t<rD?9:10},sD={encode:H3,decode:V3,encodingLength:nD},Z0=sD;const Gg=(t,e,r=0)=>(Z0.encode(t,e,r),e),Yg=t=>Z0.encodingLength(t),nh=(t,e)=>{const r=e.byteLength,n=Yg(t),s=n+Yg(r),i=new Uint8Array(s+r);return Gg(t,i,0),Gg(r,i,n),i.set(e,s),new iD(t,r,e,i)};class iD{constructor(e,r,n,s){this.code=e,this.size=r,this.digest=n,this.bytes=s}}const J0=({name:t,code:e,encode:r})=>new oD(t,e,r);class oD{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?nh(this.code,r):r.then(n=>nh(this.code,n))}else throw Error("Unknown type, must be binary type")}}const X0=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),aD=J0({name:"sha2-256",code:18,encode:X0("SHA-256")}),cD=J0({name:"sha2-512",code:19,encode:X0("SHA-512")});var lD=Object.freeze({__proto__:null,sha256:aD,sha512:cD});const Q0=0,uD="identity",eb=V0,dD=t=>nh(Q0,eb(t)),hD={code:Q0,name:uD,encode:eb,digest:dD};var fD=Object.freeze({__proto__:null,identity:hD});new TextEncoder,new TextDecoder;const Zg={...o3,...c3,...u3,...h3,...g3,...I3,...N3,...R3,...$3,...q3};({...lD,...fD});function tb(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function pD(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?tb(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function rb(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Jg=rb("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ku=rb("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=pD(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),gD={utf8:Jg,"utf-8":Jg,hex:Zg.base16,latin1:Ku,ascii:Ku,binary:Ku,...Zg};function mD(t,e="utf8"){const r=gD[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?tb(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var wD=Object.defineProperty,yD=(t,e,r)=>e in t?wD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,mn=(t,e,r)=>yD(t,typeof e!="symbol"?e+"":e,r);class bD{constructor(e,r){this.core=e,this.logger=r,mn(this,"keychain",new Map),mn(this,"name",bP),mn(this,"version",EP),mn(this,"initialized",!1),mn(this,"storagePrefix",Nn),mn(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),mn(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),mn(this,"set",async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()}),mn(this,"get",n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:i}=se("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(i)}return s}),mn(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=tr(r,this.name)}get context(){return Sr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Bd(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ld(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}var ED=Object.defineProperty,vD=(t,e,r)=>e in t?ED(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ht=(t,e,r)=>vD(t,typeof e!="symbol"?e+"":e,r);class _D{constructor(e,r,n){this.core=e,this.logger=r,Ht(this,"name",wP),Ht(this,"keychain"),Ht(this,"randomSessionIdentifier",Yd()),Ht(this,"initialized",!1),Ht(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Ht(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),Ht(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=wp(s);return Qw(i.publicKey)}),Ht(this,"generateKeyPair",()=>{this.isInitialized();const s=fO();return this.setPrivateKey(s.publicKey,s.privateKey)}),Ht(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=wp(i),a=this.randomSessionIdentifier;return await lI(a,s,yP,o)}),Ht(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=pO(a,i);return this.setSymKey(c,o)}),Ht(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||Mc(s);return await this.keychain.set(o,s),o}),Ht(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),Ht(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),Ht(this,"encode",async(s,i,o)=>{this.isInitialized();const a=P0(o),c=Jn(i);if(Cg(a))return wO(c,o==null?void 0:o.encoding);if(_g(a)){const h=a.senderPublicKey,m=a.receiverPublicKey;s=await this.generateSharedKey(h,m)}const l=this.getSymKey(s),{type:u,senderPublicKey:d}=a;return gO({type:u,symKey:l,message:c,senderPublicKey:d,encoding:o==null?void 0:o.encoding})}),Ht(this,"decode",async(s,i,o)=>{this.isInitialized();const a=bO(i,o);if(Cg(a)){const c=yO(i,o==null?void 0:o.encoding);return oi(c)}if(_g(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=mO({symKey:c,encoded:i,encoding:o==null?void 0:o.encoding});return oi(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),Ht(this,"getPayloadType",(s,i=an)=>{const o=ya({encoded:s,encoding:i});return li(o.type)}),Ht(this,"getPayloadSenderPublicKey",(s,i=an)=>{const o=ya({encoded:s,encoding:i});return o.senderPublicKey?Ir(o.senderPublicKey,ir):void 0}),this.core=e,this.logger=tr(r,this.name),this.keychain=n||new bD(this.core,this.logger)}get context(){return Sr(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Hg)}catch{e=Yd(),await this.keychain.set(Hg,e)}return mD(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}var CD=Object.defineProperty,AD=Object.defineProperties,ID=Object.getOwnPropertyDescriptors,Xg=Object.getOwnPropertySymbols,SD=Object.prototype.hasOwnProperty,TD=Object.prototype.propertyIsEnumerable,sh=(t,e,r)=>e in t?CD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ND=(t,e)=>{for(var r in e||(e={}))SD.call(e,r)&&sh(t,r,e[r]);if(Xg)for(var r of Xg(e))TD.call(e,r)&&sh(t,r,e[r]);return t},xD=(t,e)=>AD(t,ID(e)),Or=(t,e,r)=>sh(t,typeof e!="symbol"?e+"":e,r);class OD extends a_{constructor(e,r){super(e,r),this.logger=e,this.core=r,Or(this,"messages",new Map),Or(this,"messagesWithoutClientAck",new Map),Or(this,"name",vP),Or(this,"version",_P),Or(this,"initialized",!1),Or(this,"storagePrefix",Nn),Or(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),Or(this,"set",async(n,s,i)=>{this.isInitialized();const o=Cn(s);let a=this.messages.get(n);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(n,a),i===Fc.inbound){const c=this.messagesWithoutClientAck.get(n)||{};this.messagesWithoutClientAck.set(n,xD(ND({},c),{[o]:s}))}return await this.persist(),o}),Or(this,"get",n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s}),Or(this,"getWithoutAck",n=>{this.isInitialized();const s={};for(const i of n){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),Or(this,"has",(n,s)=>{this.isInitialized();const i=this.get(n),o=Cn(s);return typeof i[o]<"u"}),Or(this,"ack",async(n,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(n);if(typeof i>"u")return;const o=Cn(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(n):this.messagesWithoutClientAck.set(n,i),await this.persist()}),Or(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),this.messagesWithoutClientAck.delete(n),await this.persist()}),this.logger=tr(e,this.name),this.core=r}get context(){return Sr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Bd(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,Bd(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ld(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?Ld(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}var RD=Object.defineProperty,PD=Object.defineProperties,DD=Object.getOwnPropertyDescriptors,Qg=Object.getOwnPropertySymbols,kD=Object.prototype.hasOwnProperty,UD=Object.prototype.propertyIsEnumerable,ih=(t,e,r)=>e in t?RD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vc=(t,e)=>{for(var r in e||(e={}))kD.call(e,r)&&ih(t,r,e[r]);if(Qg)for(var r of Qg(e))UD.call(e,r)&&ih(t,r,e[r]);return t},Gu=(t,e)=>PD(t,DD(e)),rn=(t,e,r)=>ih(t,typeof e!="symbol"?e+"":e,r);class $D extends c_{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,rn(this,"events",new Gr.EventEmitter),rn(this,"name",CP),rn(this,"queue",new Map),rn(this,"publishTimeout",ne.toMiliseconds(ne.ONE_MINUTE)),rn(this,"initialPublishTimeout",ne.toMiliseconds(ne.ONE_SECOND*15)),rn(this,"needsTransportRestart",!1),rn(this,"publish",async(n,s,i)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:i}});const a=(i==null?void 0:i.ttl)||Wg,c=cl(i),l=(i==null?void 0:i.prompt)||!1,u=(i==null?void 0:i.tag)||0,d=(i==null?void 0:i.id)||Js().toString(),h={topic:n,message:s,opts:{ttl:a,relay:c,prompt:l,tag:u,id:d,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}},m=`Failed to publish payload, please try again. id:${d} tag:${u}`;try{const f=new Promise(async g=>{const _=({id:N})=>{h.opts.id===N&&(this.removeRequestFromQueue(N),this.relayer.events.removeListener(Lt.publish,_),g(h))};this.relayer.events.on(Lt.publish,_);const I=vs(new Promise((N,C)=>{this.rpcPublish({topic:n,message:s,ttl:a,prompt:l,tag:u,id:d,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}).then(N).catch(E=>{this.logger.warn(E,E==null?void 0:E.message),C(E)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${d} tag:${u}`);try{await I,this.events.removeListener(Lt.publish,_)}catch(N){this.queue.set(d,Gu(vc({},h),{attempt:1})),this.logger.warn(N,N==null?void 0:N.message)}});this.logger.trace({type:"method",method:"publish",params:{id:d,topic:n,message:s,opts:i}}),await vs(f,this.publishTimeout,m)}catch(f){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(f),(o=i==null?void 0:i.internal)!=null&&o.throwOnFailedPublish)throw f}finally{this.queue.delete(d)}}),rn(this,"on",(n,s)=>{this.events.on(n,s)}),rn(this,"once",(n,s)=>{this.events.once(n,s)}),rn(this,"off",(n,s)=>{this.events.off(n,s)}),rn(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.relayer=e,this.logger=tr(r,this.name),this.registerEventListeners()}get context(){return Sr(this.logger)}async rpcPublish(e){var r,n,s,i;const{topic:o,message:a,ttl:c=Wg,prompt:l,tag:u,id:d,attestation:h,tvf:m}=e,f={method:Vo(cl().protocol).publish,params:vc({topic:o,message:a,ttl:c,prompt:l,tag:u,attestation:h},m),id:d};Vt((r=f.params)==null?void 0:r.prompt)&&((n=f.params)==null||delete n.prompt),Vt((s=f.params)==null?void 0:s.tag)&&((i=f.params)==null||delete i.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:f});const g=await this.relayer.request(f);return this.relayer.events.emit(Lt.publish,e),this.logger.debug("Successfully Published Payload"),g}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,r)=>{const n=e.attempt+1;this.queue.set(r,Gu(vc({},e),{attempt:n}));const{topic:s,message:i,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${n}`),await this.rpcPublish(Gu(vc({},e),{topic:s,message:i,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(bi.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Lt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Lt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var BD=Object.defineProperty,LD=(t,e,r)=>e in t?BD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xi=(t,e,r)=>LD(t,typeof e!="symbol"?e+"":e,r);class MD{constructor(){xi(this,"map",new Map),xi(this,"set",(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])}),xi(this,"get",e=>this.map.get(e)||[]),xi(this,"exists",(e,r)=>this.get(e).includes(r)),xi(this,"delete",(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const s=n.filter(i=>i!==r);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),xi(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var FD=Object.defineProperty,jD=Object.defineProperties,qD=Object.getOwnPropertyDescriptors,em=Object.getOwnPropertySymbols,HD=Object.prototype.hasOwnProperty,WD=Object.prototype.propertyIsEnumerable,oh=(t,e,r)=>e in t?FD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ko=(t,e)=>{for(var r in e||(e={}))HD.call(e,r)&&oh(t,r,e[r]);if(em)for(var r of em(e))WD.call(e,r)&&oh(t,r,e[r]);return t},Yu=(t,e)=>jD(t,qD(e)),at=(t,e,r)=>oh(t,typeof e!="symbol"?e+"":e,r);class zD extends d_{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,at(this,"subscriptions",new Map),at(this,"topicMap",new MD),at(this,"events",new Gr.EventEmitter),at(this,"name",OP),at(this,"version",RP),at(this,"pending",new Map),at(this,"cached",[]),at(this,"initialized",!1),at(this,"storagePrefix",Nn),at(this,"subscribeTimeout",ne.toMiliseconds(ne.ONE_MINUTE)),at(this,"initialSubscribeTimeout",ne.toMiliseconds(ne.ONE_SECOND*15)),at(this,"clientId"),at(this,"batchSubscribeTopicsLimit",500),at(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),at(this,"subscribe",async(n,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const i=cl(s),o={topic:n,relay:i,transportType:s==null?void 0:s.transportType};this.pending.set(n,o);const a=await this.rpcSubscribe(n,i,s);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}})),a}catch(i){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(i),i}}),at(this,"unsubscribe",async(n,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)}),at(this,"isSubscribed",n=>new Promise(s=>{s(this.topicMap.topics.includes(n))})),at(this,"isKnownTopic",n=>new Promise(s=>{s(this.topicMap.topics.includes(n)||this.pending.has(n)||this.cached.some(i=>i.topic===n))})),at(this,"on",(n,s)=>{this.events.on(n,s)}),at(this,"once",(n,s)=>{this.events.once(n,s)}),at(this,"off",(n,s)=>{this.events.off(n,s)}),at(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),at(this,"start",async()=>{await this.onConnect()}),at(this,"stop",async()=>{await this.onDisconnect()}),at(this,"restart",async()=>{await this.restore(),await this.onRestart()}),at(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(s=>{n.push(s)}),await this.batchSubscribe(n)}),at(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(bi.pulse,async()=>{await this.checkPending()}),this.events.on(Rr.created,async n=>{const s=Rr.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()}),this.events.on(Rr.deleted,async n=>{const s=Rr.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()})}),this.relayer=e,this.logger=tr(r,this.name),this.clientId=""}get context(){return Sr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async s=>await this.unsubscribeById(e,s,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const s=cl(n);await this.restartToComplete({topic:e,id:r,relay:s}),await this.rpcUnsubscribe(e,r,s);const i=st("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,r,n){var s;(!n||(n==null?void 0:n.transportType)===ft.relay)&&await this.restartToComplete({topic:e,id:e,relay:r});const i={method:Vo(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});const o=(s=n==null?void 0:n.internal)==null?void 0:s.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if((n==null?void 0:n.transportType)===ft.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(i).catch(u=>this.logger.warn(u))},ne.toMiliseconds(ne.ONE_SECOND)),a;const c=new Promise(async u=>{const d=h=>{h.topic===e&&(this.events.removeListener(Rr.created,d),u(h.id))};this.events.on(Rr.created,d);try{const h=await vs(new Promise((m,f)=>{this.relayer.request(i).catch(g=>{this.logger.warn(g,g==null?void 0:g.message),f(g)}).then(m)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Rr.created,d),u(h)}catch{}}),l=await vs(c,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!l&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return l?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Lt.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,n={method:Vo(r.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await vs(new Promise(s=>{this.relayer.request(n).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(Lt.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const r=e[0].relay,n={method:Vo(r.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let s;try{s=await await vs(new Promise((i,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(Lt.connection_stalled)}return s}rpcUnsubscribe(e,r,n){const s={method:Vo(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,r){this.setSubscription(e,Yu(ko({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,ko({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r)}addSubscription(e,r){this.subscriptions.set(e,ko({},r)),this.topicMap.set(r.topic,e),this.events.emit(Rr.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=se("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(Rr.deleted,Yu(ko({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Rr.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<r;n++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Rr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async r=>Yu(ko({},r),{id:await this.getSubscriptionId(r.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await L2(ne.toMiliseconds(ne.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Cn(e+await this.getClientId())}}var VD=Object.defineProperty,tm=Object.getOwnPropertySymbols,KD=Object.prototype.hasOwnProperty,GD=Object.prototype.propertyIsEnumerable,ah=(t,e,r)=>e in t?VD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,rm=(t,e)=>{for(var r in e||(e={}))KD.call(e,r)&&ah(t,r,e[r]);if(tm)for(var r of tm(e))GD.call(e,r)&&ah(t,r,e[r]);return t},ze=(t,e,r)=>ah(t,typeof e!="symbol"?e+"":e,r);class YD extends l_{constructor(e){super(e),ze(this,"protocol","wc"),ze(this,"version",2),ze(this,"core"),ze(this,"logger"),ze(this,"events",new Gr.EventEmitter),ze(this,"provider"),ze(this,"messages"),ze(this,"subscriber"),ze(this,"publisher"),ze(this,"name",IP),ze(this,"transportExplicitlyClosed",!1),ze(this,"initialized",!1),ze(this,"connectionAttemptInProgress",!1),ze(this,"relayUrl"),ze(this,"projectId"),ze(this,"packageName"),ze(this,"bundleId"),ze(this,"hasExperiencedNetworkDisruption",!1),ze(this,"pingTimeout"),ze(this,"heartBeatTimeout",ne.toMiliseconds(ne.THIRTY_SECONDS+ne.FIVE_SECONDS)),ze(this,"reconnectTimeout"),ze(this,"connectPromise"),ze(this,"reconnectInProgress",!1),ze(this,"requestsInFlight",[]),ze(this,"connectTimeout",ne.toMiliseconds(ne.ONE_SECOND*15)),ze(this,"request",async r=>{var n,s;this.logger.debug("Publishing Request Payload");const i=r.id||Js().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:r.method,topic:(n=r.params)==null?void 0:n.topic},"relayer.request - publishing...");const o=`${i}:${((s=r.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),ze(this,"resetPingTimeout",()=>{nl()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,n,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(n=(r=this.provider)==null?void 0:r.connection)==null?void 0:n.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o==null?void 0:o.message)}},this.heartBeatTimeout))}),ze(this,"onPayloadHandler",r=>{this.onProviderPayload(r),this.resetPingTimeout()}),ze(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected 🛜"),this.startPingTimeout(),this.events.emit(Lt.connect)}),ze(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected 🛑"),this.requestsInFlight=[],this.onProviderDisconnect()}),ze(this,"onProviderErrorHandler",r=>{this.logger.fatal(`Fatal socket error: ${r.message}`),this.events.emit(Lt.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),ze(this,"registerProviderListeners",()=>{this.provider.on(Fr.payload,this.onPayloadHandler),this.provider.on(Fr.connect,this.onConnectHandler),this.provider.on(Fr.disconnect,this.onDisconnectHandler),this.provider.on(Fr.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?tr(e.logger,this.name):Ma(co({level:e.logger||AP})),this.messages=new OD(this.logger,e.core),this.subscriber=new zD(this,this.logger),this.publisher=new $D(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||W0,this.projectId=e.projectId,_2()?this.packageName=zp():C2()&&(this.bundleId=zp()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e==null?void 0:e.message)}}get context(){return Sr(this.logger)}get connected(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now(),transportType:ft.relay},Fc.outbound)}async subscribe(e,r){var n,s,i;this.isInitialized(),(!(r!=null&&r.transportType)||(r==null?void 0:r.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((n=r==null?void 0:r.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(s=r==null?void 0:r.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(Rr.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(Rr.created,l)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(e,rm({internal:{throwOnFailedPublish:o}},r)).catch(h=>{o&&d(h)})||a,u()})]),a}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await vs(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(r,n)=>{await this.connect(e).then(r).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await kg())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const r=e.sort((n,s)=>n.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${r.length} message events sorted`);for(const n of r)try{await this.onMessageEvent(n)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${r.length} message events processed`)}async onLinkMessageEvent(e,r){const{topic:n}=e;if(!r.sessionExists){const s=Rt(ne.FIVE_MINUTES),i={topic:n,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,i)}this.events.emit(Lt.message,e),await this.recordMessageEvent(e,Fc.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let r=1;for(;r<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${r}...`),await this.createProvider(),await new Promise(async(n,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Fr.disconnect,i),await vs(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(Fr.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{a(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Fr.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Fr.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const s=n;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${r}`);break}await new Promise(n=>setTimeout(n,ne.toMiliseconds(r*1))),r++}}startPingTimeout(){var e,r,n,s,i;if(nl())try{(r=(e=this.provider)==null?void 0:e.connection)!=null&&r.socket&&((i=(s=(n=this.provider)==null?void 0:n.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Yr(new fP(N2({sdkVersion:th,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,r){const{topic:n,message:s}=e;await this.messages.set(n,s,r)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(r))return this.logger.warn(`Ignoring message for unknown topic ${r}`),!0;const s=this.messages.has(r,n);return s&&this.logger.warn(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),ef(e)){if(!e.method.endsWith(SP))return;const r=e.params,{topic:n,message:s,publishedAt:i,attestation:o}=r.data,a={topic:n,message:s,publishedAt:i,transportType:ft.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(rm({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Ll(e)&&this.events.emit(Lt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,Fc.inbound),this.events.emit(Lt.message,e))}async acknowledgePayload(e){const r=$l(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(Fr.payload,this.onPayloadHandler),this.provider.off(Fr.connect,this.onConnectHandler),this.provider.off(Fr.disconnect,this.onDisconnectHandler),this.provider.off(Fr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await kg();hR(async r=>{e!==r&&(e=r,r?await this.transportOpen().catch(n=>this.logger.error(n,n==null?void 0:n.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(bi.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&gR())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(r){this.logger.warn(r,r==null?void 0:r.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(Lt.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},ne.toMiliseconds(TP)))))}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function ZD(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function nm(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function sm(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const JD="[object RegExp]",XD="[object String]",QD="[object Number]",ek="[object Boolean]",im="[object Arguments]",tk="[object Symbol]",rk="[object Date]",nk="[object Map]",sk="[object Set]",ik="[object Array]",ok="[object Function]",ak="[object ArrayBuffer]",Zu="[object Object]",ck="[object Error]",lk="[object DataView]",uk="[object Uint8Array]",dk="[object Uint8ClampedArray]",hk="[object Uint16Array]",fk="[object Uint32Array]",pk="[object BigUint64Array]",gk="[object Int8Array]",mk="[object Int16Array]",wk="[object Int32Array]",yk="[object BigInt64Array]",bk="[object Float32Array]",Ek="[object Float64Array]";function om(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function vk(t,e,r){return Ko(t,e,void 0,void 0,void 0,void 0,r)}function Ko(t,e,r,n,s,i,o){const a=o(t,e,r,n,s,i);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return ra(t,e,i,o)}return ra(t,e,i,o)}function ra(t,e,r,n){if(Object.is(t,e))return!0;let s=sm(t),i=sm(e);if(s===im&&(s=Zu),i===im&&(i=Zu),s!==i)return!1;switch(s){case XD:return t.toString()===e.toString();case QD:{const c=t.valueOf(),l=e.valueOf();return ZD(c,l)}case ek:case rk:case tk:return Object.is(t.valueOf(),e.valueOf());case JD:return t.source===e.source&&t.flags===e.flags;case ok:return t===e}r=r??new Map;const o=r.get(t),a=r.get(e);if(o!=null&&a!=null)return o===e;r.set(t,e),r.set(e,t);try{switch(s){case nk:{if(t.size!==e.size)return!1;for(const[c,l]of t.entries())if(!e.has(c)||!Ko(l,e.get(c),c,t,e,r,n))return!1;return!0}case sk:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const d=c[u],h=l.findIndex(m=>Ko(d,m,void 0,t,e,r,n));if(h===-1)return!1;l.splice(h,1)}return!0}case ik:case uk:case dk:case hk:case fk:case pk:case gk:case mk:case wk:case yk:case bk:case Ek:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!Ko(t[c],e[c],c,t,e,r,n))return!1;return!0}case ak:return t.byteLength!==e.byteLength?!1:ra(new Uint8Array(t),new Uint8Array(e),r,n);case lk:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:ra(new Uint8Array(t),new Uint8Array(e),r,n);case ck:return t.name===e.name&&t.message===e.message;case Zu:{if(!(ra(t.constructor,e.constructor,r,n)||om(t)&&om(e)))return!1;const c=[...Object.keys(t),...nm(t)],l=[...Object.keys(e),...nm(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const d=c[u],h=t[d];if(!Object.hasOwn(e,d))return!1;const m=e[d];if(!Ko(h,m,d,t,e,r,n))return!1}return!0}default:return!1}}finally{r.delete(t),r.delete(e)}}function _k(){}function Ck(t,e){return vk(t,e,_k)}var Ak=Object.defineProperty,am=Object.getOwnPropertySymbols,Ik=Object.prototype.hasOwnProperty,Sk=Object.prototype.propertyIsEnumerable,ch=(t,e,r)=>e in t?Ak(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,cm=(t,e)=>{for(var r in e||(e={}))Ik.call(e,r)&&ch(t,r,e[r]);if(am)for(var r of am(e))Sk.call(e,r)&&ch(t,r,e[r]);return t},hr=(t,e,r)=>ch(t,typeof e!="symbol"?e+"":e,r);class vi extends u_{constructor(e,r,n,s=Nn,i=void 0){super(e,r,n,s),this.core=e,this.logger=r,this.name=n,hr(this,"map",new Map),hr(this,"version",NP),hr(this,"cached",[]),hr(this,"initialized",!1),hr(this,"getKey"),hr(this,"storagePrefix",Nn),hr(this,"recentlyDeleted",[]),hr(this,"recentlyDeletedLimit",200),hr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Vt(o)?this.map.set(this.getKey(o),o):HO(o)?this.map.set(o.id,o):WO(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),hr(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),hr(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),hr(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>Ck(a[c],o[c]))):this.values)),hr(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=cm(cm({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),hr(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=tr(r,this.name),this.storagePrefix=s,this.getKey=i}get context(){return Sr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){if(this.recentlyDeleted.includes(e)){const{message:s}=se("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:n}=se("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Tk=Object.defineProperty,Nk=(t,e,r)=>e in t?Tk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$e=(t,e,r)=>Nk(t,typeof e!="symbol"?e+"":e,r);class xk{constructor(e,r){this.core=e,this.logger=r,$e(this,"name",PP),$e(this,"version",DP),$e(this,"events",new _h),$e(this,"pairings"),$e(this,"initialized",!1),$e(this,"storagePrefix",Nn),$e(this,"ignoredPayloadTypes",[Gn]),$e(this,"registeredMethods",[]),$e(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),$e(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),$e(this,"create",async n=>{this.isInitialized();const s=Yd(),i=await this.core.crypto.setSymKey(s),o=Rt(ne.FIVE_MINUTES),a={protocol:H0},c={topic:i,expiry:o,relay:a,active:!1,methods:n==null?void 0:n.methods},l=Ig({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:n==null?void 0:n.methods});return this.events.emit(Vs.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:n==null?void 0:n.transportType}),{topic:i,uri:l}}),$e(this,"pair",async n=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:n==null?void 0:n.uri,trace:[yn.pairing_started]}});this.isValidPair(n,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=Ag(n.uri);s.props.properties.topic=i,s.addTrace(yn.pairing_uri_validation_success),s.addTrace(yn.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(yn.existing_pairing),u.active)throw s.setError(jn.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(yn.pairing_not_expired)}const d=c||Rt(ne.FIVE_MINUTES),h={topic:i,relay:a,expiry:d,active:!1,methods:l};this.core.expirer.set(i,d),await this.pairings.set(i,h),s.addTrace(yn.store_new_pairing),n.activatePairing&&await this.activate({topic:i}),this.events.emit(Vs.create,h),s.addTrace(yn.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(yn.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(jn.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(m){throw s.setError(jn.subscribe_pairing_topic_failure),m}return s.addTrace(yn.subscribe_pairing_topic_success),h}),$e(this,"activate",async({topic:n})=>{this.isInitialized();const s=Rt(ne.FIVE_MINUTES);this.core.expirer.set(n,s),await this.pairings.update(n,{active:!0,expiry:s})}),$e(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=n;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=Ws();this.events.once(Je("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),$e(this,"updateExpiry",async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})}),$e(this,"updateMetadata",async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})}),$e(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),$e(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",st("USER_DISCONNECTED")),await this.deletePairing(s))}),$e(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(s);return Ig({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),$e(this,"sendRequest",async(n,s,i)=>{const o=_s(s,i),a=await this.core.crypto.encode(n,o),c=Po[s].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),$e(this,"sendResult",async(n,s,i)=>{const o=$l(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=Po[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),$e(this,"sendError",async(n,s,i)=>{const o=Bl(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=Po[c]?Po[c].res:Po.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),$e(this,"deletePairing",async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,st("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])}),$e(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(s=>ps(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))}),$e(this,"onRelayEventRequest",async n=>{const{topic:s,payload:i}=n;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),$e(this,"onRelayEventResponse",async n=>{const{topic:s,payload:i}=n,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),$e(this,"onPairingPingRequest",async(n,s)=>{const{id:i}=s;try{this.isValidPing({topic:n}),await this.sendResult(i,n,!0),this.events.emit(Vs.ping,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),$e(this,"onPairingPingResponse",(n,s)=>{const{id:i}=s;setTimeout(()=>{En(s)?this.events.emit(Je("pairing_ping",i),{}):zr(s)&&this.events.emit(Je("pairing_ping",i),{error:s.error})},500)}),$e(this,"onPairingDeleteRequest",async(n,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Vs.delete,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),$e(this,"onUnknownRpcMethodRequest",async(n,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=st("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,n,a),this.logger.error(a)}catch(a){await this.sendError(i,n,a),this.logger.error(a)}}),$e(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error(st("WC_METHOD_UNSUPPORTED",n))}),$e(this,"isValidPair",(n,s)=>{var i;if(!wr(n)){const{message:a}=se("MISSING_OR_INVALID",`pair() params: ${n}`);throw s.setError(jn.malformed_pairing_uri),new Error(a)}if(!qO(n.uri)){const{message:a}=se("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw s.setError(jn.malformed_pairing_uri),new Error(a)}const o=Ag(n==null?void 0:n.uri);if(!((i=o==null?void 0:o.relay)!=null&&i.protocol)){const{message:a}=se("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(jn.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=se("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(jn.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&ne.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(jn.pairing_expired);const{message:a}=se("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),$e(this,"isValidPing",async n=>{if(!wr(n)){const{message:i}=se("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),$e(this,"isValidDisconnect",async n=>{if(!wr(n)){const{message:i}=se("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),$e(this,"isValidPairingTopic",async n=>{if(!St(n,!1)){const{message:s}=se("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=se("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(ps(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=se("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}}),this.core=e,this.logger=tr(r,this.name),this.pairings=new vi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Sr(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Lt.message,async e=>{const{topic:r,message:n,transportType:s}=e;if(this.pairings.keys.includes(r)&&s!==ft.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const i=await this.core.crypto.decode(r,n);ef(i)?(this.core.history.set(r,i),await this.onRelayEventRequest({topic:r,payload:i})):Ll(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:r,payload:i}),this.core.history.delete(r,i.id)),await this.core.relayer.messages.ack(r,n)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(Hr.expired,async e=>{const{topic:r}=Hy(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Vs.expire,{topic:r}))})}}var Ok=Object.defineProperty,Rk=(t,e,r)=>e in t?Ok(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Wt=(t,e,r)=>Rk(t,typeof e!="symbol"?e+"":e,r);class Pk extends o_{constructor(e,r){super(e,r),this.core=e,this.logger=r,Wt(this,"records",new Map),Wt(this,"events",new Gr.EventEmitter),Wt(this,"name",kP),Wt(this,"version",UP),Wt(this,"cached",[]),Wt(this,"initialized",!1),Wt(this,"storagePrefix",Nn),Wt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Wt(this,"set",(n,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:i,expiry:Rt(ne.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(en.created,o)}),Wt(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=zr(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.persist(),this.events.emit(en.updated,s))}),Wt(this,"get",async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s))),Wt(this,"delete",(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===n){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(en.deleted,i)}}),this.persist()}),Wt(this,"exists",async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1)),Wt(this,"on",(n,s)=>{this.events.on(n,s)}),Wt(this,"once",(n,s)=>{this.events.once(n,s)}),Wt(this,"off",(n,s)=>{this.events.off(n,s)}),Wt(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=tr(r,this.name)}get context(){return Sr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:_s(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=se("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(en.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(en.created,e=>{const r=en.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(en.updated,e=>{const r=en.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(en.deleted,e=>{const r=en.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.core.heartbeat.on(bi.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(r=>{ne.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(en.deleted,r,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Dk=Object.defineProperty,kk=(t,e,r)=>e in t?Dk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Qt=(t,e,r)=>kk(t,typeof e!="symbol"?e+"":e,r);class Uk extends h_{constructor(e,r){super(e,r),this.core=e,this.logger=r,Qt(this,"expirations",new Map),Qt(this,"events",new Gr.EventEmitter),Qt(this,"name",$P),Qt(this,"version",BP),Qt(this,"cached",[]),Qt(this,"initialized",!1),Qt(this,"storagePrefix",Nn),Qt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Qt(this,"has",n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}}),Qt(this,"set",(n,s)=>{this.isInitialized();const i=this.formatTarget(n),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(Hr.created,{target:i,expiration:o})}),Qt(this,"get",n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)}),Qt(this,"del",n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Hr.deleted,{target:s,expiration:i})}}),Qt(this,"on",(n,s)=>{this.events.on(n,s)}),Qt(this,"once",(n,s)=>{this.events.once(n,s)}),Qt(this,"off",(n,s)=>{this.events.off(n,s)}),Qt(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=tr(r,this.name)}get context(){return Sr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return x2(e);if(typeof e=="number")return O2(e);const{message:r}=se("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Hr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=se("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;ne.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(Hr.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(bi.pulse,()=>this.checkExpirations()),this.events.on(Hr.created,e=>{const r=Hr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Hr.expired,e=>{const r=Hr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Hr.deleted,e=>{const r=Hr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}var $k=Object.defineProperty,Bk=(t,e,r)=>e in t?$k(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,It=(t,e,r)=>Bk(t,typeof e!="symbol"?e+"":e,r);class Lk extends f_{constructor(e,r,n){super(e,r,n),this.core=e,this.logger=r,this.store=n,It(this,"name",LP),It(this,"abortController"),It(this,"isDevEnv"),It(this,"verifyUrlV3",FP),It(this,"storagePrefix",Nn),It(this,"version",q0),It(this,"publicKey"),It(this,"fetchPromise"),It(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&ne.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),It(this,"register",async s=>{if(!po()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=Xn.getDocument(),u=this.startAbortTimer(ne.ONE_SECOND*5),d=await new Promise((h,m)=>{const f=()=>{window.removeEventListener("message",_),l.body.removeChild(g),m("attestation aborted")};this.abortController.signal.addEventListener("abort",f);const g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",f,{signal:this.abortController.signal});const _=I=>{if(I.data&&typeof I.data=="string")try{const N=JSON.parse(I.data);if(N.type==="verify_attestation"){if(Id(N.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",f),window.removeEventListener("message",_),h(N.attestation===null?"":N.attestation)}}catch(N){this.logger.warn(N)}};l.body.appendChild(g),window.addEventListener("message",_,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",d),d}catch(l){this.logger.warn(l)}return""}),It(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Id(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,c)}),It(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(ne.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),It(this,"getVerifyUrl",s=>{let i=s||ta;return jP.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${ta}`),i=ta),i}),It(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(ne.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),It(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),It(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),It(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),It(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),It(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),It(this,"validateAttestation",(s,i)=>{const o=vO(s,i.publicKey),a={hasExpired:ne.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=tr(r,this.name),this.abortController=new AbortController,this.isDevEnv=Mh(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Sr(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ne.toMiliseconds(e))}}var Mk=Object.defineProperty,Fk=(t,e,r)=>e in t?Mk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,lm=(t,e,r)=>Fk(t,typeof e!="symbol"?e+"":e,r);class jk extends p_{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,lm(this,"context",qP),lm(this,"registerDeviceToken",async n=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=n,c=`${HP}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=tr(r,this.context)}}var qk=Object.defineProperty,um=Object.getOwnPropertySymbols,Hk=Object.prototype.hasOwnProperty,Wk=Object.prototype.propertyIsEnumerable,lh=(t,e,r)=>e in t?qk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Uo=(t,e)=>{for(var r in e||(e={}))Hk.call(e,r)&&lh(t,r,e[r]);if(um)for(var r of um(e))Wk.call(e,r)&&lh(t,r,e[r]);return t},Dt=(t,e,r)=>lh(t,typeof e!="symbol"?e+"":e,r);class zk extends g_{constructor(e,r,n=!0){super(e,r,n),this.core=e,this.logger=r,Dt(this,"context",zP),Dt(this,"storagePrefix",Nn),Dt(this,"storageVersion",WP),Dt(this,"events",new Map),Dt(this,"shouldPersist",!1),Dt(this,"init",async()=>{if(!Mh())try{const s={eventId:Kp(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:jy(this.core.relayer.protocol,this.core.relayer.version,th)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),Dt(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=Kp(),u=this.core.projectId||"",d=Date.now(),h=Uo({eventId:l,timestamp:d,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,h),this.shouldPersist=!0),h}),Dt(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return Uo(Uo({},a),this.setMethods(a.eventId))}),Dt(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),Dt(this,"setEventListeners",()=>{this.core.heartbeat.on(bi.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{ne.fromMiliseconds(Date.now())-ne.fromMiliseconds(s.timestamp)>VP&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),Dt(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),Dt(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),Dt(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),Dt(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Dt(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,Uo(Uo({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),Dt(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),Dt(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${KP}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${th}${i}`,{method:"POST",body:JSON.stringify(s)})}),Dt(this,"getAppDomain",()=>Fy().url),this.logger=tr(r,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var Vk=Object.defineProperty,dm=Object.getOwnPropertySymbols,Kk=Object.prototype.hasOwnProperty,Gk=Object.prototype.propertyIsEnumerable,uh=(t,e,r)=>e in t?Vk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,hm=(t,e)=>{for(var r in e||(e={}))Kk.call(e,r)&&uh(t,r,e[r]);if(dm)for(var r of dm(e))Gk.call(e,r)&&uh(t,r,e[r]);return t},ut=(t,e,r)=>uh(t,typeof e!="symbol"?e+"":e,r);let Yk=class nb extends r_{constructor(e){var r;super(e),ut(this,"protocol",j0),ut(this,"version",q0),ut(this,"name",eh),ut(this,"relayUrl"),ut(this,"projectId"),ut(this,"customStoragePrefix"),ut(this,"events",new Gr.EventEmitter),ut(this,"logger"),ut(this,"heartbeat"),ut(this,"relayer"),ut(this,"crypto"),ut(this,"storage"),ut(this,"history"),ut(this,"expirer"),ut(this,"pairing"),ut(this,"verify"),ut(this,"echoClient"),ut(this,"linkModeSupportedApps"),ut(this,"eventClient"),ut(this,"initialized",!1),ut(this,"logChunkController"),ut(this,"on",(a,c)=>this.events.on(a,c)),ut(this,"once",(a,c)=>this.events.once(a,c)),ut(this,"off",(a,c)=>this.events.off(a,c)),ut(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),ut(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:ft.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const n=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(n)try{return this.customStoragePrefix=n.customStoragePrefix,this.logger=n.logger,this.heartbeat=n.heartbeat,this.crypto=n.crypto,this.history=n.history,this.expirer=n.expirer,this.storage=n.storage,this.relayer=n.relayer,this.pairing=n.pairing,this.verify=n.verify,this.echoClient=n.echoClient,this.linkModeSupportedApps=n.linkModeSupportedApps,this.eventClient=n.eventClient,this.initialized=n.initialized,this.logChunkController=n.logChunkController,n}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||W0,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=co({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:gP.logger,name:eh}),{logger:i,chunkLoggerController:o}=Ah({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(r=this.logChunkController)!=null&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=tr(i,this.name),this.heartbeat=new t1,this.crypto=new _D(this,this.logger,e==null?void 0:e.keychain),this.history=new Pk(this,this.logger),this.expirer=new Uk(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new B1(hm(hm({},mP),e==null?void 0:e.storageOptions)),this.relayer=new YD({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new xk(this,this.logger),this.verify=new Lk(this,this.logger,this.storage),this.echoClient=new jk(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new zk(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const r=new nb(e);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(xP,n),r}get context(){return Sr(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(zg,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(zg)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${e}`,n=`${r}_count`;return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[n]} times.`),globalThis[r]}catch(r){console.warn("Failed to get global WalletConnect core",r);return}}setGlobalCore(e){var r;try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${((r=e.opts)==null?void 0:r.customStoragePrefix)||""}`;globalThis[n]=e}catch(n){console.warn("Failed to set global WalletConnect core",n)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&pP.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const Zk=Yk,sb="wc",ib=2,ob="client",tf=`${sb}@${ib}:${ob}:`,Ju={name:ob,logger:"error"},fm="WALLETCONNECT_DEEPLINK_CHOICE",Jk="proposal",pm="Proposal expired",Xk="session",Oi=ne.SEVEN_DAYS,Qk="engine",kt={wc_sessionPropose:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1114},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:ne.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:ne.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1119}}},Xu={min:ne.FIVE_MINUTES,max:ne.SEVEN_DAYS},wn={idle:"IDLE",active:"ACTIVE"},eU={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},tU="request",rU=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],nU="wc",sU="auth",iU="authKeys",oU="pairingTopics",aU="requests",Fl=`${nU}@${1.5}:${sU}:`,jc=`${Fl}:PUB_KEY`;var cU=Object.defineProperty,lU=Object.defineProperties,uU=Object.getOwnPropertyDescriptors,gm=Object.getOwnPropertySymbols,dU=Object.prototype.hasOwnProperty,hU=Object.prototype.propertyIsEnumerable,dh=(t,e,r)=>e in t?cU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ht=(t,e)=>{for(var r in e||(e={}))dU.call(e,r)&&dh(t,r,e[r]);if(gm)for(var r of gm(e))hU.call(e,r)&&dh(t,r,e[r]);return t},fr=(t,e)=>lU(t,uU(e)),J=(t,e,r)=>dh(t,typeof e!="symbol"?e+"":e,r);class fU extends b_{constructor(e){super(e),J(this,"name",Qk),J(this,"events",new _h),J(this,"initialized",!1),J(this,"requestQueue",{state:wn.idle,queue:[]}),J(this,"sessionRequestQueue",{state:wn.idle,queue:[]}),J(this,"requestQueueDelay",ne.ONE_SECOND),J(this,"expectedPairingMethodMap",new Map),J(this,"recentlyDeletedMap",new Map),J(this,"recentlyDeletedLimit",200),J(this,"relayMessageCache",[]),J(this,"pendingSessions",new Map),J(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(kt)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ne.toMiliseconds(this.requestQueueDelay)))}),J(this,"connect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const n=fr(ht({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n),n.optionalNamespaces=BO(n.requiredNamespaces,n.optionalNamespaces),n.requiredNamespaces={};const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=n;let u=s,d,h=!1;try{if(u){const A=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=A.active}}catch(A){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),A}if(!u||!h){const{topic:A,uri:x}=await this.client.core.pairing.create();u=A,d=x}if(!u){const{message:A}=se("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(A)}const m=await this.client.core.crypto.generateKeyPair(),f=kt.wc_sessionPropose.req.ttl||ne.FIVE_MINUTES,g=Rt(f),_=fr(ht(ht({requiredNamespaces:i,optionalNamespaces:o,relays:l??[{protocol:H0}],proposer:{publicKey:m,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:u},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:bn()}),I=Je("session_connect",_.id),{reject:N,resolve:C,done:E}=Ws(f,pm),v=({id:A})=>{A===_.id&&(this.client.events.off("proposal_expire",v),this.pendingSessions.delete(_.id),this.events.emit(I,{error:{message:pm,code:0}}))};return this.client.events.on("proposal_expire",v),this.events.once(I,({error:A,session:x})=>{this.client.events.off("proposal_expire",v),A?N(A):x&&C(x)}),await this.sendRequest({topic:u,method:"wc_sessionPropose",params:_,throwOnFailedPublish:!0,clientRpcId:_.id}),await this.setProposal(_.id,_),{uri:d,approval:E}}),J(this,"pair",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(r)}catch(n){throw this.client.logger.error("pair() failed"),n}}),J(this,"approve",async r=>{var n,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(n=r==null?void 0:r.id)==null?void 0:n.toString(),trace:[tn.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(U){throw o.setError(Fs.no_internet_connection),U}try{await this.isValidProposalId(r==null?void 0:r.id)}catch(U){throw this.client.logger.error(`approve() -> proposal.get(${r==null?void 0:r.id}) failed`),o.setError(Fs.proposal_not_found),U}try{await this.isValidApprove(r)}catch(U){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Fs.session_approve_namespace_validation_failure),U}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=r,m=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:f,proposer:g,requiredNamespaces:_,optionalNamespaces:I}=m;let N=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:f});N||(N=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:tn.session_approve_started,properties:{topic:f,trace:[tn.session_approve_started,tn.session_namespaces_validation_success]}}));const C=await this.client.core.crypto.generateKeyPair(),E=g.publicKey,v=await this.client.core.crypto.generateSharedKey(C,E),A=ht(ht(ht({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:C,metadata:this.client.metadata},expiry:Rt(Oi)},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),x=ft.relay;N.addTrace(tn.subscribing_session_topic);try{await this.client.core.relayer.subscribe(v,{transportType:x})}catch(U){throw N.setError(Fs.subscribe_session_topic_failure),U}N.addTrace(tn.subscribe_session_topic_success);const D=fr(ht({},A),{topic:v,requiredNamespaces:_,optionalNamespaces:I,pairingTopic:f,acknowledged:!1,self:A.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:C,transportType:ft.relay});await this.client.session.set(v,D),N.addTrace(tn.store_session);try{N.addTrace(tn.publishing_session_settle),await this.sendRequest({topic:v,method:"wc_sessionSettle",params:A,throwOnFailedPublish:!0}).catch(U=>{throw N==null||N.setError(Fs.session_settle_publish_failure),U}),N.addTrace(tn.session_settle_publish_success),N.addTrace(tn.publishing_session_approve),await this.sendResult({id:a,topic:f,result:{relay:{protocol:c??"irn"},responderPublicKey:C},throwOnFailedPublish:!0}).catch(U=>{throw N==null||N.setError(Fs.session_approve_publish_failure),U}),N.addTrace(tn.session_approve_publish_success)}catch(U){throw this.client.logger.error(U),this.client.session.delete(v,st("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(v),U}return this.client.core.eventClient.deleteEvent({eventId:N.eventId}),await this.client.core.pairing.updateMetadata({topic:f,metadata:g.metadata}),await this.client.proposal.delete(a,st("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:f}),await this.setExpiry(v,Rt(Oi)),{topic:v,acknowledged:()=>Promise.resolve(this.client.session.get(v))}}),J(this,"reject",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(r)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:n,reason:s}=r;let i;try{i=this.client.proposal.get(n).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),o}i&&(await this.sendError({id:n,topic:i,error:s,rpcOpts:kt.wc_sessionPropose.reject}),await this.client.proposal.delete(n,st("USER_DISCONNECTED")))}),J(this,"update",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(r)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:n,namespaces:s}=r,{done:i,resolve:o,reject:a}=Ws(),c=bn(),l=Js().toString(),u=this.client.session.get(n).namespaces;return this.events.once(Je("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(n,{namespaces:s}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(d=>{this.client.logger.error(d),this.client.session.update(n,{namespaces:u}),a(d)}),{acknowledged:i}}),J(this,"extend",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(r)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:n}=r,s=bn(),{done:i,resolve:o,reject:a}=Ws();return this.events.once(Je("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(n,Rt(Oi)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),J(this,"request",async r=>{this.isInitialized();try{await this.isValidRequest(r)}catch(_){throw this.client.logger.error("request() -> isValidRequest() failed"),_}const{chainId:n,request:s,topic:i,expiry:o=kt.wc_sessionRequest.req.ttl}=r,a=this.client.session.get(i);(a==null?void 0:a.transportType)===ft.relay&&await this.confirmOnlineStateOrThrow();const c=bn(),l=Js().toString(),{done:u,resolve:d,reject:h}=Ws(o,"Request expired. Please try again.");this.events.once(Je("session_request",c),({error:_,result:I})=>{_?h(_):d(I)});const m="wc_sessionRequest",f=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(f)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:m,params:{request:fr(ht({},s),{expiryTimestamp:Rt(o)}),chainId:n},expiry:o,throwOnFailedPublish:!0,appLink:f}).catch(_=>h(_)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),await u();const g={request:fr(ht({},s),{expiryTimestamp:Rt(o)}),chainId:n};return await Promise.all([new Promise(async _=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:m,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(I=>h(I)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),_()}),new Promise(async _=>{var I;if(!((I=a.sessionConfig)!=null&&I.disableDeepLink)){const N=await k2(this.client.core.storage,fm);await R2({id:c,topic:i,wcDeepLink:N})}_()}),u()]).then(_=>_[2])}),J(this,"respond",async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:s}=r,{id:i}=s,o=this.client.session.get(n);o.transportType===ft.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);En(s)?await this.sendResult({id:i,topic:n,result:s.result,throwOnFailedPublish:!0,appLink:a}):zr(s)&&await this.sendError({id:i,topic:n,error:s.error,appLink:a}),this.cleanupAfterResponse(r)}),J(this,"ping",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(r)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:n}=r;if(this.client.session.keys.includes(n)){const s=bn(),i=Js().toString(),{done:o,resolve:a,reject:c}=Ws();this.events.once(Je("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(n)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:n}))}),J(this,"emit",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(r);const{topic:n,event:s,chainId:i}=r,o=Js().toString(),a=bn();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),J(this,"disconnect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(r);const{topic:n}=r;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:st("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:s}=se("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(s)}}),J(this,"find",r=>(this.isInitialized(),this.client.session.getAll().filter(n=>FO(n,r)))),J(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),J(this,"authenticate",async(r,n)=>{var s;this.isInitialized(),this.isValidAuthenticate(r);const i=n&&this.client.core.linkModeSupportedApps.includes(n)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?ft.link_mode:ft.relay;o===ft.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:d,type:h,exp:m,nbf:f,methods:g=[],expiry:_}=r,I=[...r.resources||[]],{topic:N,uri:C}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:N,uri:C}});const E=await this.client.core.crypto.generateKeyPair(),v=Mc(E);if(await Promise.all([this.client.auth.authKeys.set(jc,{responseTopic:v,publicKey:E}),this.client.auth.pairingTopics.set(v,{topic:v,pairingTopic:N})]),await this.client.core.relayer.subscribe(v,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${N}`),g.length>0){const{namespace:k}=Zi(a[0]);let L=ZN(k,"request",g);Lc(I)&&(L=XN(L,I.pop())),I.push(L)}const A=_&&_>kt.wc_sessionAuthenticate.req.ttl?_:kt.wc_sessionAuthenticate.req.ttl,x={authPayload:{type:h??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:m,nbf:f,resources:I},requester:{publicKey:E,metadata:this.client.metadata},expiryTimestamp:Rt(A)},D={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},U={requiredNamespaces:{},optionalNamespaces:D,relays:[{protocol:"irn"}],pairingTopic:N,proposer:{publicKey:E,metadata:this.client.metadata},expiryTimestamp:Rt(kt.wc_sessionPropose.req.ttl),id:bn()},{done:M,resolve:$,reject:F}=Ws(A,"Request expired"),W=bn(),q=Je("session_connect",U.id),y=Je("session_request",W),b=async({error:k,session:L})=>{this.events.off(y,O),k?F(k):L&&$({session:L})},O=async k=>{var L,H,K;if(await this.deletePendingAuthRequest(W,{message:"fulfilled",code:0}),k.error){const be=st("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return k.error.code===be.code?void 0:(this.events.off(q,b),F(k.error.message))}await this.deleteProposal(U.id),this.events.off(q,b);const{cacaos:Q,responder:Z}=k.result,re=[],we=[];for(const be of Q){await ng({cacao:be,projectId:this.client.core.projectId})||(this.client.logger.error(be,"Signature verification failed"),F(st("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:xe}=be,Ze=Lc(xe.resources),tt=[Md(xe.iss)],qe=sl(xe.iss);if(Ze){const ct=sg(Ze),jt=ig(Ze);re.push(...ct),tt.push(...jt)}for(const ct of tt)we.push(`${ct}:${qe}`)}const Ee=await this.client.core.crypto.generateSharedKey(E,Z.publicKey);let Ne;re.length>0&&(Ne={topic:Ee,acknowledged:!0,self:{publicKey:E,metadata:this.client.metadata},peer:Z,controller:Z.publicKey,expiry:Rt(Oi),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:N,namespaces:xg([...new Set(re)],[...new Set(we)]),transportType:o},await this.client.core.relayer.subscribe(Ee,{transportType:o}),await this.client.session.set(Ee,Ne),N&&await this.client.core.pairing.updateMetadata({topic:N,metadata:Z.metadata}),Ne=this.client.session.get(Ee)),(L=this.client.metadata.redirect)!=null&&L.linkMode&&(H=Z.metadata.redirect)!=null&&H.linkMode&&(K=Z.metadata.redirect)!=null&&K.universal&&n&&(this.client.core.addLinkModeSupportedApp(Z.metadata.redirect.universal),this.client.session.update(Ee,{transportType:ft.link_mode})),$({auths:Q,session:Ne})};this.events.once(q,b),this.events.once(y,O);let B;try{if(i){const k=_s("wc_sessionAuthenticate",x,W);this.client.core.history.set(N,k);const L=await this.client.core.crypto.encode("",k,{type:Xa,encoding:ys});B=Ec(n,N,L)}else await Promise.all([this.sendRequest({topic:N,method:"wc_sessionAuthenticate",params:x,expiry:r.expiry,throwOnFailedPublish:!0,clientRpcId:W}),this.sendRequest({topic:N,method:"wc_sessionPropose",params:U,expiry:kt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:U.id})])}catch(k){throw this.events.off(q,b),this.events.off(y,O),k}return await this.setProposal(U.id,U),await this.setAuthRequest(W,{request:fr(ht({},x),{verifyContext:{}}),pairingTopic:N,transportType:o}),{uri:B??C,response:M}}),J(this,"approveSessionAuthenticate",async r=>{const{id:n,auths:s}=r,i=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[js.authenticated_session_approve_started]}});try{this.isInitialized()}catch(_){throw i.setError(Do.no_internet_connection),_}const o=this.getPendingAuthRequest(n);if(!o)throw i.setError(Do.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const a=o.transportType||ft.relay;a===ft.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=Mc(c),d={type:Gn,receiverPublicKey:c,senderPublicKey:l},h=[],m=[];for(const _ of s){if(!await ng({cacao:_,projectId:this.client.core.projectId})){i.setError(Do.invalid_cacao);const v=st("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:u,error:v,encodeOpts:d}),new Error(v.message)}i.addTrace(js.cacaos_verified);const{p:I}=_,N=Lc(I.resources),C=[Md(I.iss)],E=sl(I.iss);if(N){const v=sg(N),A=ig(N);h.push(...v),C.push(...A)}for(const v of C)m.push(`${v}:${E}`)}const f=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(js.create_authenticated_session_topic);let g;if((h==null?void 0:h.length)>0){g={topic:f,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:Rt(Oi),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:xg([...new Set(h)],[...new Set(m)]),transportType:a},i.addTrace(js.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(f,{transportType:a})}catch(_){throw i.setError(Do.subscribe_authenticated_session_topic_failure),_}i.addTrace(js.subscribe_authenticated_session_topic_success),await this.client.session.set(f,g),i.addTrace(js.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(js.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:n,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(_){throw i.setError(Do.authenticated_session_approve_publish_failure),_}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),J(this,"rejectSessionAuthenticate",async r=>{this.isInitialized();const{id:n,reason:s}=r,i=this.getPendingAuthRequest(n);if(!i)throw new Error(`Could not find pending auth request with id ${n}`);i.transportType===ft.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=Mc(o),l={type:Gn,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:n,topic:c,error:s,encodeOpts:l,rpcOpts:kt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.client.proposal.delete(n,st("USER_DISCONNECTED"))}),J(this,"formatAuthMessage",r=>{this.isInitialized();const{request:n,iss:s}=r;return n0(n,s)}),J(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const r=this.relayMessageCache.shift();r&&await this.onRelayMessage(r)}catch(r){this.client.logger.error(r)}},50)}),J(this,"cleanupDuplicatePairings",async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===r.peer.metadata.url&&i.topic&&i.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}}),J(this,"deleteSession",async r=>{var n;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=r,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,st("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(fm).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===s&&this.deletePendingSessionRequest(l.id,st("USER_DISCONNECTED"))}),s===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=wn.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),J(this,"deleteProposal",async(r,n)=>{if(n)try{const s=this.client.proposal.get(r),i=this.client.core.eventClient.getEvent({topic:s.pairingTopic});i==null||i.setError(Fs.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(r,st("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"proposal")}),J(this,"deletePendingSessionRequest",async(r,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),s?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==r),s&&(this.sessionRequestQueue.state=wn.idle,this.client.events.emit("session_request_expire",{id:r}))}),J(this,"deletePendingAuthRequest",async(r,n,s=!1)=>{await Promise.all([this.client.auth.requests.delete(r,n),s?Promise.resolve():this.client.core.expirer.del(r)])}),J(this,"setExpiry",async(r,n)=>{this.client.session.keys.includes(r)&&(this.client.core.expirer.set(r,n),await this.client.session.update(r,{expiry:n}))}),J(this,"setProposal",async(r,n)=>{this.client.core.expirer.set(r,Rt(kt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(r,n)}),J(this,"setAuthRequest",async(r,n)=>{const{request:s,pairingTopic:i,transportType:o=ft.relay}=n;this.client.core.expirer.set(r,s.expiryTimestamp),await this.client.auth.requests.set(r,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:r,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),J(this,"setPendingSessionRequest",async r=>{const{id:n,topic:s,params:i,verifyContext:o}=r,a=i.request.expiryTimestamp||Rt(kt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,a),await this.client.pendingRequest.set(n,{id:n,topic:s,params:i,verifyContext:o})}),J(this,"sendRequest",async r=>{const{topic:n,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:d}=r,h=_s(s,i,c);let m;const f=!!u;try{const I=f?ys:an;m=await this.client.core.crypto.encode(n,h,{encoding:I})}catch(I){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),I}let g;if(rU.includes(s)){const I=Cn(JSON.stringify(h)),N=Cn(m);g=await this.client.core.verify.register({id:N,decryptedId:I})}const _=kt[s].req;if(_.attestation=g,o&&(_.ttl=o),a&&(_.id=a),this.client.core.history.set(n,h),f){const I=Ec(u,n,m);await global.Linking.openURL(I,this.client.name)}else{const I=kt[s].req;o&&(I.ttl=o),a&&(I.id=a),I.tvf=fr(ht({},d),{correlationId:h.id}),l?(I.internal=fr(ht({},I.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,m,I)):this.client.core.relayer.publish(n,m,I).catch(N=>this.client.logger.error(N))}return h.id}),J(this,"sendResult",async r=>{const{id:n,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=r,l=$l(n,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const f=d?ys:an;u=await this.client.core.crypto.encode(s,l,fr(ht({},a||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),f}let h,m;try{h=await this.client.core.history.get(s,n);const f=h.request;try{m=this.getTVFParams(n,f.params,i)}catch(g){this.client.logger.warn("sendResult() -> getTVFParams() failed",g)}}catch(f){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${n}) failed`),f}if(d){const f=Ec(c,s,u);await global.Linking.openURL(f,this.client.name)}else{const f=h.request.method,g=kt[f].res;g.tvf=fr(ht({},m),{correlationId:n}),o?(g.internal=fr(ht({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,g)):this.client.core.relayer.publish(s,u,g).catch(_=>this.client.logger.error(_))}await this.client.core.history.resolve(l)}),J(this,"sendError",async r=>{const{id:n,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=r,l=Bl(n,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const m=d?ys:an;u=await this.client.core.crypto.encode(s,l,fr(ht({},o||{}),{encoding:m}))}catch(m){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),m}let h;try{h=await this.client.core.history.get(s,n)}catch(m){throw this.client.logger.error(`sendError() -> history.get(${s}, ${n}) failed`),m}if(d){const m=Ec(c,s,u);await global.Linking.openURL(m,this.client.name)}else{const m=h.request.method,f=a||kt[m].res;this.client.core.relayer.publish(s,u,f)}await this.client.core.history.resolve(l)}),J(this,"cleanup",async()=>{const r=[],n=[];this.client.session.getAll().forEach(s=>{let i=!1;ps(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&r.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{ps(s.expiryTimestamp)&&n.push(s.id)}),await Promise.all([...r.map(s=>this.deleteSession({topic:s})),...n.map(s=>this.deleteProposal(s))])}),J(this,"onProviderMessageEvent",async r=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(r):await this.onRelayMessage(r)}),J(this,"onRelayEventRequest",async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()}),J(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===wn.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=wn.active;const r=this.requestQueue.queue.shift();if(r)try{await this.processRequest(r)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=wn.idle}),J(this,"processRequest",async r=>{const{topic:n,payload:s,attestation:i,transportType:o,encryptedId:a}=r,c=s.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,s);case"wc_sessionPing":return await this.onSessionPingRequest(n,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(n,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),J(this,"onRelayEventResponse",async r=>{const{topic:n,payload:s,transportType:i}=r,o=(await this.client.core.history.get(n,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),J(this,"onRelayEventUnknownPayload",r=>{const{topic:n}=r,{message:s}=se("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),J(this,"shouldIgnorePairingRequest",r=>{const{topic:n,requestMethod:s}=r,i=this.expectedPairingMethodMap.get(n);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),J(this,"onSessionProposeRequest",async r=>{const{topic:n,payload:s,attestation:i,encryptedId:o}=r,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:n});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l==null||l.setError(jn.proposal_listener_not_found)),this.isValidConnect(ht({},s.params));const u=a.expiryTimestamp||Rt(kt.wc_sessionPropose.req.ttl),d=ht({id:c,pairingTopic:n,expiryTimestamp:u},a);await this.setProposal(c,d);const h=await this.getVerifyContext({attestationId:i,hash:Cn(JSON.stringify(s)),encryptedId:o,metadata:d.proposer.metadata});l==null||l.addTrace(yn.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:h})}catch(l){await this.sendError({id:c,topic:n,error:l,rpcOpts:kt.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),J(this,"onSessionProposeResponse",async(r,n,s)=>{const{id:i}=n;if(En(n)){const{result:o}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:r,proposalId:i,publicKey:c});const d=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:r})}else if(zr(n)){await this.client.proposal.delete(i,st("USER_DISCONNECTED"));const o=Je("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:n.error})}}),J(this,"onSessionSettleRequest",async(r,n)=>{const{id:s,params:i}=n;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=n.params,m=[...this.pendingSessions.values()].find(_=>_.sessionTopic===r);if(!m)return this.client.logger.error(`Pending session not found for topic ${r}`);const f=this.client.proposal.get(m.proposalId),g=fr(ht(ht(ht({topic:r,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:m.pairingTopic,requiredNamespaces:f.requiredNamespaces,optionalNamespaces:f.optionalNamespaces,controller:a.publicKey,self:{publicKey:m.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{transportType:ft.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:m.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(Je("session_connect",m.proposalId),{session:g}),this.pendingSessions.delete(m.proposalId),this.deleteProposal(m.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:n.id,topic:r,result:!0,throwOnFailedPublish:!0})}catch(o){await this.sendError({id:s,topic:r,error:o}),this.client.logger.error(o)}}),J(this,"onSessionSettleResponse",async(r,n)=>{const{id:s}=n;En(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Je("session_approve",s),{})):zr(n)&&(await this.client.session.delete(r,st("USER_DISCONNECTED")),this.events.emit(Je("session_approve",s),{error:n.error}))}),J(this,"onSessionUpdateRequest",async(r,n)=>{const{params:s,id:i}=n;try{const o=`${r}_session_update`,a=Ro.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:r,error:st("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(ht({topic:r},s));try{Ro.set(o,i),await this.client.session.update(r,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:r,result:!0,throwOnFailedPublish:!0})}catch(c){throw Ro.delete(o),c}this.client.events.emit("session_update",{id:i,topic:r,params:s})}catch(o){await this.sendError({id:i,topic:r,error:o}),this.client.logger.error(o)}}),J(this,"isRequestOutOfSync",(r,n)=>n.toString().slice(0,-3)<r.toString().slice(0,-3)),J(this,"onSessionUpdateResponse",(r,n)=>{const{id:s}=n,i=Je("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);En(n)?this.events.emit(Je("session_update",s),{}):zr(n)&&this.events.emit(Je("session_update",s),{error:n.error})}),J(this,"onSessionExtendRequest",async(r,n)=>{const{id:s}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Rt(Oi)),await this.sendResult({id:s,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:s,topic:r})}catch(i){await this.sendError({id:s,topic:r,error:i}),this.client.logger.error(i)}}),J(this,"onSessionExtendResponse",(r,n)=>{const{id:s}=n,i=Je("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);En(n)?this.events.emit(Je("session_extend",s),{}):zr(n)&&this.events.emit(Je("session_extend",s),{error:n.error})}),J(this,"onSessionPingRequest",async(r,n)=>{const{id:s}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:s,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:r})}catch(i){await this.sendError({id:s,topic:r,error:i}),this.client.logger.error(i)}}),J(this,"onSessionPingResponse",(r,n)=>{const{id:s}=n,i=Je("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);En(n)?this.events.emit(Je("session_ping",s),{}):zr(n)&&this.events.emit(Je("session_ping",s),{error:n.error})},500)}),J(this,"onSessionDeleteRequest",async(r,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),Promise.all([new Promise(i=>{this.client.core.relayer.once(Lt.publish,async()=>{i(await this.deleteSession({topic:r,id:s}))})}),this.sendResult({id:s,topic:r,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:r,error:st("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),J(this,"onSessionRequest",async r=>{var n,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=r,{id:d,params:h}=a;try{await this.isValidRequest(ht({topic:o},h));const m=this.client.session.get(o),f=await this.getVerifyContext({attestationId:c,hash:Cn(JSON.stringify(_s("wc_sessionRequest",h,d))),encryptedId:l,metadata:m.peer.metadata,transportType:u}),g={id:d,topic:o,params:h,verifyContext:f};await this.setPendingSessionRequest(g),u===ft.link_mode&&(n=m.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((s=m.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(m){await this.sendError({id:d,topic:o,error:m}),this.client.logger.error(m)}}),J(this,"onSessionRequestResponse",(r,n)=>{const{id:s}=n,i=Je("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);En(n)?this.events.emit(Je("session_request",s),{result:n.result}):zr(n)&&this.events.emit(Je("session_request",s),{error:n.error})}),J(this,"onSessionEventRequest",async(r,n)=>{const{id:s,params:i}=n;try{const o=`${r}_session_event_${i.event.name}`,a=Ro.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(ht({topic:r},i)),this.client.events.emit("session_event",{id:s,topic:r,params:i}),Ro.set(o,s)}catch(o){await this.sendError({id:s,topic:r,error:o}),this.client.logger.error(o)}}),J(this,"onSessionAuthenticateResponse",(r,n)=>{const{id:s}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:r,payload:n}),En(n)?this.events.emit(Je("session_request",s),{result:n.result}):zr(n)&&this.events.emit(Je("session_request",s),{error:n.error})}),J(this,"onSessionAuthenticateRequest",async r=>{var n;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=r;try{const{requester:l,authPayload:u,expiryTimestamp:d}=i.params,h=await this.getVerifyContext({attestationId:o,hash:Cn(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),m={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:h,expiryTimestamp:d};await this.setAuthRequest(i.id,{request:m,pairingTopic:s,transportType:c}),c===ft.link_mode&&(n=l.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:h})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(i.params.requester.metadata,c),m={type:Gn,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:m,rpcOpts:kt.wc_sessionAuthenticate.autoReject,appLink:h})}}),J(this,"addSessionRequestToSessionRequestQueue",r=>{this.sessionRequestQueue.queue.push(r)}),J(this,"cleanupAfterResponse",r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=wn.idle,this.processSessionRequestQueue()},ne.toMiliseconds(this.requestQueueDelay))}),J(this,"cleanupPendingSentRequestsForTopic",({topic:r,error:n})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===r&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=Je("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(Je("session_request",i.request.id),{error:n})})}),J(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===wn.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=wn.active,this.emitSessionRequest(r)}catch(n){this.client.logger.error(n)}}),J(this,"emitSessionRequest",r=>{this.client.events.emit("session_request",r)}),J(this,"onPairingCreated",r=>{if(r.methods&&this.expectedPairingMethodMap.set(r.topic,r.methods),r.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===r.topic);n&&this.onSessionProposeRequest({topic:r.topic,payload:_s("wc_sessionPropose",fr(ht({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties,scopedProperties:n.scopedProperties}),n.id)})}),J(this,"isValidConnect",async r=>{if(!wr(r)){const{message:l}=se("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(l)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=r;if(Vt(n)||await this.isValidPairingTopic(n),!XO(c)){const{message:l}=se("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(!Vt(s)&&Ss(s)!==0){const l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(s,"requiredNamespaces")}if(!Vt(i)&&Ss(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),Vt(o)||this.validateSessionProps(o,"sessionProperties"),!Vt(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u)))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),J(this,"validateNamespaces",(r,n)=>{const s=JO(r,"connect()",n);if(s)throw new Error(s.message)}),J(this,"isValidApprove",async r=>{if(!wr(r))throw new Error(se("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=r;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const c=this.client.proposal.get(n),l=Wu(s,"approve()");if(l)throw new Error(l.message);const u=Pg(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!St(i,!0)){const{message:d}=se("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(d)}if(Vt(o)||this.validateSessionProps(o,"sessionProperties"),!Vt(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(s));if(!Object.keys(a).every(h=>d.has(h)))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),J(this,"isValidReject",async r=>{if(!wr(r)){const{message:i}=se("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(i)}const{id:n,reason:s}=r;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!eR(s)){const{message:i}=se("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),J(this,"isValidSessionSettleRequest",r=>{if(!wr(r)){const{message:l}=se("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(l)}const{relay:n,controller:s,namespaces:i,expiry:o}=r;if(!k0(n)){const{message:l}=se("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=zO(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Wu(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(ps(o)){const{message:l}=se("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),J(this,"isValidUpdate",async r=>{if(!wr(r)){const{message:c}=se("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(c)}const{topic:n,namespaces:s}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const i=this.client.session.get(n),o=Wu(s,"update()");if(o)throw new Error(o.message);const a=Pg(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),J(this,"isValidExtend",async r=>{if(!wr(r)){const{message:s}=se("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(s)}const{topic:n}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)}),J(this,"isValidRequest",async r=>{if(!wr(r)){const{message:c}=se("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(c)}const{topic:n,request:s,chainId:i,expiry:o}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!Rg(a,i)){const{message:c}=se("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!tR(s)){const{message:c}=se("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!sR(a,i,s.method)){const{message:c}=se("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!cR(o,Xu)){const{message:c}=se("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Xu.min} and ${Xu.max}`);throw new Error(c)}}),J(this,"isValidRespond",async r=>{var n;if(!wr(r)){const{message:o}=se("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(o)}const{topic:s,response:i}=r;try{await this.isValidSessionTopic(s)}catch(o){throw(n=r==null?void 0:r.response)!=null&&n.id&&this.cleanupAfterResponse(r),o}if(!rR(i)){const{message:o}=se("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),J(this,"isValidPing",async r=>{if(!wr(r)){const{message:s}=se("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}),J(this,"isValidEmit",async r=>{if(!wr(r)){const{message:a}=se("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(a)}const{topic:n,event:s,chainId:i}=r;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!Rg(o,i)){const{message:a}=se("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!nR(s)){const{message:a}=se("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!iR(o,i,s.name)){const{message:a}=se("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),J(this,"isValidDisconnect",async r=>{if(!wr(r)){const{message:s}=se("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}),J(this,"isValidAuthenticate",r=>{const{chains:n,uri:s,domain:i,nonce:o}=r;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!St(s,!1))throw new Error("uri is required parameter");if(!St(i,!1))throw new Error("domain is required parameter");if(!St(o,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(c=>Zi(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=Zi(n[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),J(this,"getVerifyContext",async r=>{const{attestationId:n,hash:s,encryptedId:i,metadata:o,transportType:a}=r,c={verified:{verifyUrl:o.verifyUrl||ta,validation:"UNKNOWN",origin:o.url||""}};try{if(a===ft.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:n,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),J(this,"validateSessionProps",(r,n)=>{Object.values(r).forEach((s,i)=>{if(s==null){const{message:o}=se("MISSING_OR_INVALID",`${n} must contain an existing value for each key. Received: ${s} for key ${Object.keys(r)[i]}`);throw new Error(o)}})}),J(this,"getPendingAuthRequest",r=>{const n=this.client.auth.requests.get(r);return typeof n=="object"?n:void 0}),J(this,"addToRecentlyDeleted",(r,n)=>{if(this.recentlyDeletedMap.set(r,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),J(this,"checkRecentlyDeleted",r=>{const n=this.recentlyDeletedMap.get(r);if(n){const{message:s}=se("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${r}`);throw new Error(s)}}),J(this,"isLinkModeEnabled",(r,n)=>{var s,i,o,a,c,l,u,d,h;return!r||n!==ft.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=r==null?void 0:r.redirect)==null?void 0:u.universal)!==void 0&&((d=r==null?void 0:r.redirect)==null?void 0:d.universal)!==""&&((h=r==null?void 0:r.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(r.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),J(this,"getAppLinkIfEnabled",(r,n)=>{var s;return this.isLinkModeEnabled(r,n)?(s=r==null?void 0:r.redirect)==null?void 0:s.universal:void 0}),J(this,"handleLinkModeMessage",({url:r})=>{if(!r||!r.includes("wc_ev")||!r.includes("topic"))return;const n=Vp(r,"topic")||"",s=decodeURIComponent(Vp(r,"wc_ev")||""),i=this.client.session.keys.includes(n);i&&this.client.session.update(n,{transportType:ft.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:s,sessionExists:i})}),J(this,"registerLinkModeListeners",async()=>{var r;if(Mh()||Us()&&(r=this.client.metadata.redirect)!=null&&r.linkMode){const n=global==null?void 0:global.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await n.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),J(this,"getTVFParams",(r,n,s)=>{var i,o;const a={correlationId:r,rpcMethods:[n.request.method],chainId:n.chainId};try{const c=this.extractTxHashesFromResult(n.request,s);a.txHashes=c,a.contractAddresses=this.isValidContractData(n.request.params)?[(o=(i=n.request.params)==null?void 0:i[0])==null?void 0:o.to]:[]}catch(c){this.client.logger.warn("Error getting TVF params",c)}return a}),J(this,"isValidContractData",r=>{var n;if(!r)return!1;try{const s=(r==null?void 0:r.data)||((n=r==null?void 0:r[0])==null?void 0:n.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),J(this,"extractTxHashesFromResult",(r,n)=>{var s;try{if(!n)return[];const i=r.method,o=eU[i];if(i==="sui_signTransaction")return[kN(n.transactionBytes)];if(i==="near_signTransaction")return[Qp(n)];if(i==="near_signTransactions")return n.map(c=>Qp(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=n.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[CR({transaction:r.params.transactionPayload,signature:n.signature})];if(i==="algo_signTxn")return Yn(n)?n.map(c=>eg(c)):[eg(n)];if(i==="cosmos_signDirect")return[$N(n)];if(typeof n=="string")return[n];const a=n[o.key];if(Yn(a))return i==="solana_signAllTransactions"?a.map(c=>DN(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn("Error extracting tx hashes from result",i)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,r=this.client.core.relayer.messages.getWithoutAck(e);for(const[n,s]of Object.entries(r))for(const i of s)try{await this.onProviderMessageEvent({topic:n,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${n}, message: ${i}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Lt.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:r,message:n,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(jc)?this.client.auth.authKeys.get(jc):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(r,n,{receiverPublicKey:o,encoding:i===ft.link_mode?ys:an});ef(a)?(this.client.core.history.set(r,a),await this.onRelayEventRequest({topic:r,payload:a,attestation:s,transportType:i,encryptedId:Cn(n)})):Ll(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a,transportType:i}),this.client.core.history.delete(r,a.id)):await this.onRelayEventUnknownPayload({topic:r,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(r,n)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Hr.expired,async e=>{const{topic:r,id:n}=Hy(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,se("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,se("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Vs.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(Vs.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!St(e,!1)){const{message:r}=se("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=se("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(ps(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=se("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!St(e,!1)){const{message:r}=se("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:r}=se("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(ps(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:r}=se("EXPIRED",`session topic: ${e}`);throw new Error(r)}if(!this.client.core.crypto.keychain.has(e)){const{message:r}=se("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(St(e,!1)){const{message:r}=se("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=se("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!QO(e)){const{message:r}=se("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=se("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(ps(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:r}=se("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class pU extends vi{constructor(e,r){super(e,r,Jk,tf),this.core=e,this.logger=r}}let gU=class extends vi{constructor(e,r){super(e,r,Xk,tf),this.core=e,this.logger=r}};class mU extends vi{constructor(e,r){super(e,r,tU,tf,n=>n.id),this.core=e,this.logger=r}}class wU extends vi{constructor(e,r){super(e,r,iU,Fl,()=>jc),this.core=e,this.logger=r}}class yU extends vi{constructor(e,r){super(e,r,oU,Fl),this.core=e,this.logger=r}}class bU extends vi{constructor(e,r){super(e,r,aU,Fl,n=>n.id),this.core=e,this.logger=r}}var EU=Object.defineProperty,vU=(t,e,r)=>e in t?EU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Qu=(t,e,r)=>vU(t,typeof e!="symbol"?e+"":e,r);class _U{constructor(e,r){this.core=e,this.logger=r,Qu(this,"authKeys"),Qu(this,"pairingTopics"),Qu(this,"requests"),this.authKeys=new wU(this.core,this.logger),this.pairingTopics=new yU(this.core,this.logger),this.requests=new bU(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var CU=Object.defineProperty,AU=(t,e,r)=>e in t?CU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Be=(t,e,r)=>AU(t,typeof e!="symbol"?e+"":e,r);let IU=class ab extends y_{constructor(e){super(e),Be(this,"protocol",sb),Be(this,"version",ib),Be(this,"name",Ju.name),Be(this,"metadata"),Be(this,"core"),Be(this,"logger"),Be(this,"events",new Gr.EventEmitter),Be(this,"engine"),Be(this,"session"),Be(this,"proposal"),Be(this,"pendingRequest"),Be(this,"auth"),Be(this,"signConfig"),Be(this,"on",(n,s)=>this.events.on(n,s)),Be(this,"once",(n,s)=>this.events.once(n,s)),Be(this,"off",(n,s)=>this.events.off(n,s)),Be(this,"removeListener",(n,s)=>this.events.removeListener(n,s)),Be(this,"removeAllListeners",n=>this.events.removeAllListeners(n)),Be(this,"connect",async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}}),Be(this,"pair",async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}}),Be(this,"approve",async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}}),Be(this,"reject",async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}}),Be(this,"update",async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}}),Be(this,"extend",async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}}),Be(this,"request",async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}}),Be(this,"respond",async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}}),Be(this,"ping",async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}}),Be(this,"emit",async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}}),Be(this,"disconnect",async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}}),Be(this,"find",n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}}),Be(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}}),Be(this,"authenticate",async(n,s)=>{try{return await this.engine.authenticate(n,s)}catch(i){throw this.logger.error(i.message),i}}),Be(this,"formatAuthMessage",n=>{try{return this.engine.formatAuthMessage(n)}catch(s){throw this.logger.error(s.message),s}}),Be(this,"approveSessionAuthenticate",async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),Be(this,"rejectSessionAuthenticate",async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),this.name=(e==null?void 0:e.name)||Ju.name,this.metadata=I2(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ma(co({level:(e==null?void 0:e.logger)||Ju.logger}));this.core=(e==null?void 0:e.core)||new Zk(e),this.logger=tr(r,this.name),this.session=new gU(this.core,this.logger),this.proposal=new pU(this.core,this.logger),this.pendingRequest=new mU(this.core,this.logger),this.engine=new fU(this),this.auth=new _U(this.core,this.logger)}static async init(e){const r=new ab(e);return await r.initialize(),r}get context(){return Sr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},ne.toMiliseconds(ne.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var _c={exports:{}},mm;function SU(){return mm||(mm=1,function(t,e){var r=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof vn<"u"&&vn,n=function(){function i(){this.fetch=!1,this.DOMException=r.DOMException}return i.prototype=r,new i}();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof vn<"u"&&vn||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(y){return y&&DataView.prototype.isPrototypeOf(y)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(y){return y&&u.indexOf(Object.prototype.toString.call(y))>-1};function h(y){if(typeof y!="string"&&(y=String(y)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(y)||y==="")throw new TypeError('Invalid character in header field name: "'+y+'"');return y.toLowerCase()}function m(y){return typeof y!="string"&&(y=String(y)),y}function f(y){var b={next:function(){var O=y.shift();return{done:O===void 0,value:O}}};return c.iterable&&(b[Symbol.iterator]=function(){return b}),b}function g(y){this.map={},y instanceof g?y.forEach(function(b,O){this.append(O,b)},this):Array.isArray(y)?y.forEach(function(b){if(b.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+b.length);this.append(b[0],b[1])},this):y&&Object.getOwnPropertyNames(y).forEach(function(b){this.append(b,y[b])},this)}g.prototype.append=function(y,b){y=h(y),b=m(b);var O=this.map[y];this.map[y]=O?O+", "+b:b},g.prototype.delete=function(y){delete this.map[h(y)]},g.prototype.get=function(y){return y=h(y),this.has(y)?this.map[y]:null},g.prototype.has=function(y){return this.map.hasOwnProperty(h(y))},g.prototype.set=function(y,b){this.map[h(y)]=m(b)},g.prototype.forEach=function(y,b){for(var O in this.map)this.map.hasOwnProperty(O)&&y.call(b,this.map[O],O,this)},g.prototype.keys=function(){var y=[];return this.forEach(function(b,O){y.push(O)}),f(y)},g.prototype.values=function(){var y=[];return this.forEach(function(b){y.push(b)}),f(y)},g.prototype.entries=function(){var y=[];return this.forEach(function(b,O){y.push([O,b])}),f(y)},c.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function _(y){if(!y._noBody){if(y.bodyUsed)return Promise.reject(new TypeError("Already read"));y.bodyUsed=!0}}function I(y){return new Promise(function(b,O){y.onload=function(){b(y.result)},y.onerror=function(){O(y.error)}})}function N(y){var b=new FileReader,O=I(b);return b.readAsArrayBuffer(y),O}function C(y){var b=new FileReader,O=I(b),B=/charset=([A-Za-z0-9_-]+)/.exec(y.type),k=B?B[1]:"utf-8";return b.readAsText(y,k),O}function E(y){for(var b=new Uint8Array(y),O=new Array(b.length),B=0;B<b.length;B++)O[B]=String.fromCharCode(b[B]);return O.join("")}function v(y){if(y.slice)return y.slice(0);var b=new Uint8Array(y.byteLength);return b.set(new Uint8Array(y)),b.buffer}function A(){return this.bodyUsed=!1,this._initBody=function(y){this.bodyUsed=this.bodyUsed,this._bodyInit=y,y?typeof y=="string"?this._bodyText=y:c.blob&&Blob.prototype.isPrototypeOf(y)?this._bodyBlob=y:c.formData&&FormData.prototype.isPrototypeOf(y)?this._bodyFormData=y:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)?this._bodyText=y.toString():c.arrayBuffer&&c.blob&&l(y)?(this._bodyArrayBuffer=v(y.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(y)||d(y))?this._bodyArrayBuffer=v(y):this._bodyText=y=Object.prototype.toString.call(y):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof y=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var y=_(this);if(y)return y;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var y=_(this);return y||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(N);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var y=_(this);if(y)return y;if(this._bodyBlob)return C(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(E(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(M)}),this.json=function(){return this.text().then(JSON.parse)},this}var x=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function D(y){var b=y.toUpperCase();return x.indexOf(b)>-1?b:y}function U(y,b){if(!(this instanceof U))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');b=b||{};var O=b.body;if(y instanceof U){if(y.bodyUsed)throw new TypeError("Already read");this.url=y.url,this.credentials=y.credentials,b.headers||(this.headers=new g(y.headers)),this.method=y.method,this.mode=y.mode,this.signal=y.signal,!O&&y._bodyInit!=null&&(O=y._bodyInit,y.bodyUsed=!0)}else this.url=String(y);if(this.credentials=b.credentials||this.credentials||"same-origin",(b.headers||!this.headers)&&(this.headers=new g(b.headers)),this.method=D(b.method||this.method||"GET"),this.mode=b.mode||this.mode||null,this.signal=b.signal||this.signal||function(){if("AbortController"in a){var L=new AbortController;return L.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&O)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(O),(this.method==="GET"||this.method==="HEAD")&&(b.cache==="no-store"||b.cache==="no-cache")){var B=/([?&])_=[^&]*/;if(B.test(this.url))this.url=this.url.replace(B,"$1_="+new Date().getTime());else{var k=/\?/;this.url+=(k.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}U.prototype.clone=function(){return new U(this,{body:this._bodyInit})};function M(y){var b=new FormData;return y.trim().split("&").forEach(function(O){if(O){var B=O.split("="),k=B.shift().replace(/\+/g," "),L=B.join("=").replace(/\+/g," ");b.append(decodeURIComponent(k),decodeURIComponent(L))}}),b}function $(y){var b=new g,O=y.replace(/\r?\n[\t ]+/g," ");return O.split("\r").map(function(B){return B.indexOf(`
`)===0?B.substr(1,B.length):B}).forEach(function(B){var k=B.split(":"),L=k.shift().trim();if(L){var H=k.join(":").trim();try{b.append(L,H)}catch(K){console.warn("Response "+K.message)}}}),b}A.call(U.prototype);function F(y,b){if(!(this instanceof F))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(b||(b={}),this.type="default",this.status=b.status===void 0?200:b.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=b.statusText===void 0?"":""+b.statusText,this.headers=new g(b.headers),this.url=b.url||"",this._initBody(y)}A.call(F.prototype),F.prototype.clone=function(){return new F(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},F.error=function(){var y=new F(null,{status:200,statusText:""});return y.ok=!1,y.status=0,y.type="error",y};var W=[301,302,303,307,308];F.redirect=function(y,b){if(W.indexOf(b)===-1)throw new RangeError("Invalid status code");return new F(null,{status:b,headers:{location:y}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(b,O){this.message=b,this.name=O;var B=Error(b);this.stack=B.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function q(y,b){return new Promise(function(O,B){var k=new U(y,b);if(k.signal&&k.signal.aborted)return B(new o.DOMException("Aborted","AbortError"));var L=new XMLHttpRequest;function H(){L.abort()}L.onload=function(){var Z={statusText:L.statusText,headers:$(L.getAllResponseHeaders()||"")};k.url.indexOf("file://")===0&&(L.status<200||L.status>599)?Z.status=200:Z.status=L.status,Z.url="responseURL"in L?L.responseURL:Z.headers.get("X-Request-URL");var re="response"in L?L.response:L.responseText;setTimeout(function(){O(new F(re,Z))},0)},L.onerror=function(){setTimeout(function(){B(new TypeError("Network request failed"))},0)},L.ontimeout=function(){setTimeout(function(){B(new TypeError("Network request timed out"))},0)},L.onabort=function(){setTimeout(function(){B(new o.DOMException("Aborted","AbortError"))},0)};function K(Z){try{return Z===""&&a.location.href?a.location.href:Z}catch{return Z}}if(L.open(k.method,K(k.url),!0),k.credentials==="include"?L.withCredentials=!0:k.credentials==="omit"&&(L.withCredentials=!1),"responseType"in L&&(c.blob?L.responseType="blob":c.arrayBuffer&&(L.responseType="arraybuffer")),b&&typeof b.headers=="object"&&!(b.headers instanceof g||a.Headers&&b.headers instanceof a.Headers)){var Q=[];Object.getOwnPropertyNames(b.headers).forEach(function(Z){Q.push(h(Z)),L.setRequestHeader(Z,m(b.headers[Z]))}),k.headers.forEach(function(Z,re){Q.indexOf(re)===-1&&L.setRequestHeader(re,Z)})}else k.headers.forEach(function(Z,re){L.setRequestHeader(re,Z)});k.signal&&(k.signal.addEventListener("abort",H),L.onreadystatechange=function(){L.readyState===4&&k.signal.removeEventListener("abort",H)}),L.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return q.polyfill=!0,a.fetch||(a.fetch=q,a.Headers=g,a.Request=U,a.Response=F),o.Headers=g,o.Request=U,o.Response=F,o.fetch=q,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=r.fetch?r:n;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e}(_c,_c.exports)),_c.exports}var TU=SU();const wm=pi(TU);var NU=Object.defineProperty,xU=Object.defineProperties,OU=Object.getOwnPropertyDescriptors,ym=Object.getOwnPropertySymbols,RU=Object.prototype.hasOwnProperty,PU=Object.prototype.propertyIsEnumerable,bm=(t,e,r)=>e in t?NU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Em=(t,e)=>{for(var r in e||(e={}))RU.call(e,r)&&bm(t,r,e[r]);if(ym)for(var r of ym(e))PU.call(e,r)&&bm(t,r,e[r]);return t},vm=(t,e)=>xU(t,OU(e));const DU={Accept:"application/json","Content-Type":"application/json"},kU="POST",_m={headers:DU,method:kU},Cm=10;let fn=class{constructor(e,r=!1){if(this.url=e,this.disableProviderPing=r,this.events=new Gr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Mg(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const r=Jn(e),n=await(await wm(this.url,vm(Em({},_m),{body:r}))).json();this.onPayload({data:n})}catch(r){this.onError(e.id,r)}}async register(e=this.url){if(!Mg(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));n()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const r=Jn({id:1,jsonrpc:"2.0",method:"test",params:[]});await wm(e,vm(Em({},_m),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?oi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),s=n.message||n.toString(),i=Bl(e,s);this.events.emit("payload",i)}parseError(e,r=this.url){return B0(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Cm&&this.events.setMaxListeners(Cm)}};const Am="error",UU="wss://relay.walletconnect.org",$U="wc",BU="universal_provider",Cc=`${$U}@2:${BU}:`,cb="https://rpc.walletconnect.org/v1/",Hi="generic",LU=`${cb}bundler`,Zr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function Im(t){return typeof t=="object"&&t!==null}function rf(t){return t==null||typeof t!="object"&&typeof t!="function"}function lb(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function ub(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const MU="[object RegExp]",db="[object String]",hb="[object Number]",fb="[object Boolean]",pb="[object Arguments]",FU="[object Symbol]",jU="[object Date]",qU="[object Map]",HU="[object Set]",WU="[object Array]",zU="[object ArrayBuffer]",VU="[object Object]",KU="[object DataView]",GU="[object Uint8Array]",YU="[object Uint8ClampedArray]",ZU="[object Uint16Array]",JU="[object Uint32Array]",XU="[object Int8Array]",QU="[object Int16Array]",e8="[object Int32Array]",t8="[object Float32Array]",r8="[object Float64Array]";function nf(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function n8(t,e){return Ki(t,void 0,t,new Map,e)}function Ki(t,e,r,n=new Map,s=void 0){const i=s==null?void 0:s(t,e,r,n);if(i!=null)return i;if(rf(t))return t;if(n.has(t))return n.get(t);if(Array.isArray(t)){const o=new Array(t.length);n.set(t,o);for(let a=0;a<t.length;a++)o[a]=Ki(t[a],a,r,n,s);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;n.set(t,o);for(const[a,c]of t)o.set(a,Ki(c,a,r,n,s));return o}if(t instanceof Set){const o=new Set;n.set(t,o);for(const a of t)o.add(Ki(a,void 0,r,n,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(nf(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);n.set(t,o);for(let a=0;a<t.length;a++)o[a]=Ki(t[a],a,r,n,s);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return n.set(t,o),Ks(o,t,r,n,s),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return n.set(t,o),Ks(o,t,r,n,s),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return n.set(t,o),Ks(o,t,r,n,s),o}if(t instanceof Error){const o=new t.constructor;return n.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,Ks(o,t,r,n,s),o}if(typeof t=="object"&&s8(t)){const o=Object.create(Object.getPrototypeOf(t));return n.set(t,o),Ks(o,t,r,n,s),o}return t}function Ks(t,e,r=t,n,s){const i=[...Object.keys(e),...lb(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(t,a);(c==null||c.writable)&&(t[a]=Ki(e[a],a,r,n,s))}}function s8(t){switch(ub(t)){case pb:case WU:case zU:case KU:case fb:case jU:case t8:case r8:case XU:case QU:case e8:case qU:case hb:case VU:case MU:case HU:case db:case FU:case GU:case YU:case ZU:case JU:return!0;default:return!1}}function i8(t,e){return n8(t,(r,n,s,i)=>{if(typeof t=="object")switch(Object.prototype.toString.call(t)){case hb:case db:case fb:{const o=new t.constructor(t==null?void 0:t.valueOf());return Ks(o,t),o}case pb:{const o={};return Ks(o,t),o.length=t.length,o[Symbol.iterator]=t[Symbol.iterator],o}default:return}})}function Sm(t){return i8(t)}function Tm(t){return t!==null&&typeof t=="object"&&ub(t)==="[object Arguments]"}function o8(t){return nf(t)}function a8(){}function c8(t){if(rf(t))return t;if(Array.isArray(t)||nf(t)||t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);const e=Object.getPrototypeOf(t),r=e.constructor;if(t instanceof Date||t instanceof Map||t instanceof Set)return new r(t);if(t instanceof RegExp){const n=new r(t);return n.lastIndex=t.lastIndex,n}if(t instanceof DataView)return new r(t.buffer.slice(0));if(t instanceof Error){const n=new r(t.message);return n.stack=t.stack,n.name=t.name,n.cause=t.cause,n}if(typeof File<"u"&&t instanceof File)return new r([t],t.name,{type:t.type,lastModified:t.lastModified});if(typeof t=="object"){const n=Object.create(e);return Object.assign(n,t)}return t}function l8(t){var r;if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const n=t[Symbol.toStringTag];return n==null||!((r=Object.getOwnPropertyDescriptor(t,Symbol.toStringTag))!=null&&r.writable)?!1:t.toString()===`[object ${n}]`}let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function u8(t,...e){const r=e.slice(0,-1),n=e[e.length-1];let s=t;for(let i=0;i<r.length;i++){const o=r[i];s=hh(s,o,n,new Map)}return s}function hh(t,e,r,n){if(rf(t)&&(t=Object(t)),e==null||typeof e!="object")return t;if(n.has(e))return c8(n.get(e));if(n.set(e,t),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...lb(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=t[o];if(Tm(a)&&(a={...a}),Tm(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=Sm(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],d=Reflect.ownKeys(c);for(let h=0;h<d.length;h++){const m=d[h];u[m]=c[m]}c=u}else c=[];const l=r(c,a,o,t,e,n);l!=null?t[o]=l:Array.isArray(a)||Im(c)&&Im(a)?t[o]=hh(c,a,r,n):c==null&&l8(a)?t[o]=hh({},a,r,n):c==null&&o8(a)?t[o]=Sm(a):(c===void 0||a!==void 0)&&(t[o]=a)}return t}function d8(t,...e){return u8(t,...e,a8)}var h8=Object.defineProperty,f8=Object.defineProperties,p8=Object.getOwnPropertyDescriptors,Nm=Object.getOwnPropertySymbols,g8=Object.prototype.hasOwnProperty,m8=Object.prototype.propertyIsEnumerable,xm=(t,e,r)=>e in t?h8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ac=(t,e)=>{for(var r in e||(e={}))g8.call(e,r)&&xm(t,r,e[r]);if(Nm)for(var r of Nm(e))m8.call(e,r)&&xm(t,r,e[r]);return t},w8=(t,e)=>f8(t,p8(e));function $r(t,e,r){var n;const s=Zi(t);return((n=e.rpcMap)==null?void 0:n[s.reference])||`${cb}?chainId=${s.namespace}:${s.reference}&projectId=${r}`}function _i(t){return t.includes(":")?t.split(":")[1]:t}function gb(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function y8(t,e){const r=Object.keys(e.namespaces).filter(s=>s.includes(t));if(!r.length)return[];const n=[];return r.forEach(s=>{const i=e.namespaces[s].accounts;n.push(...i)}),n}function Ic(t={},e={}){const r=Om(t),n=Om(e);return d8(r,n)}function Om(t){var e,r,n,s,i;const o={};if(!Ss(t))return o;for(const[a,c]of Object.entries(t)){const l=Ul(a)?[a]:c.chains,u=c.methods||[],d=c.events||[],h=c.rpcMap||{},m=Vi(a);o[m]=w8(Ac(Ac({},o[m]),c),{chains:Tn(l,(e=o[m])==null?void 0:e.chains),methods:Tn(u,(r=o[m])==null?void 0:r.methods),events:Tn(d,(n=o[m])==null?void 0:n.events)}),(Ss(h)||Ss(((s=o[m])==null?void 0:s.rpcMap)||{}))&&(o[m].rpcMap=Ac(Ac({},h),(i=o[m])==null?void 0:i.rpcMap))}return o}function Rm(t){return t.includes(":")?t.split(":")[2]:t}function Pm(t){const e={};for(const[r,n]of Object.entries(t)){const s=n.methods||[],i=n.events||[],o=n.accounts||[],a=Ul(r)?[r]:n.chains?n.chains:gb(n.accounts);e[r]={chains:a,methods:s,events:i,accounts:o}}return e}function ed(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}const mb={},Ke=t=>mb[t],td=(t,e)=>{mb[t]=e};var b8=Object.defineProperty,E8=(t,e,r)=>e in t?b8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ri=(t,e,r)=>E8(t,typeof e!="symbol"?e+"":e,r);class v8{constructor(e){Ri(this,"name","polkadot"),Ri(this,"client"),Ri(this,"httpProviders"),Ri(this,"events"),Ri(this,"namespace"),Ri(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const s=_i(r);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||$r(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Yr(new fn(n,Ke("disableProviderPing")))}}var _8=Object.defineProperty,C8=Object.defineProperties,A8=Object.getOwnPropertyDescriptors,Dm=Object.getOwnPropertySymbols,I8=Object.prototype.hasOwnProperty,S8=Object.prototype.propertyIsEnumerable,fh=(t,e,r)=>e in t?_8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,km=(t,e)=>{for(var r in e||(e={}))I8.call(e,r)&&fh(t,r,e[r]);if(Dm)for(var r of Dm(e))S8.call(e,r)&&fh(t,r,e[r]);return t},Um=(t,e)=>C8(t,A8(e)),Pi=(t,e,r)=>fh(t,typeof e!="symbol"?e+"":e,r);class T8{constructor(e){Pi(this,"name","eip155"),Pi(this,"client"),Pi(this,"chainId"),Pi(this,"namespace"),Pi(this,"httpProviders"),Pi(this,"events"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(parseInt(e),r),this.chainId=parseInt(e),this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const n=r||$r(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Yr(new fn(n,Ke("disableProviderPing")))}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const s=parseInt(_i(r));e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}async handleSwitchChain(e){var r,n;let s=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var r,n,s,i,o;const a=(n=(r=e.request)==null?void 0:r.params)==null?void 0:n[0],c=((i=(s=e.request)==null?void 0:s.params)==null?void 0:i[1])||[],l=`${a}${c.join(",")}`;if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const u=this.client.session.get(e.topic),d=((o=u==null?void 0:u.sessionProperties)==null?void 0:o.capabilities)||{};if(d!=null&&d[l])return d==null?void 0:d[l];const h=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Um(km({},u.sessionProperties||{}),{capabilities:Um(km({},d||{}),{[l]:h})})})}catch(m){console.warn("Failed to update session with capabilities",m)}return h}async getCallStatus(e){var r,n;const s=this.client.session.get(e.topic),i=(r=s.sessionProperties)==null?void 0:r.bundler_name;if(i){const a=this.getBundlerUrl(e.chainId,i);try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(n=s.sessionProperties)==null?void 0:n.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,r){var n;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_s("eth_getUserOperationReceipt",[(n=r.request.params)==null?void 0:n[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,r){return`${LU}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${r}`}}var N8=Object.defineProperty,x8=(t,e,r)=>e in t?N8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Di=(t,e,r)=>x8(t,typeof e!="symbol"?e+"":e,r);class O8{constructor(e){Di(this,"name","solana"),Di(this,"client"),Di(this,"httpProviders"),Di(this,"events"),Di(this,"namespace"),Di(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const s=_i(r);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||$r(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Yr(new fn(n,Ke("disableProviderPing")))}}var R8=Object.defineProperty,P8=(t,e,r)=>e in t?R8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ki=(t,e,r)=>P8(t,typeof e!="symbol"?e+"":e,r);class D8{constructor(e){ki(this,"name","cosmos"),ki(this,"client"),ki(this,"httpProviders"),ki(this,"events"),ki(this,"namespace"),ki(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const s=_i(r);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||$r(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Yr(new fn(n,Ke("disableProviderPing")))}}var k8=Object.defineProperty,U8=(t,e,r)=>e in t?k8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ui=(t,e,r)=>U8(t,typeof e!="symbol"?e+"":e,r);class $8{constructor(e){Ui(this,"name","algorand"),Ui(this,"client"),Ui(this,"httpProviders"),Ui(this,"events"),Ui(this,"namespace"),Ui(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const n=r||$r(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.chainId=e,this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;e[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||$r(e,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Yr(new fn(n,Ke("disableProviderPing")))}}var B8=Object.defineProperty,L8=(t,e,r)=>e in t?B8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$i=(t,e,r)=>L8(t,typeof e!="symbol"?e+"":e,r);class M8{constructor(e){$i(this,"name","cip34"),$i(this,"client"),$i(this,"httpProviders"),$i(this,"events"),$i(this,"namespace"),$i(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),s=_i(r);e[s]=this.createHttpProvider(s,n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}getCardanoRPCUrl(e){const r=this.namespace.rpcMap;if(r)return r[e]}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||this.getCardanoRPCUrl(e);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Yr(new fn(n,Ke("disableProviderPing")))}}var F8=Object.defineProperty,j8=(t,e,r)=>e in t?F8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Bi=(t,e,r)=>j8(t,typeof e!="symbol"?e+"":e,r);class q8{constructor(e){Bi(this,"name","elrond"),Bi(this,"client"),Bi(this,"httpProviders"),Bi(this,"events"),Bi(this,"namespace"),Bi(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const s=_i(r);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||$r(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Yr(new fn(n,Ke("disableProviderPing")))}}var H8=Object.defineProperty,W8=(t,e,r)=>e in t?H8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Li=(t,e,r)=>W8(t,typeof e!="symbol"?e+"":e,r);class z8{constructor(e){Li(this,"name","multiversx"),Li(this,"client"),Li(this,"httpProviders"),Li(this,"events"),Li(this,"namespace"),Li(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const s=_i(r);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||$r(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Yr(new fn(n,Ke("disableProviderPing")))}}var V8=Object.defineProperty,K8=(t,e,r)=>e in t?V8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Mi=(t,e,r)=>K8(t,typeof e!="symbol"?e+"":e,r);class G8{constructor(e){Mi(this,"name","near"),Mi(this,"client"),Mi(this,"httpProviders"),Mi(this,"events"),Mi(this,"namespace"),Mi(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const n=r||$r(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;e[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||$r(e,this.namespace);return typeof n>"u"?void 0:new Yr(new fn(n,Ke("disableProviderPing")))}}var Y8=Object.defineProperty,Z8=(t,e,r)=>e in t?Y8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Fi=(t,e,r)=>Z8(t,typeof e!="symbol"?e+"":e,r);class J8{constructor(e){Fi(this,"name","tezos"),Fi(this,"client"),Fi(this,"httpProviders"),Fi(this,"events"),Fi(this,"namespace"),Fi(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const n=r||$r(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||$r(e,this.namespace);return typeof n>"u"?void 0:new Yr(new fn(n))}}var X8=Object.defineProperty,Q8=(t,e,r)=>e in t?X8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ji=(t,e,r)=>Q8(t,typeof e!="symbol"?e+"":e,r);class e${constructor(e){ji(this,"name",Hi),ji(this,"client"),ji(this,"httpProviders"),ji(this,"events"),ji(this,"namespace"),ji(this,"chainId"),this.namespace=e.namespace,this.events=Ke("events"),this.client=Ke("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){var e,r;const n={};return(r=(e=this.namespace)==null?void 0:e.accounts)==null||r.forEach(s=>{const i=Zi(s);n[`${i.namespace}:${i.reference}`]=this.createHttpProvider(s)}),n}getHttpProvider(e){const r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||$r(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Yr(new fn(n,Ke("disableProviderPing")))}}var t$=Object.defineProperty,r$=Object.defineProperties,n$=Object.getOwnPropertyDescriptors,$m=Object.getOwnPropertySymbols,s$=Object.prototype.hasOwnProperty,i$=Object.prototype.propertyIsEnumerable,ph=(t,e,r)=>e in t?t$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Sc=(t,e)=>{for(var r in e||(e={}))s$.call(e,r)&&ph(t,r,e[r]);if($m)for(var r of $m(e))i$.call(e,r)&&ph(t,r,e[r]);return t},rd=(t,e)=>r$(t,n$(e)),jr=(t,e,r)=>ph(t,typeof e!="symbol"?e+"":e,r);let o$=class wb{constructor(e){jr(this,"client"),jr(this,"namespaces"),jr(this,"optionalNamespaces"),jr(this,"sessionProperties"),jr(this,"scopedProperties"),jr(this,"events",new _h),jr(this,"rpcProviders",{}),jr(this,"session"),jr(this,"providerOpts"),jr(this,"logger"),jr(this,"uri"),jr(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ma(co({level:(e==null?void 0:e.logger)||Am})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const r=new wb(e);return await r.initialize(),r}async request(e,r,n){const[s,i]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Sc({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:n})}sendAsync(e,r,n,s){const i=new Date().getTime();this.request(e,n,s).then(o=>r(null,$l(i,o))).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:st("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,r){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:n,response:s}=await this.client.authenticate(e,r);n&&(this.uri=n,this.events.emit("display_uri",n));const i=await s();if(this.session=i.session,this.session){const o=Pm(this.session.namespaces);this.namespaces=Ic(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){const{uri:r,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});r&&(this.uri=r,this.events.emit("display_uri",r));const s=await n();this.session=s;const i=Pm(s.namespaces);return this.namespaces=Ic(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,r){try{if(!this.session)return;const[n,s]=this.validateChain(e),i=this.getProvider(n);i.name===Hi?i.setDefaultChain(`${n}:${s}`,r):i.setDefaultChain(s,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(Yn(r)){for(const n of r)e.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,r;if(this.client=this.providerOpts.client||await IU.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Am,relayUrl:this.providerOpts.relayUrl||UU,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(n){throw this.logger.error("Failed to get session",n),new Error(`The provided session: ${(r=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:r.topic} doesn't exist in the Sign client`)}else{const n=this.client.session.getAll();this.session=n[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(r=>Vi(r)))];td("client",this.client),td("events",this.events),td("disableProviderPing",this.disableProviderPing),e.forEach(r=>{if(!this.session)return;const n=y8(r,this.session),s=gb(n),i=Ic(this.namespaces,this.optionalNamespaces),o=rd(Sc({},i[r]),{accounts:n,chains:s});switch(r){case"eip155":this.rpcProviders[r]=new T8({namespace:o});break;case"algorand":this.rpcProviders[r]=new $8({namespace:o});break;case"solana":this.rpcProviders[r]=new O8({namespace:o});break;case"cosmos":this.rpcProviders[r]=new D8({namespace:o});break;case"polkadot":this.rpcProviders[r]=new v8({namespace:o});break;case"cip34":this.rpcProviders[r]=new M8({namespace:o});break;case"elrond":this.rpcProviders[r]=new q8({namespace:o});break;case"multiversx":this.rpcProviders[r]=new z8({namespace:o});break;case"near":this.rpcProviders[r]=new G8({namespace:o});break;case"tezos":this.rpcProviders[r]=new J8({namespace:o});break;default:this.rpcProviders[Hi]?this.rpcProviders[Hi].updateNamespace(o):this.rpcProviders[Hi]=new e$({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var r;const{topic:n}=e;n===((r=this.session)==null?void 0:r.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var r;const{params:n,topic:s}=e;if(s!==((r=this.session)==null?void 0:r.topic))return;const{event:i}=n;if(i.name==="accountsChanged"){const o=i.data;o&&Yn(o)&&this.events.emit("accountsChanged",o.map(Rm))}else if(i.name==="chainChanged"){const o=n.chainId,a=n.event.data,c=Vi(o),l=ed(o)!==ed(a)?`${c}:${ed(a)}`:o;this.onChainChanged(l)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var n,s;if(e!==((n=this.session)==null?void 0:n.topic))return;const{namespaces:i}=r,o=(s=this.client)==null?void 0:s.session.get(e);this.session=rd(Sc({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{var r;e.topic===((r=this.session)==null?void 0:r.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",rd(Sc({},st("USER_DISCONNECTED")),{data:e.topic})))}),this.on(Zr.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[Hi]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r={},optionalNamespaces:n={},sessionProperties:s,scopedProperties:i}=e;this.optionalNamespaces=Ic(r,n),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[r,n]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(o=>Vi(o)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const s=Vi(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,r=!1){if(!this.namespaces)return;const[n,s]=this.validateChain(e);if(!s)return;this.updateNamespaceChain(n,s),this.events.emit("chainChanged",s);const i=this.getProvider(n).getDefaultChain();r||this.getProvider(n).setDefaultChain(s),this.emitAccountsChangedOnChainChange({namespace:n,previousChainId:i,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:r,newChainId:n}){var s,i;try{if(r===n)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${n}:`)).map(Rm);if(!Yn(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,r){if(!this.namespaces)return;const n=this.namespaces[e]?e:`${e}:${r}`,s={chains:[],methods:[],events:[],defaultChain:r};this.namespaces[n]?this.namespaces[n]&&(this.namespaces[n].defaultChain=r):this.namespaces[n]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,r){var n;const s=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.setItem(`${Cc}/${e}${s}`,r)}async getFromStore(e){var r;const n=((r=this.session)==null?void 0:r.topic)||"";return await this.client.core.storage.getItem(`${Cc}/${e}${n}`)}async deleteFromStore(e){var r;const n=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.removeItem(`${Cc}/${e}${n}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const r=await this.client.core.storage.getKeys();for(const n of r)n.startsWith(Cc)&&await this.client.core.storage.removeItem(n)}catch(r){this.logger.warn("Failed to cleanup storage",r)}}};const Ji={getSIWX(){return X.state.siwx},async initializeIfEnabled(){var i;const t=X.state.siwx,e=R.getActiveCaipAddress();if(!(t&&e))return;const[r,n,s]=e.split(":");if(R.checkIfSupportedNetwork(r))try{if((await t.getSessions(`${r}:${n}`,s)).length)return;await Fe.open({view:"SIWXSignMessage"})}catch(o){console.error("SIWXUtil:initializeIfEnabled",o),je.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await((i=ue._getClient())==null?void 0:i.disconnect().catch(console.error)),me.reset("Connect"),pt.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const t=X.state.siwx,e=le.getPlainAddress(R.getActiveCaipAddress()),r=R.getActiveCaipNetwork(),n=ue._getClient();if(!t)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!r)throw new Error("No ActiveCaipNetwork or client found");if(!n)throw new Error("No ConnectionController client found");try{const s=await t.createMessage({chainId:r.caipNetworkId,accountAddress:e}),i=s.toString();ie.getConnectorId(r.chainNamespace)===G.CONNECTOR_ID.AUTH&&me.pushTransactionStack({});const a=await n.signMessage(i);await t.addSession({data:s,message:i,signature:a}),Fe.close(),je.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(s){const i=this.getSIWXEventProperties();(!Fe.state.open||me.state.view==="ApproveTransaction")&&await Fe.open({view:"SIWXSignMessage"}),i.isSmartAccount?pt.showError("This application might not support Smart Accounts"):pt.showError("Signature declined"),je.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:i}),console.error("SWIXUtil:requestSignMessage",s)}},async cancelSignMessage(){var t;try{const e=this.getSIWX();((t=e==null?void 0:e.getRequired)==null?void 0:t.call(e))?await ue.disconnect():Fe.close(),me.reset("Connect"),je.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getSessions(){const t=X.state.siwx,e=le.getPlainAddress(R.getActiveCaipAddress()),r=R.getActiveCaipNetwork();return t&&e&&r?t.getSessions(r.caipNetworkId,e):[]},async isSIWXCloseDisabled(){var e;const t=this.getSIWX();if(t){const r=me.state.view==="ApproveTransaction",n=me.state.view==="SIWXSignMessage";if(r||n)return((e=t.getRequired)==null?void 0:e.call(t))&&(await this.getSessions()).length===0}return!1},async universalProviderAuthenticate({universalProvider:t,chains:e,methods:r}){var a,c,l;const n=Ji.getSIWX(),s=new Set(e.map(u=>u.split(":")[0]));if(!n||s.size!==1||!s.has("eip155"))return!1;const i=await n.createMessage({chainId:((a=R.getActiveCaipNetwork())==null?void 0:a.caipNetworkId)||"",accountAddress:""}),o=await t.authenticate({nonce:i.nonce,domain:i.domain,uri:i.uri,exp:i.expirationTime,iat:i.issuedAt,nbf:i.notBefore,requestId:i.requestId,version:i.version,resources:i.resources,statement:i.statement,chainId:i.chainId,methods:r,chains:[i.chainId,...e.filter(u=>u!==i.chainId)]});if(pt.showLoading("Authenticating...",{autoClose:!1}),ee.setConnectedWalletInfo({...o.session.peer.metadata,name:o.session.peer.metadata.name,icon:(c=o.session.peer.metadata.icons)==null?void 0:c[0],type:"WALLET_CONNECT"},Array.from(s)[0]),(l=o==null?void 0:o.auths)!=null&&l.length){const u=o.auths.map(d=>{const h=t.client.formatAuthMessage({request:d.p,iss:d.p.iss});return{data:{...d.p,accountAddress:d.p.iss.split(":").slice(-1).join(""),chainId:d.p.iss.split(":").slice(2,4).join(":"),uri:d.p.aud,version:d.p.version||i.version,expirationTime:d.p.exp,issuedAt:d.p.iat,notBefore:d.p.nbf},message:h,signature:d.s.s,cacao:d}});try{await n.setSessions(u),je.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:Ji.getSIWXEventProperties()})}catch(d){throw console.error("SIWX:universalProviderAuth - failed to set sessions",d),je.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:Ji.getSIWXEventProperties()}),await t.disconnect().catch(console.error),d}finally{pt.hide()}}return!0},getSIWXEventProperties(){var e,r;const t=R.state.activeChain;return{network:((e=R.state.activeCaipNetwork)==null?void 0:e.caipNetworkId)||"",isSmartAccount:((r=ee.state.preferredAccountTypes)==null?void 0:r[t])===At.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){const t=this.getSIWX();t&&await t.setSessions([])}},h6={isUnsupportedChainView(){return me.state.view==="UnsupportedChain"||me.state.view==="SwitchNetwork"&&me.state.history.includes("UnsupportedChain")},async safeClose(){if(this.isUnsupportedChainView()){Fe.shake();return}if(await Ji.isSIWXCloseDisabled()){Fe.shake();return}Fe.close()}},gt={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",EIP155:"eip155",ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"},Cs={ConnectorExplorerIds:{[G.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[G.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[G.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[G.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[G.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[gt.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[gt.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[gt.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[gt.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[gt.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[gt.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[gt.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[gt.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[gt.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[gt.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[gt.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[G.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[G.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[G.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[G.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[G.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[G.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[G.CONNECTOR_ID.INJECTED]:"Browser Wallet",[G.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[G.CONNECTOR_ID.COINBASE]:"Coinbase",[G.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[G.CONNECTOR_ID.LEDGER]:"Ledger",[G.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[G.CONNECTOR_ID.INJECTED]:"INJECTED",[G.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[G.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[G.CONNECTOR_ID.AUTH]:"AUTH"}},Ea={getCaipTokens(t){if(!t)return;const e={};return Object.entries(t).forEach(([r,n])=>{e[`${gt.EIP155}:${r}`]=n}),e},isLowerCaseMatch(t,e){return(t==null?void 0:t.toLowerCase())===(e==null?void 0:e.toLowerCase())},getActiveNamespaceConnectedToAuth(){const t=R.state.activeChain;return G.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>ie.getConnectorId(e)===G.CONNECTOR_ID.AUTH&&e===t)}},a$=new AbortController,wt={EmbeddedWalletAbortController:a$,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"INVALID_APP_CONFIGURATION"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{shortMessage:"Network Not Found",longMessage:"Network not found - please make sure it is included in 'networks' array in createAppKit function"},INVALID_APP_CONFIGURATION:{shortMessage:"Invalid App Configuration",longMessage:()=>`Origin ${c$()?window.origin:"unknown"} not found on Allowlist - update configuration on cloud.reown.com`},IFRAME_LOAD_FAILED:{shortMessage:"Network Error - Could not load embedded wallet",longMessage:()=>"There was an issue loading the embedded wallet. Please try again later."},IFRAME_REQUEST_TIMEOUT:{shortMessage:"Embedded Wallet Request Timed Out",longMessage:()=>"There was an issue doing the request to the embedded wallet. Please try again later."},UNVERIFIED_DOMAIN:{shortMessage:"Invalid App Configuration",longMessage:()=>"There was an issue loading the embedded wallet. Please verify that your domain is allowed at cloud.reown.com"},JWT_TOKEN_NOT_VALID:{shortMessage:"Session Expired",longMessage:"Invalid session found on UniversalProvider - please check your time settings and connect again"},INVALID_PROJECT_ID:{shortMessage:"Invalid App Configuration",longMessage:"Invalid Project ID - update configuration"},PROJECT_ID_NOT_CONFIGURED:{shortMessage:"Project ID Not Configured",longMessage:"Project ID Not Configured - update configuration on cloud.reown.com"},SERVER_ERROR_APP_CONFIGURATION:{shortMessage:"Server Error",longMessage:t=>`Failed to get App Configuration ${t||""}`},RATE_LIMITED_APP_CONFIGURATION:{shortMessage:"Rate Limited",longMessage:"Rate limited when trying to get the App Configuration"}}};function c$(){return typeof window<"u"}const l$={createLogger(t,e="error"){const r=co({level:e}),{logger:n}=Ah({opts:r});return n.error=(...s)=>{for(const i of s)if(i instanceof Error){t(i,...s);return}t(void 0,...s)},n}},u$="rpc.walletconnect.org";function Bm(t,e){const r=new URL("https://rpc.walletconnect.org/v1/");return r.searchParams.set("chainId",t),r.searchParams.set("projectId",e),r.toString()}const nd=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],An={extendRpcUrlWithProjectId(t,e){let r=!1;try{r=new URL(t).host===u$}catch{r=!1}if(r){const n=new URL(t);return n.searchParams.has("projectId")||n.searchParams.set("projectId",e),n.toString()}return t},isCaipNetwork(t){return"chainNamespace"in t&&"caipNetworkId"in t},getChainNamespace(t){return this.isCaipNetwork(t)?t.chainNamespace:G.CHAIN.EVM},getCaipNetworkId(t){return this.isCaipNetwork(t)?t.caipNetworkId:`${G.CHAIN.EVM}:${t.id}`},getDefaultRpcUrl(t,e,r){var s,i,o;const n=(o=(i=(s=t.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null?void 0:o[0];return nd.includes(e)?Bm(e,r):n||""},extendCaipNetwork(t,{customNetworkImageUrls:e,projectId:r,customRpcUrls:n}){var h,m,f,g,_;const s=this.getChainNamespace(t),i=this.getCaipNetworkId(t),o=(h=t.rpcUrls.default.http)==null?void 0:h[0],a=this.getDefaultRpcUrl(t,i,r),c=((g=(f=(m=t==null?void 0:t.rpcUrls)==null?void 0:m.chainDefault)==null?void 0:f.http)==null?void 0:g[0])||o,l=((_=n==null?void 0:n[i])==null?void 0:_.map(I=>I.url))||[],u=[...l,a],d=[...l];return c&&!d.includes(c)&&d.push(c),{...t,chainNamespace:s,caipNetworkId:i,assets:{imageId:Cs.NetworkImageIds[t.id],imageUrl:e==null?void 0:e[t.id]},rpcUrls:{...t.rpcUrls,default:{http:u},chainDefault:{http:d}}}},extendCaipNetworks(t,{customNetworkImageUrls:e,projectId:r,customRpcUrls:n}){return t.map(s=>An.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:n,projectId:r}))},getViemTransport(t,e,r){var s,i,o;const n=[];return r==null||r.forEach(a=>{n.push(oc(a.url,a.config))}),nd.includes(t.caipNetworkId)&&n.push(oc(Bm(t.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),(o=(i=(s=t==null?void 0:t.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null||o.forEach(a=>{n.push(oc(a))}),uf(n)},extendWagmiTransports(t,e,r){if(nd.includes(t.caipNetworkId)){const n=this.getDefaultRpcUrl(t,t.caipNetworkId,e);return uf([r,oc(n)])}return r},getUnsupportedNetwork(t){return{id:t.split(":")[1],caipNetworkId:t,name:G.UNSUPPORTED_NETWORK_NAME,chainNamespace:t.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(t){var c;const e=oe.getActiveCaipNetworkId(),r=R.getAllRequestedCaipNetworks(),n=Array.from(((c=R.state.chains)==null?void 0:c.keys())||[]),s=e==null?void 0:e.split(":")[0],i=s?n.includes(s):!1,o=r==null?void 0:r.find(l=>l.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||t||(r==null?void 0:r[0])}},ul={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},pr=et({providers:{...ul},providerIds:{...ul}}),nt={state:pr,subscribeKey(t,e){return Nt(pr,t,e)},subscribe(t){return Tt(pr,()=>{t(pr)})},subscribeProviders(t){return Tt(pr.providers,()=>t(pr.providers))},setProvider(t,e){e&&(pr.providers[t]=si(e))},getProvider(t){return pr.providers[t]},setProviderId(t,e){e&&(pr.providerIds[t]=e)},getProviderId(t){if(t)return pr.providerIds[t]},reset(){pr.providers={...ul},pr.providerIds={...ul}},resetChain(t){pr.providers[t]=void 0,pr.providerIds[t]=void 0}};var sd={},$o={},Lm;function d$(){if(Lm)return $o;Lm=1,$o.byteLength=a,$o.toByteArray=l,$o.fromByteArray=h;for(var t=[],e=[],r=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,i=n.length;s<i;++s)t[s]=n[s],e[n.charCodeAt(s)]=s;e[45]=62,e[95]=63;function o(m){var f=m.length;if(f%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=m.indexOf("=");g===-1&&(g=f);var _=g===f?0:4-g%4;return[g,_]}function a(m){var f=o(m),g=f[0],_=f[1];return(g+_)*3/4-_}function c(m,f,g){return(f+g)*3/4-g}function l(m){var f,g=o(m),_=g[0],I=g[1],N=new r(c(m,_,I)),C=0,E=I>0?_-4:_,v;for(v=0;v<E;v+=4)f=e[m.charCodeAt(v)]<<18|e[m.charCodeAt(v+1)]<<12|e[m.charCodeAt(v+2)]<<6|e[m.charCodeAt(v+3)],N[C++]=f>>16&255,N[C++]=f>>8&255,N[C++]=f&255;return I===2&&(f=e[m.charCodeAt(v)]<<2|e[m.charCodeAt(v+1)]>>4,N[C++]=f&255),I===1&&(f=e[m.charCodeAt(v)]<<10|e[m.charCodeAt(v+1)]<<4|e[m.charCodeAt(v+2)]>>2,N[C++]=f>>8&255,N[C++]=f&255),N}function u(m){return t[m>>18&63]+t[m>>12&63]+t[m>>6&63]+t[m&63]}function d(m,f,g){for(var _,I=[],N=f;N<g;N+=3)_=(m[N]<<16&16711680)+(m[N+1]<<8&65280)+(m[N+2]&255),I.push(u(_));return I.join("")}function h(m){for(var f,g=m.length,_=g%3,I=[],N=16383,C=0,E=g-_;C<E;C+=N)I.push(d(m,C,C+N>E?E:C+N));return _===1?(f=m[g-1],I.push(t[f>>2]+t[f<<4&63]+"==")):_===2&&(f=(m[g-2]<<8)+m[g-1],I.push(t[f>>10]+t[f>>4&63]+t[f<<2&63]+"=")),I.join("")}return $o}var Tc={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Mm;function h$(){return Mm||(Mm=1,Tc.read=function(t,e,r,n,s){var i,o,a=s*8-n-1,c=(1<<a)-1,l=c>>1,u=-7,d=r?s-1:0,h=r?-1:1,m=t[e+d];for(d+=h,i=m&(1<<-u)-1,m>>=-u,u+=a;u>0;i=i*256+t[e+d],d+=h,u-=8);for(o=i&(1<<-u)-1,i>>=-u,u+=n;u>0;o=o*256+t[e+d],d+=h,u-=8);if(i===0)i=1-l;else{if(i===c)return o?NaN:(m?-1:1)*(1/0);o=o+Math.pow(2,n),i=i-l}return(m?-1:1)*o*Math.pow(2,i-n)},Tc.write=function(t,e,r,n,s,i){var o,a,c,l=i*8-s-1,u=(1<<l)-1,d=u>>1,h=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:i-1,f=n?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+d>=1?e+=h/c:e+=h*Math.pow(2,1-d),e*c>=2&&(o++,c/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(e*c-1)*Math.pow(2,s),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,s),o=0));s>=8;t[r+m]=a&255,m+=f,a/=256,s-=8);for(o=o<<s|a,l+=s;l>0;t[r+m]=o&255,m+=f,o/=256,l-=8);t[r+m-f]|=g*128}),Tc}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Fm;function p6(){return Fm||(Fm=1,function(t){const e=d$(),r=h$(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=N,t.INSPECT_MAX_BYTES=50;const s=2147483647;t.kMaxLength=s,a.TYPED_ARRAY_SUPPORT=i(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{const S=new Uint8Array(1),p={foo:function(){return 42}};return Object.setPrototypeOf(p,Uint8Array.prototype),Object.setPrototypeOf(S,p),S.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(S){if(S>s)throw new RangeError('The value "'+S+'" is invalid for option "size"');const p=new Uint8Array(S);return Object.setPrototypeOf(p,a.prototype),p}function a(S,p,w){if(typeof S=="number"){if(typeof p=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(S)}return c(S,p,w)}a.poolSize=8192;function c(S,p,w){if(typeof S=="string")return h(S,p);if(ArrayBuffer.isView(S))return f(S);if(S==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof S);if(Nr(S,ArrayBuffer)||S&&Nr(S.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Nr(S,SharedArrayBuffer)||S&&Nr(S.buffer,SharedArrayBuffer)))return g(S,p,w);if(typeof S=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const P=S.valueOf&&S.valueOf();if(P!=null&&P!==S)return a.from(P,p,w);const j=_(S);if(j)return j;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof S[Symbol.toPrimitive]=="function")return a.from(S[Symbol.toPrimitive]("string"),p,w);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof S)}a.from=function(S,p,w){return c(S,p,w)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(S){if(typeof S!="number")throw new TypeError('"size" argument must be of type number');if(S<0)throw new RangeError('The value "'+S+'" is invalid for option "size"')}function u(S,p,w){return l(S),S<=0?o(S):p!==void 0?typeof w=="string"?o(S).fill(p,w):o(S).fill(p):o(S)}a.alloc=function(S,p,w){return u(S,p,w)};function d(S){return l(S),o(S<0?0:I(S)|0)}a.allocUnsafe=function(S){return d(S)},a.allocUnsafeSlow=function(S){return d(S)};function h(S,p){if((typeof p!="string"||p==="")&&(p="utf8"),!a.isEncoding(p))throw new TypeError("Unknown encoding: "+p);const w=C(S,p)|0;let P=o(w);const j=P.write(S,p);return j!==w&&(P=P.slice(0,j)),P}function m(S){const p=S.length<0?0:I(S.length)|0,w=o(p);for(let P=0;P<p;P+=1)w[P]=S[P]&255;return w}function f(S){if(Nr(S,Uint8Array)){const p=new Uint8Array(S);return g(p.buffer,p.byteOffset,p.byteLength)}return m(S)}function g(S,p,w){if(p<0||S.byteLength<p)throw new RangeError('"offset" is outside of buffer bounds');if(S.byteLength<p+(w||0))throw new RangeError('"length" is outside of buffer bounds');let P;return p===void 0&&w===void 0?P=new Uint8Array(S):w===void 0?P=new Uint8Array(S,p):P=new Uint8Array(S,p,w),Object.setPrototypeOf(P,a.prototype),P}function _(S){if(a.isBuffer(S)){const p=I(S.length)|0,w=o(p);return w.length===0||S.copy(w,0,0,p),w}if(S.length!==void 0)return typeof S.length!="number"||Ci(S.length)?o(0):m(S);if(S.type==="Buffer"&&Array.isArray(S.data))return m(S.data)}function I(S){if(S>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return S|0}function N(S){return+S!=S&&(S=0),a.alloc(+S)}a.isBuffer=function(p){return p!=null&&p._isBuffer===!0&&p!==a.prototype},a.compare=function(p,w){if(Nr(p,Uint8Array)&&(p=a.from(p,p.offset,p.byteLength)),Nr(w,Uint8Array)&&(w=a.from(w,w.offset,w.byteLength)),!a.isBuffer(p)||!a.isBuffer(w))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(p===w)return 0;let P=p.length,j=w.length;for(let V=0,Y=Math.min(P,j);V<Y;++V)if(p[V]!==w[V]){P=p[V],j=w[V];break}return P<j?-1:j<P?1:0},a.isEncoding=function(p){switch(String(p).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(p,w){if(!Array.isArray(p))throw new TypeError('"list" argument must be an Array of Buffers');if(p.length===0)return a.alloc(0);let P;if(w===void 0)for(w=0,P=0;P<p.length;++P)w+=p[P].length;const j=a.allocUnsafe(w);let V=0;for(P=0;P<p.length;++P){let Y=p[P];if(Nr(Y,Uint8Array))V+Y.length>j.length?(a.isBuffer(Y)||(Y=a.from(Y)),Y.copy(j,V)):Uint8Array.prototype.set.call(j,Y,V);else if(a.isBuffer(Y))Y.copy(j,V);else throw new TypeError('"list" argument must be an Array of Buffers');V+=Y.length}return j};function C(S,p){if(a.isBuffer(S))return S.length;if(ArrayBuffer.isView(S)||Nr(S,ArrayBuffer))return S.byteLength;if(typeof S!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof S);const w=S.length,P=arguments.length>2&&arguments[2]===!0;if(!P&&w===0)return 0;let j=!1;for(;;)switch(p){case"ascii":case"latin1":case"binary":return w;case"utf8":case"utf-8":return wo(S).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w*2;case"hex":return w>>>1;case"base64":return yo(S).length;default:if(j)return P?-1:wo(S).length;p=(""+p).toLowerCase(),j=!0}}a.byteLength=C;function E(S,p,w){let P=!1;if((p===void 0||p<0)&&(p=0),p>this.length||((w===void 0||w>this.length)&&(w=this.length),w<=0)||(w>>>=0,p>>>=0,w<=p))return"";for(S||(S="utf8");;)switch(S){case"hex":return k(this,p,w);case"utf8":case"utf-8":return q(this,p,w);case"ascii":return O(this,p,w);case"latin1":case"binary":return B(this,p,w);case"base64":return W(this,p,w);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,p,w);default:if(P)throw new TypeError("Unknown encoding: "+S);S=(S+"").toLowerCase(),P=!0}}a.prototype._isBuffer=!0;function v(S,p,w){const P=S[p];S[p]=S[w],S[w]=P}a.prototype.swap16=function(){const p=this.length;if(p%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let w=0;w<p;w+=2)v(this,w,w+1);return this},a.prototype.swap32=function(){const p=this.length;if(p%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let w=0;w<p;w+=4)v(this,w,w+3),v(this,w+1,w+2);return this},a.prototype.swap64=function(){const p=this.length;if(p%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let w=0;w<p;w+=8)v(this,w,w+7),v(this,w+1,w+6),v(this,w+2,w+5),v(this,w+3,w+4);return this},a.prototype.toString=function(){const p=this.length;return p===0?"":arguments.length===0?q(this,0,p):E.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(p){if(!a.isBuffer(p))throw new TypeError("Argument must be a Buffer");return this===p?!0:a.compare(this,p)===0},a.prototype.inspect=function(){let p="";const w=t.INSPECT_MAX_BYTES;return p=this.toString("hex",0,w).replace(/(.{2})/g,"$1 ").trim(),this.length>w&&(p+=" ... "),"<Buffer "+p+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(p,w,P,j,V){if(Nr(p,Uint8Array)&&(p=a.from(p,p.offset,p.byteLength)),!a.isBuffer(p))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof p);if(w===void 0&&(w=0),P===void 0&&(P=p?p.length:0),j===void 0&&(j=0),V===void 0&&(V=this.length),w<0||P>p.length||j<0||V>this.length)throw new RangeError("out of range index");if(j>=V&&w>=P)return 0;if(j>=V)return-1;if(w>=P)return 1;if(w>>>=0,P>>>=0,j>>>=0,V>>>=0,this===p)return 0;let Y=V-j,Ue=P-w;const bt=Math.min(Y,Ue),mt=this.slice(j,V),Et=p.slice(w,P);for(let it=0;it<bt;++it)if(mt[it]!==Et[it]){Y=mt[it],Ue=Et[it];break}return Y<Ue?-1:Ue<Y?1:0};function A(S,p,w,P,j){if(S.length===0)return-1;if(typeof w=="string"?(P=w,w=0):w>2147483647?w=2147483647:w<-2147483648&&(w=-2147483648),w=+w,Ci(w)&&(w=j?0:S.length-1),w<0&&(w=S.length+w),w>=S.length){if(j)return-1;w=S.length-1}else if(w<0)if(j)w=0;else return-1;if(typeof p=="string"&&(p=a.from(p,P)),a.isBuffer(p))return p.length===0?-1:x(S,p,w,P,j);if(typeof p=="number")return p=p&255,typeof Uint8Array.prototype.indexOf=="function"?j?Uint8Array.prototype.indexOf.call(S,p,w):Uint8Array.prototype.lastIndexOf.call(S,p,w):x(S,[p],w,P,j);throw new TypeError("val must be string, number or Buffer")}function x(S,p,w,P,j){let V=1,Y=S.length,Ue=p.length;if(P!==void 0&&(P=String(P).toLowerCase(),P==="ucs2"||P==="ucs-2"||P==="utf16le"||P==="utf-16le")){if(S.length<2||p.length<2)return-1;V=2,Y/=2,Ue/=2,w/=2}function bt(Et,it){return V===1?Et[it]:Et.readUInt16BE(it*V)}let mt;if(j){let Et=-1;for(mt=w;mt<Y;mt++)if(bt(S,mt)===bt(p,Et===-1?0:mt-Et)){if(Et===-1&&(Et=mt),mt-Et+1===Ue)return Et*V}else Et!==-1&&(mt-=mt-Et),Et=-1}else for(w+Ue>Y&&(w=Y-Ue),mt=w;mt>=0;mt--){let Et=!0;for(let it=0;it<Ue;it++)if(bt(S,mt+it)!==bt(p,it)){Et=!1;break}if(Et)return mt}return-1}a.prototype.includes=function(p,w,P){return this.indexOf(p,w,P)!==-1},a.prototype.indexOf=function(p,w,P){return A(this,p,w,P,!0)},a.prototype.lastIndexOf=function(p,w,P){return A(this,p,w,P,!1)};function D(S,p,w,P){w=Number(w)||0;const j=S.length-w;P?(P=Number(P),P>j&&(P=j)):P=j;const V=p.length;P>V/2&&(P=V/2);let Y;for(Y=0;Y<P;++Y){const Ue=parseInt(p.substr(Y*2,2),16);if(Ci(Ue))return Y;S[w+Y]=Ue}return Y}function U(S,p,w,P){return ts(wo(p,S.length-w),S,w,P)}function M(S,p,w,P){return ts(Hl(p),S,w,P)}function $(S,p,w,P){return ts(yo(p),S,w,P)}function F(S,p,w,P){return ts(nc(p,S.length-w),S,w,P)}a.prototype.write=function(p,w,P,j){if(w===void 0)j="utf8",P=this.length,w=0;else if(P===void 0&&typeof w=="string")j=w,P=this.length,w=0;else if(isFinite(w))w=w>>>0,isFinite(P)?(P=P>>>0,j===void 0&&(j="utf8")):(j=P,P=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const V=this.length-w;if((P===void 0||P>V)&&(P=V),p.length>0&&(P<0||w<0)||w>this.length)throw new RangeError("Attempt to write outside buffer bounds");j||(j="utf8");let Y=!1;for(;;)switch(j){case"hex":return D(this,p,w,P);case"utf8":case"utf-8":return U(this,p,w,P);case"ascii":case"latin1":case"binary":return M(this,p,w,P);case"base64":return $(this,p,w,P);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,p,w,P);default:if(Y)throw new TypeError("Unknown encoding: "+j);j=(""+j).toLowerCase(),Y=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function W(S,p,w){return p===0&&w===S.length?e.fromByteArray(S):e.fromByteArray(S.slice(p,w))}function q(S,p,w){w=Math.min(S.length,w);const P=[];let j=p;for(;j<w;){const V=S[j];let Y=null,Ue=V>239?4:V>223?3:V>191?2:1;if(j+Ue<=w){let bt,mt,Et,it;switch(Ue){case 1:V<128&&(Y=V);break;case 2:bt=S[j+1],(bt&192)===128&&(it=(V&31)<<6|bt&63,it>127&&(Y=it));break;case 3:bt=S[j+1],mt=S[j+2],(bt&192)===128&&(mt&192)===128&&(it=(V&15)<<12|(bt&63)<<6|mt&63,it>2047&&(it<55296||it>57343)&&(Y=it));break;case 4:bt=S[j+1],mt=S[j+2],Et=S[j+3],(bt&192)===128&&(mt&192)===128&&(Et&192)===128&&(it=(V&15)<<18|(bt&63)<<12|(mt&63)<<6|Et&63,it>65535&&it<1114112&&(Y=it))}}Y===null?(Y=65533,Ue=1):Y>65535&&(Y-=65536,P.push(Y>>>10&1023|55296),Y=56320|Y&1023),P.push(Y),j+=Ue}return b(P)}const y=4096;function b(S){const p=S.length;if(p<=y)return String.fromCharCode.apply(String,S);let w="",P=0;for(;P<p;)w+=String.fromCharCode.apply(String,S.slice(P,P+=y));return w}function O(S,p,w){let P="";w=Math.min(S.length,w);for(let j=p;j<w;++j)P+=String.fromCharCode(S[j]&127);return P}function B(S,p,w){let P="";w=Math.min(S.length,w);for(let j=p;j<w;++j)P+=String.fromCharCode(S[j]);return P}function k(S,p,w){const P=S.length;(!p||p<0)&&(p=0),(!w||w<0||w>P)&&(w=P);let j="";for(let V=p;V<w;++V)j+=sc[S[V]];return j}function L(S,p,w){const P=S.slice(p,w);let j="";for(let V=0;V<P.length-1;V+=2)j+=String.fromCharCode(P[V]+P[V+1]*256);return j}a.prototype.slice=function(p,w){const P=this.length;p=~~p,w=w===void 0?P:~~w,p<0?(p+=P,p<0&&(p=0)):p>P&&(p=P),w<0?(w+=P,w<0&&(w=0)):w>P&&(w=P),w<p&&(w=p);const j=this.subarray(p,w);return Object.setPrototypeOf(j,a.prototype),j};function H(S,p,w){if(S%1!==0||S<0)throw new RangeError("offset is not uint");if(S+p>w)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(p,w,P){p=p>>>0,w=w>>>0,P||H(p,w,this.length);let j=this[p],V=1,Y=0;for(;++Y<w&&(V*=256);)j+=this[p+Y]*V;return j},a.prototype.readUintBE=a.prototype.readUIntBE=function(p,w,P){p=p>>>0,w=w>>>0,P||H(p,w,this.length);let j=this[p+--w],V=1;for(;w>0&&(V*=256);)j+=this[p+--w]*V;return j},a.prototype.readUint8=a.prototype.readUInt8=function(p,w){return p=p>>>0,w||H(p,1,this.length),this[p]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(p,w){return p=p>>>0,w||H(p,2,this.length),this[p]|this[p+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(p,w){return p=p>>>0,w||H(p,2,this.length),this[p]<<8|this[p+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(p,w){return p=p>>>0,w||H(p,4,this.length),(this[p]|this[p+1]<<8|this[p+2]<<16)+this[p+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(p,w){return p=p>>>0,w||H(p,4,this.length),this[p]*16777216+(this[p+1]<<16|this[p+2]<<8|this[p+3])},a.prototype.readBigUInt64LE=Jr(function(p){p=p>>>0,qe(p,"offset");const w=this[p],P=this[p+7];(w===void 0||P===void 0)&&ct(p,this.length-8);const j=w+this[++p]*2**8+this[++p]*2**16+this[++p]*2**24,V=this[++p]+this[++p]*2**8+this[++p]*2**16+P*2**24;return BigInt(j)+(BigInt(V)<<BigInt(32))}),a.prototype.readBigUInt64BE=Jr(function(p){p=p>>>0,qe(p,"offset");const w=this[p],P=this[p+7];(w===void 0||P===void 0)&&ct(p,this.length-8);const j=w*2**24+this[++p]*2**16+this[++p]*2**8+this[++p],V=this[++p]*2**24+this[++p]*2**16+this[++p]*2**8+P;return(BigInt(j)<<BigInt(32))+BigInt(V)}),a.prototype.readIntLE=function(p,w,P){p=p>>>0,w=w>>>0,P||H(p,w,this.length);let j=this[p],V=1,Y=0;for(;++Y<w&&(V*=256);)j+=this[p+Y]*V;return V*=128,j>=V&&(j-=Math.pow(2,8*w)),j},a.prototype.readIntBE=function(p,w,P){p=p>>>0,w=w>>>0,P||H(p,w,this.length);let j=w,V=1,Y=this[p+--j];for(;j>0&&(V*=256);)Y+=this[p+--j]*V;return V*=128,Y>=V&&(Y-=Math.pow(2,8*w)),Y},a.prototype.readInt8=function(p,w){return p=p>>>0,w||H(p,1,this.length),this[p]&128?(255-this[p]+1)*-1:this[p]},a.prototype.readInt16LE=function(p,w){p=p>>>0,w||H(p,2,this.length);const P=this[p]|this[p+1]<<8;return P&32768?P|4294901760:P},a.prototype.readInt16BE=function(p,w){p=p>>>0,w||H(p,2,this.length);const P=this[p+1]|this[p]<<8;return P&32768?P|4294901760:P},a.prototype.readInt32LE=function(p,w){return p=p>>>0,w||H(p,4,this.length),this[p]|this[p+1]<<8|this[p+2]<<16|this[p+3]<<24},a.prototype.readInt32BE=function(p,w){return p=p>>>0,w||H(p,4,this.length),this[p]<<24|this[p+1]<<16|this[p+2]<<8|this[p+3]},a.prototype.readBigInt64LE=Jr(function(p){p=p>>>0,qe(p,"offset");const w=this[p],P=this[p+7];(w===void 0||P===void 0)&&ct(p,this.length-8);const j=this[p+4]+this[p+5]*2**8+this[p+6]*2**16+(P<<24);return(BigInt(j)<<BigInt(32))+BigInt(w+this[++p]*2**8+this[++p]*2**16+this[++p]*2**24)}),a.prototype.readBigInt64BE=Jr(function(p){p=p>>>0,qe(p,"offset");const w=this[p],P=this[p+7];(w===void 0||P===void 0)&&ct(p,this.length-8);const j=(w<<24)+this[++p]*2**16+this[++p]*2**8+this[++p];return(BigInt(j)<<BigInt(32))+BigInt(this[++p]*2**24+this[++p]*2**16+this[++p]*2**8+P)}),a.prototype.readFloatLE=function(p,w){return p=p>>>0,w||H(p,4,this.length),r.read(this,p,!0,23,4)},a.prototype.readFloatBE=function(p,w){return p=p>>>0,w||H(p,4,this.length),r.read(this,p,!1,23,4)},a.prototype.readDoubleLE=function(p,w){return p=p>>>0,w||H(p,8,this.length),r.read(this,p,!0,52,8)},a.prototype.readDoubleBE=function(p,w){return p=p>>>0,w||H(p,8,this.length),r.read(this,p,!1,52,8)};function K(S,p,w,P,j,V){if(!a.isBuffer(S))throw new TypeError('"buffer" argument must be a Buffer instance');if(p>j||p<V)throw new RangeError('"value" argument is out of bounds');if(w+P>S.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(p,w,P,j){if(p=+p,w=w>>>0,P=P>>>0,!j){const Ue=Math.pow(2,8*P)-1;K(this,p,w,P,Ue,0)}let V=1,Y=0;for(this[w]=p&255;++Y<P&&(V*=256);)this[w+Y]=p/V&255;return w+P},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(p,w,P,j){if(p=+p,w=w>>>0,P=P>>>0,!j){const Ue=Math.pow(2,8*P)-1;K(this,p,w,P,Ue,0)}let V=P-1,Y=1;for(this[w+V]=p&255;--V>=0&&(Y*=256);)this[w+V]=p/Y&255;return w+P},a.prototype.writeUint8=a.prototype.writeUInt8=function(p,w,P){return p=+p,w=w>>>0,P||K(this,p,w,1,255,0),this[w]=p&255,w+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(p,w,P){return p=+p,w=w>>>0,P||K(this,p,w,2,65535,0),this[w]=p&255,this[w+1]=p>>>8,w+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(p,w,P){return p=+p,w=w>>>0,P||K(this,p,w,2,65535,0),this[w]=p>>>8,this[w+1]=p&255,w+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(p,w,P){return p=+p,w=w>>>0,P||K(this,p,w,4,4294967295,0),this[w+3]=p>>>24,this[w+2]=p>>>16,this[w+1]=p>>>8,this[w]=p&255,w+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(p,w,P){return p=+p,w=w>>>0,P||K(this,p,w,4,4294967295,0),this[w]=p>>>24,this[w+1]=p>>>16,this[w+2]=p>>>8,this[w+3]=p&255,w+4};function Q(S,p,w,P,j){tt(p,P,j,S,w,7);let V=Number(p&BigInt(4294967295));S[w++]=V,V=V>>8,S[w++]=V,V=V>>8,S[w++]=V,V=V>>8,S[w++]=V;let Y=Number(p>>BigInt(32)&BigInt(4294967295));return S[w++]=Y,Y=Y>>8,S[w++]=Y,Y=Y>>8,S[w++]=Y,Y=Y>>8,S[w++]=Y,w}function Z(S,p,w,P,j){tt(p,P,j,S,w,7);let V=Number(p&BigInt(4294967295));S[w+7]=V,V=V>>8,S[w+6]=V,V=V>>8,S[w+5]=V,V=V>>8,S[w+4]=V;let Y=Number(p>>BigInt(32)&BigInt(4294967295));return S[w+3]=Y,Y=Y>>8,S[w+2]=Y,Y=Y>>8,S[w+1]=Y,Y=Y>>8,S[w]=Y,w+8}a.prototype.writeBigUInt64LE=Jr(function(p,w=0){return Q(this,p,w,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Jr(function(p,w=0){return Z(this,p,w,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(p,w,P,j){if(p=+p,w=w>>>0,!j){const bt=Math.pow(2,8*P-1);K(this,p,w,P,bt-1,-bt)}let V=0,Y=1,Ue=0;for(this[w]=p&255;++V<P&&(Y*=256);)p<0&&Ue===0&&this[w+V-1]!==0&&(Ue=1),this[w+V]=(p/Y>>0)-Ue&255;return w+P},a.prototype.writeIntBE=function(p,w,P,j){if(p=+p,w=w>>>0,!j){const bt=Math.pow(2,8*P-1);K(this,p,w,P,bt-1,-bt)}let V=P-1,Y=1,Ue=0;for(this[w+V]=p&255;--V>=0&&(Y*=256);)p<0&&Ue===0&&this[w+V+1]!==0&&(Ue=1),this[w+V]=(p/Y>>0)-Ue&255;return w+P},a.prototype.writeInt8=function(p,w,P){return p=+p,w=w>>>0,P||K(this,p,w,1,127,-128),p<0&&(p=255+p+1),this[w]=p&255,w+1},a.prototype.writeInt16LE=function(p,w,P){return p=+p,w=w>>>0,P||K(this,p,w,2,32767,-32768),this[w]=p&255,this[w+1]=p>>>8,w+2},a.prototype.writeInt16BE=function(p,w,P){return p=+p,w=w>>>0,P||K(this,p,w,2,32767,-32768),this[w]=p>>>8,this[w+1]=p&255,w+2},a.prototype.writeInt32LE=function(p,w,P){return p=+p,w=w>>>0,P||K(this,p,w,4,2147483647,-2147483648),this[w]=p&255,this[w+1]=p>>>8,this[w+2]=p>>>16,this[w+3]=p>>>24,w+4},a.prototype.writeInt32BE=function(p,w,P){return p=+p,w=w>>>0,P||K(this,p,w,4,2147483647,-2147483648),p<0&&(p=4294967295+p+1),this[w]=p>>>24,this[w+1]=p>>>16,this[w+2]=p>>>8,this[w+3]=p&255,w+4},a.prototype.writeBigInt64LE=Jr(function(p,w=0){return Q(this,p,w,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Jr(function(p,w=0){return Z(this,p,w,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function re(S,p,w,P,j,V){if(w+P>S.length)throw new RangeError("Index out of range");if(w<0)throw new RangeError("Index out of range")}function we(S,p,w,P,j){return p=+p,w=w>>>0,j||re(S,p,w,4),r.write(S,p,w,P,23,4),w+4}a.prototype.writeFloatLE=function(p,w,P){return we(this,p,w,!0,P)},a.prototype.writeFloatBE=function(p,w,P){return we(this,p,w,!1,P)};function Ee(S,p,w,P,j){return p=+p,w=w>>>0,j||re(S,p,w,8),r.write(S,p,w,P,52,8),w+8}a.prototype.writeDoubleLE=function(p,w,P){return Ee(this,p,w,!0,P)},a.prototype.writeDoubleBE=function(p,w,P){return Ee(this,p,w,!1,P)},a.prototype.copy=function(p,w,P,j){if(!a.isBuffer(p))throw new TypeError("argument should be a Buffer");if(P||(P=0),!j&&j!==0&&(j=this.length),w>=p.length&&(w=p.length),w||(w=0),j>0&&j<P&&(j=P),j===P||p.length===0||this.length===0)return 0;if(w<0)throw new RangeError("targetStart out of bounds");if(P<0||P>=this.length)throw new RangeError("Index out of range");if(j<0)throw new RangeError("sourceEnd out of bounds");j>this.length&&(j=this.length),p.length-w<j-P&&(j=p.length-w+P);const V=j-P;return this===p&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(w,P,j):Uint8Array.prototype.set.call(p,this.subarray(P,j),w),V},a.prototype.fill=function(p,w,P,j){if(typeof p=="string"){if(typeof w=="string"?(j=w,w=0,P=this.length):typeof P=="string"&&(j=P,P=this.length),j!==void 0&&typeof j!="string")throw new TypeError("encoding must be a string");if(typeof j=="string"&&!a.isEncoding(j))throw new TypeError("Unknown encoding: "+j);if(p.length===1){const Y=p.charCodeAt(0);(j==="utf8"&&Y<128||j==="latin1")&&(p=Y)}}else typeof p=="number"?p=p&255:typeof p=="boolean"&&(p=Number(p));if(w<0||this.length<w||this.length<P)throw new RangeError("Out of range index");if(P<=w)return this;w=w>>>0,P=P===void 0?this.length:P>>>0,p||(p=0);let V;if(typeof p=="number")for(V=w;V<P;++V)this[V]=p;else{const Y=a.isBuffer(p)?p:a.from(p,j),Ue=Y.length;if(Ue===0)throw new TypeError('The value "'+p+'" is invalid for argument "value"');for(V=0;V<P-w;++V)this[V+w]=Y[V%Ue]}return this};const Ne={};function be(S,p,w){Ne[S]=class extends w{constructor(){super(),Object.defineProperty(this,"message",{value:p.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${S}]`,this.stack,delete this.name}get code(){return S}set code(j){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:j,writable:!0})}toString(){return`${this.name} [${S}]: ${this.message}`}}}be("ERR_BUFFER_OUT_OF_BOUNDS",function(S){return S?`${S} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),be("ERR_INVALID_ARG_TYPE",function(S,p){return`The "${S}" argument must be of type number. Received type ${typeof p}`},TypeError),be("ERR_OUT_OF_RANGE",function(S,p,w){let P=`The value of "${S}" is out of range.`,j=w;return Number.isInteger(w)&&Math.abs(w)>2**32?j=xe(String(w)):typeof w=="bigint"&&(j=String(w),(w>BigInt(2)**BigInt(32)||w<-(BigInt(2)**BigInt(32)))&&(j=xe(j)),j+="n"),P+=` It must be ${p}. Received ${j}`,P},RangeError);function xe(S){let p="",w=S.length;const P=S[0]==="-"?1:0;for(;w>=P+4;w-=3)p=`_${S.slice(w-3,w)}${p}`;return`${S.slice(0,w)}${p}`}function Ze(S,p,w){qe(p,"offset"),(S[p]===void 0||S[p+w]===void 0)&&ct(p,S.length-(w+1))}function tt(S,p,w,P,j,V){if(S>w||S<p){const Y=typeof p=="bigint"?"n":"";let Ue;throw p===0||p===BigInt(0)?Ue=`>= 0${Y} and < 2${Y} ** ${(V+1)*8}${Y}`:Ue=`>= -(2${Y} ** ${(V+1)*8-1}${Y}) and < 2 ** ${(V+1)*8-1}${Y}`,new Ne.ERR_OUT_OF_RANGE("value",Ue,S)}Ze(P,j,V)}function qe(S,p){if(typeof S!="number")throw new Ne.ERR_INVALID_ARG_TYPE(p,"number",S)}function ct(S,p,w){throw Math.floor(S)!==S?(qe(S,w),new Ne.ERR_OUT_OF_RANGE("offset","an integer",S)):p<0?new Ne.ERR_BUFFER_OUT_OF_BOUNDS:new Ne.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${p}`,S)}const jt=/[^+/0-9A-Za-z-_]/g;function Tr(S){if(S=S.split("=")[0],S=S.trim().replace(jt,""),S.length<2)return"";for(;S.length%4!==0;)S=S+"=";return S}function wo(S,p){p=p||1/0;let w;const P=S.length;let j=null;const V=[];for(let Y=0;Y<P;++Y){if(w=S.charCodeAt(Y),w>55295&&w<57344){if(!j){if(w>56319){(p-=3)>-1&&V.push(239,191,189);continue}else if(Y+1===P){(p-=3)>-1&&V.push(239,191,189);continue}j=w;continue}if(w<56320){(p-=3)>-1&&V.push(239,191,189),j=w;continue}w=(j-55296<<10|w-56320)+65536}else j&&(p-=3)>-1&&V.push(239,191,189);if(j=null,w<128){if((p-=1)<0)break;V.push(w)}else if(w<2048){if((p-=2)<0)break;V.push(w>>6|192,w&63|128)}else if(w<65536){if((p-=3)<0)break;V.push(w>>12|224,w>>6&63|128,w&63|128)}else if(w<1114112){if((p-=4)<0)break;V.push(w>>18|240,w>>12&63|128,w>>6&63|128,w&63|128)}else throw new Error("Invalid code point")}return V}function Hl(S){const p=[];for(let w=0;w<S.length;++w)p.push(S.charCodeAt(w)&255);return p}function nc(S,p){let w,P,j;const V=[];for(let Y=0;Y<S.length&&!((p-=2)<0);++Y)w=S.charCodeAt(Y),P=w>>8,j=w%256,V.push(j),V.push(P);return V}function yo(S){return e.toByteArray(Tr(S))}function ts(S,p,w,P){let j;for(j=0;j<P&&!(j+w>=p.length||j>=S.length);++j)p[j+w]=S[j];return j}function Nr(S,p){return S instanceof p||S!=null&&S.constructor!=null&&S.constructor.name!=null&&S.constructor.name===p.name}function Ci(S){return S!==S}const sc=function(){const S="0123456789abcdef",p=new Array(256);for(let w=0;w<16;++w){const P=w*16;for(let j=0;j<16;++j)p[P+j]=S[w]+S[j]}return p}();function Jr(S){return typeof BigInt>"u"?ic:S}function ic(){throw new Error("BigInt not supported")}}(sd)),sd}const jm={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},zt={set(t,e){kr.isClient&&localStorage.setItem(`${ge.STORAGE_KEY}${t}`,e)},get(t){return kr.isClient?localStorage.getItem(`${ge.STORAGE_KEY}${t}`):null},delete(t,e){kr.isClient&&(e?localStorage.removeItem(t):localStorage.removeItem(`${ge.STORAGE_KEY}${t}`))}},Nc=30*1e3,kr={checkIfAllowedToTriggerEmail(){const t=zt.get(ge.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<Nc){const r=Math.ceil((Nc-e)/1e3);throw new Error(`Please try again after ${r} seconds`)}}},getTimeToNextEmailLogin(){const t=zt.get(ge.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<Nc)return Math.ceil((Nc-e)/1e3)}return 0},checkIfRequestExists(t){return At.NOT_SAFE_RPC_METHODS.includes(t.method)||At.SAFE_RPC_METHODS.includes(t.method)},getResponseType(t){return typeof t=="string"&&((t==null?void 0:t.match(jm.transactionHash))||(t==null?void 0:t.match(jm.signedMessage)))?ge.RPC_RESPONSE_TYPE_TX:ge.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(t){return At.SAFE_RPC_METHODS.includes(t.method)},isClient:typeof window<"u"};var Ve;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function r(s){throw new Error}t.assertNever=r,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Ve||(Ve={}));var gh;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(gh||(gh={}));const de=Ve.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),bs=t=>{switch(typeof t){case"undefined":return de.undefined;case"string":return de.string;case"number":return isNaN(t)?de.nan:de.number;case"boolean":return de.boolean;case"function":return de.function;case"bigint":return de.bigint;case"symbol":return de.symbol;case"object":return Array.isArray(t)?de.array:t===null?de.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?de.promise:typeof Map<"u"&&t instanceof Map?de.map:typeof Set<"u"&&t instanceof Set?de.set:typeof Date<"u"&&t instanceof Date?de.date:de.object;default:return de.unknown}},te=Ve.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),f$=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class un extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const r=e||function(i){return i.message},n={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)n._errors.push(r(o));else{let a=n,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(r(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return s(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ve.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},n=[];for(const s of this.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}un.create=t=>new un(t);const va=(t,e)=>{let r;switch(t.code){case te.invalid_type:t.received===de.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case te.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,Ve.jsonStringifyReplacer)}`;break;case te.unrecognized_keys:r=`Unrecognized key(s) in object: ${Ve.joinValues(t.keys,", ")}`;break;case te.invalid_union:r="Invalid input";break;case te.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Ve.joinValues(t.options)}`;break;case te.invalid_enum_value:r=`Invalid enum value. Expected ${Ve.joinValues(t.options)}, received '${t.received}'`;break;case te.invalid_arguments:r="Invalid function arguments";break;case te.invalid_return_type:r="Invalid function return type";break;case te.invalid_date:r="Invalid date";break;case te.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:Ve.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case te.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case te.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case te.custom:r="Invalid input";break;case te.invalid_intersection_types:r="Intersection results could not be merged";break;case te.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case te.not_finite:r="Number must be finite";break;default:r=e.defaultError,Ve.assertNever(t)}return{message:r}};let yb=va;function p$(t){yb=t}function dl(){return yb}const hl=t=>{const{data:e,path:r,errorMaps:n,issueData:s}=t,i=[...r,...s.path||[]],o={...s,path:i};let a="";const c=n.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...s,path:i,message:s.message||a}},g$=[];function pe(t,e){const r=hl({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,dl(),va].filter(n=>!!n)});t.common.issues.push(r)}class er{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const n=[];for(const s of r){if(s.status==="aborted")return Oe;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){const n=[];for(const s of r)n.push({key:await s.key,value:await s.value});return er.mergeObjectSync(e,n)}static mergeObjectSync(e,r){const n={};for(const s of r){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return Oe;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(n[i.value]=o.value)}return{status:e.value,value:n}}}const Oe=Object.freeze({status:"aborted"}),bb=t=>({status:"dirty",value:t}),or=t=>({status:"valid",value:t}),mh=t=>t.status==="aborted",wh=t=>t.status==="dirty",_a=t=>t.status==="valid",fl=t=>typeof Promise<"u"&&t instanceof Promise;var _e;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(_e||(_e={}));class xn{constructor(e,r,n,s){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const qm=(t,e)=>{if(_a(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new un(t.common.issues);return this._error=r,this._error}}};function Pe(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:n,description:s}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:n??a.defaultError}:{message:r??a.defaultError},description:s}}class ke{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return bs(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:bs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new er,ctx:{common:e.parent.common,data:e.data,parsedType:bs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(fl(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){var n;const s={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:bs(e)},i=this._parseSync({data:e,path:s.path,parent:s});return qm(s,i)}async parseAsync(e,r){const n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:bs(e)},s=this._parse({data:e,path:n.path,parent:n}),i=await(fl(s)?s:Promise.resolve(s));return qm(n,i)}refine(e,r){const n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:te.custom,...n(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,r){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(e){return new hn({schema:this,typeName:Se.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Zn.create(this,this._def)}nullable(){return hi.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return dn.create(this,this._def)}promise(){return io.create(this,this._def)}or(e){return Sa.create([this,e],this._def)}and(e){return Ta.create(this,e,this._def)}transform(e){return new hn({...Pe(this._def),schema:this,typeName:Se.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new Pa({...Pe(this._def),innerType:this,defaultValue:r,typeName:Se.ZodDefault})}brand(){return new vb({typeName:Se.ZodBranded,type:this,...Pe(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new wl({...Pe(this._def),innerType:this,catchValue:r,typeName:Se.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return ec.create(this,e)}readonly(){return bl.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const m$=/^c[^\s-]{8,}$/i,w$=/^[a-z][a-z0-9]*$/,y$=/^[0-9A-HJKMNP-TV-Z]{26}$/,b$=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,E$=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,v$="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let id;const _$=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,C$=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,A$=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function I$(t,e){return!!((e==="v4"||!e)&&_$.test(t)||(e==="v6"||!e)&&C$.test(t))}class cn extends ke{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==de.string){const i=this._getOrReturnCtx(e);return pe(i,{code:te.invalid_type,expected:de.string,received:i.parsedType}),Oe}const n=new er;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),pe(s,{code:te.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),pe(s,{code:te.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?pe(s,{code:te.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&pe(s,{code:te.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")E$.test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"email",code:te.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")id||(id=new RegExp(v$,"u")),id.test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"emoji",code:te.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")b$.test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"uuid",code:te.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")m$.test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"cuid",code:te.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")w$.test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"cuid2",code:te.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")y$.test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"ulid",code:te.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),pe(s,{validation:"url",code:te.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"regex",code:te.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),pe(s,{code:te.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),pe(s,{code:te.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),pe(s,{code:te.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?A$(i).test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{code:te.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="ip"?I$(e.data,i.version)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"ip",code:te.invalid_string,message:i.message}),n.dirty()):Ve.assertNever(i);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(s=>e.test(s),{validation:r,code:te.invalid_string,..._e.errToObj(n)})}_addCheck(e){return new cn({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",..._e.errToObj(e)})}url(e){return this._addCheck({kind:"url",..._e.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",..._e.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",..._e.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",..._e.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",..._e.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",..._e.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",..._e.errToObj(e)})}datetime(e){var r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(r=e==null?void 0:e.offset)!==null&&r!==void 0?r:!1,..._e.errToObj(e==null?void 0:e.message)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,..._e.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r==null?void 0:r.position,..._e.errToObj(r==null?void 0:r.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,..._e.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,..._e.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,..._e.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,..._e.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,..._e.errToObj(r)})}nonempty(e){return this.min(1,_e.errToObj(e))}trim(){return new cn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new cn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new cn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}cn.create=t=>{var e;return new cn({checks:[],typeName:Se.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Pe(t)})};function S$(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=r>n?r:n,i=parseInt(t.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class Ps extends ke{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==de.number){const i=this._getOrReturnCtx(e);return pe(i,{code:te.invalid_type,expected:de.number,received:i.parsedType}),Oe}let n;const s=new er;for(const i of this._def.checks)i.kind==="int"?Ve.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),pe(n,{code:te.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),pe(n,{code:te.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),pe(n,{code:te.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?S$(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),pe(n,{code:te.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),pe(n,{code:te.not_finite,message:i.message}),s.dirty()):Ve.assertNever(i);return{status:s.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,_e.toString(r))}gt(e,r){return this.setLimit("min",e,!1,_e.toString(r))}lte(e,r){return this.setLimit("max",e,!0,_e.toString(r))}lt(e,r){return this.setLimit("max",e,!1,_e.toString(r))}setLimit(e,r,n,s){return new Ps({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:_e.toString(s)}]})}_addCheck(e){return new Ps({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:_e.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:_e.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:_e.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:_e.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:_e.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:_e.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:_e.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:_e.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:_e.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ve.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}}Ps.create=t=>new Ps({checks:[],typeName:Se.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Pe(t)});class Ds extends ke{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==de.bigint){const i=this._getOrReturnCtx(e);return pe(i,{code:te.invalid_type,expected:de.bigint,received:i.parsedType}),Oe}let n;const s=new er;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),pe(n,{code:te.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),pe(n,{code:te.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),pe(n,{code:te.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Ve.assertNever(i);return{status:s.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,_e.toString(r))}gt(e,r){return this.setLimit("min",e,!1,_e.toString(r))}lte(e,r){return this.setLimit("max",e,!0,_e.toString(r))}lt(e,r){return this.setLimit("max",e,!1,_e.toString(r))}setLimit(e,r,n,s){return new Ds({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:_e.toString(s)}]})}_addCheck(e){return new Ds({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:_e.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:_e.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:_e.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:_e.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:_e.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Ds.create=t=>{var e;return new Ds({checks:[],typeName:Se.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Pe(t)})};class Ca extends ke{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==de.boolean){const n=this._getOrReturnCtx(e);return pe(n,{code:te.invalid_type,expected:de.boolean,received:n.parsedType}),Oe}return or(e.data)}}Ca.create=t=>new Ca({typeName:Se.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Pe(t)});class ui extends ke{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==de.date){const i=this._getOrReturnCtx(e);return pe(i,{code:te.invalid_type,expected:de.date,received:i.parsedType}),Oe}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return pe(i,{code:te.invalid_date}),Oe}const n=new er;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),pe(s,{code:te.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),pe(s,{code:te.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):Ve.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ui({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:_e.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:_e.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}ui.create=t=>new ui({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Se.ZodDate,...Pe(t)});class pl extends ke{_parse(e){if(this._getType(e)!==de.symbol){const n=this._getOrReturnCtx(e);return pe(n,{code:te.invalid_type,expected:de.symbol,received:n.parsedType}),Oe}return or(e.data)}}pl.create=t=>new pl({typeName:Se.ZodSymbol,...Pe(t)});class Aa extends ke{_parse(e){if(this._getType(e)!==de.undefined){const n=this._getOrReturnCtx(e);return pe(n,{code:te.invalid_type,expected:de.undefined,received:n.parsedType}),Oe}return or(e.data)}}Aa.create=t=>new Aa({typeName:Se.ZodUndefined,...Pe(t)});class Ia extends ke{_parse(e){if(this._getType(e)!==de.null){const n=this._getOrReturnCtx(e);return pe(n,{code:te.invalid_type,expected:de.null,received:n.parsedType}),Oe}return or(e.data)}}Ia.create=t=>new Ia({typeName:Se.ZodNull,...Pe(t)});class so extends ke{constructor(){super(...arguments),this._any=!0}_parse(e){return or(e.data)}}so.create=t=>new so({typeName:Se.ZodAny,...Pe(t)});class ti extends ke{constructor(){super(...arguments),this._unknown=!0}_parse(e){return or(e.data)}}ti.create=t=>new ti({typeName:Se.ZodUnknown,...Pe(t)});class es extends ke{_parse(e){const r=this._getOrReturnCtx(e);return pe(r,{code:te.invalid_type,expected:de.never,received:r.parsedType}),Oe}}es.create=t=>new es({typeName:Se.ZodNever,...Pe(t)});class gl extends ke{_parse(e){if(this._getType(e)!==de.undefined){const n=this._getOrReturnCtx(e);return pe(n,{code:te.invalid_type,expected:de.void,received:n.parsedType}),Oe}return or(e.data)}}gl.create=t=>new gl({typeName:Se.ZodVoid,...Pe(t)});class dn extends ke{_parse(e){const{ctx:r,status:n}=this._processInputParams(e),s=this._def;if(r.parsedType!==de.array)return pe(r,{code:te.invalid_type,expected:de.array,received:r.parsedType}),Oe;if(s.exactLength!==null){const o=r.data.length>s.exactLength.value,a=r.data.length<s.exactLength.value;(o||a)&&(pe(r,{code:o?te.too_big:te.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(pe(r,{code:te.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(pe(r,{code:te.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((o,a)=>s.type._parseAsync(new xn(r,o,r.path,a)))).then(o=>er.mergeArray(n,o));const i=[...r.data].map((o,a)=>s.type._parseSync(new xn(r,o,r.path,a)));return er.mergeArray(n,i)}get element(){return this._def.type}min(e,r){return new dn({...this._def,minLength:{value:e,message:_e.toString(r)}})}max(e,r){return new dn({...this._def,maxLength:{value:e,message:_e.toString(r)}})}length(e,r){return new dn({...this._def,exactLength:{value:e,message:_e.toString(r)}})}nonempty(e){return this.min(1,e)}}dn.create=(t,e)=>new dn({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Se.ZodArray,...Pe(e)});function Wi(t){if(t instanceof yt){const e={};for(const r in t.shape){const n=t.shape[r];e[r]=Zn.create(Wi(n))}return new yt({...t._def,shape:()=>e})}else return t instanceof dn?new dn({...t._def,type:Wi(t.element)}):t instanceof Zn?Zn.create(Wi(t.unwrap())):t instanceof hi?hi.create(Wi(t.unwrap())):t instanceof On?On.create(t.items.map(e=>Wi(e))):t}class yt extends ke{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=Ve.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==de.object){const l=this._getOrReturnCtx(e);return pe(l,{code:te.invalid_type,expected:de.object,received:l.parsedType}),Oe}const{status:n,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof es&&this._def.unknownKeys==="strip"))for(const l in s.data)o.includes(l)||a.push(l);const c=[];for(const l of o){const u=i[l],d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new xn(s,d,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof es){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of a)c.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(l==="strict")a.length>0&&(pe(s,{code:te.unrecognized_keys,keys:a}),n.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of a){const d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new xn(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of c){const d=await u.key;l.push({key:d,value:await u.value,alwaysSet:u.alwaysSet})}return l}).then(l=>er.mergeObjectSync(n,l)):er.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return _e.errToObj,new yt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{var s,i,o,a;const c=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,r,n).message)!==null&&o!==void 0?o:n.defaultError;return r.code==="unrecognized_keys"?{message:(a=_e.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new yt({...this._def,unknownKeys:"strip"})}passthrough(){return new yt({...this._def,unknownKeys:"passthrough"})}extend(e){return new yt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new yt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Se.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new yt({...this._def,catchall:e})}pick(e){const r={};return Ve.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new yt({...this._def,shape:()=>r})}omit(e){const r={};return Ve.objectKeys(this.shape).forEach(n=>{e[n]||(r[n]=this.shape[n])}),new yt({...this._def,shape:()=>r})}deepPartial(){return Wi(this)}partial(e){const r={};return Ve.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];e&&!e[n]?r[n]=s:r[n]=s.optional()}),new yt({...this._def,shape:()=>r})}required(e){const r={};return Ve.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])r[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Zn;)i=i._def.innerType;r[n]=i}}),new yt({...this._def,shape:()=>r})}keyof(){return Eb(Ve.objectKeys(this.shape))}}yt.create=(t,e)=>new yt({shape:()=>t,unknownKeys:"strip",catchall:es.create(),typeName:Se.ZodObject,...Pe(e)});yt.strictCreate=(t,e)=>new yt({shape:()=>t,unknownKeys:"strict",catchall:es.create(),typeName:Se.ZodObject,...Pe(e)});yt.lazycreate=(t,e)=>new yt({shape:t,unknownKeys:"strip",catchall:es.create(),typeName:Se.ZodObject,...Pe(e)});class Sa extends ke{_parse(e){const{ctx:r}=this._processInputParams(e),n=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new un(a.ctx.common.issues));return pe(r,{code:te.invalid_union,unionErrors:o}),Oe}if(r.common.async)return Promise.all(n.map(async i=>{const o={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of n){const l={...r,common:{...r.common,issues:[]},parent:null},u=c._parseSync({data:r.data,path:r.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(c=>new un(c));return pe(r,{code:te.invalid_union,unionErrors:a}),Oe}}get options(){return this._def.options}}Sa.create=(t,e)=>new Sa({options:t,typeName:Se.ZodUnion,...Pe(e)});const qc=t=>t instanceof xa?qc(t.schema):t instanceof hn?qc(t.innerType()):t instanceof Oa?[t.value]:t instanceof ks?t.options:t instanceof Ra?Object.keys(t.enum):t instanceof Pa?qc(t._def.innerType):t instanceof Aa?[void 0]:t instanceof Ia?[null]:null;class jl extends ke{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==de.object)return pe(r,{code:te.invalid_type,expected:de.object,received:r.parsedType}),Oe;const n=this.discriminator,s=r.data[n],i=this.optionsMap.get(s);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):(pe(r,{code:te.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Oe)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){const s=new Map;for(const i of r){const o=qc(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new jl({typeName:Se.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:s,...Pe(n)})}}function yh(t,e){const r=bs(t),n=bs(e);if(t===e)return{valid:!0,data:t};if(r===de.object&&n===de.object){const s=Ve.objectKeys(e),i=Ve.objectKeys(t).filter(a=>s.indexOf(a)!==-1),o={...t,...e};for(const a of i){const c=yh(t[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(r===de.array&&n===de.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],c=yh(o,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return r===de.date&&n===de.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Ta extends ke{_parse(e){const{status:r,ctx:n}=this._processInputParams(e),s=(i,o)=>{if(mh(i)||mh(o))return Oe;const a=yh(i.value,o.value);return a.valid?((wh(i)||wh(o))&&r.dirty(),{status:r.value,value:a.data}):(pe(n,{code:te.invalid_intersection_types}),Oe)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Ta.create=(t,e,r)=>new Ta({left:t,right:e,typeName:Se.ZodIntersection,...Pe(r)});class On extends ke{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==de.array)return pe(n,{code:te.invalid_type,expected:de.array,received:n.parsedType}),Oe;if(n.data.length<this._def.items.length)return pe(n,{code:te.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Oe;!this._def.rest&&n.data.length>this._def.items.length&&(pe(n,{code:te.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...n.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new xn(n,o,n.path,a)):null}).filter(o=>!!o);return n.common.async?Promise.all(i).then(o=>er.mergeArray(r,o)):er.mergeArray(r,i)}get items(){return this._def.items}rest(e){return new On({...this._def,rest:e})}}On.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new On({items:t,typeName:Se.ZodTuple,rest:null,...Pe(e)})};class Na extends ke{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==de.object)return pe(n,{code:te.invalid_type,expected:de.object,received:n.parsedType}),Oe;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in n.data)s.push({key:i._parse(new xn(n,a,n.path,a)),value:o._parse(new xn(n,n.data[a],n.path,a))});return n.common.async?er.mergeObjectAsync(r,s):er.mergeObjectSync(r,s)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof ke?new Na({keyType:e,valueType:r,typeName:Se.ZodRecord,...Pe(n)}):new Na({keyType:cn.create(),valueType:e,typeName:Se.ZodRecord,...Pe(r)})}}class ml extends ke{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==de.map)return pe(n,{code:te.invalid_type,expected:de.map,received:n.parsedType}),Oe;const s=this._def.keyType,i=this._def.valueType,o=[...n.data.entries()].map(([a,c],l)=>({key:s._parse(new xn(n,a,n.path,[l,"key"])),value:i._parse(new xn(n,c,n.path,[l,"value"]))}));if(n.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return Oe;(l.status==="dirty"||u.status==="dirty")&&r.dirty(),a.set(l.value,u.value)}return{status:r.value,value:a}})}else{const a=new Map;for(const c of o){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return Oe;(l.status==="dirty"||u.status==="dirty")&&r.dirty(),a.set(l.value,u.value)}return{status:r.value,value:a}}}}ml.create=(t,e,r)=>new ml({valueType:e,keyType:t,typeName:Se.ZodMap,...Pe(r)});class di extends ke{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==de.set)return pe(n,{code:te.invalid_type,expected:de.set,received:n.parsedType}),Oe;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(pe(n,{code:te.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(pe(n,{code:te.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());const i=this._def.valueType;function o(c){const l=new Set;for(const u of c){if(u.status==="aborted")return Oe;u.status==="dirty"&&r.dirty(),l.add(u.value)}return{status:r.value,value:l}}const a=[...n.data.values()].map((c,l)=>i._parse(new xn(n,c,n.path,l)));return n.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,r){return new di({...this._def,minSize:{value:e,message:_e.toString(r)}})}max(e,r){return new di({...this._def,maxSize:{value:e,message:_e.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}di.create=(t,e)=>new di({valueType:t,minSize:null,maxSize:null,typeName:Se.ZodSet,...Pe(e)});class Xi extends ke{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==de.function)return pe(r,{code:te.invalid_type,expected:de.function,received:r.parsedType}),Oe;function n(a,c){return hl({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,dl(),va].filter(l=>!!l),issueData:{code:te.invalid_arguments,argumentsError:c}})}function s(a,c){return hl({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,dl(),va].filter(l=>!!l),issueData:{code:te.invalid_return_type,returnTypeError:c}})}const i={errorMap:r.common.contextualErrorMap},o=r.data;if(this._def.returns instanceof io){const a=this;return or(async function(...c){const l=new un([]),u=await a._def.args.parseAsync(c,i).catch(m=>{throw l.addIssue(n(c,m)),l}),d=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(d,i).catch(m=>{throw l.addIssue(s(d,m)),l})})}else{const a=this;return or(function(...c){const l=a._def.args.safeParse(c,i);if(!l.success)throw new un([n(c,l.error)]);const u=Reflect.apply(o,this,l.data),d=a._def.returns.safeParse(u,i);if(!d.success)throw new un([s(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Xi({...this._def,args:On.create(e).rest(ti.create())})}returns(e){return new Xi({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new Xi({args:e||On.create([]).rest(ti.create()),returns:r||ti.create(),typeName:Se.ZodFunction,...Pe(n)})}}class xa extends ke{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}xa.create=(t,e)=>new xa({getter:t,typeName:Se.ZodLazy,...Pe(e)});class Oa extends ke{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return pe(r,{received:r.data,code:te.invalid_literal,expected:this._def.value}),Oe}return{status:"valid",value:e.data}}get value(){return this._def.value}}Oa.create=(t,e)=>new Oa({value:t,typeName:Se.ZodLiteral,...Pe(e)});function Eb(t,e){return new ks({values:t,typeName:Se.ZodEnum,...Pe(e)})}class ks extends ke{_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),n=this._def.values;return pe(r,{expected:Ve.joinValues(n),received:r.parsedType,code:te.invalid_type}),Oe}if(this._def.values.indexOf(e.data)===-1){const r=this._getOrReturnCtx(e),n=this._def.values;return pe(r,{received:r.data,code:te.invalid_enum_value,options:n}),Oe}return or(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e){return ks.create(e)}exclude(e){return ks.create(this.options.filter(r=>!e.includes(r)))}}ks.create=Eb;class Ra extends ke{_parse(e){const r=Ve.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==de.string&&n.parsedType!==de.number){const s=Ve.objectValues(r);return pe(n,{expected:Ve.joinValues(s),received:n.parsedType,code:te.invalid_type}),Oe}if(r.indexOf(e.data)===-1){const s=Ve.objectValues(r);return pe(n,{received:n.data,code:te.invalid_enum_value,options:s}),Oe}return or(e.data)}get enum(){return this._def.values}}Ra.create=(t,e)=>new Ra({values:t,typeName:Se.ZodNativeEnum,...Pe(e)});class io extends ke{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==de.promise&&r.common.async===!1)return pe(r,{code:te.invalid_type,expected:de.promise,received:r.parsedType}),Oe;const n=r.parsedType===de.promise?r.data:Promise.resolve(r.data);return or(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}io.create=(t,e)=>new io({type:t,typeName:Se.ZodPromise,...Pe(e)});class hn extends ke{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Se.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:n}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{pe(n,o),o.fatal?r.abort():r.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(n.data,i);return n.common.issues.length?{status:"dirty",value:n.data}:n.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:n.path,parent:n})):this._def.schema._parseSync({data:o,path:n.path,parent:n})}if(s.type==="refinement"){const o=a=>{const c=s.refinement(a,i);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?Oe:(a.status==="dirty"&&r.dirty(),o(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?Oe:(a.status==="dirty"&&r.dirty(),o(a.value).then(()=>({status:r.value,value:a.value}))))}if(s.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!_a(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>_a(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:r.value,value:a})):o);Ve.assertNever(s)}}hn.create=(t,e,r)=>new hn({schema:t,typeName:Se.ZodEffects,effect:e,...Pe(r)});hn.createWithPreprocess=(t,e,r)=>new hn({schema:e,effect:{type:"preprocess",transform:t},typeName:Se.ZodEffects,...Pe(r)});class Zn extends ke{_parse(e){return this._getType(e)===de.undefined?or(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Zn.create=(t,e)=>new Zn({innerType:t,typeName:Se.ZodOptional,...Pe(e)});class hi extends ke{_parse(e){return this._getType(e)===de.null?or(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}hi.create=(t,e)=>new hi({innerType:t,typeName:Se.ZodNullable,...Pe(e)});class Pa extends ke{_parse(e){const{ctx:r}=this._processInputParams(e);let n=r.data;return r.parsedType===de.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}Pa.create=(t,e)=>new Pa({innerType:t,typeName:Se.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Pe(e)});class wl extends ke{_parse(e){const{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return fl(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new un(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new un(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}wl.create=(t,e)=>new wl({innerType:t,typeName:Se.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Pe(e)});class yl extends ke{_parse(e){if(this._getType(e)!==de.nan){const n=this._getOrReturnCtx(e);return pe(n,{code:te.invalid_type,expected:de.nan,received:n.parsedType}),Oe}return{status:"valid",value:e.data}}}yl.create=t=>new yl({typeName:Se.ZodNaN,...Pe(t)});const T$=Symbol("zod_brand");class vb extends ke{_parse(e){const{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class ec extends ke{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Oe:i.status==="dirty"?(r.dirty(),bb(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?Oe:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,r){return new ec({in:e,out:r,typeName:Se.ZodPipeline})}}class bl extends ke{_parse(e){const r=this._def.innerType._parse(e);return _a(r)&&(r.value=Object.freeze(r.value)),r}}bl.create=(t,e)=>new bl({innerType:t,typeName:Se.ZodReadonly,...Pe(e)});const _b=(t,e={},r)=>t?so.create().superRefine((n,s)=>{var i,o;if(!t(n)){const a=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,c=(o=(i=a.fatal)!==null&&i!==void 0?i:r)!==null&&o!==void 0?o:!0,l=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...l,fatal:c})}}):so.create(),N$={object:yt.lazycreate};var Se;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Se||(Se={}));const x$=(t,e={message:`Input not instance of ${t.name}`})=>_b(r=>r instanceof t,e),Cb=cn.create,Ab=Ps.create,O$=yl.create,R$=Ds.create,Ib=Ca.create,P$=ui.create,D$=pl.create,k$=Aa.create,U$=Ia.create,$$=so.create,B$=ti.create,L$=es.create,M$=gl.create,F$=dn.create,j$=yt.create,q$=yt.strictCreate,H$=Sa.create,W$=jl.create,z$=Ta.create,V$=On.create,K$=Na.create,G$=ml.create,Y$=di.create,Z$=Xi.create,J$=xa.create,X$=Oa.create,Q$=ks.create,e5=Ra.create,t5=io.create,Hm=hn.create,r5=Zn.create,n5=hi.create,s5=hn.createWithPreprocess,i5=ec.create,o5=()=>Cb().optional(),a5=()=>Ab().optional(),c5=()=>Ib().optional(),l5={string:t=>cn.create({...t,coerce:!0}),number:t=>Ps.create({...t,coerce:!0}),boolean:t=>Ca.create({...t,coerce:!0}),bigint:t=>Ds.create({...t,coerce:!0}),date:t=>ui.create({...t,coerce:!0})},u5=Oe;var T=Object.freeze({__proto__:null,defaultErrorMap:va,setErrorMap:p$,getErrorMap:dl,makeIssue:hl,EMPTY_PATH:g$,addIssueToContext:pe,ParseStatus:er,INVALID:Oe,DIRTY:bb,OK:or,isAborted:mh,isDirty:wh,isValid:_a,isAsync:fl,get util(){return Ve},get objectUtil(){return gh},ZodParsedType:de,getParsedType:bs,ZodType:ke,ZodString:cn,ZodNumber:Ps,ZodBigInt:Ds,ZodBoolean:Ca,ZodDate:ui,ZodSymbol:pl,ZodUndefined:Aa,ZodNull:Ia,ZodAny:so,ZodUnknown:ti,ZodNever:es,ZodVoid:gl,ZodArray:dn,ZodObject:yt,ZodUnion:Sa,ZodDiscriminatedUnion:jl,ZodIntersection:Ta,ZodTuple:On,ZodRecord:Na,ZodMap:ml,ZodSet:di,ZodFunction:Xi,ZodLazy:xa,ZodLiteral:Oa,ZodEnum:ks,ZodNativeEnum:Ra,ZodPromise:io,ZodEffects:hn,ZodTransformer:hn,ZodOptional:Zn,ZodNullable:hi,ZodDefault:Pa,ZodCatch:wl,ZodNaN:yl,BRAND:T$,ZodBranded:vb,ZodPipeline:ec,ZodReadonly:bl,custom:_b,Schema:ke,ZodSchema:ke,late:N$,get ZodFirstPartyTypeKind(){return Se},coerce:l5,any:$$,array:F$,bigint:R$,boolean:Ib,date:P$,discriminatedUnion:W$,effect:Hm,enum:Q$,function:Z$,instanceof:x$,intersection:z$,lazy:J$,literal:X$,map:G$,nan:O$,nativeEnum:e5,never:L$,null:U$,nullable:n5,number:Ab,object:j$,oboolean:c5,onumber:a5,optional:r5,ostring:o5,pipeline:i5,preprocess:s5,promise:t5,record:K$,set:Y$,strictObject:q$,string:Cb,symbol:D$,transformer:Hm,tuple:V$,undefined:k$,union:H$,unknown:B$,void:M$,NEVER:u5,ZodIssueCode:te,quotelessJson:f$,ZodError:un});const vt=T.object({message:T.string()});function he(t){return T.literal(ge[t])}T.object({accessList:T.array(T.string()),blockHash:T.string().nullable(),blockNumber:T.string().nullable(),chainId:T.string().or(T.number()),from:T.string(),gas:T.string(),hash:T.string(),input:T.string().nullable(),maxFeePerGas:T.string(),maxPriorityFeePerGas:T.string(),nonce:T.string(),r:T.string(),s:T.string(),to:T.string(),transactionIndex:T.string().nullable(),type:T.string(),v:T.string(),value:T.string()});const d5=T.object({chainId:T.string().or(T.number())}),h5=T.object({email:T.string().email()}),f5=T.object({otp:T.string()}),p5=T.object({uri:T.string(),preferredAccountType:T.optional(T.string()),chainId:T.optional(T.string().or(T.number()))}),g5=T.object({chainId:T.optional(T.string().or(T.number())),preferredAccountType:T.optional(T.string()),socialUri:T.optional(T.string())}),m5=T.object({provider:T.enum(["google","github","apple","facebook","x","discord"])}),w5=T.object({email:T.string().email()}),y5=T.object({otp:T.string()}),b5=T.object({otp:T.string()}),E5=T.object({themeMode:T.optional(T.enum(["light","dark"])),themeVariables:T.optional(T.record(T.string(),T.string().or(T.number()))),w3mThemeVariables:T.optional(T.record(T.string(),T.string()))}),v5=T.object({metadata:T.object({name:T.string(),description:T.string(),url:T.string(),icons:T.array(T.string())}).optional(),sdkVersion:T.string().optional(),sdkType:T.string().optional(),projectId:T.string()}),_5=T.object({type:T.string()}),C5=T.object({action:T.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),A5=T.object({url:T.string()}),I5=T.object({userName:T.string()}),S5=T.object({email:T.string().optional().nullable(),address:T.string(),chainId:T.string().or(T.number()),accounts:T.array(T.object({address:T.string(),type:T.enum([At.ACCOUNT_TYPES.EOA,At.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:T.string().optional().nullable(),preferredAccountType:T.optional(T.string())}),T5=T.object({action:T.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),N5=T.object({email:T.string().email().optional().nullable(),address:T.string(),chainId:T.string().or(T.number()),smartAccountDeployed:T.optional(T.boolean()),accounts:T.array(T.object({address:T.string(),type:T.enum([At.ACCOUNT_TYPES.EOA,At.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:T.optional(T.string())}),x5=T.object({uri:T.string()}),O5=T.object({isConnected:T.boolean()}),R5=T.object({chainId:T.string().or(T.number())}),P5=T.object({chainId:T.string().or(T.number())}),D5=T.object({newEmail:T.string().email()}),k5=T.object({smartAccountEnabledNetworks:T.array(T.number())});T.object({address:T.string(),isDeployed:T.boolean()});const U5=T.object({version:T.string().optional()}),$5=T.object({type:T.string(),address:T.string()}),B5=T.any(),L5=T.object({method:T.literal("eth_accounts")}),M5=T.object({method:T.literal("eth_blockNumber")}),F5=T.object({method:T.literal("eth_call"),params:T.array(T.any())}),j5=T.object({method:T.literal("eth_chainId")}),q5=T.object({method:T.literal("eth_estimateGas"),params:T.array(T.any())}),H5=T.object({method:T.literal("eth_feeHistory"),params:T.array(T.any())}),W5=T.object({method:T.literal("eth_gasPrice")}),z5=T.object({method:T.literal("eth_getAccount"),params:T.array(T.any())}),V5=T.object({method:T.literal("eth_getBalance"),params:T.array(T.any())}),K5=T.object({method:T.literal("eth_getBlockByHash"),params:T.array(T.any())}),G5=T.object({method:T.literal("eth_getBlockByNumber"),params:T.array(T.any())}),Y5=T.object({method:T.literal("eth_getBlockReceipts"),params:T.array(T.any())}),Z5=T.object({method:T.literal("eth_getBlockTransactionCountByHash"),params:T.array(T.any())}),J5=T.object({method:T.literal("eth_getBlockTransactionCountByNumber"),params:T.array(T.any())}),X5=T.object({method:T.literal("eth_getCode"),params:T.array(T.any())}),Q5=T.object({method:T.literal("eth_getFilterChanges"),params:T.array(T.any())}),e4=T.object({method:T.literal("eth_getFilterLogs"),params:T.array(T.any())}),t4=T.object({method:T.literal("eth_getLogs"),params:T.array(T.any())}),r4=T.object({method:T.literal("eth_getProof"),params:T.array(T.any())}),n4=T.object({method:T.literal("eth_getStorageAt"),params:T.array(T.any())}),s4=T.object({method:T.literal("eth_getTransactionByBlockHashAndIndex"),params:T.array(T.any())}),i4=T.object({method:T.literal("eth_getTransactionByBlockNumberAndIndex"),params:T.array(T.any())}),o4=T.object({method:T.literal("eth_getTransactionByHash"),params:T.array(T.any())}),a4=T.object({method:T.literal("eth_getTransactionCount"),params:T.array(T.any())}),c4=T.object({method:T.literal("eth_getTransactionReceipt"),params:T.array(T.any())}),l4=T.object({method:T.literal("eth_getUncleCountByBlockHash"),params:T.array(T.any())}),u4=T.object({method:T.literal("eth_getUncleCountByBlockNumber"),params:T.array(T.any())}),d4=T.object({method:T.literal("eth_maxPriorityFeePerGas")}),h4=T.object({method:T.literal("eth_newBlockFilter")}),f4=T.object({method:T.literal("eth_newFilter"),params:T.array(T.any())}),p4=T.object({method:T.literal("eth_newPendingTransactionFilter")}),g4=T.object({method:T.literal("eth_sendRawTransaction"),params:T.array(T.any())}),m4=T.object({method:T.literal("eth_syncing"),params:T.array(T.any())}),w4=T.object({method:T.literal("eth_uninstallFilter"),params:T.array(T.any())}),Wm=T.object({method:T.literal("personal_sign"),params:T.array(T.any())}),y4=T.object({method:T.literal("eth_signTypedData_v4"),params:T.array(T.any())}),b4=T.object({method:T.literal("eth_sendTransaction"),params:T.array(T.any())}),E4=T.object({method:T.literal("solana_signMessage"),params:T.object({message:T.string(),pubkey:T.string()})}),v4=T.object({method:T.literal("solana_signTransaction"),params:T.object({transaction:T.string()})}),_4=T.object({method:T.literal("solana_signAllTransactions"),params:T.object({transactions:T.array(T.string())})}),C4=T.object({method:T.literal("solana_signAndSendTransaction"),params:T.object({transaction:T.string(),options:T.object({skipPreflight:T.boolean().optional(),preflightCommitment:T.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:T.number().optional(),minContextSlot:T.number().optional()}).optional()})}),A4=T.object({method:T.literal("wallet_sendCalls"),params:T.array(T.object({chainId:T.string().or(T.number()).optional(),from:T.string().optional(),version:T.string().optional(),capabilities:T.any().optional(),calls:T.array(T.object({to:T.string().startsWith("0x"),data:T.string().startsWith("0x").optional(),value:T.string().optional()}))}))}),I4=T.object({method:T.literal("wallet_getCallsStatus"),params:T.array(T.string())}),S4=T.object({method:T.literal("wallet_getCapabilities")}),T4=T.object({method:T.literal("wallet_grantPermissions"),params:T.array(T.any())}),N4=T.object({method:T.literal("wallet_revokePermissions"),params:T.any()}),x4=T.object({method:T.literal("wallet_getAssets"),params:T.any()}),zm=T.object({token:T.string()}),fe=T.object({id:T.string().optional()}),Bo={appEvent:fe.extend({type:he("APP_SWITCH_NETWORK"),payload:d5}).or(fe.extend({type:he("APP_CONNECT_EMAIL"),payload:h5})).or(fe.extend({type:he("APP_CONNECT_DEVICE")})).or(fe.extend({type:he("APP_CONNECT_OTP"),payload:f5})).or(fe.extend({type:he("APP_CONNECT_SOCIAL"),payload:p5})).or(fe.extend({type:he("APP_GET_FARCASTER_URI")})).or(fe.extend({type:he("APP_CONNECT_FARCASTER")})).or(fe.extend({type:he("APP_GET_USER"),payload:T.optional(g5)})).or(fe.extend({type:he("APP_GET_SOCIAL_REDIRECT_URI"),payload:m5})).or(fe.extend({type:he("APP_SIGN_OUT")})).or(fe.extend({type:he("APP_IS_CONNECTED"),payload:T.optional(zm)})).or(fe.extend({type:he("APP_GET_CHAIN_ID")})).or(fe.extend({type:he("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(fe.extend({type:he("APP_INIT_SMART_ACCOUNT")})).or(fe.extend({type:he("APP_SET_PREFERRED_ACCOUNT"),payload:_5})).or(fe.extend({type:he("APP_RPC_REQUEST"),payload:Wm.or(x4).or(L5).or(M5).or(F5).or(j5).or(q5).or(H5).or(W5).or(z5).or(V5).or(K5).or(G5).or(Y5).or(Z5).or(J5).or(X5).or(Q5).or(e4).or(t4).or(r4).or(n4).or(s4).or(i4).or(o4).or(a4).or(c4).or(l4).or(u4).or(d4).or(h4).or(f4).or(p4).or(g4).or(m4).or(w4).or(Wm).or(y4).or(b4).or(E4).or(v4).or(_4).or(C4).or(I4).or(A4).or(S4).or(T4).or(N4)})).or(fe.extend({type:he("APP_UPDATE_EMAIL"),payload:w5})).or(fe.extend({type:he("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:y5})).or(fe.extend({type:he("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:b5})).or(fe.extend({type:he("APP_SYNC_THEME"),payload:E5})).or(fe.extend({type:he("APP_SYNC_DAPP_DATA"),payload:v5})).or(fe.extend({type:he("APP_RELOAD")})),frameEvent:fe.extend({type:he("FRAME_SWITCH_NETWORK_ERROR"),payload:vt}).or(fe.extend({type:he("FRAME_SWITCH_NETWORK_SUCCESS"),payload:P5})).or(fe.extend({type:he("FRAME_CONNECT_EMAIL_SUCCESS"),payload:C5})).or(fe.extend({type:he("FRAME_CONNECT_EMAIL_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:A5})).or(fe.extend({type:he("FRAME_GET_FARCASTER_URI_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:I5})).or(fe.extend({type:he("FRAME_CONNECT_FARCASTER_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_CONNECT_OTP_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_CONNECT_OTP_SUCCESS")})).or(fe.extend({type:he("FRAME_CONNECT_DEVICE_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_CONNECT_DEVICE_SUCCESS")})).or(fe.extend({type:he("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:S5})).or(fe.extend({type:he("FRAME_CONNECT_SOCIAL_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_GET_USER_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_GET_USER_SUCCESS"),payload:N5})).or(fe.extend({type:he("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:x5})).or(fe.extend({type:he("FRAME_SIGN_OUT_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_SIGN_OUT_SUCCESS")})).or(fe.extend({type:he("FRAME_IS_CONNECTED_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_IS_CONNECTED_SUCCESS"),payload:O5})).or(fe.extend({type:he("FRAME_GET_CHAIN_ID_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_GET_CHAIN_ID_SUCCESS"),payload:R5})).or(fe.extend({type:he("FRAME_RPC_REQUEST_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_RPC_REQUEST_SUCCESS"),payload:B5})).or(fe.extend({type:he("FRAME_SESSION_UPDATE"),payload:zm})).or(fe.extend({type:he("FRAME_UPDATE_EMAIL_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_UPDATE_EMAIL_SUCCESS"),payload:T5})).or(fe.extend({type:he("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(fe.extend({type:he("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:D5})).or(fe.extend({type:he("FRAME_SYNC_THEME_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_SYNC_THEME_SUCCESS")})).or(fe.extend({type:he("FRAME_SYNC_DAPP_DATA_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(fe.extend({type:he("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:k5})).or(fe.extend({type:he("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:$5})).or(fe.extend({type:he("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_READY"),payload:U5})).or(fe.extend({type:he("FRAME_RELOAD_ERROR"),payload:vt})).or(fe.extend({type:he("FRAME_RELOAD_SUCCESS")}))};function od(t,e={}){var r;return typeof(e==null?void 0:e.type)=="string"&&((r=e==null?void 0:e.type)==null?void 0:r.includes(t))}class O4{constructor({projectId:e,isAppClient:r=!1,chainId:n="eip155:1",enableLogger:s=!0}){if(this.iframe=null,this.iframeIsReady=!1,this.rpcUrl=G.BLOCKCHAIN_API_RPC_URL,this.initFrame=()=>{const i=document.getElementById("w3m-iframe");this.iframe&&!i&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(i,o,a)=>{function c({data:l}){if(!od(ge.FRAME_EVENT_KEY,l))return;const u=Bo.frameEvent.parse(l);u.id===i&&(o(u),window.removeEventListener("message",c))}kr.isClient&&(window.addEventListener("message",c),a.addEventListener("abort",()=>{window.removeEventListener("message",c)}))},onFrameEvent:i=>{kr.isClient&&window.addEventListener("message",({data:o})=>{if(!od(ge.FRAME_EVENT_KEY,o))return;const a=Bo.frameEvent.parse(o);i(a)})},onAppEvent:i=>{kr.isClient&&window.addEventListener("message",({data:o})=>{if(!od(ge.APP_EVENT_KEY,o))return;const a=Bo.appEvent.parse(o);i(a)})},postAppEvent:i=>{var o;if(kr.isClient){if(!((o=this.iframe)!=null&&o.contentWindow))throw new Error("W3mFrame: iframe is not set");Bo.appEvent.parse(i),this.iframe.contentWindow.postMessage(i,"*")}},postFrameEvent:i=>{if(kr.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");Bo.frameEvent.parse(i),parent.postMessage(i,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((i,o)=>{this.frameLoadPromiseResolver={resolve:i,reject:o}}),r&&(this.frameLoadPromise=new Promise((i,o)=>{this.frameLoadPromiseResolver={resolve:i,reject:o}}),kr.isClient)){const i=document.createElement("iframe");i.id="w3m-iframe",i.src=`${sv}?projectId=${e}&chainId=${n}&version=${ov}&enableLogger=${s}`,i.name="w3m-secure-iframe",i.style.position="fixed",i.style.zIndex="999999",i.style.display="none",i.style.border="none",i.style.animationDelay="0s, 50ms",i.style.borderBottomLeftRadius="clamp(0px, var(--wui-border-radius-l), 44px)",i.style.borderBottomRightRadius="clamp(0px, var(--wui-border-radius-l), 44px)",this.iframe=i,this.iframe.onerror=()=>{var o;(o=this.frameLoadPromiseResolver)==null||o.reject("Unable to load email login dependency")},this.events.onFrameEvent(o=>{var a;o.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,(a=this.frameLoadPromiseResolver)==null||a.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(r=>({[r]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${r}&projectId=${this.projectId}`,chainId:r}}));return Object.assign({},...e)}}class R4{constructor(e){var i;const r=co({level:iv}),{logger:n,chunkLoggerController:s}=Ah({opts:r});this.logger=tr(n,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&((i=this.chunkLoggerController)!=null&&i.downloadLogsBlobInBrowser)&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{var o;(o=this.chunkLoggerController)!=null&&o.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class P4{constructor({projectId:e,chainId:r,enableLogger:n=!0,onTimeout:s,abortController:i}){this.openRpcRequests=[],this.isInitialized=!1,n&&(this.w3mLogger=new R4(e)),this.abortController=i,this.w3mFrame=new O4({projectId:e,isAppClient:!0,chainId:r,enableLogger:n}),this.onTimeout=s,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(r=>{r.type===ge.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,this.isInitialized=!0,this.initPromise=void 0}async init(){if(!this.isInitialized){if(this.initPromise){await this.initPromise;return}await this.createFrame()}}getLoginEmailUsed(){return!!zt.get(ge.EMAIL_LOGIN_USED_KEY)}getEmail(){return zt.get(ge.EMAIL)}getUsername(){return zt.get(ge.SOCIAL_USERNAME)}async reload(){var e;try{await this.appEvent({type:ge.APP_RELOAD})}catch(r){throw(e=this.w3mLogger)==null||e.logger.error({error:r},"Error reloading iframe"),r}}async connectEmail(e){var r;try{kr.checkIfAllowedToTriggerEmail(),await this.init();const n=await this.appEvent({type:ge.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error connecting email"),n}}async connectDevice(){var e;try{return this.appEvent({type:ge.APP_CONNECT_DEVICE})}catch(r){throw(e=this.w3mLogger)==null||e.logger.error({error:r},"Error connecting device"),r}}async connectOtp(e){var r;try{return this.appEvent({type:ge.APP_CONNECT_OTP,payload:e})}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error connecting otp"),n}}async isConnected(){var e;try{if(!this.getLoginEmailUsed())return{isConnected:!1};const r=await this.appEvent({type:ge.APP_IS_CONNECTED});return r!=null&&r.isConnected||this.deleteAuthLoginCache(),r}catch(r){throw this.deleteAuthLoginCache(),(e=this.w3mLogger)==null||e.logger.error({error:r},"Error checking connection"),r}}async getChainId(){var e;try{const r=await this.appEvent({type:ge.APP_GET_CHAIN_ID});return this.setLastUsedChainId(r.chainId),r}catch(r){throw(e=this.w3mLogger)==null||e.logger.error({error:r},"Error getting chain id"),r}}async getSocialRedirectUri(e){var r;try{return await this.init(),this.appEvent({type:ge.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error getting social redirect uri"),n}}async updateEmail(e){var r;try{const n=await this.appEvent({type:ge.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error updating email"),n}}async updateEmailPrimaryOtp(e){var r;try{return this.appEvent({type:ge.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error updating email primary otp"),n}}async updateEmailSecondaryOtp(e){var r;try{const n=await this.appEvent({type:ge.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(n.newEmail),n}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error updating email secondary otp"),n}}async syncTheme(e){var r;try{return this.appEvent({type:ge.APP_SYNC_THEME,payload:e})}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error syncing theme"),n}}async syncDappData(e){var r;try{return this.appEvent({type:ge.APP_SYNC_DAPP_DATA,payload:e})}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error syncing dapp data"),n}}async getSmartAccountEnabledNetworks(){var e;try{const r=await this.appEvent({type:ge.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(r.smartAccountEnabledNetworks),r}catch(r){throw this.persistSmartAccountEnabledNetworks([]),(e=this.w3mLogger)==null||e.logger.error({error:r},"Error getting smart account enabled networks"),r}}async setPreferredAccount(e){var r;try{return this.appEvent({type:ge.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error setting preferred account"),n}}async connect(e){var r,n;if(e!=null&&e.socialUri)try{await this.init();const s=await this.appEvent({type:ge.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType,chainId:e.chainId}});return s.userName&&this.setSocialLoginSuccess(s.userName),this.setLoginSuccess(s.email),this.setLastUsedChainId(s.chainId),this.user=s,s}catch(s){throw(r=this.w3mLogger)==null||r.logger.error({error:s},"Error connecting social"),s}else try{const s=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,i=await this.getUser({chainId:s,preferredAccountType:e==null?void 0:e.preferredAccountType});return this.setLoginSuccess(i.email),this.setLastUsedChainId(i.chainId),this.user=i,i}catch(s){throw(n=this.w3mLogger)==null||n.logger.error({error:s},"Error connecting"),s}}async getUser(e){var r;try{await this.init();const n=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,s=await this.appEvent({type:ge.APP_GET_USER,payload:{...e,chainId:n}});return this.user=s,s}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error connecting"),n}}async connectSocial(e){var r;try{await this.init();const n=await this.appEvent({type:ge.APP_CONNECT_SOCIAL,payload:{uri:e}});return n.userName&&this.setSocialLoginSuccess(n.userName),n}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error connecting social"),n}}async getFarcasterUri(){var e;try{return await this.init(),await this.appEvent({type:ge.APP_GET_FARCASTER_URI})}catch(r){throw(e=this.w3mLogger)==null||e.logger.error({error:r},"Error getting farcaster uri"),r}}async connectFarcaster(){var e;try{const r=await this.appEvent({type:ge.APP_CONNECT_FARCASTER});return r.userName&&this.setSocialLoginSuccess(r.userName),r}catch(r){throw(e=this.w3mLogger)==null||e.logger.error({error:r},"Error connecting farcaster"),r}}async switchNetwork(e){var r;try{const n=await this.appEvent({type:ge.APP_SWITCH_NETWORK,payload:{chainId:e}});return this.setLastUsedChainId(n.chainId),n}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error switching network"),n}}async disconnect(){var e;try{return this.deleteAuthLoginCache(),await new Promise(async n=>{const s=setTimeout(()=>{n()},3e3);await this.appEvent({type:ge.APP_SIGN_OUT}),clearTimeout(s),n()})}catch(r){throw(e=this.w3mLogger)==null||e.logger.error({error:r},"Error disconnecting"),r}}async request(e){var r,n,s,i;try{if(At.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();(r=this.rpcRequestHandler)==null||r.call(this,e);const o=await this.appEvent({type:ge.APP_RPC_REQUEST,payload:e});return(n=this.rpcSuccessHandler)==null||n.call(this,o,e),o}catch(o){throw(s=this.rpcErrorHandler)==null||s.call(this,o,e),(i=this.w3mLogger)==null||i.logger.error({error:o},"Error requesting"),o}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(r=>{r.type===ge.FRAME_IS_CONNECTED_SUCCESS&&r.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(r=>{r.type===ge.FRAME_IS_CONNECTED_ERROR&&e(),r.type===ge.FRAME_IS_CONNECTED_SUCCESS&&!r.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(r=>{r.type===ge.FRAME_GET_USER_SUCCESS&&e(r.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(r=>{r.type===ge.FRAME_CONNECT_SOCIAL_SUCCESS&&e(r.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(r=>{r.type===ge.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(r.payload):r.type===ge.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:At.ACCOUNT_TYPES.EOA})})}onGetSmartAccountEnabledNetworks(e){this.w3mFrame.events.onFrameEvent(r=>{r.type===ge.FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS?e(r.payload.smartAccountEnabledNetworks):r.type===ge.FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR&&e([])})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}rejectRpcRequests(){var e;try{this.openRpcRequests.forEach(({abortController:r,method:n})=>{At.SAFE_RPC_METHODS.includes(n)||r.abort()}),this.openRpcRequests=[]}catch(r){(e=this.w3mLogger)==null||e.logger.error({error:r},"Error aborting RPC request")}}async appEvent(e){let r,n;function s(c){return c.replace("@w3m-app/","")}const i=[ge.APP_SYNC_DAPP_DATA,ge.APP_SYNC_THEME,ge.APP_SET_PREFERRED_ACCOUNT],o=s(e.type);return!this.w3mFrame.iframeIsReady&&!i.includes(e.type)&&(n=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(n),[ge.APP_CONNECT_EMAIL,ge.APP_CONNECT_DEVICE,ge.APP_CONNECT_OTP,ge.APP_CONNECT_SOCIAL,ge.APP_GET_SOCIAL_REDIRECT_URI].map(s).includes(o)&&(r=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_request_timeout"),this.abortController.abort()},12e4)),new Promise((c,l)=>{var m,f,g;const u=Math.random().toString(36).substring(7);(g=(m=this.w3mLogger)==null?void 0:(f=m.logger).info)==null||g.call(f,{event:e,id:u},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:u});const d=new AbortController;if(o==="RPC_REQUEST"){const _=e;this.openRpcRequests=[...this.openRpcRequests,{..._.payload,abortController:d}]}d.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?l(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&l(new Error("Something went wrong"))});function h(_,I){var N,C,E;_.id===u&&((C=I==null?void 0:(N=I.logger).info)==null||C.call(N,{framEvent:_,id:u},"Received frame response"),_.type===`@w3m-frame/${o}_SUCCESS`?(r&&clearTimeout(r),n&&clearTimeout(n),"payload"in _&&c(_.payload),c(void 0)):_.type===`@w3m-frame/${o}_ERROR`&&(r&&clearTimeout(r),n&&clearTimeout(n),"payload"in _&&l(new Error(((E=_.payload)==null?void 0:E.message)||"An error occurred")),l(new Error("An error occurred"))))}this.w3mFrame.events.registerFrameEventHandler(u,_=>h(_,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){zt.set(ge.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){zt.set(ge.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&zt.set(ge.EMAIL,e),zt.set(ge.EMAIL_LOGIN_USED_KEY,"true"),zt.delete(ge.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){zt.delete(ge.EMAIL_LOGIN_USED_KEY),zt.delete(ge.EMAIL),zt.delete(ge.LAST_USED_CHAIN_KEY),zt.delete(ge.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&zt.set(ge.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=zt.get(ge.LAST_USED_CHAIN_KEY)??void 0,r=Number(e);return isNaN(r)?e:r}persistSmartAccountEnabledNetworks(e){zt.set(ge.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}}class ri{constructor(){}static getInstance({projectId:e,chainId:r,enableLogger:n,onTimeout:s,abortController:i}){return ri.instance||(ri.instance=new P4({projectId:e,chainId:r,enableLogger:n,onTimeout:s,abortController:i})),ri.instance}}function D4(){try{return le.returnOpenHref(`${G.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes")}catch{throw new Error("Could not open social popup")}}async function k4(){me.push("ConnectingFarcaster");const t=ie.getAuthConnector();if(t&&!ee.state.farcasterUrl)try{const{url:e}=await t.provider.getFarcasterUri();ee.setFarcasterUrl(e,R.state.activeChain)}catch(e){me.goBack(),pt.showError(e)}}async function U4(t){me.push("ConnectingSocial");const e=ie.getAuthConnector();let r=null;try{const n=setTimeout(()=>{throw new Error("Social login timed out. Please try again.")},45e3);if(e&&t){if(le.isTelegram()||(r=D4()),r)ee.setSocialWindow(r,R.state.activeChain);else if(!le.isTelegram())throw new Error("Could not create social popup");const{uri:s}=await e.provider.getSocialRedirectUri({provider:t});if(!s)throw r==null||r.close(),new Error("Could not fetch the social redirect uri");if(r&&(r.location.href=s),le.isTelegram()){oe.setTelegramSocialProvider(t);const i=le.formatTelegramSocialLoginUrl(s);le.openHref(i,"_top")}clearTimeout(n)}}catch(n){r==null||r.close(),pt.showError(n==null?void 0:n.message)}}async function g6(t){ee.setSocialProvider(t,R.state.activeChain),je.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:t}}),t==="farcaster"?await k4():await U4(t)}var Vm={};const $4={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:(typeof process<"u"&&typeof Vm<"u"?Vm.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}},bh={filterOutDuplicatesByRDNS(t){const e=X.state.enableEIP6963?ie.state.connectors:[],r=oe.getRecentWallets(),n=e.map(a=>{var c;return(c=a.info)==null?void 0:c.rdns}).filter(Boolean),s=r.map(a=>a.rdns).filter(Boolean),i=n.concat(s);if(i.includes("io.metamask.mobile")&&le.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return t.filter(a=>!i.includes(String(a==null?void 0:a.rdns)))},filterOutDuplicatesByIds(t){const e=ie.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),r=oe.getRecentWallets(),n=e.map(a=>a.explorerId),s=r.map(a=>a.id),i=n.concat(s);return t.filter(a=>!i.includes(a==null?void 0:a.id))},filterOutDuplicateWallets(t){const e=this.filterOutDuplicatesByRDNS(t);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(t){const{connectors:e}=ie.state,{featuredWalletIds:r}=X.state,n=e.filter(o=>o.type==="ANNOUNCED").reduce((o,a)=>{var c;return(c=a.info)!=null&&c.rdns&&(o[a.info.rdns]=!0),o},{});return t.map(o=>({...o,installed:!!o.rdns&&!!n[o.rdns??""]})).sort((o,a)=>{const c=Number(a.installed)-Number(o.installed);if(c!==0)return c;if(r!=null&&r.length){const l=r.indexOf(o.id),u=r.indexOf(a.id);if(l!==-1&&u!==-1)return l-u;if(l!==-1)return-1;if(u!==-1)return 1}return 0})},getConnectOrderMethod(t,e){var c;const r=(t==null?void 0:t.connectMethodsOrder)||((c=X.state.features)==null?void 0:c.connectMethodsOrder),n=e||ie.state.connectors;if(r)return r;const{injected:s,announced:i}=Hc.getConnectorsByType(n,ve.state.recommended,ve.state.featured),o=s.filter(Hc.showConnector),a=i.filter(Hc.showConnector);return o.length||a.length?["wallet","email","social"]:$4.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(t){const e=!!t.rdns&&ve.state.excludedWallets.some(n=>n.rdns===t.rdns),r=!!t.name&&ve.state.excludedWallets.some(n=>Ea.isLowerCaseMatch(n.name,t.name));return e||r}},Hc={getConnectorsByType(t,e,r){const{customWallets:n}=X.state,s=oe.getRecentWallets(),i=bh.filterOutDuplicateWallets(e),o=bh.filterOutDuplicateWallets(r),a=t.filter(d=>d.type==="MULTI_CHAIN"),c=t.filter(d=>d.type==="ANNOUNCED"),l=t.filter(d=>d.type==="INJECTED"),u=t.filter(d=>d.type==="EXTERNAL");return{custom:n,recent:s,external:u,multiChain:a,announced:c,injected:l,recommended:i,featured:o}},showConnector(t){var s;const e=(s=t.info)==null?void 0:s.rdns,r=!!e&&ve.state.excludedWallets.some(i=>!!i.rdns&&i.rdns===e),n=!!t.name&&ve.state.excludedWallets.some(i=>Ea.isLowerCaseMatch(i.name,t.name));return!(t.type==="INJECTED"&&(t.name==="Browser Wallet"&&(!le.isMobile()||le.isMobile()&&!e&&!ue.checkInstalled())||r||n)||(t.type==="ANNOUNCED"||t.type==="EXTERNAL")&&(r||n))},getIsConnectedWithWC(){return Array.from(R.state.chains.values()).some(r=>ie.getConnectorId(r.namespace)===G.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:t,featured:e,custom:r,recent:n,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=(l=>(l=X.state.features)==null?void 0:l.connectorTypeOrder)()??[]}){const u=Hc.getIsConnectedWithWC(),m=[{type:"walletConnect",isEnabled:X.state.enableWalletConnect&&!u},{type:"recent",isEnabled:n.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:r&&r.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:t.length>0}].filter(I=>I.isEnabled),f=new Set(m.map(I=>I.type)),g=c.filter(I=>f.has(I)).map(I=>({type:I,isEnabled:!0})),_=m.filter(({type:I})=>!g.some(({type:C})=>C===I));return Array.from(new Set([...g,..._].map(({type:I})=>I)))},getAuthName({email:t,socialUsername:e,socialProvider:r}){return e?r&&r==="discord"&&e.endsWith("0")?e.slice(0,-1):e:t.length>30?`${t.slice(0,-3)}...`:t},async fetchProviderData(t){var e,r;try{if(t.name==="Browser Wallet"&&!le.isMobile())return{accounts:[],chainId:void 0};if(t.id===G.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[n,s]=await Promise.all([(e=t.provider)==null?void 0:e.request({method:"eth_accounts"}),(r=t.provider)==null?void 0:r.request({method:"eth_chainId"}).then(i=>Number(i))]);return{accounts:n,chainId:s}}catch(n){return console.warn(`Failed to fetch provider data for ${t.name}`,n),{accounts:[],chainId:void 0}}}},m6={interpolate(t,e,r){if(t.length!==2||e.length!==2)throw new Error("inputRange and outputRange must be an array of length 2");const n=t[0]||0,s=t[1]||0,i=e[0]||0,o=e[1]||0;return r<n?i:r>s?o:(o-i)/(s-n)*(r-n)+i}};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Wc=globalThis,sf=Wc.ShadowRoot&&(Wc.ShadyCSS===void 0||Wc.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,of=Symbol(),Km=new WeakMap;let Sb=class{constructor(e,r,n){if(this._$cssResult$=!0,n!==of)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=r}get styleSheet(){let e=this.o;const r=this.t;if(sf&&e===void 0){const n=r!==void 0&&r.length===1;n&&(e=Km.get(r)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&Km.set(r,e))}return e}toString(){return this.cssText}};const qr=t=>new Sb(typeof t=="string"?t:t+"",void 0,of),Qi=(t,...e)=>{const r=t.length===1?t[0]:e.reduce((n,s,i)=>n+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[i+1],t[0]);return new Sb(r,t,of)},B4=(t,e)=>{if(sf)t.adoptedStyleSheets=e.map(r=>r instanceof CSSStyleSheet?r:r.styleSheet);else for(const r of e){const n=document.createElement("style"),s=Wc.litNonce;s!==void 0&&n.setAttribute("nonce",s),n.textContent=r.cssText,t.appendChild(n)}},Gm=sf?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let r="";for(const n of e.cssRules)r+=n.cssText;return qr(r)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:L4,defineProperty:M4,getOwnPropertyDescriptor:F4,getOwnPropertyNames:j4,getOwnPropertySymbols:q4,getPrototypeOf:H4}=Object,Ts=globalThis,Ym=Ts.trustedTypes,W4=Ym?Ym.emptyScript:"",ad=Ts.reactiveElementPolyfillSupport,na=(t,e)=>t,Eh={toAttribute(t,e){switch(e){case Boolean:t=t?W4:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let r=t;switch(e){case Boolean:r=t!==null;break;case Number:r=t===null?null:Number(t);break;case Object:case Array:try{r=JSON.parse(t)}catch{r=null}}return r}},Tb=(t,e)=>!L4(t,e),Zm={attribute:!0,type:String,converter:Eh,reflect:!1,useDefault:!1,hasChanged:Tb};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),Ts.litPropertyMetadata??(Ts.litPropertyMetadata=new WeakMap);let zi=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,r=Zm){if(r.state&&(r.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((r=Object.create(r)).wrapped=!0),this.elementProperties.set(e,r),!r.noAccessor){const n=Symbol(),s=this.getPropertyDescriptor(e,n,r);s!==void 0&&M4(this.prototype,e,s)}}static getPropertyDescriptor(e,r,n){const{get:s,set:i}=F4(this.prototype,e)??{get(){return this[r]},set(o){this[r]=o}};return{get:s,set(o){const a=s==null?void 0:s.call(this);i==null||i.call(this,o),this.requestUpdate(e,a,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Zm}static _$Ei(){if(this.hasOwnProperty(na("elementProperties")))return;const e=H4(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(na("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(na("properties"))){const r=this.properties,n=[...j4(r),...q4(r)];for(const s of n)this.createProperty(s,r[s])}const e=this[Symbol.metadata];if(e!==null){const r=litPropertyMetadata.get(e);if(r!==void 0)for(const[n,s]of r)this.elementProperties.set(n,s)}this._$Eh=new Map;for(const[r,n]of this.elementProperties){const s=this._$Eu(r,n);s!==void 0&&this._$Eh.set(s,r)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const r=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const s of n)r.unshift(Gm(s))}else e!==void 0&&r.push(Gm(e));return r}static _$Eu(e,r){const n=r.attribute;return n===!1?void 0:typeof n=="string"?n:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(r=>this.enableUpdating=r),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(r=>r(this))}addController(e){var r;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((r=e.hostConnected)==null||r.call(e))}removeController(e){var r;(r=this._$EO)==null||r.delete(e)}_$E_(){const e=new Map,r=this.constructor.elementProperties;for(const n of r.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return B4(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(r=>{var n;return(n=r.hostConnected)==null?void 0:n.call(r)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(r=>{var n;return(n=r.hostDisconnected)==null?void 0:n.call(r)})}attributeChangedCallback(e,r,n){this._$AK(e,n)}_$ET(e,r){var i;const n=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,n);if(s!==void 0&&n.reflect===!0){const o=(((i=n.converter)==null?void 0:i.toAttribute)!==void 0?n.converter:Eh).toAttribute(r,n.type);this._$Em=e,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._$Em=null}}_$AK(e,r){var i,o;const n=this.constructor,s=n._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const a=n.getPropertyOptions(s),c=typeof a.converter=="function"?{fromAttribute:a.converter}:((i=a.converter)==null?void 0:i.fromAttribute)!==void 0?a.converter:Eh;this._$Em=s,this[s]=c.fromAttribute(r,a.type)??((o=this._$Ej)==null?void 0:o.get(s))??null,this._$Em=null}}requestUpdate(e,r,n){var s;if(e!==void 0){const i=this.constructor,o=this[e];if(n??(n=i.getPropertyOptions(e)),!((n.hasChanged??Tb)(o,r)||n.useDefault&&n.reflect&&o===((s=this._$Ej)==null?void 0:s.get(e))&&!this.hasAttribute(i._$Eu(e,n))))return;this.C(e,r,n)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,r,{useDefault:n,reflect:s,wrapped:i},o){n&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,o??r??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||n||(r=void 0),this._$AL.set(e,r)),s===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(r){Promise.reject(r)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var n;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[i,o]of this._$Ep)this[i]=o;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[i,o]of s){const{wrapped:a}=o,c=this[i];a!==!0||this._$AL.has(i)||c===void 0||this.C(i,void 0,o,c)}}let e=!1;const r=this._$AL;try{e=this.shouldUpdate(r),e?(this.willUpdate(r),(n=this._$EO)==null||n.forEach(s=>{var i;return(i=s.hostUpdate)==null?void 0:i.call(s)}),this.update(r)):this._$EM()}catch(s){throw e=!1,this._$EM(),s}e&&this._$AE(r)}willUpdate(e){}_$AE(e){var r;(r=this._$EO)==null||r.forEach(n=>{var s;return(s=n.hostUpdated)==null?void 0:s.call(n)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(r=>this._$ET(r,this[r]))),this._$EM()}updated(e){}firstUpdated(e){}};zi.elementStyles=[],zi.shadowRootOptions={mode:"open"},zi[na("elementProperties")]=new Map,zi[na("finalized")]=new Map,ad==null||ad({ReactiveElement:zi}),(Ts.reactiveElementVersions??(Ts.reactiveElementVersions=[])).push("2.1.0");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const sa=globalThis,El=sa.trustedTypes,Jm=El?El.createPolicy("lit-html",{createHTML:t=>t}):void 0,Nb="$lit$",Es=`lit$${Math.random().toFixed(9).slice(2)}$`,xb="?"+Es,z4=`<${xb}>`,fi=document,Da=()=>fi.createComment(""),ka=t=>t===null||typeof t!="object"&&typeof t!="function",af=Array.isArray,V4=t=>af(t)||typeof(t==null?void 0:t[Symbol.iterator])=="function",cd=`[ 	
\f\r]`,Lo=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Xm=/-->/g,Qm=/>/g,qs=RegExp(`>|${cd}(?:([^\\s"'>=/]+)(${cd}*=${cd}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),ew=/'/g,tw=/"/g,Ob=/^(?:script|style|textarea|title)$/i,Rb=t=>(e,...r)=>({_$litType$:t,strings:e,values:r}),b6=Rb(1),E6=Rb(2),oo=Symbol.for("lit-noChange"),Mt=Symbol.for("lit-nothing"),rw=new WeakMap,Xs=fi.createTreeWalker(fi,129);function Pb(t,e){if(!af(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return Jm!==void 0?Jm.createHTML(e):e}const K4=(t,e)=>{const r=t.length-1,n=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=Lo;for(let a=0;a<r;a++){const c=t[a];let l,u,d=-1,h=0;for(;h<c.length&&(o.lastIndex=h,u=o.exec(c),u!==null);)h=o.lastIndex,o===Lo?u[1]==="!--"?o=Xm:u[1]!==void 0?o=Qm:u[2]!==void 0?(Ob.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=qs):u[3]!==void 0&&(o=qs):o===qs?u[0]===">"?(o=s??Lo,d=-1):u[1]===void 0?d=-2:(d=o.lastIndex-u[2].length,l=u[1],o=u[3]===void 0?qs:u[3]==='"'?tw:ew):o===tw||o===ew?o=qs:o===Xm||o===Qm?o=Lo:(o=qs,s=void 0);const m=o===qs&&t[a+1].startsWith("/>")?" ":"";i+=o===Lo?c+z4:d>=0?(n.push(l),c.slice(0,d)+Nb+c.slice(d)+Es+m):c+Es+(d===-2?a:m)}return[Pb(t,i+(t[r]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),n]};class Ua{constructor({strings:e,_$litType$:r},n){let s;this.parts=[];let i=0,o=0;const a=e.length-1,c=this.parts,[l,u]=K4(e,r);if(this.el=Ua.createElement(l,n),Xs.currentNode=this.el.content,r===2||r===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(s=Xs.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const d of s.getAttributeNames())if(d.endsWith(Nb)){const h=u[o++],m=s.getAttribute(d).split(Es),f=/([.?@])?(.*)/.exec(h);c.push({type:1,index:i,name:f[2],strings:m,ctor:f[1]==="."?Y4:f[1]==="?"?Z4:f[1]==="@"?J4:ql}),s.removeAttribute(d)}else d.startsWith(Es)&&(c.push({type:6,index:i}),s.removeAttribute(d));if(Ob.test(s.tagName)){const d=s.textContent.split(Es),h=d.length-1;if(h>0){s.textContent=El?El.emptyScript:"";for(let m=0;m<h;m++)s.append(d[m],Da()),Xs.nextNode(),c.push({type:2,index:++i});s.append(d[h],Da())}}}else if(s.nodeType===8)if(s.data===xb)c.push({type:2,index:i});else{let d=-1;for(;(d=s.data.indexOf(Es,d+1))!==-1;)c.push({type:7,index:i}),d+=Es.length-1}i++}}static createElement(e,r){const n=fi.createElement("template");return n.innerHTML=e,n}}function ao(t,e,r=t,n){var o,a;if(e===oo)return e;let s=n!==void 0?(o=r._$Co)==null?void 0:o[n]:r._$Cl;const i=ka(e)?void 0:e._$litDirective$;return(s==null?void 0:s.constructor)!==i&&((a=s==null?void 0:s._$AO)==null||a.call(s,!1),i===void 0?s=void 0:(s=new i(t),s._$AT(t,r,n)),n!==void 0?(r._$Co??(r._$Co=[]))[n]=s:r._$Cl=s),s!==void 0&&(e=ao(t,s._$AS(t,e.values),s,n)),e}class G4{constructor(e,r){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=r}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:r},parts:n}=this._$AD,s=((e==null?void 0:e.creationScope)??fi).importNode(r,!0);Xs.currentNode=s;let i=Xs.nextNode(),o=0,a=0,c=n[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new tc(i,i.nextSibling,this,e):c.type===1?l=new c.ctor(i,c.name,c.strings,this,e):c.type===6&&(l=new X4(i,this,e)),this._$AV.push(l),c=n[++a]}o!==(c==null?void 0:c.index)&&(i=Xs.nextNode(),o++)}return Xs.currentNode=fi,s}p(e){let r=0;for(const n of this._$AV)n!==void 0&&(n.strings!==void 0?(n._$AI(e,n,r),r+=n.strings.length-2):n._$AI(e[r])),r++}}class tc{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,r,n,s){this.type=2,this._$AH=Mt,this._$AN=void 0,this._$AA=e,this._$AB=r,this._$AM=n,this.options=s,this._$Cv=(s==null?void 0:s.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const r=this._$AM;return r!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=r.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,r=this){e=ao(this,e,r),ka(e)?e===Mt||e==null||e===""?(this._$AH!==Mt&&this._$AR(),this._$AH=Mt):e!==this._$AH&&e!==oo&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):V4(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Mt&&ka(this._$AH)?this._$AA.nextSibling.data=e:this.T(fi.createTextNode(e)),this._$AH=e}$(e){var i;const{values:r,_$litType$:n}=e,s=typeof n=="number"?this._$AC(e):(n.el===void 0&&(n.el=Ua.createElement(Pb(n.h,n.h[0]),this.options)),n);if(((i=this._$AH)==null?void 0:i._$AD)===s)this._$AH.p(r);else{const o=new G4(s,this),a=o.u(this.options);o.p(r),this.T(a),this._$AH=o}}_$AC(e){let r=rw.get(e.strings);return r===void 0&&rw.set(e.strings,r=new Ua(e)),r}k(e){af(this._$AH)||(this._$AH=[],this._$AR());const r=this._$AH;let n,s=0;for(const i of e)s===r.length?r.push(n=new tc(this.O(Da()),this.O(Da()),this,this.options)):n=r[s],n._$AI(i),s++;s<r.length&&(this._$AR(n&&n._$AB.nextSibling,s),r.length=s)}_$AR(e=this._$AA.nextSibling,r){var n;for((n=this._$AP)==null?void 0:n.call(this,!1,!0,r);e&&e!==this._$AB;){const s=e.nextSibling;e.remove(),e=s}}setConnected(e){var r;this._$AM===void 0&&(this._$Cv=e,(r=this._$AP)==null||r.call(this,e))}}class ql{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,r,n,s,i){this.type=1,this._$AH=Mt,this._$AN=void 0,this.element=e,this.name=r,this._$AM=s,this.options=i,n.length>2||n[0]!==""||n[1]!==""?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=Mt}_$AI(e,r=this,n,s){const i=this.strings;let o=!1;if(i===void 0)e=ao(this,e,r,0),o=!ka(e)||e!==this._$AH&&e!==oo,o&&(this._$AH=e);else{const a=e;let c,l;for(e=i[0],c=0;c<i.length-1;c++)l=ao(this,a[n+c],r,c),l===oo&&(l=this._$AH[c]),o||(o=!ka(l)||l!==this._$AH[c]),l===Mt?e=Mt:e!==Mt&&(e+=(l??"")+i[c+1]),this._$AH[c]=l}o&&!s&&this.j(e)}j(e){e===Mt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class Y4 extends ql{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Mt?void 0:e}}class Z4 extends ql{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Mt)}}class J4 extends ql{constructor(e,r,n,s,i){super(e,r,n,s,i),this.type=5}_$AI(e,r=this){if((e=ao(this,e,r,0)??Mt)===oo)return;const n=this._$AH,s=e===Mt&&n!==Mt||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,i=e!==Mt&&(n===Mt||s);s&&this.element.removeEventListener(this.name,this,n),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var r;typeof this._$AH=="function"?this._$AH.call(((r=this.options)==null?void 0:r.host)??this.element,e):this._$AH.handleEvent(e)}}class X4{constructor(e,r,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=r,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){ao(this,e)}}const ld=sa.litHtmlPolyfillSupport;ld==null||ld(Ua,tc),(sa.litHtmlVersions??(sa.litHtmlVersions=[])).push("3.3.0");const Q4=(t,e,r)=>{const n=(r==null?void 0:r.renderBefore)??e;let s=n._$litPart$;if(s===void 0){const i=(r==null?void 0:r.renderBefore)??null;n._$litPart$=s=new tc(e.insertBefore(Da(),i),i,void 0,r??{})}return s._$AI(t),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ni=globalThis;class zc extends zi{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var r;const e=super.createRenderRoot();return(r=this.renderOptions).renderBefore??(r.renderBefore=e.firstChild),e}update(e){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=Q4(r,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return oo}}var lw;zc._$litElement$=!0,zc.finalized=!0,(lw=ni.litElementHydrateSupport)==null||lw.call(ni,{LitElement:zc});const ud=ni.litElementPolyfillSupport;ud==null||ud({LitElement:zc});(ni.litElementVersions??(ni.litElementVersions=[])).push("4.2.0");let ia,Ns,xs;function v6(t,e){ia=document.createElement("style"),Ns=document.createElement("style"),xs=document.createElement("style"),ia.textContent=eo(t).core.cssText,Ns.textContent=eo(t).dark.cssText,xs.textContent=eo(t).light.cssText,document.head.appendChild(ia),document.head.appendChild(Ns),document.head.appendChild(xs),Db(e)}function Db(t){Ns&&xs&&(t==="light"?(Ns.removeAttribute("media"),xs.media="enabled"):(xs.removeAttribute("media"),Ns.media="enabled"))}function eB(t){ia&&Ns&&xs&&(ia.textContent=eo(t).core.cssText,Ns.textContent=eo(t).dark.cssText,xs.textContent=eo(t).light.cssText)}function eo(t){return{core:Qi`
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${qr(t!=null&&t["--w3m-color-mix-strength"]?`${t["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${qr((t==null?void 0:t["--w3m-font-family"])||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${qr((t==null?void 0:t["--w3m-font-size-master"])||"10px")};
        --w3m-border-radius-master: ${qr((t==null?void 0:t["--w3m-border-radius-master"])||"4px")};
        --w3m-z-index: ${qr((t==null?void 0:t["--w3m-z-index"])||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:Qi`
      :root {
        --w3m-color-mix: ${qr((t==null?void 0:t["--w3m-color-mix"])||"#fff")};
        --w3m-accent: ${qr(Kn(t,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${qr(Kn(t,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:Qi`
      :root {
        --w3m-color-mix: ${qr((t==null?void 0:t["--w3m-color-mix"])||"#000")};
        --w3m-accent: ${qr(Kn(t,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${qr(Kn(t,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}const _6=Qi`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,C6=Qi`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,A6=Qi`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`,nw={getSpacingStyles(t,e){if(Array.isArray(t))return t[e]?`var(--wui-spacing-${t[e]})`:void 0;if(typeof t=="string")return`var(--wui-spacing-${t})`},getFormattedDate(t){return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(t)},getHostName(t){try{return new URL(t).hostname}catch{return""}},getTruncateString({string:t,charsStart:e,charsEnd:r,truncate:n}){return t.length<=e+r?t:n==="end"?`${t.substring(0,e)}...`:n==="start"?`...${t.substring(t.length-r)}`:`${t.substring(0,Math.floor(e))}...${t.substring(t.length-Math.floor(r))}`},generateAvatarColors(t){const r=t.toLowerCase().replace(/^0x/iu,"").replace(/[^a-f0-9]/gu,"").substring(0,6).padEnd(6,"0"),n=this.hexToRgb(r),s=getComputedStyle(document.documentElement).getPropertyValue("--w3m-border-radius-master"),o=100-3*Number(s==null?void 0:s.replace("px","")),a=`${o}% ${o}% at 65% 40%`,c=[];for(let l=0;l<5;l+=1){const u=this.tintColor(n,.15*l);c.push(`rgb(${u[0]}, ${u[1]}, ${u[2]})`)}return`
    --local-color-1: ${c[0]};
    --local-color-2: ${c[1]};
    --local-color-3: ${c[2]};
    --local-color-4: ${c[3]};
    --local-color-5: ${c[4]};
    --local-radial-circle: ${a}
   `},hexToRgb(t){const e=parseInt(t,16),r=e>>16&255,n=e>>8&255,s=e&255;return[r,n,s]},tintColor(t,e){const[r,n,s]=t,i=Math.round(r+(255-r)*e),o=Math.round(n+(255-n)*e),a=Math.round(s+(255-s)*e);return[i,o,a]},isNumber(t){return{number:/^[0-9]+$/u}.number.test(t)},getColorTheme(t){var e;return t||(typeof window<"u"&&window.matchMedia&&typeof window.matchMedia=="function"?(e=window.matchMedia("(prefers-color-scheme: dark)"))!=null&&e.matches?"dark":"light":"dark")},splitBalance(t){const e=t.split(".");return e.length===2?[e[0],e[1]]:["0","00"]},roundNumber(t,e,r){return t.toString().length>=e?Number(t).toFixed(r):t},formatNumberToLocalString(t,e=2){return t===void 0?"0.00":typeof t=="number"?t.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e}):parseFloat(t).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e})}},tB=3,rB=["receive","deposit","borrow","claim"],nB=["withdraw","repay","burn"],sw={getTransactionGroupTitle(t,e){const r=_f.getYear(),n=_f.getMonthNameByIndex(e);return t===r?n:`${n} ${t}`},getTransactionImages(t){const[e,r]=t,n=!!e&&(t==null?void 0:t.every(o=>!!o.nft_info)),s=(t==null?void 0:t.length)>1;return(t==null?void 0:t.length)===2&&!n?[this.getTransactionImage(e),this.getTransactionImage(r)]:s?t.map(o=>this.getTransactionImage(o)):[this.getTransactionImage(e)]},getTransactionImage(t){return{type:sw.getTransactionTransferTokenType(t),url:sw.getTransactionImageURL(t)}},getTransactionImageURL(t){var s,i,o,a,c;let e;const r=!!(t!=null&&t.nft_info),n=!!(t!=null&&t.fungible_info);return t&&r?e=(o=(i=(s=t==null?void 0:t.nft_info)==null?void 0:s.content)==null?void 0:i.preview)==null?void 0:o.url:t&&n&&(e=(c=(a=t==null?void 0:t.fungible_info)==null?void 0:a.icon)==null?void 0:c.url),e},getTransactionTransferTokenType(t){if(t!=null&&t.fungible_info)return"FUNGIBLE";if(t!=null&&t.nft_info)return"NFT"},getTransactionDescriptions(t){var d,h,m;const e=(d=t==null?void 0:t.metadata)==null?void 0:d.operationType,r=t==null?void 0:t.transfers,n=((h=t==null?void 0:t.transfers)==null?void 0:h.length)>0,s=((m=t==null?void 0:t.transfers)==null?void 0:m.length)>1,i=n&&(r==null?void 0:r.every(f=>!!(f!=null&&f.fungible_info))),[o,a]=r;let c=this.getTransferDescription(o),l=this.getTransferDescription(a);if(!n)return(e==="send"||e==="receive")&&i?(c=nw.getTruncateString({string:t==null?void 0:t.metadata.sentFrom,charsStart:4,charsEnd:6,truncate:"middle"}),l=nw.getTruncateString({string:t==null?void 0:t.metadata.sentTo,charsStart:4,charsEnd:6,truncate:"middle"}),[c,l]):[t.metadata.status];if(s)return r.map(f=>this.getTransferDescription(f));let u="";return rB.includes(e)?u="+":nB.includes(e)&&(u="-"),c=u.concat(c),[c]},getTransferDescription(t){var r;let e="";return t&&(t!=null&&t.nft_info?e=((r=t==null?void 0:t.nft_info)==null?void 0:r.name)||"-":t!=null&&t.fungible_info&&(e=this.getFungibleTransferDescription(t)||"-")),e},getFungibleTransferDescription(t){var n;return t?[this.getQuantityFixedValue(t==null?void 0:t.quantity.numeric),(n=t==null?void 0:t.fungible_info)==null?void 0:n.symbol].join(" ").trim():null},getQuantityFixedValue(t){return t?parseFloat(t).toFixed(tB):null}};function sB(t,e){const{kind:r,elements:n}=e;return{kind:r,elements:n,finisher(s){customElements.get(t)||customElements.define(t,s)}}}function iB(t,e){return customElements.get(t)||customElements.define(t,e),e}function I6(t){return function(r){return typeof r=="function"?iB(t,r):sB(t,r)}}const Go={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]},S6=jb({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://eth.merkle.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xce01f8eee7E479C928F8919abD53E553a36CeF67",blockCreated:19258213},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}});function rc(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}const iw=rc({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),ow=rc({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});rc({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});rc({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}});rc({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});const oB={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},oa={getMethodsByChainNamespace(t){return oB[t]||[]},createDefaultNamespace(t){return{methods:this.getMethodsByChainNamespace(t),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(t,e){if(!e)return{...t};const r={...t},n=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>n.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>n.add(s)),e.events&&Object.keys(e.events).forEach(s=>n.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&n.add(i)}),n.forEach(s=>{r[s]||(r[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{r[s]&&(r[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{r[s]&&(r[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{r[s]&&(r[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!r[a]||(r[a].rpcMap||(r[a].rpcMap={}),s.has(a)||(r[a].rpcMap={},s.add(a)),r[a].rpcMap[c]=o)})}return r},createNamespaces(t,e){const r=t.reduce((n,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];n[o]||(n[o]=this.createDefaultNamespace(o));const l=`${o}:${i}`,u=n[o];switch(u.chains.push(l),l){case iw.caipNetworkId:u.chains.push(iw.deprecatedCaipNetworkId);break;case ow.caipNetworkId:u.chains.push(ow.deprecatedCaipNetworkId);break}return u!=null&&u.rpcMap&&c&&(u.rpcMap[i]=c),n},{});return this.applyNamespaceOverrides(r,e)},resolveReownName:async t=>{var n;const e=await Zo.resolveName(t);return((n=(Object.values(e==null?void 0:e.addresses)||[])[0])==null?void 0:n.address)||!1},getChainsFromNamespaces(t={}){return Object.values(t).flatMap(e=>{const r=e.chains||[],n=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...r,...n]))})},isSessionEventData(t){return typeof t=="object"&&t!==null&&"id"in t&&"topic"in t&&"params"in t&&typeof t.params=="object"&&t.params!==null&&"chainId"in t.params&&"event"in t.params&&typeof t.params.event=="object"&&t.params.event!==null},isOriginAllowed(t,e,r){for(const n of[...e,...r])if(n.includes("*")){const i=`^${n.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(i,"u").test(t))return!0}else try{if(new URL(n).origin===t)return!0}catch{if(n===t)return!0}return!1}};class cf{constructor({provider:e,namespace:r}){this.id=G.CONNECTOR_ID.WALLET_CONNECT,this.name=Cs.ConnectorNamesMap[G.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=Cs.ConnectorImageIds[G.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=R.getCaipNetworks.bind(R),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=r}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const r=this.getCaipNetworks(),n=X.state.universalProviderConfigOverride,s=oa.createNamespaces(r,n);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(r=>r.caipNetworkId);return Ji.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:aB})}}const aB=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"];class kb{constructor(e){this.availableConnectors=[],this.eventListeners=new Map,this.getCaipNetworks=r=>R.getCaipNetworks(r),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get networks(){return this.getCaipNetworks(this.namespace)}setAuthProvider(e){this.addConnector({id:G.CONNECTOR_ID.AUTH,type:"AUTH",name:G.CONNECTOR_NAMES.AUTH,provider:e,imageId:Cs.ConnectorImageIds[G.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const r=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(n=>r.has(n.id)?!1:(r.add(n.id),!0)),this.emit("connectors",this.availableConnectors)}setStatus(e,r){ee.setStatus(e,r)}on(e,r){var n;this.eventListeners.has(e)||this.eventListeners.set(e,new Set),(n=this.eventListeners.get(e))==null||n.add(r)}off(e,r){const n=this.eventListeners.get(e);n&&n.delete(r)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,r){const n=this.eventListeners.get(e);n&&n.forEach(s=>s(r))}async connectWalletConnect(e){return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}async switchNetwork(e){var i;const{caipNetwork:r,providerType:n}=e;if(!e.provider)return;const s="provider"in e.provider?e.provider.provider:e.provider;if(n==="WALLET_CONNECT"){s.setDefaultChain(r.caipNetworkId);return}if(s&&n==="AUTH"){const o=s,a=(i=ee.state.preferredAccountTypes)==null?void 0:i[r.chainNamespace];await o.switchNetwork(r.caipNetworkId);const c=await o.getUser({chainId:r.caipNetworkId,preferredAccountType:a});this.emit("switchNetwork",c)}}getWalletConnectConnector(){const e=this.connectors.find(r=>r instanceof cf);if(!e)throw new Error("WalletConnectConnector not found");return e}}class cB extends kb{setUniversalProvider(e){this.addConnector(new cf({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace}))}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect()}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}}async getAccounts({namespace:e}){var s,i,o,a;const r=this.provider,n=((a=(o=(i=(s=r==null?void 0:r.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const[,,l]=c.split(":");return l}).filter((c,l,u)=>u.indexOf(c)===l))||[];return Promise.resolve({accounts:n.map(c=>le.createAccount(e,c,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){var i,o,a,c,l;if(!(e.caipNetwork&&Ye.BALANCE_SUPPORTED_CHAINS.includes((i=e.caipNetwork)==null?void 0:i.chainNamespace))||(o=e.caipNetwork)!=null&&o.testnet)return{balance:"0.00",symbol:((a=e.caipNetwork)==null?void 0:a.nativeCurrency.symbol)||""};if(ee.state.balanceLoading&&e.chainId===((c=R.state.activeCaipNetwork)==null?void 0:c.id))return{balance:ee.state.balance||"0.00",symbol:ee.state.balanceSymbol||""};const s=(await ee.fetchTokenBalance()).find(u=>{var d,h;return u.chainId===`${(d=e.caipNetwork)==null?void 0:d.chainNamespace}:${e.chainId}`&&u.symbol===((h=e.caipNetwork)==null?void 0:h.nativeCurrency.symbol)});return{balance:(s==null?void 0:s.quantity.numeric)||"0.00",symbol:(s==null?void 0:s.symbol)||((l=e.caipNetwork)==null?void 0:l.nativeCurrency.symbol)||""}}async signMessage(e){var o,a,c;const{provider:r,message:n,address:s}=e;if(!r)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return((o=R.state.activeCaipNetwork)==null?void 0:o.chainNamespace)===G.CHAIN.SOLANA?i=(await r.request({method:"solana_signMessage",params:{message:fo.encode(new TextEncoder().encode(n)),pubkey:s}},(a=R.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)).signature:i=await r.request({method:"personal_sign",params:[n,s]},(c=R.state.activeCaipNetwork)==null?void 0:c.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){var s,i,o,a,c,l;const{caipNetwork:r}=e,n=this.getWalletConnectConnector();if(r.chainNamespace===G.CHAIN.EVM)try{await((s=n.provider)==null?void 0:s.request({method:"wallet_switchEthereumChain",params:[{chainId:df(r.id)}]}))}catch(u){if(u.code===Go.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||u.code===Go.ERROR_INVALID_CHAIN_ID||u.code===Go.ERROR_CODE_DEFAULT||((o=(i=u==null?void 0:u.data)==null?void 0:i.originalError)==null?void 0:o.code)===Go.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await((l=n.provider)==null?void 0:l.request({method:"wallet_addEthereumChain",params:[{chainId:df(r.id),rpcUrls:[(a=r==null?void 0:r.rpcUrls.chainDefault)==null?void 0:a.http],chainName:r.name,nativeCurrency:r.nativeCurrency,blockExplorerUrls:[(c=r.blockExplorers)==null?void 0:c.default.url]}]}))}catch{throw new Error("Chain is not supported")}}n.provider.setDefaultChain(r.caipNetworkId)}getWalletConnectProvider(){const e=this.connectors.find(n=>n.type==="WALLET_CONNECT");return e==null?void 0:e.provider}}const lB=["email","socials","swaps","onramp","activity","reownBranding"],xc={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return!!t.isEnabled&&e.includes("email")},processFallback:t=>t===void 0?Ye.DEFAULT_REMOTE_FEATURES.email:!!t},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e.filter(r=>r!=="email"):!1},processFallback:t=>t===void 0?Ye.DEFAULT_REMOTE_FEATURES.socials:typeof t=="boolean"?t?Ye.DEFAULT_REMOTE_FEATURES.socials:!1:t},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Ye.DEFAULT_REMOTE_FEATURES.swaps:typeof t=="boolean"?t?Ye.DEFAULT_REMOTE_FEATURES.swaps:!1:t},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Ye.DEFAULT_REMOTE_FEATURES.onramp:typeof t=="boolean"?t?Ye.DEFAULT_REMOTE_FEATURES.onramp:!1:t},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Ye.DEFAULT_REMOTE_FEATURES.activity:!!t},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Ye.DEFAULT_REMOTE_FEATURES.reownBranding:!!t}},uB={localSettingsOverridden:new Set,getApiConfig(t,e){return e==null?void 0:e.find(r=>r.id===t)},addWarning(t,e){if(t!==void 0){const r=xc[e],n=r.isLegacy?`"features.${r.localFeatureName}" (now "${e}")`:`"features.${e}"`;this.localSettingsOverridden.add(n)}},processFeature(t,e,r,n,s){const i=xc[t],o=e[i.localFeatureName];if(s&&!i.isAvailableOnBasic)return!1;if(n){const a=this.getApiConfig(i.apiFeatureName,r);return(a==null?void 0:a.config)===null?this.processFallbackFeature(t,o):a!=null&&a.config?(o!==void 0&&this.addWarning(o,t),this.processApiFeature(t,a)):!1}return this.processFallbackFeature(t,o)},processApiFeature(t,e){return xc[t].processApi(e)},processFallbackFeature(t,e){return xc[t].processFallback(e)},async fetchRemoteFeatures(t){const e=t.basic??!1,r=t.features||{};this.localSettingsOverridden.clear();let n=null,s=!1;try{n=await ve.fetchProjectConfig(),s=n!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}const i=s&&!e?Ye.DEFAULT_REMOTE_FEATURES:Ye.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of lB){const a=this.processFeature(o,r,n,s,e);Object.assign(i,{[o]:a})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),Ye.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;_t.open({shortMessage:"Local configuration ignored",longMessage:`[Reown Config Notice] ${o}`},"warning")}return i}};class dB{constructor(e){this.chainNamespaces=[],this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(r,n)=>{var s,i,o,a;if(r){const c=(i=(s=R.getNetworkData(r))==null?void 0:s.requestedCaipNetworks)==null?void 0:i.find(d=>d.id===n);if(c)return c;const l=(o=R.getNetworkData(r))==null?void 0:o.caipNetwork;return l||((a=R.getRequestedCaipNetworks(r).filter(d=>d.chainNamespace===r))==null?void 0:a[0])}return R.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const r=this.getCaipNetwork();if(r)return r.id},this.getCaipNetworks=r=>R.getCaipNetworks(r),this.getActiveChainNamespace=()=>R.state.activeChain,this.setRequestedCaipNetworks=(r,n)=>{R.setRequestedCaipNetworks(r,n)},this.getApprovedCaipNetworkIds=()=>R.getAllApprovedCaipNetworkIds(),this.getCaipAddress=r=>R.state.activeChain===r||!r?R.state.activeCaipAddress:R.getAccountProp("caipAddress",r),this.setClientId=r=>{ye.setClientId(r)},this.getProvider=r=>nt.getProvider(r),this.getProviderType=r=>nt.getProviderId(r),this.getPreferredAccountType=r=>{var n;return(n=ee.state.preferredAccountTypes)==null?void 0:n[r]},this.setCaipAddress=(r,n)=>{ee.setCaipAddress(r,n),r&&X.state.enableEmbedded&&this.close()},this.setBalance=(r,n,s)=>{ee.setBalance(r,n,s)},this.setProfileName=(r,n)=>{ee.setProfileName(r,n)},this.setProfileImage=(r,n)=>{ee.setProfileImage(r,n)},this.setUser=(r,n)=>{ee.setUser(r,n)},this.resetAccount=r=>{ee.resetAccount(r)},this.setCaipNetwork=r=>{R.setActiveCaipNetwork(r)},this.setCaipNetworkOfNamespace=(r,n)=>{R.setChainNetworkData(n,{caipNetwork:r})},this.setAllAccounts=(r,n)=>{ee.setAllAccounts(r,n),X.setHasMultipleAddresses((r==null?void 0:r.length)>1)},this.setStatus=(r,n)=>{ee.setStatus(r,n),ie.isConnected()?oe.setConnectionStatus("connected"):oe.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=r=>R.getAccountProp("address",r),this.setConnectors=r=>{const n=[...ie.state.allConnectors,...r];ie.setConnectors(n)},this.setConnections=(r,n)=>{ue.setConnections(r,n)},this.fetchIdentity=r=>ye.fetchIdentity(r),this.getReownName=r=>Zo.getNamesForAddress(r),this.getConnectors=()=>ie.getConnectors(),this.getConnectorImage=r=>ww.getConnectorImage(r),this.getConnections=r=>la.getConnectionsData(r).connections,this.getRecentConnections=r=>la.getConnectionsData(r).recentConnections,this.switchConnection=r=>ue.switchConnection(r),this.deleteConnection=r=>oe.deleteAddressFromConnection(r),this.setConnectedWalletInfo=(r,n)=>{const s=nt.getProviderId(n),i=r?{...r,type:s}:void 0;ee.setConnectedWalletInfo(i,n)},this.getIsConnectedState=()=>!!R.state.activeCaipAddress,this.addAddressLabel=(r,n,s)=>{ee.addAddressLabel(r,n,s)},this.removeAddressLabel=(r,n)=>{ee.removeAddressLabel(r,n)},this.getAddress=r=>R.state.activeChain===r||!r?ee.state.address:R.getAccountProp("address",r),this.setApprovedCaipNetworksData=r=>R.setApprovedCaipNetworksData(r),this.resetNetwork=r=>{R.resetNetwork(r)},this.addConnector=r=>{ie.addConnector(r)},this.resetWcConnection=()=>{ue.resetWcConnection()},this.setAddressExplorerUrl=(r,n)=>{ee.setAddressExplorerUrl(r,n)},this.setSmartAccountDeployed=(r,n)=>{ee.setSmartAccountDeployed(r,n)},this.setSmartAccountEnabledNetworks=(r,n)=>{R.setSmartAccountEnabledNetworks(r,n)},this.setPreferredAccountType=(r,n)=>{ee.setPreferredAccountType(r,n)},this.setEIP6963Enabled=r=>{X.setEIP6963Enabled(r)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,r){const n=e==null?void 0:e.map(i=>i.namespace).filter(i=>!!i);if(n!=null&&n.length)return[...new Set(n)];const s=r==null?void 0:r.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){var r,n,s;this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),await this.syncExistingConnection(),this.remoteFeatures=await uB.fetchRemoteFeatures(e),X.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&gd.setOnrampProviders(this.remoteFeatures.onramp),((r=X.state.remoteFeatures)!=null&&r.email||Array.isArray((n=X.state.remoteFeatures)==null?void 0:n.socials)&&((s=X.state.remoteFeatures)==null?void 0:s.socials.length)>0)&&await this.checkAllowedOrigins()}async checkAllowedOrigins(){try{const e=await ve.fetchAllowedOrigins();if(!e||!le.isClient()){_t.open(wt.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}const r=window.location.origin;oa.isOriginAllowed(r,e,Go.DEFAULT_ALLOWED_ANCESTORS)||_t.open(wt.ALERT_ERRORS.INVALID_APP_CONFIGURATION,"error")}catch(e){if(!(e instanceof Error)){_t.open(wt.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}switch(e.message){case"RATE_LIMITED":_t.open(wt.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const r=e.cause instanceof Error?e.cause:e;_t.open({shortMessage:wt.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.shortMessage,longMessage:wt.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.longMessage(r.message)},"error");break}default:_t.open(wt.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error")}}}sendInitializeEvent(e){var n;const{...r}=e;delete r.adapters,delete r.universalProvider,je.sendEvent({type:"track",event:"INITIALIZE",properties:{...r,networks:e.networks.map(s=>s.id),siweConfig:{options:((n=e.siweConfig)==null?void 0:n.options)||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&yr.setThemeMode(e.themeMode),e.themeVariables&&yr.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");R.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const r=this.getDefaultNetwork();r&&R.setActiveCaipNetwork(r)}initializeConnectionController(e){ue.initialize(e.adapters??[]),ue.setWcBasic(e.basic??!1)}initializeConnectorController(){ie.initialize(this.chainNamespaces)}initializeProjectSettings(e){X.setProjectId(e.projectId),X.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){var o;X.setDebug(e.debug!==!1),X.setEnableWalletConnect(e.enableWalletConnect!==!1),X.setEnableWalletGuide(e.enableWalletGuide!==!1),X.setEnableWallets(e.enableWallets!==!1),X.setEIP6963Enabled(e.enableEIP6963!==!1),X.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),X.setEnableAuthLogger(e.enableAuthLogger!==!1),X.setCustomRpcUrls(e.customRpcUrls),X.setEnableEmbedded(e.enableEmbedded),X.setAllWallets(e.allWallets),X.setIncludeWalletIds(e.includeWalletIds),X.setExcludeWalletIds(e.excludeWalletIds),X.setFeaturedWalletIds(e.featuredWalletIds),X.setTokens(e.tokens),X.setTermsConditionsUrl(e.termsConditionsUrl),X.setPrivacyPolicyUrl(e.privacyPolicyUrl),X.setCustomWallets(e.customWallets),X.setFeatures(e.features),X.setAllowUnsupportedChain(e.allowUnsupportedChain),X.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),X.setPreferUniversalLinks(e.experimental_preferUniversalLinks),X.setDefaultAccountTypes(e.defaultAccountTypes);const r=oe.getPreferredAccountTypes()||{},n={...X.state.defaultAccountTypes,...r};ee.setPreferredAccountTypes(n);const s=this.getDefaultMetaData();if(!e.metadata&&s&&(e.metadata=s),X.setMetadata(e.metadata),X.setDisableAppend(e.disableAppend),X.setEnableEmbedded(e.enableEmbedded),X.setSIWX(e.siwx),!e.projectId){_t.open(wt.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(((o=e.adapters)==null?void 0:o.find(a=>a.namespace===G.CHAIN.EVM))&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");X.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){var e,r,n,s;return le.isClient()?{name:((r=(e=document.getElementsByTagName("title"))==null?void 0:e[0])==null?void 0:r.textContent)||"",description:((n=document.querySelector('meta[property="og:description"]'))==null?void 0:n.content)||"",url:window.location.origin,icons:[((s=document.querySelector('link[rel~="icon"]'))==null?void 0:s.href)||""]}:null}setUnsupportedNetwork(e){const r=this.getActiveChainNamespace();if(r){const n=An.getUnsupportedNetwork(`${r}:${e}`);R.setActiveCaipNetwork(n)}}getDefaultNetwork(){return An.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,r){return An.extendCaipNetwork(e,{customNetworkImageUrls:r.chainImages,projectId:r.projectId})}extendCaipNetworks(e){return An.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const r=e.networks.find(s=>{var i;return s.id===((i=e.defaultNetwork)==null?void 0:i.id)});return r?An.extendCaipNetwork(r,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectNamespace(e){try{const r=this.getAdapter(e),n=nt.getProvider(e),s=nt.getProviderId(e),{caipAddress:i}=R.getAccountData(e)||{};this.setLoading(!0,e),i&&(r!=null&&r.disconnect)&&await r.disconnect({provider:n,providerType:s}),oe.removeConnectedNamespace(e),nt.resetChain(e),this.setUser(void 0,e),this.setStatus("disconnected",e),this.setConnectedWalletInfo(void 0,e),ie.removeConnectorId(e),R.resetAccount(e),R.resetNetwork(e),this.setLoading(!1,e)}catch(r){throw this.setLoading(!1,e),new Error(`Failed to disconnect chain ${e}: ${r.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{var i;const e=R.state.activeChain,r=this.getAdapter(e),n=(i=this.getCaipNetwork(e))==null?void 0:i.id;if(!r)throw new Error("Adapter not found");const s=await r.connectWalletConnect(n);this.close(),this.setClientId((s==null?void 0:s.clientId)||null),oe.setConnectedNamespaces([...R.state.chains.keys()]),this.chainNamespaces.forEach(o=>{ie.setConnectorId(gt.CONNECTOR_TYPE_WALLET_CONNECT,o)}),await this.syncWalletConnectAccount()},connectExternal:async({id:e,info:r,type:n,provider:s,chain:i,caipNetwork:o,socialUri:a})=>{var g,_,I,N,C,E;const c=R.state.activeChain,l=i||c,u=this.getAdapter(l);if(i&&i!==c&&!o){const v=this.getCaipNetworks().find(A=>A.chainNamespace===i);v&&this.setCaipNetwork(v)}if(!u)throw new Error("Adapter not found");const d=this.getCaipNetwork(l),h=await u.connect({id:e,info:r,type:n,provider:s,socialUri:a,chainId:(o==null?void 0:o.id)||(d==null?void 0:d.id),rpcUrl:((I=(_=(g=o==null?void 0:o.rpcUrls)==null?void 0:g.default)==null?void 0:_.http)==null?void 0:I[0])||((E=(C=(N=d==null?void 0:d.rpcUrls)==null?void 0:N.default)==null?void 0:C.http)==null?void 0:E[0])});if(!h)return;oe.addConnectedNamespace(l),this.syncProvider({...h,chainNamespace:l});const m=ee.state.allAccounts,{accounts:f}=(m==null?void 0:m.length)>0?{accounts:[...m]}:await u.getAccounts({namespace:l,id:e});this.setAllAccounts(f,l),this.setStatus("connected",l),this.syncConnectedWalletInfo(l)},reconnectExternal:async({id:e,info:r,type:n,provider:s})=>{var a;const i=R.state.activeChain,o=this.getAdapter(i);o!=null&&o.reconnect&&(await(o==null?void 0:o.reconnect({id:e,info:r,type:n,provider:s,chainId:(a=this.getCaipNetwork())==null?void 0:a.id})),oe.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnect:async({chainNamespace:e}={})=>{const r=dv(e);try{const n=await Promise.allSettled(r.map(async([i])=>this.disconnectNamespace(i)));Ge.resetSend(),ue.resetWcConnection(),await Ji.clearSessions(),ie.setFilterByNamespace(void 0);const s=n.filter(i=>i.status==="rejected");if(s.length>0)throw new Error(s.map(i=>i.reason.message).join(", "));oe.deleteConnectedSocialProvider(),je.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:e||"all"}})}catch(n){throw new Error(`Failed to disconnect chains: ${n.message}`)}},checkInstalled:e=>e?e.some(r=>{var n;return!!((n=window.ethereum)!=null&&n[String(r)])}):!!window.ethereum,signMessage:async e=>{const r=this.getAdapter(R.state.activeChain),n=await(r==null?void 0:r.signMessage({message:e,address:ee.state.address,provider:nt.getProvider(R.state.activeChain)}));return(n==null?void 0:n.signature)||""},sendTransaction:async e=>{const r=e.chainNamespace;if(Ye.SEND_SUPPORTED_NAMESPACES.includes(r)){const n=this.getAdapter(R.state.activeChain),s=nt.getProvider(r),i=await(n==null?void 0:n.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}));return(i==null?void 0:i.hash)||""}return""},estimateGas:async e=>{if(e.chainNamespace===G.CHAIN.EVM){const r=this.getAdapter(R.state.activeChain),n=nt.getProvider(R.state.activeChain),s=this.getCaipNetwork();if(!s)throw new Error("CaipNetwork is undefined");const i=await(r==null?void 0:r.estimateGas({...e,provider:n,caipNetwork:s}));return(i==null?void 0:i.gas)||0n}return 0n},getEnsAvatar:async()=>{var e;return await this.syncIdentity({address:ee.state.address,chainId:Number((e=this.getCaipNetwork())==null?void 0:e.id),chainNamespace:R.state.activeChain}),ee.state.profileImage||!1},getEnsAddress:async e=>await oa.resolveReownName(e),writeContract:async e=>{const r=this.getAdapter(R.state.activeChain),n=this.getCaipNetwork(),s=this.getCaipAddress(),i=nt.getProvider(R.state.activeChain);if(!n||!s)throw new Error("CaipNetwork or CaipAddress is undefined");const o=await(r==null?void 0:r.writeContract({...e,caipNetwork:n,provider:i,caipAddress:s}));return o==null?void 0:o.hash},parseUnits:(e,r)=>{const n=this.getAdapter(R.state.activeChain);return(n==null?void 0:n.parseUnits({value:e,decimals:r}))??0n},formatUnits:(e,r)=>{const n=this.getAdapter(R.state.activeChain);return(n==null?void 0:n.formatUnits({value:e,decimals:r}))??"0"},getCapabilities:async e=>{const r=this.getAdapter(R.state.activeChain);return await(r==null?void 0:r.getCapabilities(e))},grantPermissions:async e=>{const r=this.getAdapter(R.state.activeChain);return await(r==null?void 0:r.grantPermissions(e))},revokePermissions:async e=>{const r=this.getAdapter(R.state.activeChain);return r!=null&&r.revokePermissions?await r.revokePermissions(e):"0x"},walletGetAssets:async e=>{const r=this.getAdapter(R.state.activeChain);return await(r==null?void 0:r.walletGetAssets(e))??{}},updateBalance:e=>{const r=this.getCaipNetwork(e);!r||!ee.state.address||this.updateNativeBalance(ee.state.address,r==null?void 0:r.id,e)}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},ue.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){var r,n,s,i,o;if(nt.getProviderId(R.state.activeChain)===gt.CONNECTOR_TYPE_WALLET_CONNECT){const a=(n=(r=this.universalProvider)==null?void 0:r.session)==null?void 0:n.namespaces;return{supportsAllNetworks:((o=(i=(s=this.universalProvider)==null?void 0:s.session)==null?void 0:i.peer)==null?void 0:o.metadata.name)==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(a)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;const r=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=nt.getProvider(r),i=nt.getProviderId(r);if(e.chainNamespace===R.state.activeChain){const o=this.getAdapter(r);await(o==null?void 0:o.switchNetwork({caipNetwork:e,provider:s,providerType:i}))}else if(this.setCaipNetwork(e),i===gt.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(r);o&&this.syncAccount({address:o,chainId:e.id,chainNamespace:r})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(r=>{const n=r.chains||[],s=r.accounts.map(i=>{const{chainId:o,chainNamespace:a}=Pr.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...n,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((r,n)=>{var i;const s=e==null?void 0:e.find(o=>o.namespace===n);return s?(s.construct({namespace:n,projectId:(i=this.options)==null?void 0:i.projectId,networks:this.getCaipNetworks()}),r[n]=s):r[n]=new cB({namespace:n,networks:this.getCaipNetworks()}),r},{})}async initChainAdapter(e){var r;this.onConnectors(e),this.listenAdapter(e),await((r=this.chainAdapters)==null?void 0:r[e].syncConnectors(this.options,this)),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){const r=this.getAdapter(e);r==null||r.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const r=this.getAdapter(e);if(!r)return;const n=oe.getConnectionStatus();n==="connected"?this.setStatus("connecting",e):n==="disconnected"?(oe.clearAddressCache(),this.setStatus(n,e)):this.setStatus(n,e),r.on("switchNetwork",({address:s,chainId:i})=>{const o=this.getCaipNetworks().find(l=>l.id===i||l.caipNetworkId===i),a=R.state.activeChain===e,c=R.getAccountProp("address",e);if(o){const l=a&&s?s:c;l&&this.syncAccount({address:l,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),r.on("disconnect",this.disconnect.bind(this,e)),r.on("connections",s=>{this.setConnections(s,e)}),r.on("pendingTransactions",()=>{const s=ee.state.address,i=R.state.activeCaipNetwork;!s||!(i!=null&&i.id)||this.updateNativeBalance(s,i.id,i.chainNamespace)}),r.on("accountChanged",({address:s,chainId:i})=>{var a,c;const o=R.state.activeChain===e;o&&i?this.syncAccount({address:s,chainId:i,chainNamespace:e}):o&&((a=R.state.activeCaipNetwork)!=null&&a.id)?this.syncAccount({address:s,chainId:(c=R.state.activeCaipNetwork)==null?void 0:c.id,chainNamespace:e}):this.syncAccountInfo(s,i,e),this.syncAllAccounts(e)})}async createUniversalProviderForAdapter(e){var r,n,s;await this.getUniversalProvider(),this.universalProvider&&((s=(n=(r=this.chainAdapters)==null?void 0:r[e])==null?void 0:n.setUniversalProvider)==null||s.call(n,this.universalProvider))}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async syncNamespaceConnection(e){try{e===G.CHAIN.EVM&&le.isSafeApp()&&ie.setConnectorId(G.CONNECTOR_ID.SAFE,e);const r=ie.getConnectorId(e);switch(this.setStatus("connecting",e),r){case G.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case G.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(r){console.warn("AppKit couldn't sync existing connection",r),this.setStatus("disconnected",e)}}async syncAdapterConnection(e){var a,c,l;const r=this.getAdapter(e),n=ie.getConnectorId(e),s=this.getCaipNetwork(e),o=ie.getConnectors(e).find(u=>u.id===n);try{if(!r||!o)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!(s!=null&&s.id))throw new Error("CaipNetwork not found");const u=await(r==null?void 0:r.syncConnection({namespace:e,id:o.id,chainId:s.id,rpcUrl:(l=(c=(a=s==null?void 0:s.rpcUrls)==null?void 0:a.default)==null?void 0:c.http)==null?void 0:l[0]}));if(u){const d=await(r==null?void 0:r.getAccounts({namespace:e,id:o.id}));d&&d.accounts.length>0?this.setAllAccounts(d.accounts,e):this.setAllAccounts([le.createAccount(e,u.address,"eoa")],e),this.syncProvider({...u,chainNamespace:e}),await this.syncAccount({...u,chainNamespace:e}),this.setStatus("connected",e)}else this.setStatus("disconnected",e)}catch{this.setStatus("disconnected",e)}}async syncWalletConnectAccount(){var n,s;const e=Object.keys(((s=(n=this.universalProvider)==null?void 0:n.session)==null?void 0:s.namespaces)||{}),r=this.chainNamespaces.map(async i=>{var u,d,h,m,f;const o=this.getAdapter(i),a=((m=(h=(d=(u=this.universalProvider)==null?void 0:u.session)==null?void 0:d.namespaces)==null?void 0:h[i])==null?void 0:m.accounts)||[],c=(f=R.state.activeCaipNetwork)==null?void 0:f.id,l=a.find(g=>{const{chainId:_}=Pr.parseCaipAddress(g);return _===(c==null?void 0:c.toString())})||a[0];if(l){const g=Pr.validateCaipAddress(l),{chainId:_,address:I}=Pr.parseCaipAddress(g);if(nt.setProviderId(i,gt.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&R.state.activeCaipNetwork&&(o==null?void 0:o.namespace)!==G.CHAIN.EVM){const N=o==null?void 0:o.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:R.state.activeCaipNetwork});nt.setProvider(i,N)}else nt.setProvider(i,this.universalProvider);ie.setConnectorId(G.CONNECTOR_ID.WALLET_CONNECT,i),oe.addConnectedNamespace(i),this.syncWalletConnectAccounts(i),await this.syncAccount({address:I,chainId:_,chainNamespace:i})}else e.includes(i)&&this.setStatus("disconnected",i);this.syncConnectedWalletInfo(i),await R.setApprovedCaipNetworksData(i)});await Promise.all(r)}syncWalletConnectAccounts(e){var n,s,i,o,a;const r=(a=(o=(i=(s=(n=this.universalProvider)==null?void 0:n.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const{address:l}=Pr.parseCaipAddress(c);return l}).filter((c,l,u)=>u.indexOf(c)===l);r&&this.setAllAccounts(r.map(c=>le.createAccount(e,c,e==="bip122"?"payment":"eoa")),e)}syncProvider({type:e,provider:r,id:n,chainNamespace:s}){nt.setProviderId(s,e),nt.setProvider(s,r),ie.setConnectorId(n,s)}async syncAllAccounts(e){const r=ie.getConnectorId(e);if(!r)return;const n=this.getAdapter(e),s=await(n==null?void 0:n.getAccounts({namespace:e,id:r}));s&&s.accounts.length>0&&this.setAllAccounts(s.accounts,e)}async syncAccount(e){var d,h;const r=e.chainNamespace===R.state.activeChain,n=R.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=oe.getActiveNetworkProps(),c=i||a,l=((d=R.state.activeCaipNetwork)==null?void 0:d.name)===G.UNSUPPORTED_NETWORK_NAME,u=R.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let m=this.getCaipNetworks().find(_=>_.id.toString()===c.toString()),f=this.getCaipNetworks().find(_=>_.chainNamespace===o);if(!u&&!m&&!f){const _=this.getApprovedCaipNetworkIds()||[],I=_.find(C=>{var E;return((E=Pr.parseCaipNetworkId(C))==null?void 0:E.chainId)===c.toString()}),N=_.find(C=>{var E;return((E=Pr.parseCaipNetworkId(C))==null?void 0:E.chainNamespace)===o});m=this.getCaipNetworks().find(C=>C.caipNetworkId===I),f=this.getCaipNetworks().find(C=>C.caipNetworkId===N||"deprecatedCaipNetworkId"in C&&C.deprecatedCaipNetworkId===N)}const g=m||f;(g==null?void 0:g.chainNamespace)===R.state.activeChain?X.state.enableNetworkSwitch&&!X.state.allowUnsupportedChain&&((h=R.state.activeCaipNetwork)==null?void 0:h.name)===G.UNSUPPORTED_NETWORK_NAME?R.showUnsupportedChainUI():this.setCaipNetwork(g):r||n&&this.setCaipNetworkOfNamespace(n,o),this.syncConnectedWalletInfo(o),Ea.isLowerCaseMatch(s,ee.state.address)||this.syncAccountInfo(s,g==null?void 0:g.id,o),r?await this.syncBalance({address:s,chainId:g==null?void 0:g.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:n==null?void 0:n.id,chainNamespace:o})}}async syncAccountInfo(e,r,n){const s=this.getCaipAddress(n),i=r||(s==null?void 0:s.split(":")[1]);if(!i)return;const o=`${n}:${i}:${e}`;this.setCaipAddress(o,n),await this.syncIdentity({address:e,chainId:i,chainNamespace:n})}async syncReownName(e,r){try{const n=await this.getReownName(e);if(n[0]){const s=n[0];this.setProfileName(s.name,r)}else this.setProfileName(null,r)}catch{this.setProfileName(null,r)}}syncConnectedWalletInfo(e){var s;const r=ie.getConnectorId(e),n=nt.getProviderId(e);if(n===gt.CONNECTOR_TYPE_ANNOUNCED||n===gt.CONNECTOR_TYPE_INJECTED){if(r){const i=this.getConnectors().find(o=>o.id===r);if(i){const{info:o,name:a,imageUrl:c}=i,l=c||this.getConnectorImage(i);this.setConnectedWalletInfo({name:a,icon:l,...o},e)}}}else if(n===gt.CONNECTOR_TYPE_WALLET_CONNECT){const i=nt.getProvider(e);i!=null&&i.session&&this.setConnectedWalletInfo({...i.session.peer.metadata,name:i.session.peer.metadata.name,icon:(s=i.session.peer.metadata.icons)==null?void 0:s[0]},e)}else if(r&&r===G.CONNECTOR_ID.COINBASE){const i=this.getConnectors().find(o=>o.id===G.CONNECTOR_ID.COINBASE);this.setConnectedWalletInfo({name:"Coinbase Wallet",icon:this.getConnectorImage(i)},e)}}async syncBalance(e){!ca.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(n=>{var s;return n.id.toString()===((s=e.chainId)==null?void 0:s.toString())})||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,r,n){const s=this.getAdapter(n),i=R.getCaipNetworkByNamespace(n,r);if(s){const o=await s.getBalance({address:e,chainId:r,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,n),o}}async initializeUniversalAdapter(){var n,s,i,o,a,c,l,u,d,h;const e=l$.createLogger((m,...f)=>{m&&this.handleAlertError(m),console.error(...f)}),r={projectId:(n=this.options)==null?void 0:n.projectId,metadata:{name:(s=this.options)!=null&&s.metadata?(i=this.options)==null?void 0:i.metadata.name:"",description:(o=this.options)!=null&&o.metadata?(a=this.options)==null?void 0:a.metadata.description:"",url:(c=this.options)!=null&&c.metadata?(l=this.options)==null?void 0:l.metadata.url:"",icons:(u=this.options)!=null&&u.metadata?(d=this.options)==null?void 0:d.metadata.icons:[""]},logger:e};X.setManualWCControl(!!((h=this.options)!=null&&h.manualWCControl)),this.universalProvider=this.options.universalProvider??await o$.init(r),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&(this.universalProvider.on("display_uri",e=>{ue.setUri(e)}),this.universalProvider.on("connect",ue.finalizeWcConnection),this.universalProvider.on("disconnect",()=>{this.chainNamespaces.forEach(e=>{this.resetAccount(e)}),ue.resetWcConnection()}),this.universalProvider.on("chainChanged",e=>{const r=this.getCaipNetworks().find(s=>s.id==e),n=this.getCaipNetwork();if(!r){this.setUnsupportedNetwork(e);return}(n==null?void 0:n.id)!==(r==null?void 0:r.id)&&this.setCaipNetwork(r)}),this.universalProvider.on("session_event",e=>{if(oa.isSessionEventData(e)){const{name:r,data:n}=e.params.event;r==="accountsChanged"&&Array.isArray(n)&&le.isCaipAddress(n[0])&&this.syncAccount(Pr.parseCaipAddress(n[0]))}}))}createUniversalProvider(){var e;return!this.universalProviderInitPromise&&le.isClient()&&((e=this.options)!=null&&e.projectId)&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){je.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const r=Object.entries(wt.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[n,s]=r??[],{message:i,alertErrorKey:o}=s??{};if(n&&i&&!this.reportedAlertErrors[n]){const a=wt.ALERT_ERRORS[o];a&&(_t.open(a,"error"),this.reportedAlertErrors[n]=!0)}}getAdapter(e){var r;if(e)return(r=this.chainAdapters)==null?void 0:r[e]}createAdapter(e){var s;if(!e)return;const r=e.namespace;if(!r)return;this.createClients();const n=e;n.namespace=r,n.construct({namespace:r,projectId:(s=this.options)==null?void 0:s.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(r)||this.chainNamespaces.push(r),this.chainAdapters&&(this.chainAdapters[r]=n)}async open(e){if(await this.injectModalUi(),e!=null&&e.uri&&ue.setUri(e.uri),e!=null&&e.arguments)switch(e==null?void 0:e.view){case"Swap":return Fe.open({...e,data:{swap:e.arguments}})}return Fe.open(e)}async close(){await this.injectModalUi(),Fe.close()}setLoading(e,r){Fe.setLoading(e,r)}async disconnect(e){await ue.disconnect({namespace:e})}getSIWX(){return X.state.siwx}getError(){return""}getChainId(){var e;return(e=R.state.activeCaipNetwork)==null?void 0:e.id}async switchNetwork(e){const r=this.getCaipNetworks().find(n=>n.id===e.id);if(!r){_t.open(wt.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await R.switchActiveNetwork(r)}getWalletProvider(){return R.state.activeChain?nt.state.providers[R.state.activeChain]:null}getWalletProviderType(){return nt.getProviderId(R.state.activeChain)}subscribeProviders(e){return nt.subscribeProviders(e)}getThemeMode(){return yr.state.themeMode}getThemeVariables(){return yr.state.themeVariables}setThemeMode(e){yr.setThemeMode(e),Db(yr.state.themeMode)}setTermsConditionsUrl(e){X.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){X.setPrivacyPolicyUrl(e)}setThemeVariables(e){yr.setThemeVariables(e),eB(yr.state.themeVariables)}subscribeTheme(e){return yr.subscribe(e)}subscribeConnections(e){return ue.subscribe(e)}getWalletInfo(){return ee.state.connectedWalletInfo}getAccount(e){var o;const r=ie.getAuthConnector(e),n=R.getAccountData(e),s=R.state.activeChain,i=oe.getConnectedConnectorId(e||s);if(n)return{allAccounts:n.allAccounts,caipAddress:n.caipAddress,address:le.getPlainAddress(n.caipAddress),isConnected:!!n.caipAddress,status:n.status,embeddedWalletInfo:r&&i===G.CONNECTOR_ID.AUTH?{user:n.user?{...n.user,username:oe.getConnectedSocialUsername()}:void 0,authProvider:n.socialProvider||"email",accountType:(o=n.preferredAccountTypes)==null?void 0:o[e||s],isSmartAccountDeployed:!!n.smartAccountDeployed}:void 0}}subscribeAccount(e,r){const n=()=>{const s=this.getAccount(r);s&&e(s)};r?R.subscribeChainProp("accountState",n,r):R.subscribe(n),ie.subscribe(n)}subscribeNetwork(e){return R.subscribe(({activeCaipNetwork:r})=>{e({caipNetwork:r,chainId:r==null?void 0:r.id,caipNetworkId:r==null?void 0:r.caipNetworkId})})}subscribeWalletInfo(e){return ee.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){ee.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){R.subscribeKey("activeCaipNetwork",e)}getState(){return Sn.state}subscribeState(e){return Sn.subscribe(e)}showErrorMessage(e){pt.showError(e)}showSuccessMessage(e){pt.showSuccess(e)}getEvent(){return{...je.state}}subscribeEvents(e){return je.subscribe(e)}replace(e){me.replace(e)}redirect(e){me.push(e)}popTransactionStack(e){me.popTransactionStack(e)}isOpen(){return Fe.state.open}isTransactionStackEmpty(){return me.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){X.setFeatures(e)}updateRemoteFeatures(e){X.setRemoteFeatures(e)}updateOptions(e){const n={...X.state||{},...e};X.setOptions(n)}setConnectMethodsOrder(e){X.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){X.setWalletFeaturesOrder(e)}setCollapseWallets(e){X.setCollapseWallets(e)}setSocialsOrder(e){X.setSocialsOrder(e)}getConnectMethodsOrder(){return bh.getConnectOrderMethod(X.state.features,ie.getConnectors())}addNetwork(e,r){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const n=this.extendCaipNetwork(r,this.options);this.getCaipNetworks().find(s=>s.id===n.id)||R.addNetwork(n)}removeNetwork(e,r){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===r)&&R.removeNetwork(e,r)}}let aw=!1;class hB extends dB{setupAuthConnectorListeners(e){e.onRpcRequest(r=>{kr.checkIfRequestExists(r)?kr.checkIfRequestIsSafe(r)||this.handleUnsafeRPCRequest():(this.open(),console.error(At.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:r.method}),setTimeout(()=>{this.showErrorMessage(At.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack("error"))}),e.onRpcSuccess((r,n)=>{const s=kr.checkIfRequestIsSafe(n),i=ee.state.address,o=R.state.activeCaipNetwork;s||(i&&(o!=null&&o.id)&&this.updateNativeBalance(i,o.id,o.chainNamespace),this.isTransactionStackEmpty()?this.close():this.popTransactionStack("success"))}),e.onNotConnected(()=>{const r=R.state.activeChain;ie.getConnectorId(r)===G.CONNECTOR_ID.AUTH&&(this.setCaipAddress(void 0,r),this.setLoading(!1,r))}),e.onConnect(r=>{var l,u;const n=R.state.activeChain,s=n===G.CHAIN.EVM?`eip155:${r.chainId}:${r.address}`:`${r.chainId}:${r.address}`,i=X.state.defaultAccountTypes[n],o=(l=ee.state.preferredAccountTypes)==null?void 0:l[n],a=r.preferredAccountType||o||i;Ea.isLowerCaseMatch(r.address,ee.state.address)||this.syncIdentity({address:r.address,chainId:r.chainId,chainNamespace:n}),this.setCaipAddress(s,n),this.setUser({...ee.state.user||{},...r},n),this.setSmartAccountDeployed(!!r.smartAccountDeployed,n),this.setPreferredAccountType(a,n);const c=(u=r.accounts)==null?void 0:u.map(d=>le.createAccount(n,d.address,d.type||o||i));this.setAllAccounts(c||[le.createAccount(n,r.address,r.preferredAccountType||a)],n),this.setLoading(!1,n)}),e.onSocialConnected(({userName:r})=>{this.setUser({...ee.state.user||{},username:r},R.state.activeChain)}),e.onGetSmartAccountEnabledNetworks(r=>{this.setSmartAccountEnabledNetworks(r,R.state.activeChain)}),e.onSetPreferredAccount(({address:r,type:n})=>{r&&this.setPreferredAccountType(n,R.state.activeChain)})}async syncAuthConnector(e,r){var d,h,m,f;const n=G.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(r),s=r===R.state.activeChain;if(!n)return;this.setLoading(!0,r);const i=e.getLoginEmailUsed();this.setLoading(i,r),i&&this.setStatus("connecting",r);const o=e.getEmail(),a=e.getUsername();this.setUser({...((d=ee.state)==null?void 0:d.user)||{},username:a,email:o},r),this.setupAuthConnectorListeners(e);const{isConnected:c}=await e.isConnected(),l=yr.getSnapshot(),u=X.getSnapshot();await Promise.all([e.syncDappData({metadata:u.metadata,sdkVersion:u.sdkVersion,projectId:u.projectId,sdkType:u.sdkType}),e.syncTheme({themeMode:l.themeMode,themeVariables:l.themeVariables,w3mThemeVariables:Kn(l.themeVariables,l.themeMode)})]),await e.getSmartAccountEnabledNetworks(),r&&n&&s&&(c&&((h=this.connectionControllerClient)!=null&&h.connectExternal)?(await((f=this.connectionControllerClient)==null?void 0:f.connectExternal({id:G.CONNECTOR_ID.AUTH,info:{name:G.CONNECTOR_ID.AUTH},type:gt.CONNECTOR_TYPE_AUTH,provider:e,chainId:(m=R.state.activeCaipNetwork)==null?void 0:m.id,chain:r})),this.setStatus("connected",r)):ie.getConnectorId(r)===G.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",r),oe.removeConnectedNamespace(r))),this.setLoading(!1,r)}async checkExistingTelegramSocialConnection(e){var r;try{if(!le.isTelegram())return;const n=oe.getTelegramSocialProvider();if(!n||!le.isClient())return;const i=new URL(window.location.href).searchParams.get("result_uri");if(!i)return;ee.setSocialProvider(n,e),await((r=this.authProvider)==null?void 0:r.init());const o=ie.getAuthConnector();n&&o&&(this.setLoading(!0,e),await ue.connectExternal({id:o.id,type:o.type,socialUri:i},o.chain),oe.setConnectedSocialProvider(n),oe.removeTelegramSocialProvider(),je.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:n}}))}catch(n){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",n)}try{const n=new URL(window.location.href);n.searchParams.delete("result_uri"),window.history.replaceState({},document.title,n.toString())}catch(n){console.error("tma social login failed",n)}}createAuthProvider(e){var l,u,d,h;if(!G.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const n=(l=this.remoteFeatures)==null?void 0:l.email,s=Array.isArray((u=this.remoteFeatures)==null?void 0:u.socials)&&this.remoteFeatures.socials.length>0,i=n||s,a=Ea.getActiveNamespaceConnectedToAuth()||e;!this.authProvider&&((d=this.options)!=null&&d.projectId)&&i&&(this.authProvider=ri.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:(h=this.getCaipNetwork(a))==null?void 0:h.caipNetworkId,abortController:wt.EmbeddedWalletAbortController,onTimeout:m=>{m==="iframe_load_failed"?_t.open(wt.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):m==="iframe_request_timeout"?_t.open(wt.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):m==="unverified_domain"&&_t.open(wt.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")}}),Sn.subscribeOpen(m=>{var f;!m&&this.isTransactionStackEmpty()&&((f=this.authProvider)==null||f.rejectRpcRequests())}));const c=e===R.state.activeChain;this.authProvider&&c&&(this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){var r,n,s;this.createAuthProvider(e),this.authProvider&&((s=(n=(r=this.chainAdapters)==null?void 0:r[e])==null?void 0:n.setAuthProvider)==null||s.call(n,this.authProvider))}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&ve.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){var o,a;if(!e)return;const r=R.state.activeChain,n=e.chainNamespace,s=this.getAddressByChainNamespace(n);if(n===r&&s){const c=this.getAdapter(n),l=nt.getProvider(n),u=nt.getProviderId(n);await(c==null?void 0:c.switchNetwork({caipNetwork:e,provider:l,providerType:u})),this.setCaipNetwork(e)}else{const l=nt.getProviderId(r)===gt.CONNECTOR_TYPE_AUTH,u=nt.getProviderId(n),d=u===gt.CONNECTOR_TYPE_AUTH,h=G.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n);if((l&&u===void 0||d)&&h)try{if(R.state.activeChain=e.chainNamespace,s){const m=this.getAdapter(n);await(m==null?void 0:m.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:u}))}else await((a=(o=this.connectionControllerClient)==null?void 0:o.connectExternal)==null?void 0:a.call(o,{id:G.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:n,chainId:e.id,type:gt.CONNECTOR_TYPE_AUTH,caipNetwork:e}));this.setCaipNetwork(e)}catch{const f=this.getAdapter(n);await(f==null?void 0:f.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:u}))}else u===gt.CONNECTOR_TYPE_WALLET_CONNECT?(this.setCaipNetwork(e),this.syncWalletConnectAccount()):(this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:n}))}}async initialize(e){var r;await super.initialize(e),(r=this.chainNamespaces)==null||r.forEach(n=>{this.createAuthProviderForAdapter(n)}),await this.injectModalUi(),Sn.set({initialized:!0})}async syncIdentity({address:e,chainId:r,chainNamespace:n}){var o;const s=`${n}:${r}`,i=(o=this.caipNetworks)==null?void 0:o.find(a=>a.caipNetworkId===s);if(n!==G.CHAIN.EVM||i!=null&&i.testnet){this.setProfileName(null,n),this.setProfileImage(null,n);return}try{const{name:a,avatar:c}=await this.fetchIdentity({address:e,caipNetworkId:s});this.setProfileName(a,n),this.setProfileImage(c,n)}catch{await this.syncReownName(e,n),r!==1&&this.setProfileImage(null,n)}}syncConnectedWalletInfo(e){const r=nt.getProviderId(e);if(r===gt.CONNECTOR_TYPE_AUTH){const n=this.authProvider;if(n){const s=oe.getConnectedSocialProvider()??"email",i=n.getEmail()??n.getUsername();this.setConnectedWalletInfo({name:r,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(le.isClient()&&!aw)try{const e={...Ye.DEFAULT_FEATURES,...this.options.features},r=this.remoteFeatures;if(await this.loadModalComponents(e,r),le.isClient()&&!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!X.state.disableAppend&&!X.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}aw=!0}catch(e){console.error("Error injecting modal UI:",e)}}async loadModalComponents(e,r){if(!le.isClient())return;const n=[];(r.email||r.socials&&r.socials.length>0)&&n.push(mr(()=>import("./embedded-wallet-SxqnNz-1.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),r.email&&n.push(mr(()=>import("./email-Dr8bETm9.js"),__vite__mapDeps([14,1,2,3,13,7,12,6,11,15,8]))),r.socials&&n.push(mr(()=>import("./socials-B_EA-w2t.js"),__vite__mapDeps([16,1,2,3,17,6,18,19,12,20,11,7,13,21,5,22]))),r.swaps&&r.swaps.length>0&&n.push(mr(()=>import("./swaps-CNER8pYh.js"),__vite__mapDeps([23,1,2,3,11,7,24,25,22,26,5,12,8,6]))),e.send&&n.push(mr(()=>import("./send-B1GarwWd.js"),__vite__mapDeps([27,1,2,3,11,7,12,6,18,13,26,5,8,28,29]))),e.receive&&n.push(mr(()=>import("./receive-DWNjaDsF.js"),__vite__mapDeps([30,1,2,3,31,5,21]))),r.onramp&&r.onramp.length>0&&n.push(mr(()=>import("./onramp-Egp8ZTs9.js"),__vite__mapDeps([32,1,2,3,33,22,12,5,7,34,17,6,18,35,13,11,20,8]))),r.activity&&n.push(mr(()=>import("./transactions--JUwT97p.js"),__vite__mapDeps([36,1,2,3,37,12,13,5,33,22]))),e.pay&&n.push(mr(()=>import("./index-BtLoahgX.js"),__vite__mapDeps([38,1,2,3,11,7,39,5,12,9,34,29,20]))),await Promise.all([...n,mr(()=>import("./index-CK9Fz2P5.js"),__vite__mapDeps([40,1,2,3,5,7,28,12,41,9,34,11,10,39,37,13,33,22,24,25,29,6,8,15,17,18,19,4,20,31,21,35])),mr(()=>import("./w3m-modal-CZLUB59t.js"),__vite__mapDeps([42,1,2,3,9,5,12,10,7,25,41]))])}}const fB="1.7.9";function T6(t){return new hB({...t,sdkVersion:le.generateSdkVersion(t.adapters??[],"html",fB)})}function pB(t){let e=[],r,n;function s(a){return ca.parseEvmChainId(a)||1}function i(){var a;return r||(r=ri.getInstance({projectId:t.options.projectId,chainId:(a=R.getActiveCaipNetwork())==null?void 0:a.caipNetworkId,enableLogger:t.options.enableAuthLogger,onTimeout:c=>{c==="iframe_load_failed"?_t.open(wt.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):c==="iframe_request_timeout"?_t.open(wt.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):c==="unverified_domain"&&_t.open(wt.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},abortController:wt.EmbeddedWalletAbortController})),r}async function o(a={}){var g,_;const c=i();let l=a.chainId;if(a.isReconnecting){const I=ca.parseEvmChainId(c.getLastUsedChainId()||""),N=(g=t.chains)==null?void 0:g[0].id;if(l=I||N,!l)throw new Error("ChainId not found in provider")}const u=(_=ee.state.preferredAccountTypes)==null?void 0:_.eip155,{address:d,chainId:h,accounts:m}=await c.connect({chainId:l,preferredAccountType:u,socialUri:a.socialUri});e=(m==null?void 0:m.map(I=>I.address))||[d];const f=s(h);return{accounts:e,account:d,chainId:f,chain:{id:f,unsuported:!1}}}return hw(a=>({id:G.CONNECTOR_ID.AUTH,name:G.CONNECTOR_NAMES.AUTH,type:"AUTH",chain:G.CHAIN.EVM,async connect(c={}){if(n)return n;n||(n=new Promise(u=>{u(o(c))}));const l=await n;return n=void 0,l},async disconnect(){await(await this.getProvider()).disconnect()},getAccounts(){return e!=null&&e.length?(a.emitter.emit("change",{accounts:e}),Promise.resolve(e)):Promise.resolve([])},async getProvider(){var c;return this.provider||(this.provider=ri.getInstance({projectId:t.options.projectId,chainId:(c=R.getActiveCaipNetwork())==null?void 0:c.caipNetworkId,enableLogger:t.options.enableAuthLogger,abortController:wt.EmbeddedWalletAbortController,onTimeout:l=>{l==="iframe_load_failed"?_t.open(wt.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):l==="iframe_request_timeout"?_t.open(wt.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):l==="unverified_domain"&&_t.open(wt.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")}})),Promise.resolve(this.provider)},async getChainId(){const c=await this.getProvider(),{chainId:l}=await c.getChainId();return s(l)},async isAuthorized(){const l=R.state.activeChain===G.CHAIN.EVM;if(G.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(h=>ie.getConnectorId(h)===G.CONNECTOR_ID.AUTH)&&!l)return!1;const d=await this.getProvider();return Promise.resolve(d.getLoginEmailUsed())},async switchChain({chainId:c}){var l,u;try{const d=a.chains.find(g=>g.id===c);if(!d)throw new dd(new Error("chain not found on connector."));const h=await this.getProvider(),m=(l=ee.state.preferredAccountTypes)==null?void 0:l.eip155,f=await h.connect({chainId:c,preferredAccountType:m});return e=((u=f==null?void 0:f.accounts)==null?void 0:u.map(g=>g.address))||[f.address],a.emitter.emit("change",{chainId:Number(c),accounts:e}),d}catch(d){throw d instanceof Error?new dd(d):d}},onAccountsChanged(c){c.length===0?this.onDisconnect():a.emitter.emit("change",{accounts:c.map(fw)})},onChainChanged(c){const l=Number(c);a.emitter.emit("change",{chainId:l})},async onDisconnect(c){await(await this.getProvider()).disconnect()}}))}lf.type="walletConnect";function lf(t,e){const r=t.isNewChainsStale??!0;let n,s,i,o,a,c,l;return hw(u=>({id:"walletConnect",name:"WalletConnect",type:lf.type,async setup(){const d=await this.getProvider().catch(()=>null);d&&(o||(o=this.onConnect.bind(this),d.on("connect",o)),c||(c=this.onSessionDelete.bind(this),d.on("session_delete",c)))},async connect({...d}={}){var h,m,f;try{const g=R.getCaipNetworks(),_=await this.getProvider();if(!_)throw new hf;a||(a=this.onDisplayUri,_.on("display_uri",a));const I=await this.isChainsStale();_.session&&I&&await _.disconnect();const N=X.state.universalProviderConfigOverride;if(!_.session||I){const U=oa.createNamespaces(g,N);await _.connect({optionalNamespaces:U,..."pairingTopic"in d?{pairingTopic:d.pairingTopic}:{}}),this.setRequestedChainsIds(g.map(M=>Number(M.id)))}const C=await this.getAccounts(),E=await this.getChainId(),v=(f=(m=(h=_.session)==null?void 0:h.namespaces)==null?void 0:m.eip155)==null?void 0:f.chains,A=v==null?void 0:v.some(U=>Number(U.split(":")[1])===E);let x=1;A?x=E:v!=null&&v[0]&&(x=Number(v[0].split(":")[1])),a&&(_.removeListener("display_uri",a),a=void 0),o&&(_.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),_.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),_.on("chainChanged",i)),l||(l=this.onDisconnect.bind(this),_.on("disconnect",l)),c||(c=this.onSessionDelete.bind(this),_.on("session_delete",c));const D=N==null?void 0:N.defaultChain;return _.setDefaultChain(D??`eip155:${x}`),{accounts:C,chainId:x}}catch(g){throw/(user rejected|connection request reset)/i.test(g==null?void 0:g.message)?new Wl(g):g}},async disconnect(){const d=await this.getProvider();try{await(d==null?void 0:d.disconnect())}catch(h){if(!/No matching key/i.test(h.message))throw h}finally{i&&(d==null||d.removeListener("chainChanged",i),i=void 0),l&&(d==null||d.removeListener("disconnect",l),l=void 0),o||(o=this.onConnect.bind(this),d==null||d.on("connect",o)),s&&(d==null||d.removeListener("accountsChanged",s),s=void 0),c&&(d==null||d.removeListener("session_delete",c),c=void 0),this.setRequestedChainsIds([])}},async getAccounts(){var f,g,_;const d=await this.getProvider();if(!((f=d==null?void 0:d.session)!=null&&f.namespaces))return[];const h=(_=(g=d==null?void 0:d.session)==null?void 0:g.namespaces[G.CHAIN.EVM])==null?void 0:_.accounts;return(h==null?void 0:h.map(I=>I.split(":")[2]))??[]},async getProvider({chainId:d}={}){var f,g;n||(n=await e.getUniversalProvider(),n==null||n.events.setMaxListeners(Number.POSITIVE_INFINITY));const h=oe.getActiveNamespace(),m=(f=e.getCaipNetwork())==null?void 0:f.id;if(d&&m!==d&&h){const _=oe.getStoredActiveCaipNetworkId(),I=e.getCaipNetworks(h),N=I==null?void 0:I.find(C=>C.id===_);N&&N.chainNamespace===G.CHAIN.EVM&&await((g=this.switchChain)==null?void 0:g.call(this,{chainId:Number(N.id)}))}return n},async getChainId(){var g,_,I,N;const d=(g=e.getCaipNetwork(G.CHAIN.EVM))==null?void 0:g.id;if(d)return d;const m=(N=(I=(_=(await this.getProvider()).session)==null?void 0:_.namespaces[G.CHAIN.EVM])==null?void 0:I.chains)==null?void 0:N[0],f=R.getCaipNetworks().find(C=>C.id===m);return f==null?void 0:f.id},async isAuthorized(){try{const[d,h]=await Promise.all([this.getAccounts(),this.getProvider()]);return d.length?await this.isChainsStale()&&h.session?(await h.disconnect().catch(()=>{}),!1):!0:!1}catch{return!1}},async switchChain({addEthereumChainParameter:d,chainId:h}){var g,_,I,N;const m=await this.getProvider();if(!m)throw new hf;const f=R.getCaipNetworks().find(C=>C.id===h);if(!f)throw new dd(new qb);try{await m.request({method:"wallet_switchEthereumChain",params:[{chainId:ff(h)}]}),f!=null&&f.caipNetworkId&&m.setDefaultChain(f==null?void 0:f.caipNetworkId),u.emitter.emit("change",{chainId:Number(h)});const C=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...C,h]),{...f,id:f.id}}catch(C){const E=C;if(/(?:user rejected)/iu.test(E.message))throw new Wl(E);try{let v;d!=null&&d.blockExplorerUrls?v=d.blockExplorerUrls:v=(g=f.blockExplorers)!=null&&g.default.url?[(_=f.blockExplorers)==null?void 0:_.default.url]:[];const A=((N=(I=f.rpcUrls)==null?void 0:I.chainDefault)==null?void 0:N.http)||[],x={blockExplorerUrls:v,chainId:ff(h),chainName:f.name,iconUrls:d==null?void 0:d.iconUrls,nativeCurrency:f.nativeCurrency,rpcUrls:A};await m.request({method:"wallet_addEthereumChain",params:[x]});const D=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...D,h]),{...f,id:f.id}}catch(v){throw new Wl(v)}}},onAccountsChanged(d){d.length===0?this.onDisconnect():u.emitter.emit("change",{accounts:d.map(h=>fw(h))})},onChainChanged(d){const h=Number(d);u.emitter.emit("change",{chainId:h})},onConnect(d){this.setRequestedChainsIds(R.getCaipNetworks().map(h=>Number(h.id)))},async onDisconnect(d){this.setRequestedChainsIds([]),u.emitter.emit("disconnect");const h=await this.getProvider();s&&(h.removeListener("accountsChanged",s),s=void 0),i&&(h.removeListener("chainChanged",i),i=void 0),l&&(h.removeListener("disconnect",l),l=void 0),c&&(h.removeListener("session_delete",c),c=void 0),o||(o=this.onConnect.bind(this),h.on("connect",o))},onDisplayUri(d){u.emitter.emit("message",{type:"display_uri",data:d})},onSessionDelete(){this.onDisconnect()},getNamespaceChainsIds(){var m,f,g;if(!((m=n==null?void 0:n.session)!=null&&m.namespaces))return[];const d=(g=(f=n==null?void 0:n.session)==null?void 0:f.namespaces[G.CHAIN.EVM])==null?void 0:g.accounts;return(d==null?void 0:d.map(_=>Number.parseInt(_.split(":")[1]??"")))??[]},async getRequestedChainsIds(){var h;const d=await((h=u.storage)==null?void 0:h.getItem(this.requestedChainsStorageKey))??[];return[...new Set(d)]},async isChainsStale(){if(!r)return!1;const d=u.chains.map(f=>f.id),h=this.getNamespaceChainsIds();if(h.length&&!h.some(f=>d.includes(f)))return!1;const m=await this.getRequestedChainsIds();return!d.every(f=>m.includes(Number(f)))},async setRequestedChainsIds(d){var h;await((h=u.storage)==null?void 0:h.setItem(this.requestedChainsStorageKey,d))},get requestedChainsStorageKey(){return`${this.id}.requestedChains`}}))}const Mo=et({pendingTransactions:0}),cw={state:Mo,subscribeKey(t,e){return Nt(Mo,t,e)},increase(t){Mo[t]+=1},decrease(t){Mo[t]-=1},reset(t){Mo[t]=0}};function gB(t){try{return JSON.parse(t)}catch{throw new Error("Error parsing wallet capabilities")}}async function mB(t){if(le.isSafeApp()){const{safe:e}=await mr(async()=>{const{safe:r}=await import("./index-tlA5APKf.js");return{safe:r}},__vite__mapDeps([43,2,3]));if(e&&!t.some(r=>r.type==="safe"))return e()}return null}async function wB(t){try{const{coinbaseWallet:e}=await mr(async()=>{const{coinbaseWallet:r}=await import("./index-tlA5APKf.js");return{coinbaseWallet:r}},__vite__mapDeps([43,2,3]));if(e&&!t.some(r=>r.id==="coinbaseWalletSDK"))return e()}catch(e){console.error("Failed to import Coinbase Wallet SDK:",e)}return null}const yB={enable:!1,pollingInterval:3e4};class N6 extends kb{constructor(e){const r=An.extendCaipNetworks(e.networks,{projectId:e.projectId,customNetworkImageUrls:{},customRpcUrls:e.customRpcUrls});super(),this.balancePromises={},this.namespace=G.CHAIN.EVM,this.adapterType=G.ADAPTER_TYPES.WAGMI,this.projectId=e.projectId,this.pendingTransactionsFilter={...yB,...e.pendingTransactionsFilter??{}},this.createConfig({...e,networks:r}),this.checkChainId()}construct(e){this.checkChainId(),this.setupWatchers()}async getAccounts(e){const r=this.getWagmiConnector(e.id);if(!r)return{accounts:[]};if(r.id===G.CONNECTOR_ID.AUTH){const i=await r.getProvider();if(!(i!=null&&i.user))return{accounts:[]};const{address:o,accounts:a}=i.user;return Promise.resolve({accounts:(a||[{address:o,type:"eoa"}]).map(c=>le.createAccount("eip155",c.address,c.type))})}const{addresses:n,address:s}=zl(this.wagmiConfig);return Promise.resolve({accounts:[...new Set(n||[s])].map(i=>le.createAccount("eip155",i||"","eoa"))})}checkChainId(){const{chainId:e}=zl(this.wagmiConfig);e&&this.emit("switchNetwork",{chainId:e})}getWagmiConnector(e){return this.wagmiConfig.connectors.find(r=>r.id===e)}createConfig(e){this.wagmiChains=e.networks.filter(s=>s.chainNamespace===G.CHAIN.EVM);const r={},n=[...e.connectors??[]];this.wagmiChains.forEach(s=>{var a,c;const i=(a=e.transports)==null?void 0:a[s.id],o=An.getCaipNetworkId(s);i?r[s.id]=An.extendWagmiTransports(s,e.projectId,i):r[s.id]=An.getViemTransport(s,e.projectId,(c=e.customRpcUrls)==null?void 0:c[o])}),this.wagmiConfig=Hb({...e,chains:this.wagmiChains,connectors:n,transports:r})}setupWatchPendingTransactions(){if(!this.pendingTransactionsFilter.enable||this.unwatchPendingTransactions)return;this.unwatchPendingTransactions=Wb(this.wagmiConfig,{pollingInterval:this.pendingTransactionsFilter.pollingInterval,onError:()=>{},onTransactions:()=>{this.emit("pendingTransactions"),cw.increase("pendingTransactions")}});const e=cw.subscribeKey("pendingTransactions",r=>{var n;r>=G.LIMITS.PENDING_TRANSACTIONS&&((n=this.unwatchPendingTransactions)==null||n.call(this),e())})}setupWatchers(){zb(this.wagmiConfig,{onChange:(e,r)=>{e.status==="disconnected"&&r.address&&this.emit("disconnect"),e!=null&&e.chainId&&(e==null?void 0:e.chainId)!==(r==null?void 0:r.chainId)&&this.emit("switchNetwork",{chainId:e.chainId}),e.status==="connected"&&(e.address!==(r==null?void 0:r.address)||r.status!=="connected")&&(this.setupWatchPendingTransactions(),this.emit("accountChanged",{address:e.address,chainId:e.chainId}))}})}async addThirdPartyConnectors(e){const r=[];if(e.enableCoinbase!==!1){const s=await wB(this.wagmiConfig.connectors);s&&r.push(s)}const n=await mB(this.wagmiConfig.connectors);n&&r.push(n),await Promise.all(r.map(s=>{const i=this.wagmiConfig._internal.connectors.setup(s);return this.wagmiConfig._internal.connectors.setState(o=>[...o,i]),this.addWagmiConnector(i,e)}))}addWagmiConnectors(e,r){var o,a,c,l;const n=[];e.enableWalletConnect!==!1&&n.push(lf(e,r)),e.enableInjected!==!1&&n.push(Vb({shimDisconnect:!0}));const s=((o=r==null?void 0:r.remoteFeatures)==null?void 0:o.email)??!0,i=Array.isArray((a=r==null?void 0:r.remoteFeatures)==null?void 0:a.socials)&&((l=(c=r==null?void 0:r.remoteFeatures)==null?void 0:c.socials)==null?void 0:l.length)>0;(s||i)&&n.push(pB({chains:this.wagmiChains,options:{projectId:e.projectId,enableAuthLogger:e.enableAuthLogger}})),n.forEach(u=>{const d=this.wagmiConfig._internal.connectors.setup(u);this.wagmiConfig._internal.connectors.setState(h=>[...h,d])})}async signMessage(e){try{return{signature:await Kb(this.wagmiConfig,{message:e.message,account:e.address})}}catch{throw new Error("WagmiAdapter:signMessage - Sign message failed")}}async sendTransaction(e){const{chainId:r,address:n}=zl(this.wagmiConfig),s={account:n,to:e.to,value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,data:e.data,chainId:r,type:"legacy",parameters:["nonce"]};await Gb(this.wagmiConfig,s);const i=await Yb(this.wagmiConfig,s);return await Zb(this.wagmiConfig,{hash:i,timeout:25e3}),{hash:i}}async writeContract(e){var o;const{caipNetwork:r,...n}=e,s=Number(ca.caipNetworkIdToNumber(r.caipNetworkId));return{hash:await Jb(this.wagmiConfig,{chain:(o=this.wagmiChains)==null?void 0:o[s],chainId:s,address:n.tokenAddress,account:n.fromAddress,abi:n.abi,functionName:n.method,args:n.args,__mode:"prepared"})}}async estimateGas(e){try{return{gas:await Xb(this.wagmiConfig,{account:e.address,to:e.to,data:e.data,type:"legacy"})}}catch{throw new Error("WagmiAdapter:estimateGas - error estimating gas")}}parseUnits(e){return Qb(e.value,e.decimals)}formatUnits(e){return uw(e.value,e.decimals)}async addWagmiConnector(e,r){var s;if(e.id===G.CONNECTOR_ID.AUTH||e.id===G.CONNECTOR_ID.WALLET_CONNECT)return;const n=await e.getProvider().catch(()=>{});this.addConnector({id:e.id,explorerId:Cs.ConnectorExplorerIds[e.id],imageUrl:((s=r==null?void 0:r.connectorImages)==null?void 0:s[e.id])??e.icon,name:Cs.ConnectorNamesMap[e.id]??e.name,imageId:Cs.ConnectorImageIds[e.id],type:Cs.ConnectorTypesMap[e.type]??"EXTERNAL",info:e.id===G.CONNECTOR_ID.INJECTED?void 0:{rdns:e.id},provider:n,chain:this.namespace,chains:[]})}async syncConnectors(e,r){eE(this.wagmiConfig,{onChange:n=>{n.forEach(s=>this.addWagmiConnector(s,e))}}),this.addWagmiConnectors(e,r),await Promise.all(this.wagmiConfig.connectors.map(n=>this.addWagmiConnector(n,e))),this.addThirdPartyConnectors(e)}async syncConnection(e){var l,u;const{id:r,chainId:n}=e,i=$s(this.wagmiConfig).find(d=>d.connector.id===r),o=this.getWagmiConnector(r),a=await(o==null?void 0:o.getProvider());if(le.isSafeApp()&&r===G.CONNECTOR_ID.SAFE&&!(i!=null&&i.accounts.length)){const d=this.getWagmiConnector("safe");if(d){const h=await Vl(this.wagmiConfig,{connector:d,chainId:Number(n)}),m=await d.getProvider();return{chainId:Number(n),address:h.accounts[0],provider:m,type:(l=i==null?void 0:i.connector.type)==null?void 0:l.toUpperCase(),id:i==null?void 0:i.connector.id}}}return{chainId:Number(i==null?void 0:i.chainId),address:i==null?void 0:i.accounts[0],provider:a,type:(u=i==null?void 0:i.connector.type)==null?void 0:u.toUpperCase(),id:i==null?void 0:i.connector.id}}async connectWalletConnect(e){const r=this.getWalletConnectConnector();await r.authenticate();const n=this.getWagmiConnector("walletConnect");if(!n)throw new Error("UniversalAdapter:connectWalletConnect - connector not found");const s=await Vl(this.wagmiConfig,{connector:n,chainId:e?Number(e):void 0});return s.chainId!==Number(e)&&await pf(this.wagmiConfig,{chainId:s.chainId}),{clientId:await r.provider.client.core.crypto.getClientId()}}async connect(e){var u,d,h,m,f;const{id:r,provider:n,type:s,info:i,chainId:o,socialUri:a}=e,c=this.getWagmiConnector(r);if(!c)throw new Error("connectionControllerClient:connectExternal - connector is undefined");if(n&&i&&c.id===G.CONNECTOR_ID.EIP6963&&((u=c.setEip6963Wallet)==null||u.call(c,{provider:n,info:i})),c.uid===((h=(d=this.wagmiConfig)==null?void 0:d.state)==null?void 0:h.current)){const g=(f=(m=this.wagmiConfig.state)==null?void 0:m.connections)==null?void 0:f.get(c.uid);if(g)return{address:g==null?void 0:g.accounts[0],chainId:g==null?void 0:g.chainId,provider:n,type:s,id:r}}const l=await Vl(this.wagmiConfig,{connector:c,chainId:o?Number(o):void 0,socialUri:a});return{address:l.accounts[0],chainId:l.chainId,provider:n,type:s,id:r}}async reconnect(e){const{id:r}=e,n=this.getWagmiConnector(r);if(!n)throw new Error("connectionControllerClient:connectExternal - connector is undefined");await gf(this.wagmiConfig,{connectors:[n]})}async getBalance(e){const r=e.address,n=this.getCaipNetworks().find(s=>s.id===e.chainId);if(!r)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(n&&this.wagmiConfig){const s=`${n.caipNetworkId}:${e.address}`,i=this.balancePromises[s];if(i)return i;const o=oe.getNativeBalanceCacheForCaipAddress(s);return o?{balance:o.balance,symbol:o.symbol}:(this.balancePromises[s]=new Promise(async a=>{var c,l;try{const u=Number(e.chainId),d=await tE(this.wagmiConfig,{address:e.address,chainId:u,token:(l=(c=e.tokens)==null?void 0:c[n.caipNetworkId])==null?void 0:l.address});oe.updateNativeBalanceCache({caipAddress:s,balance:d.formatted,symbol:d.symbol,timestamp:Date.now()}),a({balance:d.formatted,symbol:d.symbol})}catch(u){console.warn("Appkit:WagmiAdapter:getBalance - Error getting balance",u),a({balance:"0.00",symbol:"ETH"})}}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"})}return{balance:"",symbol:""}}getWalletConnectProvider(){var e;return(e=this.getWagmiConnector("walletConnect"))==null?void 0:e.provider}async disconnect(){const e=$s(this.wagmiConfig);await Promise.allSettled(e.map(async r=>{const n=this.getWagmiConnector(r.connector.id);n&&await rE(this.wagmiConfig,{connector:n})})),this.wagmiConfig.state.connections.clear()}async switchNetwork(e){var n,s,i,o,a;const{caipNetwork:r}=e;await pf(this.wagmiConfig,{chainId:r.id,addEthereumChainParameter:{chainName:r.name,nativeCurrency:r.nativeCurrency,rpcUrls:[((i=(s=(n=r.rpcUrls)==null?void 0:n.chainDefault)==null?void 0:s.http)==null?void 0:i[0])??""],blockExplorerUrls:[((o=r.blockExplorers)==null?void 0:o.default.url)??""],iconUrls:[((a=r.assets)==null?void 0:a.imageUrl)??""]}}),await super.switchNetwork(e)}async getCapabilities(e){var a,c;if(!this.wagmiConfig)throw new Error("connectionControllerClient:getCapabilities - wagmiConfig is undefined");const n=$s(this.wagmiConfig)[0],s=n?this.getWagmiConnector(n.connector.id):null;if(!s)throw new Error("connectionControllerClient:getCapabilities - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:getCapabilities - provider is undefined");const o=(c=(a=i.session)==null?void 0:a.sessionProperties)==null?void 0:c.capabilities;if(o){const u=gB(o)[e];if(u)return u}return await i.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:grantPermissions - wagmiConfig is undefined");const n=$s(this.wagmiConfig)[0],s=n?this.getWagmiConnector(n.connector.id):null;if(!s)throw new Error("connectionControllerClient:grantPermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:grantPermissions - provider is undefined");return i.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:revokePermissions - wagmiConfig is undefined");const n=$s(this.wagmiConfig)[0],s=n?this.getWagmiConnector(n.connector.id):null;if(!s)throw new Error("connectionControllerClient:revokePermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:revokePermissions - provider is undefined");return i.request({method:"wallet_revokePermissions",params:e})}async walletGetAssets(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:walletGetAssets - wagmiConfig is undefined");const n=$s(this.wagmiConfig)[0],s=n?this.getWagmiConnector(n.connector.id):null;if(!s)throw new Error("connectionControllerClient:walletGetAssets - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:walletGetAssets - provider is undefined");return i.request({method:"wallet_getAssets",params:[e]})}setUniversalProvider(e){e.on("connect",()=>{const r=$s(this.wagmiConfig),n=this.getWagmiConnector("walletConnect");n&&!r.find(s=>s.connector.id===n.id)&&gf(this.wagmiConfig,{connectors:[n]})}),this.addConnector(new cf({provider:e,caipNetworks:this.getCaipNetworks(),namespace:"eip155"}))}}export{Nt as $,ee as A,dt as B,ie as C,m6 as D,Zo as E,Ge as F,ww as G,ve as H,EB as I,gd as J,qo as K,on as L,Fe as M,vB as N,X as O,_f as P,sw as Q,me as R,pt as S,yr as T,nw as U,ye as V,N6 as W,Pr as X,BE as Y,et as Z,nt as _,zc as a,Tt as a0,Hc as a1,la as a2,Ea as a3,A6 as a4,bh as a5,mv as a6,Ji as a7,_B as a8,E6 as a9,Mt as aa,h6 as ab,v6 as ac,Tb as ad,Eh as ae,oo as af,p6 as ag,Av as ah,I6 as b,T6 as c,Ye as d,G as e,le as f,Kn as g,R as h,Qi as i,je as j,At as k,C6 as l,S6 as m,kr as n,ue as o,gt as p,g6 as q,_6 as r,P4 as s,_t as t,CB as u,$4 as v,oe as w,b6 as x,wt as y,Ae as z};
